Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=512, c_out=7, checkpoints='./checkpoints/', cut_freq=196, d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=7, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTh1_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:7
>>>>>>>start training : ETTh1_720_96_FITS_ETTh1_ftM_sl720_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=196, out_features=222, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  155947008.0
params:  43734.0
Trainable parameters:  43734
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 2.282963991165161
Epoch: 1, Steps: 15 | Train Loss: 0.7003916 Vali Loss: 1.6529287 Test Loss: 0.9418807
Validation loss decreased (inf --> 1.652929).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 2.6385340690612793
Epoch: 2, Steps: 15 | Train Loss: 0.6370319 Vali Loss: 1.5293413 Test Loss: 0.8908449
Validation loss decreased (1.652929 --> 1.529341).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 2.8862428665161133
Epoch: 3, Steps: 15 | Train Loss: 0.5885618 Vali Loss: 1.4486381 Test Loss: 0.8532531
Validation loss decreased (1.529341 --> 1.448638).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 2.935688018798828
Epoch: 4, Steps: 15 | Train Loss: 0.5525009 Vali Loss: 1.3991444 Test Loss: 0.8300209
Validation loss decreased (1.448638 --> 1.399144).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 2.8279688358306885
Epoch: 5, Steps: 15 | Train Loss: 0.5250500 Vali Loss: 1.3520514 Test Loss: 0.8119125
Validation loss decreased (1.399144 --> 1.352051).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 3.3202672004699707
Epoch: 6, Steps: 15 | Train Loss: 0.5027991 Vali Loss: 1.3274571 Test Loss: 0.8014960
Validation loss decreased (1.352051 --> 1.327457).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 2.541064739227295
Epoch: 7, Steps: 15 | Train Loss: 0.4850306 Vali Loss: 1.3043926 Test Loss: 0.7943518
Validation loss decreased (1.327457 --> 1.304393).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 2.5921225547790527
Epoch: 8, Steps: 15 | Train Loss: 0.4707922 Vali Loss: 1.2802464 Test Loss: 0.7880767
Validation loss decreased (1.304393 --> 1.280246).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 2.554921865463257
Epoch: 9, Steps: 15 | Train Loss: 0.4587004 Vali Loss: 1.2720590 Test Loss: 0.7847236
Validation loss decreased (1.280246 --> 1.272059).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 3.1293230056762695
Epoch: 10, Steps: 15 | Train Loss: 0.4481518 Vali Loss: 1.2652380 Test Loss: 0.7835057
Validation loss decreased (1.272059 --> 1.265238).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 3.009613513946533
Epoch: 11, Steps: 15 | Train Loss: 0.4391738 Vali Loss: 1.2733091 Test Loss: 0.7811591
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 2.994036912918091
Epoch: 12, Steps: 15 | Train Loss: 0.4313983 Vali Loss: 1.2538999 Test Loss: 0.7801442
Validation loss decreased (1.265238 --> 1.253900).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 2.7023441791534424
Epoch: 13, Steps: 15 | Train Loss: 0.4245723 Vali Loss: 1.2494220 Test Loss: 0.7794154
Validation loss decreased (1.253900 --> 1.249422).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 2.945646286010742
Epoch: 14, Steps: 15 | Train Loss: 0.4186622 Vali Loss: 1.2482698 Test Loss: 0.7787676
Validation loss decreased (1.249422 --> 1.248270).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 2.965952157974243
Epoch: 15, Steps: 15 | Train Loss: 0.4132208 Vali Loss: 1.2441007 Test Loss: 0.7786503
Validation loss decreased (1.248270 --> 1.244101).  Saving model ...
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 2.99416446685791
Epoch: 16, Steps: 15 | Train Loss: 0.4081777 Vali Loss: 1.2457793 Test Loss: 0.7789862
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 3.2305965423583984
Epoch: 17, Steps: 15 | Train Loss: 0.4038959 Vali Loss: 1.2408199 Test Loss: 0.7788033
Validation loss decreased (1.244101 --> 1.240820).  Saving model ...
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 2.9560365676879883
Epoch: 18, Steps: 15 | Train Loss: 0.3990565 Vali Loss: 1.2394043 Test Loss: 0.7780225
Validation loss decreased (1.240820 --> 1.239404).  Saving model ...
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 3.142946720123291
Epoch: 19, Steps: 15 | Train Loss: 0.3958234 Vali Loss: 1.2402264 Test Loss: 0.7773035
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 3.0575177669525146
Epoch: 20, Steps: 15 | Train Loss: 0.3918005 Vali Loss: 1.2364962 Test Loss: 0.7777643
Validation loss decreased (1.239404 --> 1.236496).  Saving model ...
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 3.066575288772583
Epoch: 21, Steps: 15 | Train Loss: 0.3886236 Vali Loss: 1.2357883 Test Loss: 0.7770880
Validation loss decreased (1.236496 --> 1.235788).  Saving model ...
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 2.524925947189331
Epoch: 22, Steps: 15 | Train Loss: 0.3856520 Vali Loss: 1.2377762 Test Loss: 0.7770017
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 2.8609488010406494
Epoch: 23, Steps: 15 | Train Loss: 0.3825325 Vali Loss: 1.2314364 Test Loss: 0.7767323
Validation loss decreased (1.235788 --> 1.231436).  Saving model ...
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 2.7161316871643066
Epoch: 24, Steps: 15 | Train Loss: 0.3796245 Vali Loss: 1.2345752 Test Loss: 0.7766316
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 2.7924110889434814
Epoch: 25, Steps: 15 | Train Loss: 0.3774967 Vali Loss: 1.2352786 Test Loss: 0.7767353
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 2.6227195262908936
Epoch: 26, Steps: 15 | Train Loss: 0.3750571 Vali Loss: 1.2307411 Test Loss: 0.7761738
Validation loss decreased (1.231436 --> 1.230741).  Saving model ...
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 2.731250286102295
Epoch: 27, Steps: 15 | Train Loss: 0.3728760 Vali Loss: 1.2331860 Test Loss: 0.7753604
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 2.185943365097046
Epoch: 28, Steps: 15 | Train Loss: 0.3706256 Vali Loss: 1.2256836 Test Loss: 0.7752324
Validation loss decreased (1.230741 --> 1.225684).  Saving model ...
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 2.5272672176361084
Epoch: 29, Steps: 15 | Train Loss: 0.3692584 Vali Loss: 1.2302740 Test Loss: 0.7747231
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 2.362098217010498
Epoch: 30, Steps: 15 | Train Loss: 0.3670177 Vali Loss: 1.2243817 Test Loss: 0.7746539
Validation loss decreased (1.225684 --> 1.224382).  Saving model ...
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 2.3869237899780273
Epoch: 31, Steps: 15 | Train Loss: 0.3656337 Vali Loss: 1.2238516 Test Loss: 0.7739773
Validation loss decreased (1.224382 --> 1.223852).  Saving model ...
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 2.6752591133117676
Epoch: 32, Steps: 15 | Train Loss: 0.3636997 Vali Loss: 1.2240279 Test Loss: 0.7736974
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 2.879739999771118
Epoch: 33, Steps: 15 | Train Loss: 0.3622154 Vali Loss: 1.2214749 Test Loss: 0.7734039
Validation loss decreased (1.223852 --> 1.221475).  Saving model ...
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 3.133283853530884
Epoch: 34, Steps: 15 | Train Loss: 0.3607585 Vali Loss: 1.2225988 Test Loss: 0.7728486
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 2.812283754348755
Epoch: 35, Steps: 15 | Train Loss: 0.3591414 Vali Loss: 1.2252691 Test Loss: 0.7727642
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 2.5437281131744385
Epoch: 36, Steps: 15 | Train Loss: 0.3581205 Vali Loss: 1.2172599 Test Loss: 0.7722276
Validation loss decreased (1.221475 --> 1.217260).  Saving model ...
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 2.8087246417999268
Epoch: 37, Steps: 15 | Train Loss: 0.3569054 Vali Loss: 1.2221903 Test Loss: 0.7720954
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 2.7611093521118164
Epoch: 38, Steps: 15 | Train Loss: 0.3556079 Vali Loss: 1.2185090 Test Loss: 0.7718289
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 2.6887547969818115
Epoch: 39, Steps: 15 | Train Loss: 0.3544658 Vali Loss: 1.2189581 Test Loss: 0.7715295
EarlyStopping counter: 3 out of 3
Early stopping
train 7825
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=196, out_features=222, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  155947008.0
params:  43734.0
Trainable parameters:  43734
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 3.07330060005188
Epoch: 1, Steps: 15 | Train Loss: 0.5290150 Vali Loss: 1.0750357 Test Loss: 0.6578139
Validation loss decreased (inf --> 1.075036).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 2.8151073455810547
Epoch: 2, Steps: 15 | Train Loss: 0.4706110 Vali Loss: 0.9676949 Test Loss: 0.5766140
Validation loss decreased (1.075036 --> 0.967695).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 3.131279468536377
Epoch: 3, Steps: 15 | Train Loss: 0.4308861 Vali Loss: 0.8968340 Test Loss: 0.5201510
Validation loss decreased (0.967695 --> 0.896834).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 3.0973401069641113
Epoch: 4, Steps: 15 | Train Loss: 0.4038108 Vali Loss: 0.8469580 Test Loss: 0.4800371
Validation loss decreased (0.896834 --> 0.846958).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 2.717069387435913
Epoch: 5, Steps: 15 | Train Loss: 0.3844958 Vali Loss: 0.8121545 Test Loss: 0.4520444
Validation loss decreased (0.846958 --> 0.812154).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 3.240114688873291
Epoch: 6, Steps: 15 | Train Loss: 0.3705423 Vali Loss: 0.7863473 Test Loss: 0.4324462
Validation loss decreased (0.812154 --> 0.786347).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 2.897756576538086
Epoch: 7, Steps: 15 | Train Loss: 0.3606726 Vali Loss: 0.7686142 Test Loss: 0.4190192
Validation loss decreased (0.786347 --> 0.768614).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 3.2160484790802
Epoch: 8, Steps: 15 | Train Loss: 0.3544595 Vali Loss: 0.7544869 Test Loss: 0.4096770
Validation loss decreased (0.768614 --> 0.754487).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 3.098031997680664
Epoch: 9, Steps: 15 | Train Loss: 0.3498220 Vali Loss: 0.7467788 Test Loss: 0.4032562
Validation loss decreased (0.754487 --> 0.746779).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 3.2059547901153564
Epoch: 10, Steps: 15 | Train Loss: 0.3461742 Vali Loss: 0.7402329 Test Loss: 0.3985096
Validation loss decreased (0.746779 --> 0.740233).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 3.357872486114502
Epoch: 11, Steps: 15 | Train Loss: 0.3437823 Vali Loss: 0.7356747 Test Loss: 0.3952631
Validation loss decreased (0.740233 --> 0.735675).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 2.9519526958465576
Epoch: 12, Steps: 15 | Train Loss: 0.3414992 Vali Loss: 0.7305461 Test Loss: 0.3928735
Validation loss decreased (0.735675 --> 0.730546).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 3.1327531337738037
Epoch: 13, Steps: 15 | Train Loss: 0.3402983 Vali Loss: 0.7235502 Test Loss: 0.3915019
Validation loss decreased (0.730546 --> 0.723550).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 3.0830323696136475
Epoch: 14, Steps: 15 | Train Loss: 0.3389470 Vali Loss: 0.7179833 Test Loss: 0.3902109
Validation loss decreased (0.723550 --> 0.717983).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 3.0456387996673584
Epoch: 15, Steps: 15 | Train Loss: 0.3388167 Vali Loss: 0.7204199 Test Loss: 0.3893324
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 3.140322685241699
Epoch: 16, Steps: 15 | Train Loss: 0.3379137 Vali Loss: 0.7183901 Test Loss: 0.3887854
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 3.348335027694702
Epoch: 17, Steps: 15 | Train Loss: 0.3375331 Vali Loss: 0.7205749 Test Loss: 0.3882202
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTh1_720_96_FITS_ETTh1_ftM_sl720_ll48_pl96_H6_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.3820028603076935, mae:0.4051586091518402, rse:0.5870717167854309, corr:[0.27304354 0.27836415 0.27617508 0.27900165 0.27716196 0.27332768
 0.2725414  0.27343404 0.27305603 0.2720721  0.27188975 0.27206847
 0.27182353 0.27096945 0.27033013 0.27058285 0.2709185  0.27044
 0.26936325 0.2688307  0.26874167 0.2680522  0.2669843  0.26731005
 0.26799682 0.26751482 0.26671427 0.26692882 0.26761594 0.26759598
 0.26700637 0.26654744 0.26655918 0.26645157 0.26588842 0.26571184
 0.26597425 0.26598844 0.26555425 0.26528308 0.2659442  0.26668745
 0.26665995 0.2661475  0.265982   0.26634288 0.26684883 0.26722136
 0.26709986 0.26682764 0.26602793 0.26500273 0.26399252 0.26291567
 0.262207   0.2614486  0.26072282 0.26089498 0.26110736 0.2609255
 0.2602511  0.26023313 0.26082522 0.26081884 0.26007062 0.2599685
 0.2611107  0.26149958 0.2606944  0.26012054 0.26042366 0.26056296
 0.25973037 0.25854608 0.25770822 0.2577705  0.2573471  0.2563259
 0.2556858  0.25544497 0.25469807 0.25365597 0.2532594  0.25352728
 0.25334543 0.25240737 0.25225237 0.2525234  0.25174275 0.24996977
 0.24914728 0.24897173 0.24608262 0.24050115 0.24057187 0.2390782 ]
