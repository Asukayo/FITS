Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=144, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=70, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=3, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=True, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Weather_720_j96_H10', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=2021, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:3
>>>>>>>start training : Weather_720_j96_H10_FITS_custom_ftM_sl720_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 5175
test 10444
Model(
  (freq_upsampler): ModuleList(
    (0): Linear(in_features=70, out_features=79, bias=True)
    (1): Linear(in_features=70, out_features=79, bias=True)
    (2): Linear(in_features=70, out_features=79, bias=True)
    (3): Linear(in_features=70, out_features=79, bias=True)
    (4): Linear(in_features=70, out_features=79, bias=True)
    (5): Linear(in_features=70, out_features=79, bias=True)
    (6): Linear(in_features=70, out_features=79, bias=True)
    (7): Linear(in_features=70, out_features=79, bias=True)
    (8): Linear(in_features=70, out_features=79, bias=True)
    (9): Linear(in_features=70, out_features=79, bias=True)
    (10): Linear(in_features=70, out_features=79, bias=True)
    (11): Linear(in_features=70, out_features=79, bias=True)
    (12): Linear(in_features=70, out_features=79, bias=True)
    (13): Linear(in_features=70, out_features=79, bias=True)
    (14): Linear(in_features=70, out_features=79, bias=True)
    (15): Linear(in_features=70, out_features=79, bias=True)
    (16): Linear(in_features=70, out_features=79, bias=True)
    (17): Linear(in_features=70, out_features=79, bias=True)
    (18): Linear(in_features=70, out_features=79, bias=True)
    (19): Linear(in_features=70, out_features=79, bias=True)
    (20): Linear(in_features=70, out_features=79, bias=True)
  )
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  14864640.0
params:  117789.0
Trainable parameters:  117789
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3655212
	speed: 0.2002s/iter; left time: 2793.0956s
	iters: 200, epoch: 1 | loss: 0.3668001
	speed: 0.1723s/iter; left time: 2387.1764s
Epoch: 1 cost time: 51.102394104003906
Epoch: 1, Steps: 281 | Train Loss: 0.4990466 Vali Loss: 0.4133729 Test Loss: 0.1651707
Validation loss decreased (inf --> 0.413373).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3415803
	speed: 0.6110s/iter; left time: 8352.8835s
	iters: 200, epoch: 2 | loss: 0.6114894
	speed: 0.1611s/iter; left time: 2186.2321s
Epoch: 2 cost time: 46.62685823440552
Epoch: 2, Steps: 281 | Train Loss: 0.4091563 Vali Loss: 0.3955794 Test Loss: 0.1546467
Validation loss decreased (0.413373 --> 0.395579).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3154807
	speed: 0.5416s/iter; left time: 7251.1608s
	iters: 200, epoch: 3 | loss: 0.3751000
	speed: 0.1684s/iter; left time: 2237.7909s
Epoch: 3 cost time: 46.066309213638306
Epoch: 3, Steps: 281 | Train Loss: 0.4005315 Vali Loss: 0.3904904 Test Loss: 0.1503333
Validation loss decreased (0.395579 --> 0.390490).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3172369
	speed: 0.6136s/iter; left time: 8043.6236s
	iters: 200, epoch: 4 | loss: 0.7916231
	speed: 0.1654s/iter; left time: 2151.5593s
Epoch: 4 cost time: 47.14536690711975
Epoch: 4, Steps: 281 | Train Loss: 0.3964448 Vali Loss: 0.3876416 Test Loss: 0.1480428
Validation loss decreased (0.390490 --> 0.387642).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2446576
	speed: 0.6360s/iter; left time: 8158.0121s
	iters: 200, epoch: 5 | loss: 0.2969828
	speed: 0.1915s/iter; left time: 2436.6723s
Epoch: 5 cost time: 53.734384298324585
Epoch: 5, Steps: 281 | Train Loss: 0.3943367 Vali Loss: 0.3854669 Test Loss: 0.1474979
Validation loss decreased (0.387642 --> 0.385467).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2487536
	speed: 0.6511s/iter; left time: 8168.8834s
	iters: 200, epoch: 6 | loss: 0.2919302
	speed: 0.1614s/iter; left time: 2008.6227s
Epoch: 6 cost time: 46.671499252319336
Epoch: 6, Steps: 281 | Train Loss: 0.3919639 Vali Loss: 0.3844148 Test Loss: 0.1463824
Validation loss decreased (0.385467 --> 0.384415).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3359546
	speed: 0.6038s/iter; left time: 7405.7554s
	iters: 200, epoch: 7 | loss: 0.2587764
	speed: 0.1636s/iter; left time: 1989.7414s
Epoch: 7 cost time: 46.573217153549194
Epoch: 7, Steps: 281 | Train Loss: 0.3910068 Vali Loss: 0.3810033 Test Loss: 0.1460380
Validation loss decreased (0.384415 --> 0.381003).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.5696931
	speed: 0.5970s/iter; left time: 7154.0702s
	iters: 200, epoch: 8 | loss: 0.3112347
	speed: 0.1653s/iter; left time: 1964.2968s
Epoch: 8 cost time: 46.63103699684143
Epoch: 8, Steps: 281 | Train Loss: 0.3902764 Vali Loss: 0.3826255 Test Loss: 0.1452653
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3282650
	speed: 0.5947s/iter; left time: 6960.0290s
	iters: 200, epoch: 9 | loss: 0.2967194
	speed: 0.1645s/iter; left time: 1908.1637s
Epoch: 9 cost time: 46.9804892539978
Epoch: 9, Steps: 281 | Train Loss: 0.3906024 Vali Loss: 0.3811091 Test Loss: 0.1450386
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3055225
	speed: 0.6293s/iter; left time: 7187.3670s
	iters: 200, epoch: 10 | loss: 0.2819517
	speed: 0.1828s/iter; left time: 2069.2116s
Epoch: 10 cost time: 51.607590198516846
Epoch: 10, Steps: 281 | Train Loss: 0.3899792 Vali Loss: 0.3814585 Test Loss: 0.1445693
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Weather_720_j96_H10_FITS_custom_ftM_sl720_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.14655020833015442, mae:0.20061366260051727, rse:0.5044817328453064, corr:[0.4745812  0.47802722 0.47871625 0.47788802 0.47663218 0.475668
 0.47528493 0.47534016 0.4754345  0.47519016 0.4744633  0.47343525
 0.47234944 0.47144353 0.47084346 0.47043777 0.4701316  0.46967784
 0.46902338 0.4680852  0.46702006 0.46600077 0.4652314  0.46469158
 0.46430278 0.46391228 0.46334925 0.4624904  0.46140456 0.460192
 0.45908576 0.45825756 0.4578636  0.45777485 0.45784384 0.4577653
 0.45746493 0.45683563 0.45592323 0.45486224 0.453893   0.45321873
 0.4528795  0.45276752 0.45271373 0.4525252  0.45216185 0.45159018
 0.4506884  0.44965994 0.44869274 0.44781983 0.4471996  0.4467767
 0.44645303 0.4461048  0.44568095 0.44513422 0.44450626 0.44384918
 0.4432602  0.44278494 0.44246122 0.4422492  0.44207862 0.4419028
 0.44163805 0.44127044 0.44081342 0.44029215 0.4398104  0.43932527
 0.4389726  0.4387448  0.43855375 0.43836248 0.4381209  0.43782982
 0.43742546 0.4368776  0.43628237 0.43565178 0.4350492  0.43460715
 0.4344272  0.43443    0.4344363  0.43419537 0.433701   0.43292266
 0.43202686 0.43125424 0.43083    0.43090254 0.43113112 0.4306961 ]
