Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=144, batch_size=256, c_out=7, checkpoints='./checkpoints/', cut_freq=82, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=3, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Weather_720_j96_H12', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=2021, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:3
>>>>>>>start training : Weather_720_j96_H12_FITS_custom_ftM_sl720_ll48_pl96_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 5175
test 10444
Model(
  (freq_upsampler): Linear(in_features=82, out_features=92, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  40556544.0
params:  7636.0
Trainable parameters:  7636
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3892356
	speed: 0.1482s/iter; left time: 1022.5292s
Epoch: 1 cost time: 21.19107174873352
Epoch: 1, Steps: 140 | Train Loss: 0.5459759 Vali Loss: 0.4587610 Test Loss: 0.1959459
Validation loss decreased (inf --> 0.458761).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.6503645
	speed: 0.4061s/iter; left time: 2745.9304s
Epoch: 2 cost time: 24.106626987457275
Epoch: 2, Steps: 140 | Train Loss: 0.4596592 Vali Loss: 0.4361559 Test Loss: 0.1826604
Validation loss decreased (0.458761 --> 0.436156).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3291559
	speed: 0.4218s/iter; left time: 2792.8212s
Epoch: 3 cost time: 25.793867111206055
Epoch: 3, Steps: 140 | Train Loss: 0.4477408 Vali Loss: 0.4277452 Test Loss: 0.1774627
Validation loss decreased (0.436156 --> 0.427745).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.4959517
	speed: 0.4570s/iter; left time: 2962.0766s
Epoch: 4 cost time: 26.155434131622314
Epoch: 4, Steps: 140 | Train Loss: 0.4433257 Vali Loss: 0.4229121 Test Loss: 0.1749415
Validation loss decreased (0.427745 --> 0.422912).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3620314
	speed: 0.4640s/iter; left time: 2942.2324s
Epoch: 5 cost time: 27.16380214691162
Epoch: 5, Steps: 140 | Train Loss: 0.4416485 Vali Loss: 0.4212821 Test Loss: 0.1729708
Validation loss decreased (0.422912 --> 0.421282).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.4716102
	speed: 0.4298s/iter; left time: 2665.0555s
Epoch: 6 cost time: 24.587024211883545
Epoch: 6, Steps: 140 | Train Loss: 0.4401408 Vali Loss: 0.4181834 Test Loss: 0.1726096
Validation loss decreased (0.421282 --> 0.418183).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.4570239
	speed: 0.3452s/iter; left time: 2092.1461s
Epoch: 7 cost time: 20.011940002441406
Epoch: 7, Steps: 140 | Train Loss: 0.4392494 Vali Loss: 0.4165679 Test Loss: 0.1717636
Validation loss decreased (0.418183 --> 0.416568).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3594302
	speed: 0.4203s/iter; left time: 2488.5894s
Epoch: 8 cost time: 24.92663049697876
Epoch: 8, Steps: 140 | Train Loss: 0.4394868 Vali Loss: 0.4176949 Test Loss: 0.1711636
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.4340213
	speed: 0.4155s/iter; left time: 2402.1954s
Epoch: 9 cost time: 24.32761311531067
Epoch: 9, Steps: 140 | Train Loss: 0.4371873 Vali Loss: 0.4179395 Test Loss: 0.1717817
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.4785029
	speed: 0.4240s/iter; left time: 2391.5495s
Epoch: 10 cost time: 25.09554624557495
Epoch: 10, Steps: 140 | Train Loss: 0.4376827 Vali Loss: 0.4161449 Test Loss: 0.1702452
Validation loss decreased (0.416568 --> 0.416145).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3716153
	speed: 0.4044s/iter; left time: 2224.6632s
Epoch: 11 cost time: 21.719202518463135
Epoch: 11, Steps: 140 | Train Loss: 0.4372549 Vali Loss: 0.4165355 Test Loss: 0.1700873
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3560989
	speed: 0.3945s/iter; left time: 2114.9138s
Epoch: 12 cost time: 26.158825159072876
Epoch: 12, Steps: 140 | Train Loss: 0.4380789 Vali Loss: 0.4147338 Test Loss: 0.1708846
Validation loss decreased (0.416145 --> 0.414734).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.6280745
	speed: 0.4717s/iter; left time: 2462.8067s
Epoch: 13 cost time: 27.583207368850708
Epoch: 13, Steps: 140 | Train Loss: 0.4375851 Vali Loss: 0.4148195 Test Loss: 0.1705174
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.5279099
	speed: 0.4661s/iter; left time: 2368.3928s
Epoch: 14 cost time: 27.051891326904297
Epoch: 14, Steps: 140 | Train Loss: 0.4368248 Vali Loss: 0.4131483 Test Loss: 0.1697271
Validation loss decreased (0.414734 --> 0.413148).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3526062
	speed: 0.3971s/iter; left time: 1962.1907s
Epoch: 15 cost time: 20.304837226867676
Epoch: 15, Steps: 140 | Train Loss: 0.4352476 Vali Loss: 0.4164275 Test Loss: 0.1700629
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3406090
	speed: 0.4090s/iter; left time: 1963.8427s
Epoch: 16 cost time: 26.257909297943115
Epoch: 16, Steps: 140 | Train Loss: 0.4371778 Vali Loss: 0.4147831 Test Loss: 0.1699517
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.4630566
	speed: 0.4116s/iter; left time: 1918.4494s
Epoch: 17 cost time: 21.27527117729187
Epoch: 17, Steps: 140 | Train Loss: 0.4372845 Vali Loss: 0.4123794 Test Loss: 0.1699654
Validation loss decreased (0.413148 --> 0.412379).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3362907
	speed: 0.3692s/iter; left time: 1669.1261s
Epoch: 18 cost time: 24.450475931167603
Epoch: 18, Steps: 140 | Train Loss: 0.4370419 Vali Loss: 0.4138339 Test Loss: 0.1696833
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3480721
	speed: 0.4210s/iter; left time: 1844.4241s
Epoch: 19 cost time: 24.91202449798584
Epoch: 19, Steps: 140 | Train Loss: 0.4363947 Vali Loss: 0.4120668 Test Loss: 0.1697359
Validation loss decreased (0.412379 --> 0.412067).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2932234
	speed: 0.4256s/iter; left time: 1805.0242s
Epoch: 20 cost time: 23.986039876937866
Epoch: 20, Steps: 140 | Train Loss: 0.4359031 Vali Loss: 0.4139004 Test Loss: 0.1697608
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3756259
	speed: 0.4084s/iter; left time: 1674.9721s
Epoch: 21 cost time: 26.127647638320923
Epoch: 21, Steps: 140 | Train Loss: 0.4369215 Vali Loss: 0.4158766 Test Loss: 0.1697357
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3751122
	speed: 0.4976s/iter; left time: 1970.9583s
Epoch: 22 cost time: 28.51778292655945
Epoch: 22, Steps: 140 | Train Loss: 0.4368882 Vali Loss: 0.4139397 Test Loss: 0.1693577
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Weather_720_j96_H12_FITS_custom_ftM_sl720_ll48_pl96_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.17036977410316467, mae:0.22510342299938202, rse:0.5439368486404419, corr:[0.48389068 0.48662516 0.48629183 0.48527873 0.4847148  0.4847358
 0.4849644  0.4850201  0.48466766 0.4840348  0.48347285 0.48325366
 0.48330158 0.48339352 0.48325887 0.48275286 0.48202604 0.48109427
 0.4803444  0.4798455  0.47960597 0.47945675 0.47921026 0.47863176
 0.4777454  0.47667998 0.4756357  0.47464746 0.47387198 0.4732009
 0.4726149  0.47197333 0.47129142 0.47047278 0.46966022 0.46887183
 0.46824837 0.46764374 0.46701068 0.46628818 0.46554506 0.46486357
 0.46418047 0.46352953 0.46294764 0.46239227 0.46189705 0.461431
 0.46082488 0.46021014 0.45965925 0.45910734 0.45868403 0.4583084
 0.45792308 0.4574464  0.45696402 0.45644382 0.4559484  0.4554794
 0.45508045 0.45468333 0.4543372  0.45397764 0.4536167  0.4533047
 0.4529135  0.4525173  0.4521205  0.45177776 0.4515092  0.45116508
 0.4508049  0.45033988 0.44970942 0.4490452  0.44847012 0.44810724
 0.44790053 0.44775206 0.44772193 0.44770664 0.44750112 0.4471219
 0.44668132 0.44621795 0.4459507  0.44575813 0.44560614 0.44523436
 0.4446363  0.44398132 0.4435218  0.44341117 0.4434196  0.44263384]
