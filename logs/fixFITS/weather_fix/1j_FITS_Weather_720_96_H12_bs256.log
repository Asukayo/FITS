Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=144, batch_size=512, c_out=7, checkpoints='./checkpoints/', cut_freq=82, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=3, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Weather_720_j96_H12', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=2021, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:3
>>>>>>>start training : Weather_720_j96_H12_FITS_custom_ftM_sl720_ll48_pl96_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 36072
val 5175
test 10444
Model(
  (freq_upsampler): Linear(in_features=82, out_features=92, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  81113088.0
params:  7636.0
Trainable parameters:  7636
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 13.482458353042603
Epoch: 1, Steps: 70 | Train Loss: 0.6033906 Vali Loss: 0.4976005 Test Loss: 0.2092360
Validation loss decreased (inf --> 0.497600).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 12.037371397018433
Epoch: 2, Steps: 70 | Train Loss: 0.4840648 Vali Loss: 0.4595859 Test Loss: 0.1914935
Validation loss decreased (0.497600 --> 0.459586).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 11.59539794921875
Epoch: 3, Steps: 70 | Train Loss: 0.4630605 Vali Loss: 0.4456148 Test Loss: 0.1842593
Validation loss decreased (0.459586 --> 0.445615).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 11.561028003692627
Epoch: 4, Steps: 70 | Train Loss: 0.4537809 Vali Loss: 0.4360608 Test Loss: 0.1790711
Validation loss decreased (0.445615 --> 0.436061).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 11.914832353591919
Epoch: 5, Steps: 70 | Train Loss: 0.4495031 Vali Loss: 0.4311375 Test Loss: 0.1762835
Validation loss decreased (0.436061 --> 0.431137).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 11.787511587142944
Epoch: 6, Steps: 70 | Train Loss: 0.4461477 Vali Loss: 0.4268538 Test Loss: 0.1741534
Validation loss decreased (0.431137 --> 0.426854).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 11.84238052368164
Epoch: 7, Steps: 70 | Train Loss: 0.4426042 Vali Loss: 0.4252314 Test Loss: 0.1730793
Validation loss decreased (0.426854 --> 0.425231).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 11.828436613082886
Epoch: 8, Steps: 70 | Train Loss: 0.4429765 Vali Loss: 0.4222450 Test Loss: 0.1719837
Validation loss decreased (0.425231 --> 0.422245).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 11.593575477600098
Epoch: 9, Steps: 70 | Train Loss: 0.4416220 Vali Loss: 0.4225163 Test Loss: 0.1712067
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 10.744592905044556
Epoch: 10, Steps: 70 | Train Loss: 0.4404691 Vali Loss: 0.4216681 Test Loss: 0.1704116
Validation loss decreased (0.422245 --> 0.421668).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 9.899063110351562
Epoch: 11, Steps: 70 | Train Loss: 0.4402471 Vali Loss: 0.4182184 Test Loss: 0.1698805
Validation loss decreased (0.421668 --> 0.418218).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 11.690351486206055
Epoch: 12, Steps: 70 | Train Loss: 0.4395588 Vali Loss: 0.4207300 Test Loss: 0.1695378
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 12.000704288482666
Epoch: 13, Steps: 70 | Train Loss: 0.4394675 Vali Loss: 0.4187462 Test Loss: 0.1691764
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 11.756143808364868
Epoch: 14, Steps: 70 | Train Loss: 0.4387374 Vali Loss: 0.4187849 Test Loss: 0.1692773
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Weather_720_j96_H12_FITS_custom_ftM_sl720_ll48_pl96_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10444
mse:0.17351625859737396, mae:0.2296621948480606, rse:0.5489367246627808, corr:[0.4775519  0.48536375 0.4879896  0.48669693 0.48424125 0.48303986
 0.48356986 0.48494348 0.48599046 0.48609638 0.48531616 0.48410574
 0.4830357  0.48258334 0.4827227  0.48299858 0.48299414 0.48239464
 0.48143774 0.48032394 0.47939715 0.47889104 0.478787   0.4787005
 0.47829923 0.47745338 0.4763078  0.47500858 0.47391137 0.47313666
 0.47275847 0.47251564 0.4721529  0.47140747 0.47043425 0.4693638
 0.46845436 0.46768484 0.46712148 0.4667004  0.46631765 0.4658626
 0.4652175  0.46447113 0.4637283  0.46301067 0.46243754 0.462028
 0.4615667  0.46104512 0.46047068 0.45983246 0.4593419  0.45891836
 0.4584986  0.458035   0.45761847 0.45716184 0.45666984 0.45616654
 0.45576677 0.4554135  0.4551085  0.45473665 0.45432925 0.45394737
 0.45345524 0.45297232 0.4525708  0.45234004 0.452226   0.45194873
 0.45155397 0.4509503  0.45010212 0.44926775 0.44865984 0.4484113
 0.44833094 0.4481124  0.4478125  0.4475011  0.4471366  0.4467774
 0.44650543 0.44623432 0.4460892  0.44560683 0.44468662 0.44343302
 0.44241115 0.44196966 0.4422575  0.44325042 0.44298583 0.4381345 ]
