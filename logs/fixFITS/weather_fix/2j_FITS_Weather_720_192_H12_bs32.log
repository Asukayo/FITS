Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=144, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=82, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=3, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Weather_720_j192_H12', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=2021, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:3
>>>>>>>start training : Weather_720_j192_H12_FITS_custom_ftM_sl720_ll48_pl192_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35976
val 5079
test 10348
Model(
  (freq_upsampler): Linear(in_features=82, out_features=103, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  11351424.0
params:  8549.0
Trainable parameters:  8549
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.5927462
	speed: 0.1654s/iter; left time: 4632.0722s
	iters: 200, epoch: 1 | loss: 0.3652154
	speed: 0.1597s/iter; left time: 4455.2973s
	iters: 300, epoch: 1 | loss: 0.4027639
	speed: 0.1592s/iter; left time: 4426.7569s
	iters: 400, epoch: 1 | loss: 0.3225365
	speed: 0.1620s/iter; left time: 4487.1449s
	iters: 500, epoch: 1 | loss: 0.3013712
	speed: 0.1612s/iter; left time: 4450.3680s
Epoch: 1 cost time: 90.64941620826721
Epoch: 1, Steps: 562 | Train Loss: 0.4498922 Vali Loss: 0.5541945 Test Loss: 0.2479621
Validation loss decreased (inf --> 0.554195).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2819090
	speed: 0.8796s/iter; left time: 24134.1144s
	iters: 200, epoch: 2 | loss: 0.2619432
	speed: 0.1629s/iter; left time: 4453.7036s
	iters: 300, epoch: 2 | loss: 0.2775272
	speed: 0.1546s/iter; left time: 4210.6612s
	iters: 400, epoch: 2 | loss: 0.2017469
	speed: 0.1690s/iter; left time: 4587.3288s
	iters: 500, epoch: 2 | loss: 0.1828937
	speed: 0.1632s/iter; left time: 4412.2531s
Epoch: 2 cost time: 92.29247856140137
Epoch: 2, Steps: 562 | Train Loss: 0.2515565 Vali Loss: 0.5149400 Test Loss: 0.2307639
Validation loss decreased (0.554195 --> 0.514940).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1967418
	speed: 0.9063s/iter; left time: 24358.0116s
	iters: 200, epoch: 3 | loss: 0.1730729
	speed: 0.1515s/iter; left time: 4056.3005s
	iters: 300, epoch: 3 | loss: 0.1722777
	speed: 0.1497s/iter; left time: 3992.8905s
	iters: 400, epoch: 3 | loss: 0.1741146
	speed: 0.1730s/iter; left time: 4598.1520s
	iters: 500, epoch: 3 | loss: 0.2199787
	speed: 0.1814s/iter; left time: 4803.7718s
Epoch: 3 cost time: 93.30319881439209
Epoch: 3, Steps: 562 | Train Loss: 0.2001277 Vali Loss: 0.4935395 Test Loss: 0.2227515
Validation loss decreased (0.514940 --> 0.493539).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1717537
	speed: 0.9933s/iter; left time: 26137.5897s
	iters: 200, epoch: 4 | loss: 0.2625661
	speed: 0.1823s/iter; left time: 4780.0141s
	iters: 300, epoch: 4 | loss: 0.1616118
	speed: 0.1822s/iter; left time: 4758.1350s
	iters: 400, epoch: 4 | loss: 0.1358450
	speed: 0.1869s/iter; left time: 4862.2793s
	iters: 500, epoch: 4 | loss: 0.2242338
	speed: 0.1853s/iter; left time: 4802.3726s
Epoch: 4 cost time: 103.4348657131195
Epoch: 4, Steps: 562 | Train Loss: 0.1850679 Vali Loss: 0.4863729 Test Loss: 0.2194841
Validation loss decreased (0.493539 --> 0.486373).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1530510
	speed: 1.1444s/iter; left time: 29471.5510s
	iters: 200, epoch: 5 | loss: 0.1253589
	speed: 0.1592s/iter; left time: 4082.8385s
	iters: 300, epoch: 5 | loss: 0.1675562
	speed: 0.1581s/iter; left time: 4040.0904s
	iters: 400, epoch: 5 | loss: 0.1732520
	speed: 0.1798s/iter; left time: 4576.3552s
	iters: 500, epoch: 5 | loss: 0.2017652
	speed: 0.1901s/iter; left time: 4818.6329s
Epoch: 5 cost time: 102.51433753967285
Epoch: 5, Steps: 562 | Train Loss: 0.1812946 Vali Loss: 0.4838202 Test Loss: 0.2192036
Validation loss decreased (0.486373 --> 0.483820).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2219198
	speed: 1.0532s/iter; left time: 26530.1642s
	iters: 200, epoch: 6 | loss: 0.1607309
	speed: 0.1853s/iter; left time: 4649.0746s
	iters: 300, epoch: 6 | loss: 0.2781023
	speed: 0.1810s/iter; left time: 4524.2134s
	iters: 400, epoch: 6 | loss: 0.1562295
	speed: 0.1777s/iter; left time: 4423.3637s
	iters: 500, epoch: 6 | loss: 0.2277660
	speed: 0.1796s/iter; left time: 4451.3526s
Epoch: 6 cost time: 103.15151572227478
Epoch: 6, Steps: 562 | Train Loss: 0.1805272 Vali Loss: 0.4832576 Test Loss: 0.2184827
Validation loss decreased (0.483820 --> 0.483258).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1933090
	speed: 1.0872s/iter; left time: 26775.8182s
	iters: 200, epoch: 7 | loss: 0.2075586
	speed: 0.2014s/iter; left time: 4940.5625s
	iters: 300, epoch: 7 | loss: 0.2054540
	speed: 0.2041s/iter; left time: 4985.5306s
	iters: 400, epoch: 7 | loss: 0.1697734
	speed: 0.1977s/iter; left time: 4808.9566s
	iters: 500, epoch: 7 | loss: 0.2629384
	speed: 0.1827s/iter; left time: 4426.6652s
Epoch: 7 cost time: 111.02135968208313
Epoch: 7, Steps: 562 | Train Loss: 0.1804539 Vali Loss: 0.4826289 Test Loss: 0.2176768
Validation loss decreased (0.483258 --> 0.482629).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1844317
	speed: 0.9623s/iter; left time: 23159.5179s
	iters: 200, epoch: 8 | loss: 0.1925243
	speed: 0.1689s/iter; left time: 4048.9438s
	iters: 300, epoch: 8 | loss: 0.1564055
	speed: 0.1720s/iter; left time: 4105.7944s
	iters: 400, epoch: 8 | loss: 0.2493439
	speed: 0.1706s/iter; left time: 4054.1752s
	iters: 500, epoch: 8 | loss: 0.1452932
	speed: 0.1734s/iter; left time: 4104.7517s
Epoch: 8 cost time: 96.65357851982117
Epoch: 8, Steps: 562 | Train Loss: 0.1804559 Vali Loss: 0.4824109 Test Loss: 0.2176078
Validation loss decreased (0.482629 --> 0.482411).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1382875
	speed: 0.9448s/iter; left time: 22206.9462s
