Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=144, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=70, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='weather.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=21, factor=1, features='M', freq='h', gpu=3, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=True, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Weather_720_j336_H10', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=2021, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:3
>>>>>>>start training : Weather_720_j336_H10_FITS_custom_ftM_sl720_ll48_pl336_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 35832
val 4935
test 10204
Model(
  (freq_upsampler): ModuleList(
    (0): Linear(in_features=70, out_features=102, bias=True)
    (1): Linear(in_features=70, out_features=102, bias=True)
    (2): Linear(in_features=70, out_features=102, bias=True)
    (3): Linear(in_features=70, out_features=102, bias=True)
    (4): Linear(in_features=70, out_features=102, bias=True)
    (5): Linear(in_features=70, out_features=102, bias=True)
    (6): Linear(in_features=70, out_features=102, bias=True)
    (7): Linear(in_features=70, out_features=102, bias=True)
    (8): Linear(in_features=70, out_features=102, bias=True)
    (9): Linear(in_features=70, out_features=102, bias=True)
    (10): Linear(in_features=70, out_features=102, bias=True)
    (11): Linear(in_features=70, out_features=102, bias=True)
    (12): Linear(in_features=70, out_features=102, bias=True)
    (13): Linear(in_features=70, out_features=102, bias=True)
    (14): Linear(in_features=70, out_features=102, bias=True)
    (15): Linear(in_features=70, out_features=102, bias=True)
    (16): Linear(in_features=70, out_features=102, bias=True)
    (17): Linear(in_features=70, out_features=102, bias=True)
    (18): Linear(in_features=70, out_features=102, bias=True)
    (19): Linear(in_features=70, out_features=102, bias=True)
    (20): Linear(in_features=70, out_features=102, bias=True)
  )
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  9596160.0
params:  152082.0
Trainable parameters:  152082
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.6322261
	speed: 0.1937s/iter; left time: 5394.7966s
	iters: 200, epoch: 1 | loss: 0.4193906
	speed: 0.1944s/iter; left time: 5393.8431s
	iters: 300, epoch: 1 | loss: 0.5153489
	speed: 0.1965s/iter; left time: 5434.1832s
	iters: 400, epoch: 1 | loss: 0.3833673
	speed: 0.2160s/iter; left time: 5952.2852s
	iters: 500, epoch: 1 | loss: 0.3351528
	speed: 0.2308s/iter; left time: 6334.7691s
Epoch: 1 cost time: 119.00146269798279
Epoch: 1, Steps: 559 | Train Loss: 0.5023644 Vali Loss: 0.5741813 Test Loss: 0.2681919
Validation loss decreased (inf --> 0.574181).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2785397
	speed: 0.9865s/iter; left time: 26924.6707s
	iters: 200, epoch: 2 | loss: 0.2929350
	speed: 0.1796s/iter; left time: 4884.1029s
	iters: 300, epoch: 2 | loss: 0.2746283
	speed: 0.1920s/iter; left time: 5202.6875s
	iters: 400, epoch: 2 | loss: 0.2715623
	speed: 0.1804s/iter; left time: 4868.9476s
	iters: 500, epoch: 2 | loss: 0.2468266
	speed: 0.1751s/iter; left time: 4708.4175s
Epoch: 2 cost time: 100.89818525314331
Epoch: 2, Steps: 559 | Train Loss: 0.2963899 Vali Loss: 0.5330550 Test Loss: 0.2525831
Validation loss decreased (0.574181 --> 0.533055).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2821798
	speed: 0.9125s/iter; left time: 24395.0544s
	iters: 200, epoch: 3 | loss: 0.2290473
	speed: 0.1630s/iter; left time: 4341.5578s
	iters: 300, epoch: 3 | loss: 0.2054535
	speed: 0.1618s/iter; left time: 4292.5691s
	iters: 400, epoch: 3 | loss: 0.2383758
	speed: 0.1805s/iter; left time: 4770.1309s
	iters: 500, epoch: 3 | loss: 0.2371382
	speed: 0.1852s/iter; left time: 4876.9557s
Epoch: 3 cost time: 98.74814867973328
Epoch: 3, Steps: 559 | Train Loss: 0.2484551 Vali Loss: 0.5171525 Test Loss: 0.2465136
Validation loss decreased (0.533055 --> 0.517152).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2115670
	speed: 1.0103s/iter; left time: 26443.4536s
	iters: 200, epoch: 4 | loss: 0.2293556
	speed: 0.1882s/iter; left time: 4907.6912s
	iters: 300, epoch: 4 | loss: 0.1958767
	speed: 0.1991s/iter; left time: 5171.6941s
	iters: 400, epoch: 4 | loss: 0.2254584
	speed: 0.1964s/iter; left time: 5080.6541s
	iters: 500, epoch: 4 | loss: 0.2048519
	speed: 0.1959s/iter; left time: 5048.9277s
Epoch: 4 cost time: 111.22465229034424
Epoch: 4, Steps: 559 | Train Loss: 0.2358804 Vali Loss: 0.5118369 Test Loss: 0.2442319
Validation loss decreased (0.517152 --> 0.511837).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2700372
	speed: 1.0172s/iter; left time: 26054.4553s
	iters: 200, epoch: 5 | loss: 0.1955056
	speed: 0.1780s/iter; left time: 4541.0190s
	iters: 300, epoch: 5 | loss: 0.2308848
	speed: 0.1943s/iter; left time: 4939.2274s
	iters: 400, epoch: 5 | loss: 0.2186714
	speed: 0.1790s/iter; left time: 4530.4787s
	iters: 500, epoch: 5 | loss: 0.2882375
	speed: 0.1378s/iter; left time: 3474.6658s
Epoch: 5 cost time: 96.53430318832397
Epoch: 5, Steps: 559 | Train Loss: 0.2329966 Vali Loss: 0.5100732 Test Loss: 0.2435360
Validation loss decreased (0.511837 --> 0.510073).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2630972
	speed: 0.8222s/iter; left time: 20600.2134s
	iters: 200, epoch: 6 | loss: 0.2893631
	speed: 0.1629s/iter; left time: 4066.3958s
	iters: 300, epoch: 6 | loss: 0.2623481
	speed: 0.1560s/iter; left time: 3876.5431s
	iters: 400, epoch: 6 | loss: 0.1770850
	speed: 0.1617s/iter; left time: 4003.7732s
	iters: 500, epoch: 6 | loss: 0.2002826
	speed: 0.1344s/iter; left time: 3314.2181s
Epoch: 6 cost time: 86.35492515563965
Epoch: 6, Steps: 559 | Train Loss: 0.2323852 Vali Loss: 0.5106765 Test Loss: 0.2431605
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2102062
	speed: 0.5867s/iter; left time: 14372.1397s
	iters: 200, epoch: 7 | loss: 0.1801164
	speed: 0.1130s/iter; left time: 2755.6516s
	iters: 300, epoch: 7 | loss: 0.2529002
	speed: 0.1131s/iter; left time: 2747.2417s
	iters: 400, epoch: 7 | loss: 0.2649537
	speed: 0.0991s/iter; left time: 2398.4326s
	iters: 500, epoch: 7 | loss: 0.2305871
	speed: 0.1221s/iter; left time: 2941.1703s
Epoch: 7 cost time: 63.84385919570923
Epoch: 7, Steps: 559 | Train Loss: 0.2321864 Vali Loss: 0.5104074 Test Loss: 0.2425431
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3112572
	speed: 0.5429s/iter; left time: 12995.5982s
	iters: 200, epoch: 8 | loss: 0.2635897
	speed: 0.1711s/iter; left time: 4078.9946s
	iters: 300, epoch: 8 | loss: 0.2569957
	speed: 0.1979s/iter; left time: 4698.5604s
	iters: 400, epoch: 8 | loss: 0.3167766
	speed: 0.2031s/iter; left time: 4799.9939s
	iters: 500, epoch: 8 | loss: 0.2089934
	speed: 0.2011s/iter; left time: 4733.0861s
Epoch: 8 cost time: 101.96357321739197
Epoch: 8, Steps: 559 | Train Loss: 0.2319551 Vali Loss: 0.5092238 Test Loss: 0.2420998
Validation loss decreased (0.510073 --> 0.509224).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2553428
	speed: 0.7991s/iter; left time: 18681.6379s
	iters: 200, epoch: 9 | loss: 0.2360754
	speed: 0.1820s/iter; left time: 4236.2138s
	iters: 300, epoch: 9 | loss: 0.3078757
	speed: 0.1570s/iter; left time: 3639.4508s
	iters: 400, epoch: 9 | loss: 0.2208014
	speed: 0.1639s/iter; left time: 3781.6833s
	iters: 500, epoch: 9 | loss: 0.2460732
	speed: 0.1604s/iter; left time: 3686.1976s
Epoch: 9 cost time: 93.37350940704346
Epoch: 9, Steps: 559 | Train Loss: 0.2319623 Vali Loss: 0.5084992 Test Loss: 0.2415998
Validation loss decreased (0.509224 --> 0.508499).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3148512
	speed: 0.7412s/iter; left time: 16914.0480s
	iters: 200, epoch: 10 | loss: 0.2498581
	speed: 0.1563s/iter; left time: 3550.0914s
	iters: 300, epoch: 10 | loss: 0.2162808
	speed: 0.1799s/iter; left time: 4069.3036s
	iters: 400, epoch: 10 | loss: 0.3415778
	speed: 0.1866s/iter; left time: 4202.3036s
	iters: 500, epoch: 10 | loss: 0.1727005
	speed: 0.1981s/iter; left time: 4442.2079s
Epoch: 10 cost time: 97.02132058143616
Epoch: 10, Steps: 559 | Train Loss: 0.2318694 Vali Loss: 0.5082980 Test Loss: 0.2416405
Validation loss decreased (0.508499 --> 0.508298).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1956558
	speed: 0.7529s/iter; left time: 16759.9502s
	iters: 200, epoch: 11 | loss: 0.2458610
	speed: 0.1619s/iter; left time: 3587.3005s
	iters: 300, epoch: 11 | loss: 0.2287100
	speed: 0.1733s/iter; left time: 3823.0974s
	iters: 400, epoch: 11 | loss: 0.2389577
	speed: 0.1639s/iter; left time: 3600.3834s
	iters: 500, epoch: 11 | loss: 0.1776721
	speed: 0.1588s/iter; left time: 3470.9858s
Epoch: 11 cost time: 93.02200031280518
Epoch: 11, Steps: 559 | Train Loss: 0.2318744 Vali Loss: 0.5083952 Test Loss: 0.2415875
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3449595
	speed: 0.8147s/iter; left time: 17679.8775s
	iters: 200, epoch: 12 | loss: 0.2202574
	speed: 0.1565s/iter; left time: 3380.7788s
	iters: 300, epoch: 12 | loss: 0.1886156
	speed: 0.1580s/iter; left time: 3396.7692s
	iters: 400, epoch: 12 | loss: 0.2414111
	speed: 0.1673s/iter; left time: 3580.5770s
	iters: 500, epoch: 12 | loss: 0.2219271
	speed: 0.1595s/iter; left time: 3397.2168s
Epoch: 12 cost time: 89.00867080688477
Epoch: 12, Steps: 559 | Train Loss: 0.2317551 Vali Loss: 0.5085641 Test Loss: 0.2415095
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.3081497
	speed: 0.8506s/iter; left time: 17985.0539s
	iters: 200, epoch: 13 | loss: 0.3014686
	speed: 0.1929s/iter; left time: 4059.3931s
	iters: 300, epoch: 13 | loss: 0.2929804
	speed: 0.1899s/iter; left time: 3977.0303s
	iters: 400, epoch: 13 | loss: 0.2221432
	speed: 0.1923s/iter; left time: 4008.1330s
	iters: 500, epoch: 13 | loss: 0.2346127
	speed: 0.1874s/iter; left time: 3886.9922s
Epoch: 13 cost time: 107.67796230316162
Epoch: 13, Steps: 559 | Train Loss: 0.2318020 Vali Loss: 0.5079045 Test Loss: 0.2413532
Validation loss decreased (0.508298 --> 0.507905).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2112639
	speed: 0.8667s/iter; left time: 17839.3359s
	iters: 200, epoch: 14 | loss: 0.2900601
	speed: 0.1681s/iter; left time: 3444.0839s
	iters: 300, epoch: 14 | loss: 0.2264698
	speed: 0.1761s/iter; left time: 3589.4538s
	iters: 400, epoch: 14 | loss: 0.1590182
	speed: 0.1820s/iter; left time: 3690.8185s
	iters: 500, epoch: 14 | loss: 0.1922170
	speed: 0.1796s/iter; left time: 3625.8814s
Epoch: 14 cost time: 100.1505696773529
Epoch: 14, Steps: 559 | Train Loss: 0.2317152 Vali Loss: 0.5082147 Test Loss: 0.2411650
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2100863
	speed: 0.9341s/iter; left time: 18705.1509s
	iters: 200, epoch: 15 | loss: 0.2184066
	speed: 0.1625s/iter; left time: 3237.2783s
	iters: 300, epoch: 15 | loss: 0.2579060
	speed: 0.1745s/iter; left time: 3458.6727s
	iters: 400, epoch: 15 | loss: 0.1788099
	speed: 0.1609s/iter; left time: 3172.9856s
	iters: 500, epoch: 15 | loss: 0.1733910
	speed: 0.1697s/iter; left time: 3330.6551s
Epoch: 15 cost time: 94.00500893592834
Epoch: 15, Steps: 559 | Train Loss: 0.2317162 Vali Loss: 0.5082530 Test Loss: 0.2413878
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1762199
	speed: 0.8540s/iter; left time: 16624.8698s
	iters: 200, epoch: 16 | loss: 0.1939788
	speed: 0.1516s/iter; left time: 2935.2188s
	iters: 300, epoch: 16 | loss: 0.1915532
	speed: 0.1537s/iter; left time: 2962.1097s
	iters: 400, epoch: 16 | loss: 0.2031890
	speed: 0.1377s/iter; left time: 2639.3504s
	iters: 500, epoch: 16 | loss: 0.2116804
	speed: 0.1862s/iter; left time: 3550.1937s
Epoch: 16 cost time: 94.01740670204163
Epoch: 16, Steps: 559 | Train Loss: 0.2316231 Vali Loss: 0.5080559 Test Loss: 0.2412551
EarlyStopping counter: 3 out of 3
Early stopping
train 35832
val 4935
test 10204
Model(
  (freq_upsampler): ModuleList(
    (0): Linear(in_features=70, out_features=102, bias=True)
    (1): Linear(in_features=70, out_features=102, bias=True)
    (2): Linear(in_features=70, out_features=102, bias=True)
    (3): Linear(in_features=70, out_features=102, bias=True)
    (4): Linear(in_features=70, out_features=102, bias=True)
    (5): Linear(in_features=70, out_features=102, bias=True)
    (6): Linear(in_features=70, out_features=102, bias=True)
    (7): Linear(in_features=70, out_features=102, bias=True)
    (8): Linear(in_features=70, out_features=102, bias=True)
    (9): Linear(in_features=70, out_features=102, bias=True)
    (10): Linear(in_features=70, out_features=102, bias=True)
    (11): Linear(in_features=70, out_features=102, bias=True)
    (12): Linear(in_features=70, out_features=102, bias=True)
    (13): Linear(in_features=70, out_features=102, bias=True)
    (14): Linear(in_features=70, out_features=102, bias=True)
    (15): Linear(in_features=70, out_features=102, bias=True)
    (16): Linear(in_features=70, out_features=102, bias=True)
    (17): Linear(in_features=70, out_features=102, bias=True)
    (18): Linear(in_features=70, out_features=102, bias=True)
    (19): Linear(in_features=70, out_features=102, bias=True)
    (20): Linear(in_features=70, out_features=102, bias=True)
  )
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  9596160.0
params:  152082.0
Trainable parameters:  152082
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4913248
	speed: 0.1533s/iter; left time: 4268.2885s
	iters: 200, epoch: 1 | loss: 0.4937586
	speed: 0.1526s/iter; left time: 4234.3700s
	iters: 300, epoch: 1 | loss: 0.3988605
	speed: 0.1480s/iter; left time: 4092.0478s
	iters: 400, epoch: 1 | loss: 0.6165542
	speed: 0.1468s/iter; left time: 4045.4911s
	iters: 500, epoch: 1 | loss: 0.5155924
	speed: 0.1483s/iter; left time: 4071.3646s
Epoch: 1 cost time: 83.89698576927185
Epoch: 1, Steps: 559 | Train Loss: 0.5002682 Vali Loss: 0.5037399 Test Loss: 0.2385695
Validation loss decreased (inf --> 0.503740).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.4126014
	speed: 0.7424s/iter; left time: 20260.4599s
	iters: 200, epoch: 2 | loss: 0.5268992
	speed: 0.1436s/iter; left time: 3903.5093s
	iters: 300, epoch: 2 | loss: 0.4978696
	speed: 0.1455s/iter; left time: 3942.3691s
	iters: 400, epoch: 2 | loss: 0.3810387
	speed: 0.1420s/iter; left time: 3833.7843s
	iters: 500, epoch: 2 | loss: 0.6625069
	speed: 0.1461s/iter; left time: 3929.6393s
Epoch: 2 cost time: 81.51401209831238
Epoch: 2, Steps: 559 | Train Loss: 0.4979987 Vali Loss: 0.5026023 Test Loss: 0.2381305
Validation loss decreased (0.503740 --> 0.502602).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.7252153
	speed: 0.7565s/iter; left time: 20223.0782s
	iters: 200, epoch: 3 | loss: 0.4208236
	speed: 0.1657s/iter; left time: 4412.4438s
	iters: 300, epoch: 3 | loss: 0.6057484
	speed: 0.1689s/iter; left time: 4481.3598s
	iters: 400, epoch: 3 | loss: 0.4095982
	speed: 0.1718s/iter; left time: 4541.2418s
	iters: 500, epoch: 3 | loss: 0.4047889
	speed: 0.1771s/iter; left time: 4663.4926s
Epoch: 3 cost time: 96.30163931846619
Epoch: 3, Steps: 559 | Train Loss: 0.4971640 Vali Loss: 0.5027494 Test Loss: 0.2378654
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.4385665
	speed: 0.7963s/iter; left time: 20841.4233s
	iters: 200, epoch: 4 | loss: 0.5703516
	speed: 0.1561s/iter; left time: 4069.8554s
	iters: 300, epoch: 4 | loss: 0.4055607
	speed: 0.1505s/iter; left time: 3909.6218s
	iters: 400, epoch: 4 | loss: 0.6748974
	speed: 0.1493s/iter; left time: 3863.7595s
	iters: 500, epoch: 4 | loss: 0.3912032
	speed: 0.1483s/iter; left time: 3823.3184s
Epoch: 4 cost time: 86.593017578125
Epoch: 4, Steps: 559 | Train Loss: 0.4970668 Vali Loss: 0.5006788 Test Loss: 0.2370923
Validation loss decreased (0.502602 --> 0.500679).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.4599243
	speed: 0.7560s/iter; left time: 19365.0828s
	iters: 200, epoch: 5 | loss: 0.3721601
	speed: 0.1413s/iter; left time: 3605.0790s
	iters: 300, epoch: 5 | loss: 0.4700500
	speed: 0.1490s/iter; left time: 3787.8180s
	iters: 400, epoch: 5 | loss: 0.4391413
	speed: 0.1579s/iter; left time: 3997.4191s
	iters: 500, epoch: 5 | loss: 0.4229226
	speed: 0.1415s/iter; left time: 3567.7415s
Epoch: 5 cost time: 83.97859048843384
Epoch: 5, Steps: 559 | Train Loss: 0.4963625 Vali Loss: 0.5008286 Test Loss: 0.2370136
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.4782400
	speed: 0.6915s/iter; left time: 17325.4799s
	iters: 200, epoch: 6 | loss: 0.5593255
	speed: 0.1564s/iter; left time: 3904.1298s
	iters: 300, epoch: 6 | loss: 0.5844353
	speed: 0.1722s/iter; left time: 4279.4905s
	iters: 400, epoch: 6 | loss: 0.4217192
	speed: 0.1718s/iter; left time: 4251.9695s
	iters: 500, epoch: 6 | loss: 0.4150603
	speed: 0.1619s/iter; left time: 3992.9264s
Epoch: 6 cost time: 93.29705572128296
Epoch: 6, Steps: 559 | Train Loss: 0.4958937 Vali Loss: 0.5002344 Test Loss: 0.2368502
Validation loss decreased (0.500679 --> 0.500234).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.5048307
	speed: 0.7716s/iter; left time: 18902.8282s
	iters: 200, epoch: 7 | loss: 0.3781024
	speed: 0.1219s/iter; left time: 2973.6322s
	iters: 300, epoch: 7 | loss: 0.4571226
	speed: 0.1312s/iter; left time: 3188.3576s
	iters: 400, epoch: 7 | loss: 0.7807897
	speed: 0.1276s/iter; left time: 3087.4327s
	iters: 500, epoch: 7 | loss: 0.5229166
	speed: 0.1358s/iter; left time: 3271.4793s
Epoch: 7 cost time: 76.66993761062622
Epoch: 7, Steps: 559 | Train Loss: 0.4960617 Vali Loss: 0.4997878 Test Loss: 0.2366619
Validation loss decreased (0.500234 --> 0.499788).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.4807977
	speed: 0.8171s/iter; left time: 19560.4875s
	iters: 200, epoch: 8 | loss: 0.3996781
	speed: 0.1525s/iter; left time: 3636.1700s
	iters: 300, epoch: 8 | loss: 0.5494199
	speed: 0.1631s/iter; left time: 3871.2682s
	iters: 400, epoch: 8 | loss: 0.3809425
	speed: 0.1383s/iter; left time: 3268.9340s
	iters: 500, epoch: 8 | loss: 0.5606237
	speed: 0.1509s/iter; left time: 3552.7610s
Epoch: 8 cost time: 85.77798414230347
Epoch: 8, Steps: 559 | Train Loss: 0.4954075 Vali Loss: 0.4998896 Test Loss: 0.2363321
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.5910904
	speed: 0.7176s/iter; left time: 16777.7311s
	iters: 200, epoch: 9 | loss: 0.4153882
	speed: 0.1477s/iter; left time: 3437.4892s
	iters: 300, epoch: 9 | loss: 0.4300161
	speed: 0.1474s/iter; left time: 3416.3328s
	iters: 400, epoch: 9 | loss: 0.4830185
	speed: 0.1558s/iter; left time: 3595.3814s
	iters: 500, epoch: 9 | loss: 0.3947244
	speed: 0.1562s/iter; left time: 3589.0571s
Epoch: 9 cost time: 85.7129647731781
Epoch: 9, Steps: 559 | Train Loss: 0.4951878 Vali Loss: 0.4990514 Test Loss: 0.2363799
Validation loss decreased (0.499788 --> 0.499051).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3954696
	speed: 0.8681s/iter; left time: 19810.4482s
	iters: 200, epoch: 10 | loss: 0.5153164
	speed: 0.1698s/iter; left time: 3857.5644s
	iters: 300, epoch: 10 | loss: 0.4084530
	speed: 0.1688s/iter; left time: 3818.2730s
	iters: 400, epoch: 10 | loss: 0.3623520
	speed: 0.1467s/iter; left time: 3303.5470s
	iters: 500, epoch: 10 | loss: 0.4753226
	speed: 0.1411s/iter; left time: 3162.3860s
Epoch: 10 cost time: 88.68083238601685
Epoch: 10, Steps: 559 | Train Loss: 0.4949101 Vali Loss: 0.4979338 Test Loss: 0.2362136
Validation loss decreased (0.499051 --> 0.497934).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3669797
	speed: 0.7417s/iter; left time: 16510.5329s
	iters: 200, epoch: 11 | loss: 0.4093643
	speed: 0.1463s/iter; left time: 3242.7216s
	iters: 300, epoch: 11 | loss: 0.4458823
	speed: 0.1418s/iter; left time: 3128.2957s
	iters: 400, epoch: 11 | loss: 0.4615875
	speed: 0.1382s/iter; left time: 3034.1894s
	iters: 500, epoch: 11 | loss: 0.4566420
	speed: 0.1410s/iter; left time: 3082.0292s
Epoch: 11 cost time: 80.24337840080261
Epoch: 11, Steps: 559 | Train Loss: 0.4952827 Vali Loss: 0.4987550 Test Loss: 0.2360442
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3705806
	speed: 0.7206s/iter; left time: 15638.3304s
	iters: 200, epoch: 12 | loss: 0.4445003
	speed: 0.1420s/iter; left time: 3068.5605s
	iters: 300, epoch: 12 | loss: 0.6263356
	speed: 0.1426s/iter; left time: 3067.2245s
	iters: 400, epoch: 12 | loss: 0.5024158
	speed: 0.1470s/iter; left time: 3145.3385s
	iters: 500, epoch: 12 | loss: 0.7165664
	speed: 0.1552s/iter; left time: 3306.9180s
Epoch: 12 cost time: 82.7422981262207
Epoch: 12, Steps: 559 | Train Loss: 0.4949914 Vali Loss: 0.4984121 Test Loss: 0.2360069
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.4017645
	speed: 0.8165s/iter; left time: 17263.0787s
	iters: 200, epoch: 13 | loss: 0.4209518
	speed: 0.1984s/iter; left time: 4174.0558s
	iters: 300, epoch: 13 | loss: 0.5351084
	speed: 0.1872s/iter; left time: 3920.2252s
	iters: 400, epoch: 13 | loss: 0.6588936
	speed: 0.1709s/iter; left time: 3562.5450s
	iters: 500, epoch: 13 | loss: 0.3624007
	speed: 0.1792s/iter; left time: 3716.8203s
Epoch: 13 cost time: 101.8944845199585
Epoch: 13, Steps: 559 | Train Loss: 0.4944728 Vali Loss: 0.4984874 Test Loss: 0.2355786
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Weather_720_j336_H10_FITS_custom_ftM_sl720_ll48_pl336_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 10204
mse:0.23675045371055603, mae:0.2777855694293976, rse:0.6390442252159119, corr:[0.47244132 0.47549233 0.4760102  0.47533515 0.47424582 0.47329906
 0.47271293 0.47241533 0.4721233  0.4715805  0.4707089  0.46968195
 0.46866882 0.46786627 0.4673907  0.4671322  0.46698746 0.46666235
 0.46607378 0.46513292 0.4639923  0.46279803 0.46173617 0.46080497
 0.46001533 0.45930734 0.45858115 0.45773414 0.45678425 0.4557625
 0.45483318 0.45408714 0.45363945 0.45339665 0.45332083 0.45323175
 0.45309633 0.45276558 0.45221853 0.45150137 0.4507613  0.45013985
 0.44966158 0.44927114 0.4488994  0.44845426 0.4479589  0.44740126
 0.44664508 0.4458293  0.445062   0.44431973 0.44373247 0.4432698
 0.44289446 0.442538   0.44217318 0.44174457 0.44125828 0.44071838
 0.4401612  0.4396231  0.4391258  0.43869087 0.43831256 0.43800178
 0.43773332 0.43752167 0.43737915 0.43728834 0.43727386 0.43720934
 0.4371431  0.43702564 0.43677592 0.43639717 0.43592888 0.4354707
 0.43502316 0.43461585 0.43432236 0.4340912  0.43386936 0.433651
 0.43345302 0.4332442  0.43302128 0.43268177 0.43234038 0.43199363
 0.43173453 0.43161213 0.43157417 0.43162033 0.43171322 0.4317768
 0.43175873 0.4316383  0.43139613 0.4310857  0.430742   0.43040884
 0.43010944 0.4298411  0.42957366 0.42928764 0.4289385  0.4285525
 0.42810488 0.4276679  0.42724952 0.4268465  0.42648438 0.42623907
 0.4260787  0.4259479  0.4258527  0.42576998 0.42565012 0.4254346
 0.42517525 0.42488647 0.42459026 0.4243283  0.424098   0.4239208
 0.42379096 0.42366526 0.42355388 0.4234422  0.4232776  0.42308196
 0.42286944 0.42262745 0.42237556 0.42207614 0.42174616 0.4214073
 0.42100716 0.42062885 0.42029864 0.42005324 0.419844   0.41962653
 0.41938186 0.4190922  0.41879067 0.41849762 0.4181684  0.417768
 0.41733867 0.41693157 0.4165314  0.41613352 0.4158037  0.41548502
 0.41525513 0.41494137 0.4145867  0.41420868 0.41385478 0.41354373
 0.4132606  0.41302264 0.41276458 0.4124679  0.4120545  0.41153583
 0.41093025 0.41027546 0.4096049  0.4089692  0.4084283  0.40800944
 0.4076474  0.4073146  0.40693623 0.40650043 0.40596566 0.40533173
 0.40467334 0.40399432 0.40334308 0.40276963 0.40231794 0.40197358
 0.40168864 0.40138996 0.40106058 0.40066627 0.40021247 0.3997232
 0.39928055 0.3988377  0.39846182 0.3981498  0.39787704 0.3976125
 0.3973278  0.39700666 0.39664692 0.39626306 0.3958489  0.39540264
 0.3949828  0.3946015  0.39426947 0.39396673 0.39359283 0.3931801
 0.39270717 0.3922088  0.391692   0.3912162  0.39079735 0.39043483
 0.39010334 0.3898824  0.38965118 0.38936055 0.38901237 0.3886408
 0.38822022 0.38777056 0.387324   0.38688335 0.38647932 0.38614422
 0.3858478  0.38559222 0.3853362  0.38505718 0.3847406  0.38439825
 0.38406903 0.383785   0.38351184 0.38325724 0.38293597 0.3825926
 0.3822283  0.38183773 0.38136843 0.38091612 0.38054433 0.38026786
 0.38005468 0.3799411  0.37983534 0.37971476 0.37952667 0.37925896
 0.3788455  0.3782907  0.37770388 0.3771053  0.37668818 0.3764489
 0.37644267 0.37651163 0.3765111  0.3764339  0.37621266 0.37583774
 0.375375   0.37483004 0.3743432  0.37396204 0.37372628 0.3736008
 0.37350547 0.37338492 0.37322456 0.3729145  0.37249953 0.3720082
 0.371498   0.37098098 0.37056163 0.37023345 0.36996815 0.3697521
 0.369545   0.3692182  0.3687728  0.36820546 0.36755118 0.36683136
 0.36610857 0.36540344 0.3646995  0.36399683 0.36342978 0.36296177
 0.36250013 0.3620633  0.3616468  0.3612812  0.3609239  0.3606435
 0.36025688 0.35979277 0.3592238  0.35857123 0.357825   0.35703316
 0.35627916 0.35563377 0.35513756 0.35474417 0.354478   0.3541975
 0.35383373 0.35339653 0.35287833 0.35231978 0.35180914 0.35135505
 0.3509755  0.35059485 0.35016048 0.34962505 0.3489858  0.34823695
 0.34746686 0.34677154 0.34617183 0.3457241  0.34537604 0.3449484
 0.34432757 0.3434059  0.3422092  0.34094238 0.3397691  0.3386438 ]
