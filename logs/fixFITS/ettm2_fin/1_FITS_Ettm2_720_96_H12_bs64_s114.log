Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=106, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=106, out_features=120, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  11397120.0
params:  12840.0
Trainable parameters:  12840
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2546820
	speed: 0.1512s/iter; left time: 1973.1826s
	iters: 200, epoch: 1 | loss: 0.2523148
	speed: 0.1593s/iter; left time: 2063.2500s
Epoch: 1 cost time: 41.31098008155823
Epoch: 1, Steps: 263 | Train Loss: 0.3020640 Vali Loss: 0.1294985 Test Loss: 0.1802293
Validation loss decreased (inf --> 0.129498).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2248763
	speed: 0.7851s/iter; left time: 10040.4684s
	iters: 200, epoch: 2 | loss: 0.2167500
	speed: 0.1706s/iter; left time: 2164.1433s
Epoch: 2 cost time: 45.81633448600769
Epoch: 2, Steps: 263 | Train Loss: 0.2339761 Vali Loss: 0.1211060 Test Loss: 0.1709900
Validation loss decreased (0.129498 --> 0.121106).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2193163
	speed: 0.7486s/iter; left time: 9376.7988s
	iters: 200, epoch: 3 | loss: 0.2445739
	speed: 0.1431s/iter; left time: 1777.9670s
Epoch: 3 cost time: 40.49022054672241
Epoch: 3, Steps: 263 | Train Loss: 0.2219397 Vali Loss: 0.1180371 Test Loss: 0.1673785
Validation loss decreased (0.121106 --> 0.118037).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2051446
	speed: 0.7457s/iter; left time: 9144.3319s
	iters: 200, epoch: 4 | loss: 0.2625584
	speed: 0.1627s/iter; left time: 1979.1869s
Epoch: 4 cost time: 44.963120460510254
Epoch: 4, Steps: 263 | Train Loss: 0.2169067 Vali Loss: 0.1167794 Test Loss: 0.1658863
Validation loss decreased (0.118037 --> 0.116779).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2464222
	speed: 0.7908s/iter; left time: 9488.8533s
	iters: 200, epoch: 5 | loss: 0.1637512
	speed: 0.1620s/iter; left time: 1928.0304s
Epoch: 5 cost time: 44.86109948158264
Epoch: 5, Steps: 263 | Train Loss: 0.2140295 Vali Loss: 0.1159985 Test Loss: 0.1648427
Validation loss decreased (0.116779 --> 0.115999).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1908287
	speed: 0.7483s/iter; left time: 8781.8832s
	iters: 200, epoch: 6 | loss: 0.1608340
	speed: 0.1649s/iter; left time: 1918.6538s
Epoch: 6 cost time: 44.383384704589844
Epoch: 6, Steps: 263 | Train Loss: 0.2121993 Vali Loss: 0.1156610 Test Loss: 0.1643226
Validation loss decreased (0.115999 --> 0.115661).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2207360
	speed: 0.7262s/iter; left time: 8332.1551s
	iters: 200, epoch: 7 | loss: 0.2427519
	speed: 0.1597s/iter; left time: 1816.1696s
Epoch: 7 cost time: 42.99194264411926
Epoch: 7, Steps: 263 | Train Loss: 0.2110726 Vali Loss: 0.1155302 Test Loss: 0.1642562
Validation loss decreased (0.115661 --> 0.115530).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1846496
	speed: 0.7241s/iter; left time: 8117.1346s
	iters: 200, epoch: 8 | loss: 0.2096849
	speed: 0.1497s/iter; left time: 1662.6551s
Epoch: 8 cost time: 40.97376799583435
Epoch: 8, Steps: 263 | Train Loss: 0.2104495 Vali Loss: 0.1153651 Test Loss: 0.1639001
Validation loss decreased (0.115530 --> 0.115365).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1210376
	speed: 0.7144s/iter; left time: 7820.6226s
	iters: 200, epoch: 9 | loss: 0.2818818
	speed: 0.1576s/iter; left time: 1709.6304s
Epoch: 9 cost time: 42.08936357498169
Epoch: 9, Steps: 263 | Train Loss: 0.2098113 Vali Loss: 0.1151843 Test Loss: 0.1636498
Validation loss decreased (0.115365 --> 0.115184).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1594365
	speed: 0.7130s/iter; left time: 7617.4484s
	iters: 200, epoch: 10 | loss: 0.2029832
	speed: 0.1518s/iter; left time: 1606.6026s
Epoch: 10 cost time: 41.51249957084656
Epoch: 10, Steps: 263 | Train Loss: 0.2093835 Vali Loss: 0.1152738 Test Loss: 0.1632856
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2148314
	speed: 0.7033s/iter; left time: 7329.0670s
	iters: 200, epoch: 11 | loss: 0.1991024
	speed: 0.1279s/iter; left time: 1319.7886s
Epoch: 11 cost time: 37.73869776725769
Epoch: 11, Steps: 263 | Train Loss: 0.2088956 Vali Loss: 0.1150162 Test Loss: 0.1633256
Validation loss decreased (0.115184 --> 0.115016).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2615522
	speed: 0.6186s/iter; left time: 6283.6147s
	iters: 200, epoch: 12 | loss: 0.1702931
	speed: 0.1304s/iter; left time: 1311.2332s
Epoch: 12 cost time: 33.53903865814209
Epoch: 12, Steps: 263 | Train Loss: 0.2086618 Vali Loss: 0.1148993 Test Loss: 0.1632183
Validation loss decreased (0.115016 --> 0.114899).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1611427
	speed: 0.6444s/iter; left time: 6376.0291s
	iters: 200, epoch: 13 | loss: 0.1672654
	speed: 0.1576s/iter; left time: 1543.4567s
Epoch: 13 cost time: 43.128528118133545
Epoch: 13, Steps: 263 | Train Loss: 0.2084648 Vali Loss: 0.1151091 Test Loss: 0.1633471
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1772024
	speed: 0.7042s/iter; left time: 6782.5569s
	iters: 200, epoch: 14 | loss: 0.2226738
	speed: 0.1537s/iter; left time: 1465.1317s
Epoch: 14 cost time: 41.24561548233032
Epoch: 14, Steps: 263 | Train Loss: 0.2082325 Vali Loss: 0.1148657 Test Loss: 0.1630993
Validation loss decreased (0.114899 --> 0.114866).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1810354
	speed: 0.6492s/iter; left time: 6082.2368s
	iters: 200, epoch: 15 | loss: 0.1968427
	speed: 0.1336s/iter; left time: 1238.7849s
Epoch: 15 cost time: 36.27347755432129
Epoch: 15, Steps: 263 | Train Loss: 0.2080033 Vali Loss: 0.1146721 Test Loss: 0.1627773
Validation loss decreased (0.114866 --> 0.114672).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2586860
	speed: 0.6905s/iter; left time: 6287.8931s
	iters: 200, epoch: 16 | loss: 0.2989095
	speed: 0.1610s/iter; left time: 1450.1132s
Epoch: 16 cost time: 42.93912124633789
Epoch: 16, Steps: 263 | Train Loss: 0.2079393 Vali Loss: 0.1147163 Test Loss: 0.1626385
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2309160
	speed: 0.7056s/iter; left time: 6239.9721s
	iters: 200, epoch: 17 | loss: 0.2749775
	speed: 0.1456s/iter; left time: 1273.1846s
Epoch: 17 cost time: 39.051209926605225
Epoch: 17, Steps: 263 | Train Loss: 0.2077154 Vali Loss: 0.1146931 Test Loss: 0.1626338
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1727291
	speed: 0.6580s/iter; left time: 5645.5404s
	iters: 200, epoch: 18 | loss: 0.2727737
	speed: 0.1548s/iter; left time: 1313.1190s
Epoch: 18 cost time: 41.36204266548157
Epoch: 18, Steps: 263 | Train Loss: 0.2076631 Vali Loss: 0.1147304 Test Loss: 0.1627099
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1632574498653412, mae:0.25419554114341736, rse:0.32759153842926025, corr:[0.56525433 0.5700987  0.5677522  0.56516486 0.5647749  0.5659527
 0.56692404 0.5665129  0.56524223 0.564271   0.56418055 0.56476825
 0.56535816 0.56529915 0.56465065 0.56383663 0.5633225  0.5631508
 0.5630078  0.56250393 0.5616015  0.5605236  0.5596203  0.5590645
 0.5587331  0.55839264 0.5579083  0.55730397 0.55666715 0.5561286
 0.555728   0.55549204 0.55515593 0.5545083  0.5536799  0.55291635
 0.5523017  0.5518213  0.55129313 0.55056876 0.5496623  0.54872644
 0.5479729  0.5475316  0.54734963 0.54709446 0.5464973  0.5455366
 0.54426277 0.5429419  0.54193765 0.5414039  0.5410113  0.54038477
 0.5394051  0.53826714 0.5372326  0.5365939  0.53635716 0.5362281
 0.53588325 0.5353891  0.5349412  0.53474087 0.534793   0.53492105
 0.534748   0.5342451  0.5336719  0.5334012  0.5335831  0.53386676
 0.53375155 0.5330892  0.5319513  0.5307715  0.53011173 0.53015894
 0.5303167  0.53003037 0.528984   0.5275647  0.5264034  0.5259918
 0.5259935  0.5256123  0.5242897  0.52241445 0.5211044  0.5213034
 0.5223126  0.5224352  0.5208102  0.5183646  0.51853085 0.52253664]
