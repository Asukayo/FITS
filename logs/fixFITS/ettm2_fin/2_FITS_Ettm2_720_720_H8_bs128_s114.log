Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=256, c_out=7, checkpoints='./checkpoints/', cut_freq=74, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_720_FITS_ETTm2_ftM_sl720_ll48_pl720_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33121
val 10801
test 10801
Model(
  (freq_upsampler): Linear(in_features=74, out_features=148, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  19625984.0
params:  11100.0
Trainable parameters:  11100
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4659463
	speed: 0.0854s/iter; left time: 542.5229s
Epoch: 1 cost time: 10.791994571685791
Epoch: 1, Steps: 129 | Train Loss: 0.5026195 Vali Loss: 0.3236138 Test Loss: 0.4343829
Validation loss decreased (inf --> 0.323614).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3695068
	speed: 0.2166s/iter; left time: 1347.5815s
Epoch: 2 cost time: 10.59786868095398
Epoch: 2, Steps: 129 | Train Loss: 0.3810212 Vali Loss: 0.2982621 Test Loss: 0.4027510
Validation loss decreased (0.323614 --> 0.298262).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2940887
	speed: 0.1223s/iter; left time: 745.4549s
Epoch: 3 cost time: 7.152766227722168
Epoch: 3, Steps: 129 | Train Loss: 0.3378879 Vali Loss: 0.2887023 Test Loss: 0.3908345
Validation loss decreased (0.298262 --> 0.288702).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3321625
	speed: 0.1006s/iter; left time: 599.9870s
Epoch: 4 cost time: 4.699429273605347
Epoch: 4, Steps: 129 | Train Loss: 0.3161698 Vali Loss: 0.2834579 Test Loss: 0.3843884
Validation loss decreased (0.288702 --> 0.283458).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2323112
	speed: 0.0979s/iter; left time: 571.3710s
Epoch: 5 cost time: 4.624671220779419
Epoch: 5, Steps: 129 | Train Loss: 0.3017368 Vali Loss: 0.2801464 Test Loss: 0.3799833
Validation loss decreased (0.283458 --> 0.280146).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3433439
	speed: 0.1098s/iter; left time: 626.6480s
Epoch: 6 cost time: 5.372203826904297
Epoch: 6, Steps: 129 | Train Loss: 0.2920537 Vali Loss: 0.2773989 Test Loss: 0.3765472
Validation loss decreased (0.280146 --> 0.277399).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2505828
	speed: 0.0959s/iter; left time: 534.6707s
Epoch: 7 cost time: 4.511947393417358
Epoch: 7, Steps: 129 | Train Loss: 0.2847063 Vali Loss: 0.2748999 Test Loss: 0.3740042
Validation loss decreased (0.277399 --> 0.274900).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2926400
	speed: 0.0947s/iter; left time: 516.1075s
Epoch: 8 cost time: 5.217075347900391
Epoch: 8, Steps: 129 | Train Loss: 0.2786098 Vali Loss: 0.2734362 Test Loss: 0.3716265
Validation loss decreased (0.274900 --> 0.273436).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2590596
	speed: 0.1612s/iter; left time: 857.2144s
Epoch: 9 cost time: 11.501538515090942
Epoch: 9, Steps: 129 | Train Loss: 0.2748684 Vali Loss: 0.2720136 Test Loss: 0.3700327
Validation loss decreased (0.273436 --> 0.272014).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2724311
	speed: 0.2333s/iter; left time: 1210.9848s
Epoch: 10 cost time: 10.97382116317749
Epoch: 10, Steps: 129 | Train Loss: 0.2714749 Vali Loss: 0.2709633 Test Loss: 0.3683518
Validation loss decreased (0.272014 --> 0.270963).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2449753
	speed: 0.2673s/iter; left time: 1352.9052s
Epoch: 11 cost time: 13.116224765777588
Epoch: 11, Steps: 129 | Train Loss: 0.2691667 Vali Loss: 0.2699989 Test Loss: 0.3671710
Validation loss decreased (0.270963 --> 0.269999).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2242930
	speed: 0.2701s/iter; left time: 1331.9737s
Epoch: 12 cost time: 12.710172891616821
Epoch: 12, Steps: 129 | Train Loss: 0.2670283 Vali Loss: 0.2690526 Test Loss: 0.3661507
Validation loss decreased (0.269999 --> 0.269053).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2361744
	speed: 0.2674s/iter; left time: 1284.4855s
Epoch: 13 cost time: 12.92971658706665
Epoch: 13, Steps: 129 | Train Loss: 0.2659740 Vali Loss: 0.2684575 Test Loss: 0.3653584
Validation loss decreased (0.269053 --> 0.268457).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2280567
	speed: 0.2557s/iter; left time: 1195.1856s
Epoch: 14 cost time: 12.14421033859253
Epoch: 14, Steps: 129 | Train Loss: 0.2645784 Vali Loss: 0.2678061 Test Loss: 0.3645532
Validation loss decreased (0.268457 --> 0.267806).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2801601
	speed: 0.2426s/iter; left time: 1102.5213s
Epoch: 15 cost time: 11.573651313781738
Epoch: 15, Steps: 129 | Train Loss: 0.2637393 Vali Loss: 0.2675616 Test Loss: 0.3639992
Validation loss decreased (0.267806 --> 0.267562).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2866190
	speed: 0.2401s/iter; left time: 1060.3261s
Epoch: 16 cost time: 11.337157011032104
Epoch: 16, Steps: 129 | Train Loss: 0.2630682 Vali Loss: 0.2668191 Test Loss: 0.3635656
Validation loss decreased (0.267562 --> 0.266819).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2794155
	speed: 0.2471s/iter; left time: 1059.1595s
Epoch: 17 cost time: 11.92376184463501
Epoch: 17, Steps: 129 | Train Loss: 0.2623043 Vali Loss: 0.2666065 Test Loss: 0.3631238
Validation loss decreased (0.266819 --> 0.266606).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2535405
	speed: 0.2498s/iter; left time: 1038.7238s
Epoch: 18 cost time: 12.26050591468811
Epoch: 18, Steps: 129 | Train Loss: 0.2620721 Vali Loss: 0.2664219 Test Loss: 0.3628564
Validation loss decreased (0.266606 --> 0.266422).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3078496
	speed: 0.2308s/iter; left time: 929.9536s
Epoch: 19 cost time: 12.158799648284912
Epoch: 19, Steps: 129 | Train Loss: 0.2616739 Vali Loss: 0.2659190 Test Loss: 0.3625718
Validation loss decreased (0.266422 --> 0.265919).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2665538
	speed: 0.2479s/iter; left time: 966.7862s
Epoch: 20 cost time: 11.66189956665039
Epoch: 20, Steps: 129 | Train Loss: 0.2613633 Vali Loss: 0.2661023 Test Loss: 0.3623109
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3271509
	speed: 0.2566s/iter; left time: 967.5503s
Epoch: 21 cost time: 12.195135354995728
Epoch: 21, Steps: 129 | Train Loss: 0.2611301 Vali Loss: 0.2656794 Test Loss: 0.3620826
Validation loss decreased (0.265919 --> 0.265679).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2653947
	speed: 0.1322s/iter; left time: 481.4140s
Epoch: 22 cost time: 5.910799264907837
Epoch: 22, Steps: 129 | Train Loss: 0.2609866 Vali Loss: 0.2655310 Test Loss: 0.3619543
Validation loss decreased (0.265679 --> 0.265531).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2277564
	speed: 0.1216s/iter; left time: 427.2616s
Epoch: 23 cost time: 6.1540210247039795
Epoch: 23, Steps: 129 | Train Loss: 0.2606427 Vali Loss: 0.2654237 Test Loss: 0.3617944
Validation loss decreased (0.265531 --> 0.265424).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2941061
	speed: 0.1290s/iter; left time: 436.6983s
Epoch: 24 cost time: 5.622537851333618
Epoch: 24, Steps: 129 | Train Loss: 0.2602637 Vali Loss: 0.2652572 Test Loss: 0.3616594
Validation loss decreased (0.265424 --> 0.265257).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2428121
	speed: 0.1224s/iter; left time: 398.4848s
Epoch: 25 cost time: 5.89907431602478
Epoch: 25, Steps: 129 | Train Loss: 0.2602615 Vali Loss: 0.2650200 Test Loss: 0.3615262
Validation loss decreased (0.265257 --> 0.265020).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2991750
	speed: 0.1212s/iter; left time: 378.8723s
Epoch: 26 cost time: 7.409920692443848
Epoch: 26, Steps: 129 | Train Loss: 0.2603380 Vali Loss: 0.2648935 Test Loss: 0.3614558
Validation loss decreased (0.265020 --> 0.264893).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2263408
	speed: 0.1230s/iter; left time: 368.7269s
Epoch: 27 cost time: 6.765370607376099
Epoch: 27, Steps: 129 | Train Loss: 0.2601202 Vali Loss: 0.2650167 Test Loss: 0.3614565
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2734730
	speed: 0.1174s/iter; left time: 336.6925s
Epoch: 28 cost time: 6.037390470504761
Epoch: 28, Steps: 129 | Train Loss: 0.2596517 Vali Loss: 0.2648033 Test Loss: 0.3613450
Validation loss decreased (0.264893 --> 0.264803).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2768439
	speed: 0.1237s/iter; left time: 338.7358s
Epoch: 29 cost time: 6.046271562576294
