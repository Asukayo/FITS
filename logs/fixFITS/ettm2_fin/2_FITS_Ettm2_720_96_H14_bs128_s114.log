Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=256, c_out=7, checkpoints='./checkpoints/', cut_freq=122, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=122, out_features=138, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  30170112.0
params:  16974.0
Trainable parameters:  16974
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2593203
	speed: 0.1432s/iter; left time: 923.9801s
Epoch: 1 cost time: 18.602112293243408
Epoch: 1, Steps: 131 | Train Loss: 0.3249548 Vali Loss: 0.1927006 Test Loss: 0.2488848
Validation loss decreased (inf --> 0.192701).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1795868
	speed: 0.3787s/iter; left time: 2393.6524s
Epoch: 2 cost time: 17.85709810256958
Epoch: 2, Steps: 131 | Train Loss: 0.2212245 Vali Loss: 0.1784316 Test Loss: 0.2290052
Validation loss decreased (0.192701 --> 0.178432).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2012556
	speed: 0.3775s/iter; left time: 2336.5380s
Epoch: 3 cost time: 17.85565948486328
Epoch: 3, Steps: 131 | Train Loss: 0.1768553 Vali Loss: 0.1729955 Test Loss: 0.2225919
Validation loss decreased (0.178432 --> 0.172995).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1688093
	speed: 0.4088s/iter; left time: 2476.3250s
Epoch: 4 cost time: 20.221725702285767
Epoch: 4, Steps: 131 | Train Loss: 0.1503220 Vali Loss: 0.1689769 Test Loss: 0.2177328
Validation loss decreased (0.172995 --> 0.168977).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1240578
	speed: 0.4086s/iter; left time: 2421.7138s
Epoch: 5 cost time: 18.749348878860474
Epoch: 5, Steps: 131 | Train Loss: 0.1311781 Vali Loss: 0.1647113 Test Loss: 0.2131466
Validation loss decreased (0.168977 --> 0.164711).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1021179
	speed: 0.4044s/iter; left time: 2343.9777s
Epoch: 6 cost time: 18.118576288223267
Epoch: 6, Steps: 131 | Train Loss: 0.1166119 Vali Loss: 0.1606182 Test Loss: 0.2085258
Validation loss decreased (0.164711 --> 0.160618).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0986061
	speed: 0.3879s/iter; left time: 2197.5828s
Epoch: 7 cost time: 18.707472562789917
Epoch: 7, Steps: 131 | Train Loss: 0.1046701 Vali Loss: 0.1565153 Test Loss: 0.2042160
Validation loss decreased (0.160618 --> 0.156515).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0930400
	speed: 0.3853s/iter; left time: 2132.3606s
Epoch: 8 cost time: 18.244242906570435
Epoch: 8, Steps: 131 | Train Loss: 0.0950871 Vali Loss: 0.1529818 Test Loss: 0.2003130
Validation loss decreased (0.156515 --> 0.152982).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0893475
	speed: 0.3906s/iter; left time: 2110.4705s
Epoch: 9 cost time: 18.727155447006226
Epoch: 9, Steps: 131 | Train Loss: 0.0869282 Vali Loss: 0.1499759 Test Loss: 0.1971087
Validation loss decreased (0.152982 --> 0.149976).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0825523
	speed: 0.3987s/iter; left time: 2101.7120s
Epoch: 10 cost time: 18.670178651809692
Epoch: 10, Steps: 131 | Train Loss: 0.0802149 Vali Loss: 0.1465117 Test Loss: 0.1936426
Validation loss decreased (0.149976 --> 0.146512).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0789086
	speed: 0.3502s/iter; left time: 1800.1231s
Epoch: 11 cost time: 16.809001684188843
Epoch: 11, Steps: 131 | Train Loss: 0.0744521 Vali Loss: 0.1440780 Test Loss: 0.1909123
Validation loss decreased (0.146512 --> 0.144078).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0666778
	speed: 0.3343s/iter; left time: 1674.6659s
Epoch: 12 cost time: 14.541721105575562
Epoch: 12, Steps: 131 | Train Loss: 0.0694548 Vali Loss: 0.1414106 Test Loss: 0.1883683
Validation loss decreased (0.144078 --> 0.141411).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0709677
	speed: 0.3063s/iter; left time: 1494.2182s
Epoch: 13 cost time: 17.446484088897705
Epoch: 13, Steps: 131 | Train Loss: 0.0653082 Vali Loss: 0.1395436 Test Loss: 0.1861781
Validation loss decreased (0.141411 --> 0.139544).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0678460
	speed: 0.3817s/iter; left time: 1812.4932s
Epoch: 14 cost time: 18.391090631484985
Epoch: 14, Steps: 131 | Train Loss: 0.0616363 Vali Loss: 0.1374211 Test Loss: 0.1840815
Validation loss decreased (0.139544 --> 0.137421).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0554768
	speed: 0.3706s/iter; left time: 1710.9254s
Epoch: 15 cost time: 16.774378776550293
Epoch: 15, Steps: 131 | Train Loss: 0.0585931 Vali Loss: 0.1358031 Test Loss: 0.1825068
Validation loss decreased (0.137421 --> 0.135803).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0594524
	speed: 0.2530s/iter; left time: 1134.9528s
Epoch: 16 cost time: 13.304142951965332
Epoch: 16, Steps: 131 | Train Loss: 0.0559500 Vali Loss: 0.1341486 Test Loss: 0.1807727
Validation loss decreased (0.135803 --> 0.134149).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0470289
	speed: 0.3294s/iter; left time: 1434.5616s
Epoch: 17 cost time: 16.16916823387146
Epoch: 17, Steps: 131 | Train Loss: 0.0535275 Vali Loss: 0.1327258 Test Loss: 0.1793942
Validation loss decreased (0.134149 --> 0.132726).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0578290
	speed: 0.3249s/iter; left time: 1372.3134s
Epoch: 18 cost time: 16.114644527435303
Epoch: 18, Steps: 131 | Train Loss: 0.0513923 Vali Loss: 0.1315569 Test Loss: 0.1780727
Validation loss decreased (0.132726 --> 0.131557).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0456909
	speed: 0.3276s/iter; left time: 1340.7623s
Epoch: 19 cost time: 16.186866521835327
Epoch: 19, Steps: 131 | Train Loss: 0.0497238 Vali Loss: 0.1302965 Test Loss: 0.1769861
Validation loss decreased (0.131557 --> 0.130297).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0546175
	speed: 0.3324s/iter; left time: 1317.0791s
Epoch: 20 cost time: 16.061399221420288
Epoch: 20, Steps: 131 | Train Loss: 0.0481179 Vali Loss: 0.1294136 Test Loss: 0.1760354
Validation loss decreased (0.130297 --> 0.129414).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0472835
	speed: 0.3357s/iter; left time: 1285.9766s
Epoch: 21 cost time: 16.188879013061523
Epoch: 21, Steps: 131 | Train Loss: 0.0467441 Vali Loss: 0.1283708 Test Loss: 0.1750122
Validation loss decreased (0.129414 --> 0.128371).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0429836
	speed: 0.3381s/iter; left time: 1250.9586s
Epoch: 22 cost time: 16.111658811569214
Epoch: 22, Steps: 131 | Train Loss: 0.0455767 Vali Loss: 0.1276414 Test Loss: 0.1742998
Validation loss decreased (0.128371 --> 0.127641).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0394290
	speed: 0.3261s/iter; left time: 1163.9779s
Epoch: 23 cost time: 15.569246053695679
Epoch: 23, Steps: 131 | Train Loss: 0.0444769 Vali Loss: 0.1270045 Test Loss: 0.1737180
Validation loss decreased (0.127641 --> 0.127005).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0402584
	speed: 0.3613s/iter; left time: 1242.1505s
Epoch: 24 cost time: 18.959076404571533
Epoch: 24, Steps: 131 | Train Loss: 0.0435386 Vali Loss: 0.1264013 Test Loss: 0.1730715
Validation loss decreased (0.127005 --> 0.126401).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0414916
	speed: 0.2995s/iter; left time: 990.5832s
Epoch: 25 cost time: 11.932838201522827
Epoch: 25, Steps: 131 | Train Loss: 0.0426232 Vali Loss: 0.1257693 Test Loss: 0.1724774
Validation loss decreased (0.126401 --> 0.125769).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0380372
	speed: 0.3254s/iter; left time: 1033.3422s
Epoch: 26 cost time: 19.231797695159912
Epoch: 26, Steps: 131 | Train Loss: 0.0418573 Vali Loss: 0.1250439 Test Loss: 0.1719549
Validation loss decreased (0.125769 --> 0.125044).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0465670
	speed: 0.3520s/iter; left time: 1071.8462s
Epoch: 27 cost time: 16.66412854194641
Epoch: 27, Steps: 131 | Train Loss: 0.0412572 Vali Loss: 0.1244034 Test Loss: 0.1714408
Validation loss decreased (0.125044 --> 0.124403).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0365734
	speed: 0.3519s/iter; left time: 1025.3579s
Epoch: 28 cost time: 16.89019799232483
Epoch: 28, Steps: 131 | Train Loss: 0.0406184 Vali Loss: 0.1240672 Test Loss: 0.1711628
Validation loss decreased (0.124403 --> 0.124067).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0395749
	speed: 0.3464s/iter; left time: 963.9214s
Epoch: 29 cost time: 16.76206064224243
Epoch: 29, Steps: 131 | Train Loss: 0.0401357 Vali Loss: 0.1238510 Test Loss: 0.1707700
Validation loss decreased (0.124067 --> 0.123851).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.0348973
	speed: 0.3525s/iter; left time: 934.7540s
Epoch: 30 cost time: 16.88546109199524
Epoch: 30, Steps: 131 | Train Loss: 0.0395756 Vali Loss: 0.1232890 Test Loss: 0.1704444
Validation loss decreased (0.123851 --> 0.123289).  Saving model ...
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0318606
	speed: 0.3406s/iter; left time: 858.7714s
Epoch: 31 cost time: 15.079015970230103
Epoch: 31, Steps: 131 | Train Loss: 0.0392126 Vali Loss: 0.1228852 Test Loss: 0.1702050
Validation loss decreased (0.123289 --> 0.122885).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.0308861
	speed: 0.2792s/iter; left time: 667.2810s
Epoch: 32 cost time: 14.475428104400635
Epoch: 32, Steps: 131 | Train Loss: 0.0388089 Vali Loss: 0.1227716 Test Loss: 0.1698881
Validation loss decreased (0.122885 --> 0.122772).  Saving model ...
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0441519
	speed: 0.3439s/iter; left time: 776.8472s
Epoch: 33 cost time: 17.01107883453369
Epoch: 33, Steps: 131 | Train Loss: 0.0383809 Vali Loss: 0.1225224 Test Loss: 0.1697472
Validation loss decreased (0.122772 --> 0.122522).  Saving model ...
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0287906
	speed: 0.3355s/iter; left time: 714.0281s
Epoch: 34 cost time: 15.263628482818604
Epoch: 34, Steps: 131 | Train Loss: 0.0380361 Vali Loss: 0.1223090 Test Loss: 0.1695408
Validation loss decreased (0.122522 --> 0.122309).  Saving model ...
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.0450102
	speed: 0.3253s/iter; left time: 649.5679s
Epoch: 35 cost time: 16.173924922943115
Epoch: 35, Steps: 131 | Train Loss: 0.0378717 Vali Loss: 0.1218563 Test Loss: 0.1692773
Validation loss decreased (0.122309 --> 0.121856).  Saving model ...
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.0439442
	speed: 0.3675s/iter; left time: 685.7090s
Epoch: 36 cost time: 18.988343715667725
Epoch: 36, Steps: 131 | Train Loss: 0.0376017 Vali Loss: 0.1216595 Test Loss: 0.1690852
Validation loss decreased (0.121856 --> 0.121659).  Saving model ...
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.0363126
	speed: 0.3963s/iter; left time: 687.5553s
Epoch: 37 cost time: 17.505621671676636
Epoch: 37, Steps: 131 | Train Loss: 0.0373606 Vali Loss: 0.1212942 Test Loss: 0.1689345
Validation loss decreased (0.121659 --> 0.121294).  Saving model ...
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.0315318
	speed: 0.3678s/iter; left time: 589.8884s
Epoch: 38 cost time: 17.56212568283081
Epoch: 38, Steps: 131 | Train Loss: 0.0371253 Vali Loss: 0.1211555 Test Loss: 0.1688166
Validation loss decreased (0.121294 --> 0.121156).  Saving model ...
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.0445260
	speed: 0.3681s/iter; left time: 542.2433s
Epoch: 39 cost time: 17.192327737808228
Epoch: 39, Steps: 131 | Train Loss: 0.0369629 Vali Loss: 0.1210704 Test Loss: 0.1686852
Validation loss decreased (0.121156 --> 0.121070).  Saving model ...
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.0366679
	speed: 0.3708s/iter; left time: 497.6791s
Epoch: 40 cost time: 17.980210542678833
Epoch: 40, Steps: 131 | Train Loss: 0.0368093 Vali Loss: 0.1208821 Test Loss: 0.1685539
Validation loss decreased (0.121070 --> 0.120882).  Saving model ...
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.0392841
	speed: 0.3458s/iter; left time: 418.7850s
Epoch: 41 cost time: 15.697078943252563
Epoch: 41, Steps: 131 | Train Loss: 0.0366608 Vali Loss: 0.1207375 Test Loss: 0.1684769
Validation loss decreased (0.120882 --> 0.120738).  Saving model ...
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.0386642
	speed: 0.3512s/iter; left time: 379.2834s
Epoch: 42 cost time: 15.064374208450317
Epoch: 42, Steps: 131 | Train Loss: 0.0365129 Vali Loss: 0.1204987 Test Loss: 0.1683607
Validation loss decreased (0.120738 --> 0.120499).  Saving model ...
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.0390955
	speed: 0.2363s/iter; left time: 224.2060s
Epoch: 43 cost time: 12.768592119216919
Epoch: 43, Steps: 131 | Train Loss: 0.0363857 Vali Loss: 0.1205185 Test Loss: 0.1682322
EarlyStopping counter: 1 out of 3
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.0332852
	speed: 0.3273s/iter; left time: 267.7673s
Epoch: 44 cost time: 16.887258291244507
Epoch: 44, Steps: 131 | Train Loss: 0.0362168 Vali Loss: 0.1203135 Test Loss: 0.1681440
Validation loss decreased (0.120499 --> 0.120313).  Saving model ...
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.0358958
	speed: 0.3625s/iter; left time: 249.0500s
Epoch: 45 cost time: 17.649747133255005
Epoch: 45, Steps: 131 | Train Loss: 0.0361272 Vali Loss: 0.1202917 Test Loss: 0.1680738
Validation loss decreased (0.120313 --> 0.120292).  Saving model ...
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.0354380
	speed: 0.3295s/iter; left time: 183.1853s
Epoch: 46 cost time: 15.546226024627686
Epoch: 46, Steps: 131 | Train Loss: 0.0360554 Vali Loss: 0.1200839 Test Loss: 0.1680728
Validation loss decreased (0.120292 --> 0.120084).  Saving model ...
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.0364388
	speed: 0.3581s/iter; left time: 152.2083s
Epoch: 47 cost time: 16.63034963607788
Epoch: 47, Steps: 131 | Train Loss: 0.0359172 Vali Loss: 0.1200194 Test Loss: 0.1679665
Validation loss decreased (0.120084 --> 0.120019).  Saving model ...
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.0386555
	speed: 0.3373s/iter; left time: 99.1645s
Epoch: 48 cost time: 16.953855276107788
Epoch: 48, Steps: 131 | Train Loss: 0.0358624 Vali Loss: 0.1200334 Test Loss: 0.1679232
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.0379906
	speed: 0.2466s/iter; left time: 40.1936s
Epoch: 49 cost time: 7.604248523712158
Epoch: 49, Steps: 131 | Train Loss: 0.0357668 Vali Loss: 0.1198023 Test Loss: 0.1678414
Validation loss decreased (0.120019 --> 0.119802).  Saving model ...
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.0328486
	speed: 0.2119s/iter; left time: 6.7811s
Epoch: 50 cost time: 12.478615045547485
Epoch: 50, Steps: 131 | Train Loss: 0.0357565 Vali Loss: 0.1196560 Test Loss: 0.1678364
Validation loss decreased (0.119802 --> 0.119656).  Saving model ...
Updating learning rate to 4.0497355408796396e-05
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=122, out_features=138, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  30170112.0
params:  16974.0
Trainable parameters:  16974
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1899947
	speed: 0.1325s/iter; left time: 854.4616s
Epoch: 1 cost time: 17.235416412353516
Epoch: 1, Steps: 131 | Train Loss: 0.2137862 Vali Loss: 0.1156976 Test Loss: 0.1639822
Validation loss decreased (inf --> 0.115698).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1761769
	speed: 0.3570s/iter; left time: 2256.4504s
Epoch: 2 cost time: 16.962300300598145
Epoch: 2, Steps: 131 | Train Loss: 0.2104271 Vali Loss: 0.1148311 Test Loss: 0.1633585
Validation loss decreased (0.115698 --> 0.114831).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2199891
	speed: 0.3470s/iter; left time: 2147.8612s
Epoch: 3 cost time: 16.199116230010986
Epoch: 3, Steps: 131 | Train Loss: 0.2084402 Vali Loss: 0.1143097 Test Loss: 0.1628760
Validation loss decreased (0.114831 --> 0.114310).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2438068
	speed: 0.3463s/iter; left time: 2097.9742s
Epoch: 4 cost time: 16.186462879180908
Epoch: 4, Steps: 131 | Train Loss: 0.2082229 Vali Loss: 0.1147381 Test Loss: 0.1628515
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2460312
	speed: 0.3133s/iter; left time: 1856.8883s
Epoch: 5 cost time: 13.664636611938477
Epoch: 5, Steps: 131 | Train Loss: 0.2081017 Vali Loss: 0.1142847 Test Loss: 0.1624656
Validation loss decreased (0.114310 --> 0.114285).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2113424
	speed: 0.3513s/iter; left time: 2036.1012s
Epoch: 6 cost time: 19.69226384162903
Epoch: 6, Steps: 131 | Train Loss: 0.2072416 Vali Loss: 0.1142594 Test Loss: 0.1622607
Validation loss decreased (0.114285 --> 0.114259).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2005398
	speed: 0.3955s/iter; left time: 2240.5380s
Epoch: 7 cost time: 18.669764757156372
Epoch: 7, Steps: 131 | Train Loss: 0.2069099 Vali Loss: 0.1142593 Test Loss: 0.1623115
Validation loss decreased (0.114259 --> 0.114259).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1752849
	speed: 0.3354s/iter; left time: 1856.2458s
Epoch: 8 cost time: 15.760408163070679
Epoch: 8, Steps: 131 | Train Loss: 0.2066897 Vali Loss: 0.1140697 Test Loss: 0.1621623
Validation loss decreased (0.114259 --> 0.114070).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2078529
	speed: 0.3375s/iter; left time: 1823.4118s
Epoch: 9 cost time: 16.795665979385376
Epoch: 9, Steps: 131 | Train Loss: 0.2064974 Vali Loss: 0.1143584 Test Loss: 0.1620699
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1920534
	speed: 0.3496s/iter; left time: 1843.1869s
Epoch: 10 cost time: 17.087071418762207
Epoch: 10, Steps: 131 | Train Loss: 0.2060319 Vali Loss: 0.1143396 Test Loss: 0.1622467
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2330220
	speed: 0.3508s/iter; left time: 1803.6165s
Epoch: 11 cost time: 16.904853105545044
Epoch: 11, Steps: 131 | Train Loss: 0.2068776 Vali Loss: 0.1140293 Test Loss: 0.1621559
Validation loss decreased (0.114070 --> 0.114029).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2312714
	speed: 0.3541s/iter; left time: 1774.2412s
Epoch: 12 cost time: 16.657386541366577
Epoch: 12, Steps: 131 | Train Loss: 0.2064056 Vali Loss: 0.1141165 Test Loss: 0.1621700
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2187376
	speed: 0.3518s/iter; left time: 1716.5416s
Epoch: 13 cost time: 16.6777982711792
Epoch: 13, Steps: 131 | Train Loss: 0.2061815 Vali Loss: 0.1142678 Test Loss: 0.1621598
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1620214
	speed: 0.2793s/iter; left time: 1326.0078s
Epoch: 14 cost time: 12.910059928894043
Epoch: 14, Steps: 131 | Train Loss: 0.2063675 Vali Loss: 0.1142578 Test Loss: 0.1620942
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16276921331882477, mae:0.2538536787033081, rse:0.32710134983062744, corr:[0.5706305  0.5723078  0.5695017  0.56721896 0.5669641  0.5675892
 0.56750596 0.5664517  0.5653877  0.56502706 0.5652114  0.56527555
 0.5648474  0.56417054 0.56376684 0.56367946 0.5635844  0.56303537
 0.5619887  0.5608395  0.5600144  0.55953336 0.5591909  0.55875576
 0.55817044 0.5576116  0.5572049  0.55683154 0.5562679  0.5555015
 0.5546993  0.554171   0.55388093 0.553554   0.55300957 0.5522742
 0.55144    0.55065745 0.5499767  0.54937357 0.5487543  0.54808944
 0.5474781  0.5469898  0.54660016 0.5461073  0.54537046 0.54443204
 0.5433457  0.5422945  0.5414758  0.5408992  0.54026794 0.53941524
 0.5384466  0.5376724  0.53716505 0.5367583  0.53622776 0.5355603
 0.53490824 0.5346261  0.5347283  0.53485394 0.53467655 0.5342216
 0.53357124 0.53310364 0.5330367  0.5330939  0.53296167 0.5326593
 0.5323902  0.53234434 0.53227925 0.5318887  0.5310225  0.5298981
 0.52895683 0.52862126 0.5284186  0.5278725  0.5267983  0.5255868
 0.52488124 0.524892   0.5248442  0.5242373  0.52328193 0.5227259
 0.5231109  0.5236736  0.5230798  0.5214642  0.52081037 0.52295965]
