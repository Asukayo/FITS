Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=256, c_out=7, checkpoints='./checkpoints/', cut_freq=90, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=90, out_features=102, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  16450560.0
params:  9282.0
Trainable parameters:  9282
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2770303
	speed: 0.1324s/iter; left time: 854.0181s
Epoch: 1 cost time: 17.151020526885986
Epoch: 1, Steps: 131 | Train Loss: 0.3357746 Vali Loss: 0.1400754 Test Loss: 0.1913215
Validation loss decreased (inf --> 0.140075).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3557676
	speed: 0.3527s/iter; left time: 2228.9861s
Epoch: 2 cost time: 16.15142846107483
Epoch: 2, Steps: 131 | Train Loss: 0.2529162 Vali Loss: 0.1281314 Test Loss: 0.1780754
Validation loss decreased (0.140075 --> 0.128131).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2492113
	speed: 0.3399s/iter; left time: 2103.9110s
Epoch: 3 cost time: 16.492661952972412
Epoch: 3, Steps: 131 | Train Loss: 0.2354529 Vali Loss: 0.1231357 Test Loss: 0.1725746
Validation loss decreased (0.128131 --> 0.123136).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2161777
	speed: 0.3541s/iter; left time: 2145.3001s
Epoch: 4 cost time: 16.21614646911621
Epoch: 4, Steps: 131 | Train Loss: 0.2274721 Vali Loss: 0.1210171 Test Loss: 0.1699692
Validation loss decreased (0.123136 --> 0.121017).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1742229
	speed: 0.3530s/iter; left time: 2092.3327s
Epoch: 5 cost time: 16.98585867881775
Epoch: 5, Steps: 131 | Train Loss: 0.2225972 Vali Loss: 0.1194477 Test Loss: 0.1683583
Validation loss decreased (0.121017 --> 0.119448).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2147541
	speed: 0.3502s/iter; left time: 2029.4983s
Epoch: 6 cost time: 16.436578273773193
Epoch: 6, Steps: 131 | Train Loss: 0.2193774 Vali Loss: 0.1185020 Test Loss: 0.1671869
Validation loss decreased (0.119448 --> 0.118502).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3325937
	speed: 0.3268s/iter; left time: 1851.3686s
Epoch: 7 cost time: 15.881586790084839
Epoch: 7, Steps: 131 | Train Loss: 0.2171538 Vali Loss: 0.1179395 Test Loss: 0.1664294
Validation loss decreased (0.118502 --> 0.117939).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2311494
	speed: 0.3214s/iter; left time: 1778.5294s
Epoch: 8 cost time: 16.50702142715454
Epoch: 8, Steps: 131 | Train Loss: 0.2159371 Vali Loss: 0.1173918 Test Loss: 0.1658640
Validation loss decreased (0.117939 --> 0.117392).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2097620
	speed: 0.3540s/iter; left time: 1912.5999s
Epoch: 9 cost time: 17.461957454681396
Epoch: 9, Steps: 131 | Train Loss: 0.2144492 Vali Loss: 0.1171871 Test Loss: 0.1654099
Validation loss decreased (0.117392 --> 0.117187).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2516721
	speed: 0.2556s/iter; left time: 1347.3863s
Epoch: 10 cost time: 11.25033974647522
Epoch: 10, Steps: 131 | Train Loss: 0.2129710 Vali Loss: 0.1167938 Test Loss: 0.1650326
Validation loss decreased (0.117187 --> 0.116794).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1969963
	speed: 0.3054s/iter; left time: 1569.8127s
Epoch: 11 cost time: 15.140604019165039
Epoch: 11, Steps: 131 | Train Loss: 0.2126290 Vali Loss: 0.1164583 Test Loss: 0.1646065
Validation loss decreased (0.116794 --> 0.116458).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2516874
	speed: 0.3195s/iter; left time: 1600.8880s
Epoch: 12 cost time: 15.66907286643982
Epoch: 12, Steps: 131 | Train Loss: 0.2122209 Vali Loss: 0.1163669 Test Loss: 0.1643796
Validation loss decreased (0.116458 --> 0.116367).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2242921
	speed: 0.3374s/iter; left time: 1646.2134s
Epoch: 13 cost time: 15.981914281845093
Epoch: 13, Steps: 131 | Train Loss: 0.2118749 Vali Loss: 0.1163908 Test Loss: 0.1642307
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1651094
	speed: 0.3222s/iter; left time: 1529.7187s
Epoch: 14 cost time: 15.837975978851318
Epoch: 14, Steps: 131 | Train Loss: 0.2109498 Vali Loss: 0.1161537 Test Loss: 0.1639089
Validation loss decreased (0.116367 --> 0.116154).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2238792
	speed: 0.3291s/iter; left time: 1519.4455s
Epoch: 15 cost time: 15.832773208618164
Epoch: 15, Steps: 131 | Train Loss: 0.2109482 Vali Loss: 0.1159751 Test Loss: 0.1638332
Validation loss decreased (0.116154 --> 0.115975).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2044436
	speed: 0.3541s/iter; left time: 1588.5483s
Epoch: 16 cost time: 17.31405210494995
Epoch: 16, Steps: 131 | Train Loss: 0.2105225 Vali Loss: 0.1159064 Test Loss: 0.1638978
Validation loss decreased (0.115975 --> 0.115906).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1687352
	speed: 0.4128s/iter; left time: 1797.7007s
Epoch: 17 cost time: 18.649540185928345
Epoch: 17, Steps: 131 | Train Loss: 0.2104473 Vali Loss: 0.1158611 Test Loss: 0.1637245
Validation loss decreased (0.115906 --> 0.115861).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1794268
	speed: 0.3839s/iter; left time: 1621.5482s
Epoch: 18 cost time: 17.247770071029663
Epoch: 18, Steps: 131 | Train Loss: 0.2102698 Vali Loss: 0.1158808 Test Loss: 0.1636969
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2321150
	speed: 0.3517s/iter; left time: 1439.5544s
Epoch: 19 cost time: 16.243052005767822
Epoch: 19, Steps: 131 | Train Loss: 0.2096441 Vali Loss: 0.1157095 Test Loss: 0.1635508
Validation loss decreased (0.115861 --> 0.115709).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1730768
	speed: 0.3476s/iter; left time: 1377.2684s
Epoch: 20 cost time: 17.110963821411133
Epoch: 20, Steps: 131 | Train Loss: 0.2097655 Vali Loss: 0.1156409 Test Loss: 0.1634953
Validation loss decreased (0.115709 --> 0.115641).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2171474
	speed: 0.3259s/iter; left time: 1248.7039s
Epoch: 21 cost time: 15.667003393173218
Epoch: 21, Steps: 131 | Train Loss: 0.2091300 Vali Loss: 0.1156997 Test Loss: 0.1634205
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1917338
	speed: 0.3089s/iter; left time: 1142.8336s
Epoch: 22 cost time: 14.285322427749634
Epoch: 22, Steps: 131 | Train Loss: 0.2090522 Vali Loss: 0.1158384 Test Loss: 0.1633618
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1880788
	speed: 0.3227s/iter; left time: 1151.6095s
Epoch: 23 cost time: 15.600817918777466
Epoch: 23, Steps: 131 | Train Loss: 0.2088257 Vali Loss: 0.1156836 Test Loss: 0.1634552
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1641099601984024, mae:0.2552565634250641, rse:0.32844576239585876, corr:[0.56115335 0.5681464  0.5685641  0.5663582  0.5648611  0.5648196
 0.565691   0.56648064 0.5664907  0.56583494 0.5650835  0.5646557
 0.5646585  0.56489307 0.5650566  0.5648074  0.5641514  0.56327397
 0.5624047  0.5616745  0.5611492  0.5607356  0.5603269  0.5598541
 0.5592875  0.5586741  0.55807585 0.5575259  0.55703527 0.5565852
 0.55609745 0.5556372  0.5551888  0.5546369  0.5539678  0.55328935
 0.55265373 0.55205643 0.5514193  0.5507221  0.549971   0.54917616
 0.5483841  0.54765886 0.5470537  0.54649603 0.5459225  0.54528713
 0.5444565  0.5434198  0.5423322  0.54142034 0.5407038  0.54007286
 0.5394042  0.53868127 0.53786767 0.53704965 0.53638613 0.53597265
 0.5357184  0.53555745 0.53536993 0.5350761  0.5347054  0.5344708
 0.53437436 0.534368   0.5343146  0.5340673  0.5335734  0.53290594
 0.5322701  0.5319087  0.53176415 0.5316084  0.53113514 0.5302239
 0.5289764  0.52784    0.52704865 0.5267114  0.5264162  0.525683
 0.5243618  0.52272034 0.5212232  0.52066165 0.5211486  0.5216995
 0.5213169  0.5197455  0.5172731  0.5157748  0.5177693  0.52023846]
