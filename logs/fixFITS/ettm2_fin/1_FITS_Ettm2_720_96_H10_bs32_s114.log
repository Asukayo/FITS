Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=90, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=90, out_features=102, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4112640.0
params:  9282.0
Trainable parameters:  9282
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2502550
	speed: 0.1214s/iter; left time: 3187.2906s
	iters: 200, epoch: 1 | loss: 0.1852078
	speed: 0.1325s/iter; left time: 3465.0814s
	iters: 300, epoch: 1 | loss: 0.2064074
	speed: 0.1331s/iter; left time: 3468.5131s
	iters: 400, epoch: 1 | loss: 0.4435576
	speed: 0.1398s/iter; left time: 3627.6515s
	iters: 500, epoch: 1 | loss: 0.1873431
	speed: 0.1327s/iter; left time: 3430.1114s
Epoch: 1 cost time: 69.32469391822815
Epoch: 1, Steps: 527 | Train Loss: 0.2739694 Vali Loss: 0.1235783 Test Loss: 0.1739947
Validation loss decreased (inf --> 0.123578).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2363426
	speed: 1.0032s/iter; left time: 25805.4323s
	iters: 200, epoch: 2 | loss: 0.2044297
	speed: 0.1637s/iter; left time: 4195.8295s
	iters: 300, epoch: 2 | loss: 0.1344661
	speed: 0.1654s/iter; left time: 4220.8323s
	iters: 400, epoch: 2 | loss: 0.2055653
	speed: 0.1558s/iter; left time: 3961.7558s
	iters: 500, epoch: 2 | loss: 0.1966720
	speed: 0.1542s/iter; left time: 3905.0216s
Epoch: 2 cost time: 84.83052659034729
Epoch: 2, Steps: 527 | Train Loss: 0.2238881 Vali Loss: 0.1185677 Test Loss: 0.1681908
Validation loss decreased (0.123578 --> 0.118568).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1441607
	speed: 0.8633s/iter; left time: 21752.8762s
	iters: 200, epoch: 3 | loss: 0.1777440
	speed: 0.1205s/iter; left time: 3023.1799s
	iters: 300, epoch: 3 | loss: 0.1197550
	speed: 0.1215s/iter; left time: 3037.4013s
	iters: 400, epoch: 3 | loss: 0.2211932
	speed: 0.1112s/iter; left time: 2768.4492s
	iters: 500, epoch: 3 | loss: 0.2508659
	speed: 0.1100s/iter; left time: 2727.0418s
Epoch: 3 cost time: 62.0379843711853
Epoch: 3, Steps: 527 | Train Loss: 0.2162308 Vali Loss: 0.1164861 Test Loss: 0.1656641
Validation loss decreased (0.118568 --> 0.116486).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1263102
	speed: 0.7855s/iter; left time: 19377.6167s
	iters: 200, epoch: 4 | loss: 0.2704405
	speed: 0.1123s/iter; left time: 2759.5636s
	iters: 300, epoch: 4 | loss: 0.1675080
	speed: 0.1162s/iter; left time: 2843.4610s
	iters: 400, epoch: 4 | loss: 0.1999176
	speed: 0.1155s/iter; left time: 2815.8791s
	iters: 500, epoch: 4 | loss: 0.1519363
	speed: 0.1109s/iter; left time: 2692.6629s
Epoch: 4 cost time: 60.974920988082886
Epoch: 4, Steps: 527 | Train Loss: 0.2129867 Vali Loss: 0.1168148 Test Loss: 0.1652842
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2169577
	speed: 0.8382s/iter; left time: 20235.7234s
	iters: 200, epoch: 5 | loss: 0.1765429
	speed: 0.1274s/iter; left time: 3063.7535s
	iters: 300, epoch: 5 | loss: 0.1537992
	speed: 0.1524s/iter; left time: 3649.6873s
	iters: 400, epoch: 5 | loss: 0.1732815
	speed: 0.1504s/iter; left time: 3585.5049s
	iters: 500, epoch: 5 | loss: 0.2476786
	speed: 0.1418s/iter; left time: 3367.5676s
Epoch: 5 cost time: 74.58823156356812
Epoch: 5, Steps: 527 | Train Loss: 0.2112415 Vali Loss: 0.1161992 Test Loss: 0.1642263
Validation loss decreased (0.116486 --> 0.116199).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1863843
	speed: 1.0100s/iter; left time: 23852.5064s
	iters: 200, epoch: 6 | loss: 0.1973799
	speed: 0.1216s/iter; left time: 2859.6055s
	iters: 300, epoch: 6 | loss: 0.3389107
	speed: 0.1293s/iter; left time: 3028.1902s
	iters: 400, epoch: 6 | loss: 0.1123644
	speed: 0.1238s/iter; left time: 2886.4489s
	iters: 500, epoch: 6 | loss: 0.1732288
	speed: 0.1215s/iter; left time: 2821.2662s
Epoch: 6 cost time: 65.62436652183533
Epoch: 6, Steps: 527 | Train Loss: 0.2104330 Vali Loss: 0.1162601 Test Loss: 0.1646847
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3833440
	speed: 0.8768s/iter; left time: 20245.5199s
	iters: 200, epoch: 7 | loss: 0.1775785
	speed: 0.1349s/iter; left time: 3101.4000s
	iters: 300, epoch: 7 | loss: 0.1713199
	speed: 0.1397s/iter; left time: 3198.0139s
	iters: 400, epoch: 7 | loss: 0.1418408
	speed: 0.1319s/iter; left time: 3006.5565s
	iters: 500, epoch: 7 | loss: 0.1523657
	speed: 0.1239s/iter; left time: 2810.9349s
Epoch: 7 cost time: 71.1963062286377
Epoch: 7, Steps: 527 | Train Loss: 0.2098075 Vali Loss: 0.1159305 Test Loss: 0.1641279
Validation loss decreased (0.116199 --> 0.115930).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2547271
	speed: 0.8932s/iter; left time: 20152.9122s
	iters: 200, epoch: 8 | loss: 0.1556203
	speed: 0.1183s/iter; left time: 2656.1344s
	iters: 300, epoch: 8 | loss: 0.1887299
	speed: 0.1218s/iter; left time: 2724.2910s
	iters: 400, epoch: 8 | loss: 0.2453174
	speed: 0.1158s/iter; left time: 2577.8256s
	iters: 500, epoch: 8 | loss: 0.1210822
	speed: 0.1193s/iter; left time: 2644.5513s
Epoch: 8 cost time: 64.17699861526489
Epoch: 8, Steps: 527 | Train Loss: 0.2093846 Vali Loss: 0.1153555 Test Loss: 0.1637836
Validation loss decreased (0.115930 --> 0.115356).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3041777
	speed: 0.9214s/iter; left time: 20304.1036s
	iters: 200, epoch: 9 | loss: 0.1369208
	speed: 0.1364s/iter; left time: 2991.3343s
	iters: 300, epoch: 9 | loss: 0.1777308
	speed: 0.1535s/iter; left time: 3351.8838s
	iters: 400, epoch: 9 | loss: 0.2141312
	speed: 0.1491s/iter; left time: 3240.9745s
	iters: 500, epoch: 9 | loss: 0.1604170
	speed: 0.1474s/iter; left time: 3189.9878s
Epoch: 9 cost time: 76.8848385810852
Epoch: 9, Steps: 527 | Train Loss: 0.2091246 Vali Loss: 0.1156674 Test Loss: 0.1632703
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2481521
	speed: 0.9836s/iter; left time: 21154.7852s
	iters: 200, epoch: 10 | loss: 0.2772978
	speed: 0.1178s/iter; left time: 2521.3170s
	iters: 300, epoch: 10 | loss: 0.2183373
	speed: 0.1287s/iter; left time: 2741.8453s
	iters: 400, epoch: 10 | loss: 0.1945222
	speed: 0.1232s/iter; left time: 2612.3849s
	iters: 500, epoch: 10 | loss: 0.1316846
	speed: 0.0767s/iter; left time: 1619.2298s
Epoch: 10 cost time: 61.82380127906799
Epoch: 10, Steps: 527 | Train Loss: 0.2089488 Vali Loss: 0.1155253 Test Loss: 0.1632471
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2869305
	speed: 0.7427s/iter; left time: 15583.3386s
	iters: 200, epoch: 11 | loss: 0.2825387
	speed: 0.1233s/iter; left time: 2573.9452s
	iters: 300, epoch: 11 | loss: 0.4069321
	speed: 0.1195s/iter; left time: 2483.7164s
	iters: 400, epoch: 11 | loss: 0.3318383
	speed: 0.1164s/iter; left time: 2406.3559s
	iters: 500, epoch: 11 | loss: 0.2095861
	speed: 0.1270s/iter; left time: 2614.1946s
Epoch: 11 cost time: 64.82537627220154
Epoch: 11, Steps: 527 | Train Loss: 0.2086506 Vali Loss: 0.1156996 Test Loss: 0.1640466
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1639334112405777, mae:0.2549374997615814, rse:0.32826900482177734, corr:[0.5625543  0.5679629  0.56742704 0.5651042  0.56373864 0.56381243
 0.5646911  0.56536466 0.5652659  0.5646301  0.5640148  0.56377804
 0.5639899  0.5643927  0.5645948  0.56421834 0.56338537 0.5624062
 0.56155586 0.56092465 0.56051236 0.56016237 0.5597509  0.5592266
 0.5585988  0.5579794  0.55747867 0.55711496 0.5567946  0.55637795
 0.55574346 0.5550175  0.5542817  0.55352    0.5527943  0.5522305
 0.55181587 0.55143166 0.55091745 0.55023557 0.5494417  0.5486124
 0.5478442  0.54720426 0.54670405 0.5462156  0.54564    0.54495794
 0.5440851  0.5430601  0.54205173 0.54125994 0.5406518  0.5400657
 0.539367   0.53859776 0.53780967 0.53712475 0.5366558  0.53642255
 0.5362832  0.5361606  0.5359401  0.5355624  0.5350895  0.5347426
 0.5345123  0.5343493  0.534136   0.53372395 0.5330492  0.5322184
 0.5314942  0.53113717 0.5310376  0.530909   0.53043795 0.5295237
 0.5283426  0.5274558  0.5271364  0.5273321  0.52738917 0.52673584
 0.5252468  0.5231879  0.52109855 0.52013236 0.5208188  0.5220691
 0.5224176  0.5213396  0.51895905 0.5169111  0.51844645 0.522019  ]
