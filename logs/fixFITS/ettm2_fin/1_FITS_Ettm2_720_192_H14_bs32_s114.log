Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=122, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_192_FITS_ETTm2_ftM_sl720_ll48_pl192_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33649
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=122, out_features=154, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  8417024.0
params:  18942.0
Trainable parameters:  18942
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4896506
	speed: 0.1582s/iter; left time: 4137.1604s
	iters: 200, epoch: 1 | loss: 0.4842208
	speed: 0.1536s/iter; left time: 4001.3252s
	iters: 300, epoch: 1 | loss: 0.5567261
	speed: 0.1509s/iter; left time: 3915.9034s
	iters: 400, epoch: 1 | loss: 0.2513408
	speed: 0.1512s/iter; left time: 3907.6690s
	iters: 500, epoch: 1 | loss: 0.2699458
	speed: 0.1542s/iter; left time: 3971.9638s
Epoch: 1 cost time: 80.8051266670227
Epoch: 1, Steps: 525 | Train Loss: 0.3573735 Vali Loss: 0.1631196 Test Loss: 0.2291611
Validation loss decreased (inf --> 0.163120).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2500196
	speed: 1.0631s/iter; left time: 27243.5950s
	iters: 200, epoch: 2 | loss: 0.2019598
	speed: 0.1491s/iter; left time: 3806.7076s
	iters: 300, epoch: 2 | loss: 0.6238998
	speed: 0.1538s/iter; left time: 3911.6167s
	iters: 400, epoch: 2 | loss: 0.2391243
	speed: 0.1451s/iter; left time: 3675.3797s
	iters: 500, epoch: 2 | loss: 0.4560279
	speed: 0.1521s/iter; left time: 3838.0661s
Epoch: 2 cost time: 80.12451791763306
Epoch: 2, Steps: 525 | Train Loss: 0.3083051 Vali Loss: 0.1567567 Test Loss: 0.2230098
Validation loss decreased (0.163120 --> 0.156757).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2766106
	speed: 0.9994s/iter; left time: 25086.9078s
	iters: 200, epoch: 3 | loss: 0.2181861
	speed: 0.1512s/iter; left time: 3780.5766s
	iters: 300, epoch: 3 | loss: 0.1976384
	speed: 0.1459s/iter; left time: 3632.6133s
	iters: 400, epoch: 3 | loss: 0.2423172
	speed: 0.1472s/iter; left time: 3649.7835s
	iters: 500, epoch: 3 | loss: 0.2517166
	speed: 0.1494s/iter; left time: 3689.4600s
Epoch: 3 cost time: 79.44688439369202
Epoch: 3, Steps: 525 | Train Loss: 0.2998053 Vali Loss: 0.1547481 Test Loss: 0.2207432
Validation loss decreased (0.156757 --> 0.154748).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2356736
	speed: 1.0557s/iter; left time: 25945.3404s
	iters: 200, epoch: 4 | loss: 0.2129588
	speed: 0.1504s/iter; left time: 3682.2797s
	iters: 300, epoch: 4 | loss: 0.2306518
	speed: 0.1485s/iter; left time: 3618.7563s
	iters: 400, epoch: 4 | loss: 0.2011053
	speed: 0.1461s/iter; left time: 3546.9398s
	iters: 500, epoch: 4 | loss: 0.4513989
	speed: 0.1384s/iter; left time: 3345.7212s
Epoch: 4 cost time: 78.51817846298218
Epoch: 4, Steps: 525 | Train Loss: 0.2959481 Vali Loss: 0.1531720 Test Loss: 0.2188846
Validation loss decreased (0.154748 --> 0.153172).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1631522
	speed: 1.0578s/iter; left time: 25441.7744s
	iters: 200, epoch: 5 | loss: 0.2108569
	speed: 0.1436s/iter; left time: 3440.5143s
	iters: 300, epoch: 5 | loss: 0.3025944
	speed: 0.1186s/iter; left time: 2829.3106s
	iters: 400, epoch: 5 | loss: 0.2749823
	speed: 0.1469s/iter; left time: 3489.8918s
	iters: 500, epoch: 5 | loss: 0.5279195
	speed: 0.1449s/iter; left time: 3428.0847s
Epoch: 5 cost time: 74.98566913604736
Epoch: 5, Steps: 525 | Train Loss: 0.2937471 Vali Loss: 0.1530109 Test Loss: 0.2186077
Validation loss decreased (0.153172 --> 0.153011).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.4940284
	speed: 1.0142s/iter; left time: 23859.0906s
	iters: 200, epoch: 6 | loss: 0.3181799
	speed: 0.1372s/iter; left time: 3213.0696s
	iters: 300, epoch: 6 | loss: 0.3794917
	speed: 0.1423s/iter; left time: 3320.1348s
	iters: 400, epoch: 6 | loss: 0.2711629
	speed: 0.1473s/iter; left time: 3420.8763s
	iters: 500, epoch: 6 | loss: 0.3040231
	speed: 0.1493s/iter; left time: 3452.9123s
Epoch: 6 cost time: 75.54956340789795
Epoch: 6, Steps: 525 | Train Loss: 0.2924305 Vali Loss: 0.1523745 Test Loss: 0.2180184
Validation loss decreased (0.153011 --> 0.152375).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1905018
	speed: 0.9681s/iter; left time: 22266.2580s
	iters: 200, epoch: 7 | loss: 0.3112936
	speed: 0.1374s/iter; left time: 3146.1851s
	iters: 300, epoch: 7 | loss: 0.2942147
	speed: 0.1382s/iter; left time: 3151.3718s
	iters: 400, epoch: 7 | loss: 0.3428495
	speed: 0.1398s/iter; left time: 3172.4865s
	iters: 500, epoch: 7 | loss: 0.4098594
	speed: 0.1485s/iter; left time: 3355.3964s
Epoch: 7 cost time: 75.02748847007751
Epoch: 7, Steps: 525 | Train Loss: 0.2916865 Vali Loss: 0.1523540 Test Loss: 0.2177500
Validation loss decreased (0.152375 --> 0.152354).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.4435360
	speed: 0.9708s/iter; left time: 21819.4535s
	iters: 200, epoch: 8 | loss: 0.2768150
	speed: 0.1418s/iter; left time: 3172.9101s
	iters: 300, epoch: 8 | loss: 0.4761347
	speed: 0.1342s/iter; left time: 2990.5077s
	iters: 400, epoch: 8 | loss: 0.2732762
	speed: 0.1335s/iter; left time: 2960.0740s
	iters: 500, epoch: 8 | loss: 0.5372567
	speed: 0.1343s/iter; left time: 2964.2127s
Epoch: 8 cost time: 72.37336301803589
Epoch: 8, Steps: 525 | Train Loss: 0.2911814 Vali Loss: 0.1520483 Test Loss: 0.2173748
Validation loss decreased (0.152354 --> 0.152048).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2576357
	speed: 0.9503s/iter; left time: 20859.4446s
	iters: 200, epoch: 9 | loss: 0.2198917
	speed: 0.1413s/iter; left time: 3086.8563s
	iters: 300, epoch: 9 | loss: 0.2724822
	speed: 0.1423s/iter; left time: 3094.5349s
	iters: 400, epoch: 9 | loss: 0.4440764
	speed: 0.1422s/iter; left time: 3078.0555s
	iters: 500, epoch: 9 | loss: 0.3696831
	speed: 0.1437s/iter; left time: 3096.7008s
Epoch: 9 cost time: 74.46950387954712
Epoch: 9, Steps: 525 | Train Loss: 0.2907209 Vali Loss: 0.1519900 Test Loss: 0.2174266
Validation loss decreased (0.152048 --> 0.151990).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2149534
	speed: 0.9567s/iter; left time: 20499.1486s
	iters: 200, epoch: 10 | loss: 0.2526007
	speed: 0.1314s/iter; left time: 2801.7475s
	iters: 300, epoch: 10 | loss: 0.3795893
	speed: 0.1234s/iter; left time: 2618.9165s
	iters: 400, epoch: 10 | loss: 0.6123868
	speed: 0.1380s/iter; left time: 2914.8110s
	iters: 500, epoch: 10 | loss: 0.2475387
	speed: 0.1336s/iter; left time: 2808.7013s
Epoch: 10 cost time: 69.86962890625
Epoch: 10, Steps: 525 | Train Loss: 0.2900367 Vali Loss: 0.1518411 Test Loss: 0.2169211
Validation loss decreased (0.151990 --> 0.151841).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2377328
	speed: 0.8951s/iter; left time: 18709.4623s
	iters: 200, epoch: 11 | loss: 0.2902741
	speed: 0.1343s/iter; left time: 2794.1190s
	iters: 300, epoch: 11 | loss: 0.3229712
	speed: 0.1375s/iter; left time: 2847.2135s
	iters: 400, epoch: 11 | loss: 0.4555216
	speed: 0.1332s/iter; left time: 2744.8592s
	iters: 500, epoch: 11 | loss: 0.2340262
	speed: 0.1084s/iter; left time: 2221.4157s
Epoch: 11 cost time: 69.75896906852722
Epoch: 11, Steps: 525 | Train Loss: 0.2900525 Vali Loss: 0.1519774 Test Loss: 0.2170669
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2191327
	speed: 0.9593s/iter; left time: 19546.4893s
	iters: 200, epoch: 12 | loss: 0.1992946
	speed: 0.1380s/iter; left time: 2799.0575s
	iters: 300, epoch: 12 | loss: 0.2160320
	speed: 0.1431s/iter; left time: 2886.2312s
	iters: 400, epoch: 12 | loss: 0.2704237
	speed: 0.1328s/iter; left time: 2666.6915s
	iters: 500, epoch: 12 | loss: 0.2282280
	speed: 0.1352s/iter; left time: 2701.7231s
Epoch: 12 cost time: 72.70611500740051
Epoch: 12, Steps: 525 | Train Loss: 0.2894475 Vali Loss: 0.1517561 Test Loss: 0.2168233
Validation loss decreased (0.151841 --> 0.151756).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.4929357
	speed: 0.9576s/iter; left time: 19008.9896s
	iters: 200, epoch: 13 | loss: 0.4370376
	speed: 0.1352s/iter; left time: 2669.9226s
	iters: 300, epoch: 13 | loss: 0.2411831
	speed: 0.1385s/iter; left time: 2722.4936s
	iters: 400, epoch: 13 | loss: 0.2892335
	speed: 0.1390s/iter; left time: 2718.5092s
	iters: 500, epoch: 13 | loss: 0.3803216
	speed: 0.1348s/iter; left time: 2621.2579s
Epoch: 13 cost time: 72.85524845123291
Epoch: 13, Steps: 525 | Train Loss: 0.2894869 Vali Loss: 0.1517547 Test Loss: 0.2164881
Validation loss decreased (0.151756 --> 0.151755).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2170295
	speed: 0.9887s/iter; left time: 19107.3821s
	iters: 200, epoch: 14 | loss: 0.2273917
	speed: 0.1489s/iter; left time: 2862.7409s
	iters: 300, epoch: 14 | loss: 0.2665983
	speed: 0.1427s/iter; left time: 2729.2679s
	iters: 400, epoch: 14 | loss: 0.2769830
	speed: 0.1452s/iter; left time: 2762.5034s
	iters: 500, epoch: 14 | loss: 0.2966180
	speed: 0.1499s/iter; left time: 2837.9248s
Epoch: 14 cost time: 78.60229563713074
Epoch: 14, Steps: 525 | Train Loss: 0.2889263 Vali Loss: 0.1518305 Test Loss: 0.2169073
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.4031337
	speed: 0.9847s/iter; left time: 18513.5824s
	iters: 200, epoch: 15 | loss: 0.2258898
	speed: 0.1031s/iter; left time: 1928.3242s
	iters: 300, epoch: 15 | loss: 0.2123571
	speed: 0.1187s/iter; left time: 2207.6919s
	iters: 400, epoch: 15 | loss: 0.3153916
	speed: 0.1148s/iter; left time: 2123.0105s
	iters: 500, epoch: 15 | loss: 0.4443722
	speed: 0.1179s/iter; left time: 2168.5747s
Epoch: 15 cost time: 60.558995962142944
Epoch: 15, Steps: 525 | Train Loss: 0.2891837 Vali Loss: 0.1515798 Test Loss: 0.2162642
Validation loss decreased (0.151755 --> 0.151580).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1954910
	speed: 0.8255s/iter; left time: 15086.4908s
	iters: 200, epoch: 16 | loss: 0.2630951
	speed: 0.1170s/iter; left time: 2125.7576s
	iters: 300, epoch: 16 | loss: 0.2996315
	speed: 0.1139s/iter; left time: 2058.1051s
	iters: 400, epoch: 16 | loss: 0.2105203
	speed: 0.1129s/iter; left time: 2029.5544s
	iters: 500, epoch: 16 | loss: 0.3288436
	speed: 0.1150s/iter; left time: 2056.0399s
Epoch: 16 cost time: 61.91391038894653
Epoch: 16, Steps: 525 | Train Loss: 0.2889462 Vali Loss: 0.1515136 Test Loss: 0.2165597
Validation loss decreased (0.151580 --> 0.151514).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3099814
	speed: 0.8212s/iter; left time: 14577.7978s
	iters: 200, epoch: 17 | loss: 0.2346644
	speed: 0.1179s/iter; left time: 2080.7254s
	iters: 300, epoch: 17 | loss: 0.2157698
	speed: 0.1270s/iter; left time: 2228.7312s
	iters: 400, epoch: 17 | loss: 0.3588375
	speed: 0.1169s/iter; left time: 2040.8365s
	iters: 500, epoch: 17 | loss: 0.2329910
	speed: 0.1190s/iter; left time: 2065.1000s
Epoch: 17 cost time: 63.871771812438965
Epoch: 17, Steps: 525 | Train Loss: 0.2890133 Vali Loss: 0.1515913 Test Loss: 0.2164980
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2693886
	speed: 0.9092s/iter; left time: 15661.4738s
	iters: 200, epoch: 18 | loss: 0.3011077
	speed: 0.1425s/iter; left time: 2440.6577s
	iters: 300, epoch: 18 | loss: 0.2346197
	speed: 0.1360s/iter; left time: 2316.1479s
	iters: 400, epoch: 18 | loss: 0.4387343
	speed: 0.1339s/iter; left time: 2266.8905s
	iters: 500, epoch: 18 | loss: 0.4168298
	speed: 0.1360s/iter; left time: 2287.6670s
Epoch: 18 cost time: 73.83875560760498
Epoch: 18, Steps: 525 | Train Loss: 0.2887669 Vali Loss: 0.1515322 Test Loss: 0.2165009
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3032201
	speed: 0.9766s/iter; left time: 16310.4759s
	iters: 200, epoch: 19 | loss: 0.3093337
	speed: 0.1398s/iter; left time: 2321.1774s
	iters: 300, epoch: 19 | loss: 0.4895144
	speed: 0.1407s/iter; left time: 2321.2469s
	iters: 400, epoch: 19 | loss: 0.3347738
	speed: 0.1409s/iter; left time: 2310.3802s
	iters: 500, epoch: 19 | loss: 0.4090759
	speed: 0.1345s/iter; left time: 2192.5090s
Epoch: 19 cost time: 73.6920702457428
Epoch: 19, Steps: 525 | Train Loss: 0.2888370 Vali Loss: 0.1516780 Test Loss: 0.2165893
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_192_FITS_ETTm2_ftM_sl720_ll48_pl192_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.21716326475143433, mae:0.29164373874664307, rse:0.3772144317626953, corr:[0.5649603  0.5645937  0.5596337  0.558486   0.5601417  0.5609865
 0.5598391  0.55846256 0.5583481  0.55935067 0.56007046 0.55966836
 0.5587963  0.55836666 0.5587281  0.5592435  0.5591497  0.5583525
 0.5573544  0.5566362  0.55625546 0.55580646 0.5550934  0.5543182
 0.5537789  0.5536102  0.55354464 0.5531277  0.55229104 0.55141926
 0.5508503  0.5507168  0.55065614 0.5501951  0.5493197  0.54838467
 0.5476754  0.5472904  0.5470226  0.54658383 0.54589933 0.5451119
 0.54444915 0.54394346 0.54343224 0.5427152  0.5418046  0.5408905
 0.5401157  0.5395224  0.5389499  0.5382505  0.5373492  0.5364033
 0.5356945  0.53536713 0.5351501  0.53475946 0.5341984  0.5337085
 0.53351873 0.5336569  0.5337838  0.5336252  0.5331837  0.53274244
 0.5324234  0.53223956 0.5320105  0.53160447 0.53112215 0.53082925
 0.5308228  0.5309136  0.5307026  0.5300704  0.52920145 0.5284277
 0.5279199  0.52760446 0.52715844 0.5265227  0.5258447  0.5253124
 0.5248804  0.5243856  0.52360713 0.52273846 0.52218777 0.52216357
 0.5223973  0.5224169  0.52187896 0.5209389  0.5199582  0.5191063
 0.51813745 0.51675946 0.5148376  0.51272315 0.51115674 0.5105381
 0.51038873 0.50978243 0.5083077  0.5063271  0.5047276  0.50410086
 0.50391275 0.5033457  0.5020246  0.5001975  0.49878094 0.4983184
 0.49833015 0.49798834 0.49697337 0.4956017  0.4946091  0.49415427
 0.49391356 0.4931887  0.49197108 0.4907801  0.4902219  0.49023852
 0.4901411  0.4892809  0.48765093 0.48601308 0.48528707 0.48538932
 0.48543498 0.48470423 0.48328742 0.48197636 0.481511   0.48180786
 0.48184508 0.48090732 0.4790714  0.47738653 0.47688627 0.47728497
 0.47749376 0.47666052 0.4752736  0.474268   0.47429416 0.47476563
 0.47481227 0.47404337 0.4726891  0.47143072 0.47070774 0.47029784
 0.46961308 0.46865264 0.46800205 0.46846682 0.46943888 0.46994406
 0.46932897 0.46789676 0.46664897 0.4664855  0.4669648  0.46710423
 0.46652216 0.46575907 0.46540287 0.46549284 0.46518993 0.46388876
 0.4621483  0.46138376 0.4622796  0.46356332 0.46337715 0.461496
 0.45910555 0.45839727 0.459694   0.46061817 0.4595188  0.45713443
 0.4565389  0.45923334 0.46148837 0.45994577 0.45506608 0.45509848]
