Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=74, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_192_FITS_ETTm2_ftM_sl720_ll48_pl192_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33649
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=74, out_features=93, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  3083136.0
params:  6975.0
Trainable parameters:  6975
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.5178708
	speed: 0.1451s/iter; left time: 3793.3780s
	iters: 200, epoch: 1 | loss: 0.2595339
	speed: 0.1475s/iter; left time: 3843.6555s
	iters: 300, epoch: 1 | loss: 0.2554315
	speed: 0.1495s/iter; left time: 3879.4295s
	iters: 400, epoch: 1 | loss: 0.1818136
	speed: 0.1486s/iter; left time: 3842.5032s
	iters: 500, epoch: 1 | loss: 0.5563877
	speed: 0.1416s/iter; left time: 3647.4799s
Epoch: 1 cost time: 77.10339832305908
Epoch: 1, Steps: 525 | Train Loss: 0.3605300 Vali Loss: 0.1646971 Test Loss: 0.2300963
Validation loss decreased (inf --> 0.164697).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.6058759
	speed: 1.0132s/iter; left time: 25963.0521s
	iters: 200, epoch: 2 | loss: 0.2757639
	speed: 0.1395s/iter; left time: 3560.1773s
	iters: 300, epoch: 2 | loss: 0.2301184
	speed: 0.1410s/iter; left time: 3583.8161s
	iters: 400, epoch: 2 | loss: 0.1988413
	speed: 0.1517s/iter; left time: 3841.8439s
	iters: 500, epoch: 2 | loss: 0.2032088
	speed: 0.1535s/iter; left time: 3873.4300s
Epoch: 2 cost time: 78.01614880561829
Epoch: 2, Steps: 525 | Train Loss: 0.3105117 Vali Loss: 0.1579976 Test Loss: 0.2236670
Validation loss decreased (0.164697 --> 0.157998).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3246990
	speed: 1.0047s/iter; left time: 25218.0250s
	iters: 200, epoch: 3 | loss: 0.2450125
	speed: 0.1348s/iter; left time: 3370.7939s
	iters: 300, epoch: 3 | loss: 0.2582763
	speed: 0.1306s/iter; left time: 3252.7605s
	iters: 400, epoch: 3 | loss: 0.3884465
	speed: 0.1412s/iter; left time: 3502.3860s
	iters: 500, epoch: 3 | loss: 0.4988076
	speed: 0.1355s/iter; left time: 3347.4079s
Epoch: 3 cost time: 73.27769327163696
Epoch: 3, Steps: 525 | Train Loss: 0.3018263 Vali Loss: 0.1561012 Test Loss: 0.2211267
Validation loss decreased (0.157998 --> 0.156101).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.4318011
	speed: 1.0528s/iter; left time: 25874.1229s
	iters: 200, epoch: 4 | loss: 0.3033818
	speed: 0.1560s/iter; left time: 3818.7044s
	iters: 300, epoch: 4 | loss: 0.3293616
	speed: 0.1460s/iter; left time: 3558.3373s
	iters: 400, epoch: 4 | loss: 0.2825036
	speed: 0.1304s/iter; left time: 3164.9941s
	iters: 500, epoch: 4 | loss: 0.3136869
	speed: 0.1306s/iter; left time: 3157.6938s
Epoch: 4 cost time: 75.79435729980469
Epoch: 4, Steps: 525 | Train Loss: 0.2983236 Vali Loss: 0.1551446 Test Loss: 0.2200097
Validation loss decreased (0.156101 --> 0.155145).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3168940
	speed: 0.9814s/iter; left time: 23602.8774s
	iters: 200, epoch: 5 | loss: 0.2347153
	speed: 0.1353s/iter; left time: 3241.7482s
	iters: 300, epoch: 5 | loss: 0.3483325
	speed: 0.1373s/iter; left time: 3275.2499s
	iters: 400, epoch: 5 | loss: 0.1913691
	speed: 0.1341s/iter; left time: 3184.3008s
	iters: 500, epoch: 5 | loss: 0.1530301
	speed: 0.1363s/iter; left time: 3222.6073s
Epoch: 5 cost time: 72.86112475395203
Epoch: 5, Steps: 525 | Train Loss: 0.2959567 Vali Loss: 0.1544689 Test Loss: 0.2192291
Validation loss decreased (0.155145 --> 0.154469).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2959702
	speed: 0.8709s/iter; left time: 20488.3611s
	iters: 200, epoch: 6 | loss: 0.3042915
	speed: 0.1328s/iter; left time: 3110.3674s
	iters: 300, epoch: 6 | loss: 0.1824009
	speed: 0.1338s/iter; left time: 3121.6778s
	iters: 400, epoch: 6 | loss: 0.3368905
	speed: 0.1388s/iter; left time: 3223.4006s
	iters: 500, epoch: 6 | loss: 0.4803582
	speed: 0.1355s/iter; left time: 3134.4159s
Epoch: 6 cost time: 70.60069966316223
Epoch: 6, Steps: 525 | Train Loss: 0.2948253 Vali Loss: 0.1541291 Test Loss: 0.2187641
Validation loss decreased (0.154469 --> 0.154129).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3245383
	speed: 0.9527s/iter; left time: 21911.9254s
	iters: 200, epoch: 7 | loss: 0.3878455
	speed: 0.1337s/iter; left time: 3060.7979s
	iters: 300, epoch: 7 | loss: 0.3106287
	speed: 0.1311s/iter; left time: 2989.4977s
	iters: 400, epoch: 7 | loss: 0.1979663
	speed: 0.1365s/iter; left time: 3099.4821s
	iters: 500, epoch: 7 | loss: 0.1855462
	speed: 0.1363s/iter; left time: 3080.2145s
Epoch: 7 cost time: 71.89408421516418
Epoch: 7, Steps: 525 | Train Loss: 0.2940215 Vali Loss: 0.1540800 Test Loss: 0.2186787
Validation loss decreased (0.154129 --> 0.154080).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3034608
	speed: 0.9607s/iter; left time: 21592.0651s
	iters: 200, epoch: 8 | loss: 0.2527410
	speed: 0.1189s/iter; left time: 2660.3011s
	iters: 300, epoch: 8 | loss: 0.2455289
	speed: 0.1182s/iter; left time: 2632.0810s
	iters: 400, epoch: 8 | loss: 0.2430269
	speed: 0.1221s/iter; left time: 2707.8207s
	iters: 500, epoch: 8 | loss: 0.2160625
	speed: 0.1262s/iter; left time: 2786.4098s
Epoch: 8 cost time: 64.5100109577179
Epoch: 8, Steps: 525 | Train Loss: 0.2932673 Vali Loss: 0.1536130 Test Loss: 0.2184446
Validation loss decreased (0.154080 --> 0.153613).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2442548
	speed: 0.9182s/iter; left time: 20156.4997s
	iters: 200, epoch: 9 | loss: 0.2308938
	speed: 0.1417s/iter; left time: 3096.7737s
	iters: 300, epoch: 9 | loss: 0.5352240
	speed: 0.1132s/iter; left time: 2462.9195s
	iters: 400, epoch: 9 | loss: 0.4732210
	speed: 0.1239s/iter; left time: 2681.7957s
	iters: 500, epoch: 9 | loss: 0.2536424
	speed: 0.0957s/iter; left time: 2063.3876s
Epoch: 9 cost time: 64.66110420227051
Epoch: 9, Steps: 525 | Train Loss: 0.2927916 Vali Loss: 0.1537290 Test Loss: 0.2183473
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2895882
	speed: 0.6651s/iter; left time: 14250.8320s
	iters: 200, epoch: 10 | loss: 0.2626940
	speed: 0.1024s/iter; left time: 2183.0113s
	iters: 300, epoch: 10 | loss: 0.2656784
	speed: 0.1096s/iter; left time: 2326.2253s
	iters: 400, epoch: 10 | loss: 0.2270545
	speed: 0.1002s/iter; left time: 2115.9407s
	iters: 500, epoch: 10 | loss: 0.4010100
	speed: 0.0994s/iter; left time: 2088.9640s
Epoch: 10 cost time: 54.41331958770752
Epoch: 10, Steps: 525 | Train Loss: 0.2925445 Vali Loss: 0.1533992 Test Loss: 0.2182092
Validation loss decreased (0.153613 --> 0.153399).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2603999
	speed: 0.8154s/iter; left time: 17042.5252s
	iters: 200, epoch: 11 | loss: 0.2258921
	speed: 0.1239s/iter; left time: 2577.4665s
	iters: 300, epoch: 11 | loss: 0.2940947
	speed: 0.1455s/iter; left time: 3011.3275s
	iters: 400, epoch: 11 | loss: 0.3354352
	speed: 0.1460s/iter; left time: 3006.8525s
	iters: 500, epoch: 11 | loss: 0.1653379
	speed: 0.1631s/iter; left time: 3342.8645s
Epoch: 11 cost time: 75.27422451972961
Epoch: 11, Steps: 525 | Train Loss: 0.2918802 Vali Loss: 0.1533353 Test Loss: 0.2179518
Validation loss decreased (0.153399 --> 0.153335).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1947158
	speed: 1.0700s/iter; left time: 21802.3915s
	iters: 200, epoch: 12 | loss: 0.2588988
	speed: 0.1291s/iter; left time: 2617.9535s
	iters: 300, epoch: 12 | loss: 0.2057036
	speed: 0.1218s/iter; left time: 2456.6519s
	iters: 400, epoch: 12 | loss: 0.2565450
	speed: 0.1242s/iter; left time: 2494.3050s
	iters: 500, epoch: 12 | loss: 0.1781857
	speed: 0.1227s/iter; left time: 2451.0375s
Epoch: 12 cost time: 67.65111947059631
Epoch: 12, Steps: 525 | Train Loss: 0.2921340 Vali Loss: 0.1536317 Test Loss: 0.2181596
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2168997
	speed: 0.8784s/iter; left time: 17436.8932s
	iters: 200, epoch: 13 | loss: 0.3179614
	speed: 0.1271s/iter; left time: 2510.1433s
	iters: 300, epoch: 13 | loss: 0.3800630
	speed: 0.1261s/iter; left time: 2478.3187s
	iters: 400, epoch: 13 | loss: 0.5765988
	speed: 0.1292s/iter; left time: 2526.5651s
	iters: 500, epoch: 13 | loss: 0.1299472
	speed: 0.1335s/iter; left time: 2596.4020s
Epoch: 13 cost time: 68.74026346206665
Epoch: 13, Steps: 525 | Train Loss: 0.2919734 Vali Loss: 0.1533022 Test Loss: 0.2177891
Validation loss decreased (0.153335 --> 0.153302).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2925200
	speed: 0.8535s/iter; left time: 16495.4761s
	iters: 200, epoch: 14 | loss: 0.2942014
	speed: 0.1207s/iter; left time: 2320.8972s
	iters: 300, epoch: 14 | loss: 0.2626095
	speed: 0.1329s/iter; left time: 2541.7728s
	iters: 400, epoch: 14 | loss: 0.2009019
	speed: 0.1307s/iter; left time: 2486.7220s
	iters: 500, epoch: 14 | loss: 0.3716986
	speed: 0.1216s/iter; left time: 2301.6160s
Epoch: 14 cost time: 66.45085191726685
Epoch: 14, Steps: 525 | Train Loss: 0.2914842 Vali Loss: 0.1534072 Test Loss: 0.2179725
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2415712
	speed: 0.8486s/iter; left time: 15955.3011s
	iters: 200, epoch: 15 | loss: 0.4390427
	speed: 0.1287s/iter; left time: 2406.4006s
	iters: 300, epoch: 15 | loss: 0.2421101
	speed: 0.1247s/iter; left time: 2319.2903s
	iters: 400, epoch: 15 | loss: 0.2661477
	speed: 0.1345s/iter; left time: 2487.5704s
	iters: 500, epoch: 15 | loss: 0.2615054
	speed: 0.1344s/iter; left time: 2472.9211s
Epoch: 15 cost time: 69.22887015342712
Epoch: 15, Steps: 525 | Train Loss: 0.2914718 Vali Loss: 0.1532967 Test Loss: 0.2177246
Validation loss decreased (0.153302 --> 0.153297).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2122279
	speed: 0.9656s/iter; left time: 17647.3893s
	iters: 200, epoch: 16 | loss: 0.2549468
	speed: 0.1277s/iter; left time: 2321.5098s
	iters: 300, epoch: 16 | loss: 0.2440950
	speed: 0.1262s/iter; left time: 2281.4908s
	iters: 400, epoch: 16 | loss: 0.2144175
	speed: 0.1158s/iter; left time: 2082.3252s
	iters: 500, epoch: 16 | loss: 0.1965263
	speed: 0.1176s/iter; left time: 2101.7952s
Epoch: 16 cost time: 66.68354725837708
Epoch: 16, Steps: 525 | Train Loss: 0.2912940 Vali Loss: 0.1531049 Test Loss: 0.2175597
Validation loss decreased (0.153297 --> 0.153105).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2904293
	speed: 0.8726s/iter; left time: 15488.6979s
	iters: 200, epoch: 17 | loss: 0.2109534
	speed: 0.1403s/iter; left time: 2475.9263s
	iters: 300, epoch: 17 | loss: 0.2119559
	speed: 0.1371s/iter; left time: 2406.5998s
	iters: 400, epoch: 17 | loss: 0.1825965
	speed: 0.1435s/iter; left time: 2504.0124s
	iters: 500, epoch: 17 | loss: 0.4200460
	speed: 0.1350s/iter; left time: 2343.1664s
Epoch: 17 cost time: 72.70684361457825
Epoch: 17, Steps: 525 | Train Loss: 0.2910880 Vali Loss: 0.1530181 Test Loss: 0.2173678
Validation loss decreased (0.153105 --> 0.153018).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3336802
	speed: 0.8869s/iter; left time: 15277.1402s
	iters: 200, epoch: 18 | loss: 0.3222296
	speed: 0.1377s/iter; left time: 2358.8327s
	iters: 300, epoch: 18 | loss: 0.4966838
	speed: 0.1331s/iter; left time: 2266.0991s
	iters: 400, epoch: 18 | loss: 0.5850409
	speed: 0.1351s/iter; left time: 2286.1019s
	iters: 500, epoch: 18 | loss: 0.2084718
	speed: 0.1263s/iter; left time: 2125.4072s
Epoch: 18 cost time: 70.45489978790283
Epoch: 18, Steps: 525 | Train Loss: 0.2913422 Vali Loss: 0.1530572 Test Loss: 0.2175608
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1807155
	speed: 0.8862s/iter; left time: 14800.9901s
	iters: 200, epoch: 19 | loss: 0.1905577
	speed: 0.1286s/iter; left time: 2135.6638s
	iters: 300, epoch: 19 | loss: 0.2644871
	speed: 0.1332s/iter; left time: 2197.2077s
	iters: 400, epoch: 19 | loss: 0.2442334
	speed: 0.1372s/iter; left time: 2250.9466s
	iters: 500, epoch: 19 | loss: 0.3806246
	speed: 0.1352s/iter; left time: 2203.9302s
Epoch: 19 cost time: 70.634840965271
Epoch: 19, Steps: 525 | Train Loss: 0.2909737 Vali Loss: 0.1530144 Test Loss: 0.2174759
Validation loss decreased (0.153018 --> 0.153014).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2125379
	speed: 0.8427s/iter; left time: 13632.1639s
	iters: 200, epoch: 20 | loss: 0.2786326
	speed: 0.1183s/iter; left time: 1901.6243s
	iters: 300, epoch: 20 | loss: 0.3042863
	speed: 0.1239s/iter; left time: 1980.0482s
	iters: 400, epoch: 20 | loss: 0.2868966
	speed: 0.1301s/iter; left time: 2065.2958s
	iters: 500, epoch: 20 | loss: 0.3872611
	speed: 0.1315s/iter; left time: 2074.8378s
Epoch: 20 cost time: 66.50775289535522
Epoch: 20, Steps: 525 | Train Loss: 0.2906616 Vali Loss: 0.1533090 Test Loss: 0.2177864
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2554882
	speed: 0.9601s/iter; left time: 15026.9237s
	iters: 200, epoch: 21 | loss: 0.3600328
	speed: 0.1479s/iter; left time: 2299.2226s
	iters: 300, epoch: 21 | loss: 0.3328658
	speed: 0.1394s/iter; left time: 2154.4637s
	iters: 400, epoch: 21 | loss: 0.3407629
	speed: 0.1327s/iter; left time: 2036.5368s
	iters: 500, epoch: 21 | loss: 0.4837756
	speed: 0.1336s/iter; left time: 2037.6493s
Epoch: 21 cost time: 73.24551510810852
Epoch: 21, Steps: 525 | Train Loss: 0.2909894 Vali Loss: 0.1533281 Test Loss: 0.2179494
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1715797
	speed: 0.8217s/iter; left time: 12428.3527s
	iters: 200, epoch: 22 | loss: 0.2643202
	speed: 0.1240s/iter; left time: 1862.9495s
	iters: 300, epoch: 22 | loss: 0.1914464
	speed: 0.1206s/iter; left time: 1800.6451s
	iters: 400, epoch: 22 | loss: 0.2866847
	speed: 0.1148s/iter; left time: 1702.4880s
	iters: 500, epoch: 22 | loss: 0.3390263
	speed: 0.1149s/iter; left time: 1692.7038s
Epoch: 22 cost time: 63.690186977386475
Epoch: 22, Steps: 525 | Train Loss: 0.2907150 Vali Loss: 0.1531063 Test Loss: 0.2173753
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_192_FITS_ETTm2_ftM_sl720_ll48_pl192_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.21814526617527008, mae:0.29233551025390625, rse:0.3780663311481476, corr:[0.5597969  0.5633675  0.5627784  0.56062067 0.55877835 0.55794775
 0.55805176 0.5586077  0.5590617  0.5590926  0.5586901  0.5580635
 0.5575027  0.55715215 0.55711913 0.5572393  0.5573475  0.55722225
 0.5567384  0.5559278  0.554988   0.55406594 0.55332017 0.5528233
 0.55253416 0.55236256 0.5521848  0.551895   0.5514507  0.5508842
 0.5502506  0.5497032  0.54925084 0.54880464 0.54833    0.54783624
 0.5472838  0.5466821  0.5460416  0.5454029  0.5448     0.54424447
 0.54374325 0.54327077 0.5427998  0.54227626 0.5416859  0.54104173
 0.5402846  0.5394046  0.53847677 0.53763723 0.5369196  0.53630453
 0.53575385 0.5352843  0.5348448  0.53439236 0.53393656 0.5335143
 0.53315073 0.53292704 0.5328259  0.5327805  0.5326849  0.5325324
 0.53224117 0.5318666  0.53148425 0.5311419  0.53086126 0.5306572
 0.530481   0.5302723  0.529939   0.5294686  0.52886415 0.5281556
 0.5274094  0.5267423  0.5261307  0.5255907  0.5250846  0.52456135
 0.52398527 0.5234067  0.5227692  0.5221641  0.52165747 0.5212847
 0.52105176 0.5208913  0.52056664 0.5199604  0.5189875  0.5176053
 0.5159311  0.5142507  0.51274484 0.51151174 0.51055634 0.50975823
 0.50900644 0.5081556  0.50709647 0.5058298  0.50449234 0.5033173
 0.5023651  0.50165546 0.501116   0.5005831  0.5000152  0.49927562
 0.4982944  0.49716684 0.49606836 0.49512267 0.4944879  0.49405342
 0.49375793 0.49337825 0.49285406 0.4920818  0.4910189  0.48976564
 0.48858508 0.4877061  0.48720038 0.48694587 0.48675475 0.48639682
 0.48577452 0.48486963 0.4837684  0.4826231  0.48159003 0.48094034
 0.48067698 0.48069587 0.48075444 0.48066863 0.48033455 0.47961187
 0.47852257 0.47712713 0.47584093 0.47486728 0.47430778 0.47393805
 0.4736059  0.47321215 0.4726156  0.47174194 0.4707055  0.4698333
 0.46930107 0.46912065 0.4690115  0.46885675 0.4683225  0.46734253
 0.46592277 0.46439388 0.46325365 0.4629758  0.46357837 0.46470773
 0.46586722 0.46670035 0.4668977  0.46647343 0.46559674 0.4645892
 0.46384344 0.46353388 0.46355647 0.4635706  0.46312767 0.4622168
 0.46082237 0.45924473 0.4581357  0.45786995 0.45824632 0.45865312
 0.45843282 0.45731097 0.45543638 0.45400634 0.45515993 0.4584707 ]
