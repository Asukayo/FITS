Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=256, c_out=7, checkpoints='./checkpoints/', cut_freq=74, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=74, out_features=83, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  11006464.0
params:  6225.0
Trainable parameters:  6225
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2893367
	speed: 0.1542s/iter; left time: 994.7273s
Epoch: 1 cost time: 20.06034207344055
Epoch: 1, Steps: 131 | Train Loss: 0.3574462 Vali Loss: 0.1452921 Test Loss: 0.1954723
Validation loss decreased (inf --> 0.145292).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2355407
	speed: 0.4116s/iter; left time: 2601.4575s
Epoch: 2 cost time: 19.206732749938965
Epoch: 2, Steps: 131 | Train Loss: 0.2595821 Vali Loss: 0.1310555 Test Loss: 0.1802349
Validation loss decreased (0.145292 --> 0.131055).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2063167
	speed: 0.3983s/iter; left time: 2464.9195s
Epoch: 3 cost time: 18.731049299240112
Epoch: 3, Steps: 131 | Train Loss: 0.2401809 Vali Loss: 0.1252623 Test Loss: 0.1744196
Validation loss decreased (0.131055 --> 0.125262).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3342508
	speed: 0.4099s/iter; left time: 2482.9724s
Epoch: 4 cost time: 19.427721977233887
Epoch: 4, Steps: 131 | Train Loss: 0.2308938 Vali Loss: 0.1225810 Test Loss: 0.1711563
Validation loss decreased (0.125262 --> 0.122581).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1988697
	speed: 0.3915s/iter; left time: 2320.5416s
Epoch: 5 cost time: 17.902876615524292
Epoch: 5, Steps: 131 | Train Loss: 0.2250913 Vali Loss: 0.1206667 Test Loss: 0.1692969
Validation loss decreased (0.122581 --> 0.120667).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2073714
	speed: 0.3732s/iter; left time: 2162.9474s
Epoch: 6 cost time: 17.090137004852295
Epoch: 6, Steps: 131 | Train Loss: 0.2220385 Vali Loss: 0.1198032 Test Loss: 0.1683076
Validation loss decreased (0.120667 --> 0.119803).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2011424
	speed: 0.3835s/iter; left time: 2172.6735s
Epoch: 7 cost time: 19.43091654777527
Epoch: 7, Steps: 131 | Train Loss: 0.2194393 Vali Loss: 0.1190509 Test Loss: 0.1676680
Validation loss decreased (0.119803 --> 0.119051).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1844954
	speed: 0.4263s/iter; left time: 2359.0540s
Epoch: 8 cost time: 20.118831157684326
Epoch: 8, Steps: 131 | Train Loss: 0.2184731 Vali Loss: 0.1185449 Test Loss: 0.1668293
Validation loss decreased (0.119051 --> 0.118545).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2517804
	speed: 0.4140s/iter; left time: 2237.0942s
Epoch: 9 cost time: 19.359556198120117
Epoch: 9, Steps: 131 | Train Loss: 0.2172866 Vali Loss: 0.1182142 Test Loss: 0.1664988
Validation loss decreased (0.118545 --> 0.118214).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2373088
	speed: 0.3621s/iter; left time: 1909.0156s
Epoch: 10 cost time: 17.436665773391724
Epoch: 10, Steps: 131 | Train Loss: 0.2160984 Vali Loss: 0.1179867 Test Loss: 0.1663148
Validation loss decreased (0.118214 --> 0.117987).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1586736
	speed: 0.3615s/iter; left time: 1858.3914s
Epoch: 11 cost time: 17.063547372817993
Epoch: 11, Steps: 131 | Train Loss: 0.2152366 Vali Loss: 0.1178230 Test Loss: 0.1661282
Validation loss decreased (0.117987 --> 0.117823).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1920948
	speed: 0.3548s/iter; left time: 1777.4902s
Epoch: 12 cost time: 16.646588802337646
Epoch: 12, Steps: 131 | Train Loss: 0.2147180 Vali Loss: 0.1178484 Test Loss: 0.1659063
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1699834
	speed: 0.3355s/iter; left time: 1636.9845s
Epoch: 13 cost time: 15.226263999938965
Epoch: 13, Steps: 131 | Train Loss: 0.2141317 Vali Loss: 0.1176471 Test Loss: 0.1654980
Validation loss decreased (0.117823 --> 0.117647).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2447823
	speed: 0.3534s/iter; left time: 1677.7553s
Epoch: 14 cost time: 17.26741647720337
Epoch: 14, Steps: 131 | Train Loss: 0.2135714 Vali Loss: 0.1174024 Test Loss: 0.1652357
Validation loss decreased (0.117647 --> 0.117402).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2123827
	speed: 0.3675s/iter; left time: 1696.6688s
Epoch: 15 cost time: 18.28266477584839
Epoch: 15, Steps: 131 | Train Loss: 0.2129163 Vali Loss: 0.1172173 Test Loss: 0.1651342
Validation loss decreased (0.117402 --> 0.117217).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2017549
	speed: 0.3965s/iter; left time: 1778.9022s
Epoch: 16 cost time: 19.060829401016235
Epoch: 16, Steps: 131 | Train Loss: 0.2130191 Vali Loss: 0.1172823 Test Loss: 0.1650801
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1852154
	speed: 0.3924s/iter; left time: 1708.8379s
Epoch: 17 cost time: 18.62818717956543
Epoch: 17, Steps: 131 | Train Loss: 0.2124826 Vali Loss: 0.1169365 Test Loss: 0.1649839
Validation loss decreased (0.117217 --> 0.116936).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2542670
	speed: 0.3917s/iter; left time: 1654.5609s
Epoch: 18 cost time: 18.34804129600525
Epoch: 18, Steps: 131 | Train Loss: 0.2115632 Vali Loss: 0.1169861 Test Loss: 0.1647975
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2544169
	speed: 0.4022s/iter; left time: 1646.2607s
Epoch: 19 cost time: 19.472461462020874
Epoch: 19, Steps: 131 | Train Loss: 0.2113737 Vali Loss: 0.1169572 Test Loss: 0.1647810
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2451974
	speed: 0.3850s/iter; left time: 1525.2269s
Epoch: 20 cost time: 17.88369369506836
Epoch: 20, Steps: 131 | Train Loss: 0.2115352 Vali Loss: 0.1165680 Test Loss: 0.1645488
Validation loss decreased (0.116936 --> 0.116568).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2210142
	speed: 0.3731s/iter; left time: 1429.1895s
Epoch: 21 cost time: 18.282942533493042
Epoch: 21, Steps: 131 | Train Loss: 0.2117498 Vali Loss: 0.1167446 Test Loss: 0.1645883
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2218085
	speed: 0.3801s/iter; left time: 1406.5120s
Epoch: 22 cost time: 18.26348853111267
Epoch: 22, Steps: 131 | Train Loss: 0.2112001 Vali Loss: 0.1168316 Test Loss: 0.1645326
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1843048
	speed: 0.3955s/iter; left time: 1411.6374s
Epoch: 23 cost time: 19.37309503555298
Epoch: 23, Steps: 131 | Train Loss: 0.2111048 Vali Loss: 0.1165617 Test Loss: 0.1644181
Validation loss decreased (0.116568 --> 0.116562).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2186379
	speed: 0.3996s/iter; left time: 1373.6569s
Epoch: 24 cost time: 18.95457100868225
Epoch: 24, Steps: 131 | Train Loss: 0.2110777 Vali Loss: 0.1164831 Test Loss: 0.1643915
Validation loss decreased (0.116562 --> 0.116483).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1682502
	speed: 0.3924s/iter; left time: 1297.7447s
Epoch: 25 cost time: 18.09714984893799
Epoch: 25, Steps: 131 | Train Loss: 0.2104921 Vali Loss: 0.1166354 Test Loss: 0.1643095
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2241717
	speed: 0.3764s/iter; left time: 1195.4183s
Epoch: 26 cost time: 18.73328948020935
Epoch: 26, Steps: 131 | Train Loss: 0.2107453 Vali Loss: 0.1166214 Test Loss: 0.1641718
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.1711042
	speed: 0.3910s/iter; left time: 1190.6035s
Epoch: 27 cost time: 18.6254620552063
Epoch: 27, Steps: 131 | Train Loss: 0.2105168 Vali Loss: 0.1163502 Test Loss: 0.1642091
Validation loss decreased (0.116483 --> 0.116350).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2186492
	speed: 0.3973s/iter; left time: 1157.7990s
Epoch: 28 cost time: 19.178569793701172
Epoch: 28, Steps: 131 | Train Loss: 0.2105273 Vali Loss: 0.1166043 Test Loss: 0.1641216
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2142596
	speed: 0.3992s/iter; left time: 1111.0532s
Epoch: 29 cost time: 18.679243564605713
Epoch: 29, Steps: 131 | Train Loss: 0.2104221 Vali Loss: 0.1163938 Test Loss: 0.1641130
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1807402
	speed: 0.3908s/iter; left time: 1036.4428s
Epoch: 30 cost time: 18.831707239151
Epoch: 30, Steps: 131 | Train Loss: 0.2103582 Vali Loss: 0.1163309 Test Loss: 0.1641174
Validation loss decreased (0.116350 --> 0.116331).  Saving model ...
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.1897354
	speed: 0.3931s/iter; left time: 990.9947s
Epoch: 31 cost time: 19.443641424179077
Epoch: 31, Steps: 131 | Train Loss: 0.2100512 Vali Loss: 0.1164082 Test Loss: 0.1640650
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2745567
	speed: 0.4134s/iter; left time: 987.9195s
Epoch: 32 cost time: 19.446603536605835
Epoch: 32, Steps: 131 | Train Loss: 0.2099826 Vali Loss: 0.1163053 Test Loss: 0.1640156
Validation loss decreased (0.116331 --> 0.116305).  Saving model ...
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.1660094
	speed: 0.4205s/iter; left time: 949.8068s
Epoch: 33 cost time: 19.941020011901855
Epoch: 33, Steps: 131 | Train Loss: 0.2103007 Vali Loss: 0.1164496 Test Loss: 0.1640058
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2040923
	speed: 0.4253s/iter; left time: 905.1269s
Epoch: 34 cost time: 19.561034440994263
Epoch: 34, Steps: 131 | Train Loss: 0.2100619 Vali Loss: 0.1162809 Test Loss: 0.1640272
Validation loss decreased (0.116305 --> 0.116281).  Saving model ...
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2573527
	speed: 0.3888s/iter; left time: 776.4092s
Epoch: 35 cost time: 19.12076210975647
Epoch: 35, Steps: 131 | Train Loss: 0.2099666 Vali Loss: 0.1163689 Test Loss: 0.1639441
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.1985349
	speed: 0.3967s/iter; left time: 740.3155s
Epoch: 36 cost time: 17.98551869392395
Epoch: 36, Steps: 131 | Train Loss: 0.2099176 Vali Loss: 0.1163507 Test Loss: 0.1639239
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.1715621
	speed: 0.3399s/iter; left time: 589.7706s
Epoch: 37 cost time: 14.669864892959595
Epoch: 37, Steps: 131 | Train Loss: 0.2101502 Vali Loss: 0.1163476 Test Loss: 0.1639296
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16463910043239594, mae:0.2557905614376068, rse:0.32897481322288513, corr:[0.5624401  0.56713164 0.56862324 0.56763524 0.56597954 0.5647923
 0.56435937 0.56452787 0.5649754  0.5653541  0.56540364 0.5650712
 0.5645151  0.5639039  0.56340826 0.56302005 0.56273985 0.5624624
 0.56207556 0.5615016  0.5607876  0.5599695  0.5591717  0.5584961
 0.55794805 0.55752003 0.55717075 0.55681896 0.5563807  0.5558405
 0.5551857  0.55454963 0.55395114 0.553333   0.5527059  0.5521296
 0.5515814  0.5510443  0.55046695 0.5498364  0.5491506  0.5484191
 0.5476696  0.5469369  0.546276   0.54566664 0.54509985 0.5445568
 0.54389566 0.5430343  0.54198825 0.5408845  0.5398017  0.53880703
 0.5379572  0.53733766 0.53689754 0.536557   0.5362271  0.53586507
 0.53541726 0.5349575  0.53450555 0.5340687  0.53365254 0.533357
 0.53312105 0.53297025 0.53291047 0.532855   0.53270316 0.5323931
 0.5318997  0.53128415 0.5305903  0.5299529  0.52943474 0.52902776
 0.5286474  0.52826726 0.5276368  0.52673525 0.5255704  0.5242792
 0.5231142  0.5223568  0.5219454  0.5217517  0.5214849  0.5208782
 0.51994824 0.5189654  0.5182443  0.5184667  0.5196633  0.5200732 ]
