Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=256, c_out=7, checkpoints='./checkpoints/', cut_freq=122, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=122, out_features=138, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  30170112.0
params:  16974.0
Trainable parameters:  16974
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2840438
	speed: 0.1437s/iter; left time: 926.7253s
Epoch: 1 cost time: 18.63697910308838
Epoch: 1, Steps: 131 | Train Loss: 0.3283251 Vali Loss: 0.1390131 Test Loss: 0.1893330
Validation loss decreased (inf --> 0.139013).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2478716
	speed: 0.4006s/iter; left time: 2531.4892s
Epoch: 2 cost time: 18.52139115333557
Epoch: 2, Steps: 131 | Train Loss: 0.2508637 Vali Loss: 0.1274588 Test Loss: 0.1770078
Validation loss decreased (0.139013 --> 0.127459).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2400551
	speed: 0.3409s/iter; left time: 2110.0685s
Epoch: 3 cost time: 14.352005958557129
Epoch: 3, Steps: 131 | Train Loss: 0.2335182 Vali Loss: 0.1225757 Test Loss: 0.1720357
Validation loss decreased (0.127459 --> 0.122576).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2414594
	speed: 0.3152s/iter; left time: 1909.3135s
Epoch: 4 cost time: 15.046293020248413
Epoch: 4, Steps: 131 | Train Loss: 0.2253743 Vali Loss: 0.1198447 Test Loss: 0.1690213
Validation loss decreased (0.122576 --> 0.119845).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1783212
	speed: 0.2989s/iter; left time: 1771.8216s
Epoch: 5 cost time: 13.923808813095093
Epoch: 5, Steps: 131 | Train Loss: 0.2208064 Vali Loss: 0.1184277 Test Loss: 0.1673965
Validation loss decreased (0.119845 --> 0.118428).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1901643
	speed: 0.3651s/iter; left time: 2116.1882s
Epoch: 6 cost time: 19.338868618011475
Epoch: 6, Steps: 131 | Train Loss: 0.2176075 Vali Loss: 0.1176144 Test Loss: 0.1664805
Validation loss decreased (0.118428 --> 0.117614).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2058723
	speed: 0.3923s/iter; left time: 2222.5745s
Epoch: 7 cost time: 18.718404531478882
Epoch: 7, Steps: 131 | Train Loss: 0.2155352 Vali Loss: 0.1169478 Test Loss: 0.1655500
Validation loss decreased (0.117614 --> 0.116948).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1998415
	speed: 0.3506s/iter; left time: 1940.1725s
Epoch: 8 cost time: 14.451000928878784
Epoch: 8, Steps: 131 | Train Loss: 0.2139251 Vali Loss: 0.1165326 Test Loss: 0.1648563
Validation loss decreased (0.116948 --> 0.116533).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1947063
	speed: 0.3038s/iter; left time: 1641.6885s
Epoch: 9 cost time: 14.843065023422241
Epoch: 9, Steps: 131 | Train Loss: 0.2126276 Vali Loss: 0.1163043 Test Loss: 0.1645633
Validation loss decreased (0.116533 --> 0.116304).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2483618
	speed: 0.3026s/iter; left time: 1595.3849s
Epoch: 10 cost time: 16.458229541778564
Epoch: 10, Steps: 131 | Train Loss: 0.2122158 Vali Loss: 0.1158907 Test Loss: 0.1643004
Validation loss decreased (0.116304 --> 0.115891).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2431651
	speed: 0.4343s/iter; left time: 2232.5218s
Epoch: 11 cost time: 20.271984338760376
Epoch: 11, Steps: 131 | Train Loss: 0.2112078 Vali Loss: 0.1159570 Test Loss: 0.1642249
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2318768
	speed: 0.4019s/iter; left time: 2013.4301s
Epoch: 12 cost time: 19.703640699386597
Epoch: 12, Steps: 131 | Train Loss: 0.2109417 Vali Loss: 0.1156751 Test Loss: 0.1640127
Validation loss decreased (0.115891 --> 0.115675).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2164344
	speed: 0.3765s/iter; left time: 1836.9251s
Epoch: 13 cost time: 15.22871470451355
Epoch: 13, Steps: 131 | Train Loss: 0.2103892 Vali Loss: 0.1155907 Test Loss: 0.1637425
Validation loss decreased (0.115675 --> 0.115591).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2298977
	speed: 0.3172s/iter; left time: 1506.1345s
Epoch: 14 cost time: 14.95996880531311
Epoch: 14, Steps: 131 | Train Loss: 0.2093224 Vali Loss: 0.1152859 Test Loss: 0.1635200
Validation loss decreased (0.115591 --> 0.115286).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1894954
	speed: 0.3444s/iter; left time: 1590.0335s
Epoch: 15 cost time: 19.864243507385254
Epoch: 15, Steps: 131 | Train Loss: 0.2098039 Vali Loss: 0.1152519 Test Loss: 0.1635185
Validation loss decreased (0.115286 --> 0.115252).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2348141
	speed: 0.4140s/iter; left time: 1857.2963s
Epoch: 16 cost time: 19.412256956100464
Epoch: 16, Steps: 131 | Train Loss: 0.2095550 Vali Loss: 0.1152381 Test Loss: 0.1634380
Validation loss decreased (0.115252 --> 0.115238).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1771782
	speed: 0.4150s/iter; left time: 1807.4867s
Epoch: 17 cost time: 19.462867259979248
Epoch: 17, Steps: 131 | Train Loss: 0.2089697 Vali Loss: 0.1149877 Test Loss: 0.1631925
Validation loss decreased (0.115238 --> 0.114988).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2156748
	speed: 0.3987s/iter; left time: 1684.0716s
Epoch: 18 cost time: 18.602858543395996
Epoch: 18, Steps: 131 | Train Loss: 0.2085223 Vali Loss: 0.1150448 Test Loss: 0.1630721
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2052808
	speed: 0.4159s/iter; left time: 1702.4115s
Epoch: 19 cost time: 19.54436492919922
Epoch: 19, Steps: 131 | Train Loss: 0.2086681 Vali Loss: 0.1148281 Test Loss: 0.1629675
Validation loss decreased (0.114988 --> 0.114828).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2549019
	speed: 0.3865s/iter; left time: 1531.3758s
Epoch: 20 cost time: 16.68634605407715
Epoch: 20, Steps: 131 | Train Loss: 0.2083901 Vali Loss: 0.1150127 Test Loss: 0.1630871
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2013176
	speed: 0.3306s/iter; left time: 1266.4767s
Epoch: 21 cost time: 16.15382671356201
Epoch: 21, Steps: 131 | Train Loss: 0.2081974 Vali Loss: 0.1148652 Test Loss: 0.1628772
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1948759
	speed: 0.3138s/iter; left time: 1160.9671s
Epoch: 22 cost time: 14.427533388137817
Epoch: 22, Steps: 131 | Train Loss: 0.2084076 Vali Loss: 0.1147694 Test Loss: 0.1628262
Validation loss decreased (0.114828 --> 0.114769).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.1703257
	speed: 0.3571s/iter; left time: 1274.5101s
Epoch: 23 cost time: 20.48977041244507
Epoch: 23, Steps: 131 | Train Loss: 0.2080460 Vali Loss: 0.1147558 Test Loss: 0.1627594
Validation loss decreased (0.114769 --> 0.114756).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.1674806
	speed: 0.4219s/iter; left time: 1450.4935s
Epoch: 24 cost time: 19.549440622329712
Epoch: 24, Steps: 131 | Train Loss: 0.2080501 Vali Loss: 0.1149338 Test Loss: 0.1627830
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.1959571
	speed: 0.3538s/iter; left time: 1169.9973s
Epoch: 25 cost time: 16.0618097782135
Epoch: 25, Steps: 131 | Train Loss: 0.2074427 Vali Loss: 0.1146873 Test Loss: 0.1626129
Validation loss decreased (0.114756 --> 0.114687).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.1785038
	speed: 0.3269s/iter; left time: 1038.0763s
Epoch: 26 cost time: 14.893858432769775
Epoch: 26, Steps: 131 | Train Loss: 0.2072970 Vali Loss: 0.1146871 Test Loss: 0.1626528
Validation loss decreased (0.114687 --> 0.114687).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2404761
	speed: 0.2956s/iter; left time: 900.0446s
Epoch: 27 cost time: 14.610119581222534
Epoch: 27, Steps: 131 | Train Loss: 0.2076205 Vali Loss: 0.1144933 Test Loss: 0.1625407
Validation loss decreased (0.114687 --> 0.114493).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.1693584
	speed: 0.3798s/iter; left time: 1106.6186s
Epoch: 28 cost time: 19.54607653617859
Epoch: 28, Steps: 131 | Train Loss: 0.2073203 Vali Loss: 0.1145475 Test Loss: 0.1625068
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.1970910
	speed: 0.3923s/iter; left time: 1091.7732s
Epoch: 29 cost time: 18.602452516555786
Epoch: 29, Steps: 131 | Train Loss: 0.2076174 Vali Loss: 0.1147094 Test Loss: 0.1625510
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.1714981
	speed: 0.3773s/iter; left time: 1000.6285s
Epoch: 30 cost time: 17.621526956558228
Epoch: 30, Steps: 131 | Train Loss: 0.2070221 Vali Loss: 0.1145635 Test Loss: 0.1624981
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16316278278827667, mae:0.254314661026001, rse:0.32749655842781067, corr:[0.56587404 0.56965613 0.5660794  0.564329   0.56538874 0.5669454
 0.5668177  0.565488   0.56458795 0.5647863  0.56551135 0.56571144
 0.56511956 0.56435645 0.5640866  0.5642454  0.5642855  0.5636921
 0.5626059  0.56158775 0.56103766 0.5608123  0.5605023  0.55984956
 0.55901253 0.55838203 0.5581192  0.5579744  0.55753726 0.5567066
 0.5557395  0.5550992  0.5548234  0.5545735  0.55404305 0.5532131
 0.55228937 0.55156285 0.55106175 0.55062103 0.55003065 0.5492237
 0.5483893  0.5477581  0.54737484 0.5469598  0.5462431  0.5452032
 0.54400736 0.5429983  0.5423627  0.54195803 0.54132694 0.5402536
 0.538975   0.53799814 0.5374959  0.5372686  0.53692555 0.53630376
 0.5355676  0.5351881  0.53526914 0.53544915 0.5353113  0.5348561
 0.53422135 0.53378767 0.53370327 0.5336803  0.53339213 0.53286076
 0.5323792  0.5322315  0.5321768  0.5318094  0.53086853 0.5295765
 0.5285163  0.528247   0.52821577 0.52774316 0.52653337 0.5250334
 0.52403986 0.52383196 0.52348214 0.5223213  0.5207027  0.51997083
 0.5209131  0.52191895 0.5208612  0.51819336 0.5182499  0.52360207]
