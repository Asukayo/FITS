Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=122, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=122, out_features=138, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  7542528.0
params:  16974.0
Trainable parameters:  16974
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3481150
	speed: 0.0374s/iter; left time: 982.9702s
	iters: 200, epoch: 1 | loss: 0.2479750
	speed: 0.0473s/iter; left time: 1237.4445s
	iters: 300, epoch: 1 | loss: 0.1901154
	speed: 0.0365s/iter; left time: 949.9479s
	iters: 400, epoch: 1 | loss: 0.2234027
	speed: 0.0348s/iter; left time: 902.0328s
	iters: 500, epoch: 1 | loss: 0.2711106
	speed: 0.0460s/iter; left time: 1188.4204s
Epoch: 1 cost time: 21.273336172103882
Epoch: 1, Steps: 527 | Train Loss: 0.2733138 Vali Loss: 0.1229625 Test Loss: 0.1734075
Validation loss decreased (inf --> 0.122962).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1967335
	speed: 0.2442s/iter; left time: 6280.9280s
	iters: 200, epoch: 2 | loss: 0.2374017
	speed: 0.0444s/iter; left time: 1136.7286s
	iters: 300, epoch: 2 | loss: 0.1442447
	speed: 0.0438s/iter; left time: 1118.1007s
	iters: 400, epoch: 2 | loss: 0.1849768
	speed: 0.0503s/iter; left time: 1278.2927s
	iters: 500, epoch: 2 | loss: 0.1072444
	speed: 0.0427s/iter; left time: 1080.8029s
Epoch: 2 cost time: 23.990535736083984
Epoch: 2, Steps: 527 | Train Loss: 0.2229538 Vali Loss: 0.1177525 Test Loss: 0.1671281
Validation loss decreased (0.122962 --> 0.117752).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2092337
	speed: 0.2583s/iter; left time: 6507.5664s
	iters: 200, epoch: 3 | loss: 0.2679675
	speed: 0.0540s/iter; left time: 1355.7630s
	iters: 300, epoch: 3 | loss: 0.1892739
	speed: 0.0571s/iter; left time: 1426.1837s
	iters: 400, epoch: 3 | loss: 0.2183760
	speed: 0.0876s/iter; left time: 2180.9609s
	iters: 500, epoch: 3 | loss: 0.1431557
	speed: 0.0879s/iter; left time: 2180.4360s
Epoch: 3 cost time: 35.850871086120605
Epoch: 3, Steps: 527 | Train Loss: 0.2152785 Vali Loss: 0.1162470 Test Loss: 0.1655043
Validation loss decreased (0.117752 --> 0.116247).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1482104
	speed: 0.5963s/iter; left time: 14709.9199s
	iters: 200, epoch: 4 | loss: 0.1142734
	speed: 0.0883s/iter; left time: 2170.2059s
	iters: 300, epoch: 4 | loss: 0.1695318
	speed: 0.0811s/iter; left time: 1985.3987s
	iters: 400, epoch: 4 | loss: 0.1750949
	speed: 0.0801s/iter; left time: 1952.2501s
	iters: 500, epoch: 4 | loss: 0.1163670
	speed: 0.0817s/iter; left time: 1982.9509s
Epoch: 4 cost time: 44.30106782913208
Epoch: 4, Steps: 527 | Train Loss: 0.2123275 Vali Loss: 0.1163582 Test Loss: 0.1656795
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2001496
	speed: 0.5850s/iter; left time: 14123.5010s
	iters: 200, epoch: 5 | loss: 0.2535820
	speed: 0.0836s/iter; left time: 2009.3820s
	iters: 300, epoch: 5 | loss: 0.3780991
	speed: 0.0856s/iter; left time: 2048.3996s
	iters: 400, epoch: 5 | loss: 0.2084676
	speed: 0.0808s/iter; left time: 1926.9634s
	iters: 500, epoch: 5 | loss: 0.2233672
	speed: 0.0790s/iter; left time: 1876.7740s
Epoch: 5 cost time: 43.84433126449585
Epoch: 5, Steps: 527 | Train Loss: 0.2107955 Vali Loss: 0.1152873 Test Loss: 0.1638109
Validation loss decreased (0.116247 --> 0.115287).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1444945
	speed: 0.5176s/iter; left time: 12223.1778s
	iters: 200, epoch: 6 | loss: 0.2208546
	speed: 0.0779s/iter; left time: 1832.4276s
	iters: 300, epoch: 6 | loss: 0.2491881
	speed: 0.0749s/iter; left time: 1754.4349s
	iters: 400, epoch: 6 | loss: 0.1537190
	speed: 0.0686s/iter; left time: 1599.7118s
	iters: 500, epoch: 6 | loss: 0.3017520
	speed: 0.0755s/iter; left time: 1752.2128s
Epoch: 6 cost time: 39.26940131187439
Epoch: 6, Steps: 527 | Train Loss: 0.2096261 Vali Loss: 0.1157441 Test Loss: 0.1648415
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1851818
	speed: 0.7029s/iter; left time: 16228.5687s
	iters: 200, epoch: 7 | loss: 0.2322420
	speed: 0.1081s/iter; left time: 2484.5465s
	iters: 300, epoch: 7 | loss: 0.2891106
	speed: 0.1070s/iter; left time: 2450.1759s
	iters: 400, epoch: 7 | loss: 0.1896272
	speed: 0.1093s/iter; left time: 2491.9238s
	iters: 500, epoch: 7 | loss: 0.2300644
	speed: 0.1075s/iter; left time: 2438.7956s
Epoch: 7 cost time: 57.707419633865356
Epoch: 7, Steps: 527 | Train Loss: 0.2090199 Vali Loss: 0.1152076 Test Loss: 0.1637671
Validation loss decreased (0.115287 --> 0.115208).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1704684
	speed: 0.7592s/iter; left time: 17128.2041s
	iters: 200, epoch: 8 | loss: 0.1847378
	speed: 0.1074s/iter; left time: 2412.3583s
	iters: 300, epoch: 8 | loss: 0.1553890
	speed: 0.1051s/iter; left time: 2351.2068s
	iters: 400, epoch: 8 | loss: 0.2590164
	speed: 0.1063s/iter; left time: 2365.8154s
	iters: 500, epoch: 8 | loss: 0.2231692
	speed: 0.1059s/iter; left time: 2346.3001s
Epoch: 8 cost time: 56.867730140686035
Epoch: 8, Steps: 527 | Train Loss: 0.2082909 Vali Loss: 0.1150208 Test Loss: 0.1636695
Validation loss decreased (0.115208 --> 0.115021).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1468029
	speed: 0.8768s/iter; left time: 19320.6718s
	iters: 200, epoch: 9 | loss: 0.2624078
	speed: 0.1327s/iter; left time: 2911.8070s
	iters: 300, epoch: 9 | loss: 0.2118023
	speed: 0.1357s/iter; left time: 2964.0993s
	iters: 400, epoch: 9 | loss: 0.2316477
	speed: 0.1309s/iter; left time: 2845.6549s
	iters: 500, epoch: 9 | loss: 0.1284921
	speed: 0.1333s/iter; left time: 2883.1544s
Epoch: 9 cost time: 71.55504441261292
Epoch: 9, Steps: 527 | Train Loss: 0.2080234 Vali Loss: 0.1147486 Test Loss: 0.1632593
Validation loss decreased (0.115021 --> 0.114749).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1304300
	speed: 0.9798s/iter; left time: 21072.7146s
	iters: 200, epoch: 10 | loss: 0.1020989
	speed: 0.1414s/iter; left time: 3027.7208s
	iters: 300, epoch: 10 | loss: 0.2165754
	speed: 0.1425s/iter; left time: 3036.8065s
	iters: 400, epoch: 10 | loss: 0.2317137
	speed: 0.1467s/iter; left time: 3110.2656s
	iters: 500, epoch: 10 | loss: 0.1896285
	speed: 0.1429s/iter; left time: 3016.5994s
Epoch: 10 cost time: 75.94816470146179
Epoch: 10, Steps: 527 | Train Loss: 0.2076983 Vali Loss: 0.1148361 Test Loss: 0.1629704
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1129664
	speed: 0.9738s/iter; left time: 20431.2727s
	iters: 200, epoch: 11 | loss: 0.2668801
	speed: 0.1285s/iter; left time: 2682.4841s
	iters: 300, epoch: 11 | loss: 0.2279726
	speed: 0.1108s/iter; left time: 2302.5496s
	iters: 400, epoch: 11 | loss: 0.1699241
	speed: 0.1400s/iter; left time: 2895.9629s
	iters: 500, epoch: 11 | loss: 0.2061770
	speed: 0.1379s/iter; left time: 2838.0927s
Epoch: 11 cost time: 70.31113576889038
Epoch: 11, Steps: 527 | Train Loss: 0.2074083 Vali Loss: 0.1146553 Test Loss: 0.1628467
Validation loss decreased (0.114749 --> 0.114655).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1786269
	speed: 0.9446s/iter; left time: 19321.1022s
	iters: 200, epoch: 12 | loss: 0.1758033
	speed: 0.1366s/iter; left time: 2780.3166s
	iters: 300, epoch: 12 | loss: 0.2160428
	speed: 0.1379s/iter; left time: 2793.7137s
	iters: 400, epoch: 12 | loss: 0.1988683
	speed: 0.1326s/iter; left time: 2672.3806s
	iters: 500, epoch: 12 | loss: 0.1779145
	speed: 0.1355s/iter; left time: 2716.5539s
Epoch: 12 cost time: 72.16159057617188
Epoch: 12, Steps: 527 | Train Loss: 0.2072755 Vali Loss: 0.1143426 Test Loss: 0.1626344
Validation loss decreased (0.114655 --> 0.114343).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2175307
	speed: 0.9296s/iter; left time: 18524.3457s
	iters: 200, epoch: 13 | loss: 0.3376164
	speed: 0.1474s/iter; left time: 2922.3302s
	iters: 300, epoch: 13 | loss: 0.1725408
	speed: 0.1511s/iter; left time: 2980.4228s
	iters: 400, epoch: 13 | loss: 0.1414033
	speed: 0.1460s/iter; left time: 2865.7680s
	iters: 500, epoch: 13 | loss: 0.2291303
	speed: 0.1247s/iter; left time: 2434.7238s
Epoch: 13 cost time: 73.09431743621826
Epoch: 13, Steps: 527 | Train Loss: 0.2069501 Vali Loss: 0.1147829 Test Loss: 0.1631477
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2294474
	speed: 0.9778s/iter; left time: 18968.4680s
	iters: 200, epoch: 14 | loss: 0.2162025
	speed: 0.1495s/iter; left time: 2886.1232s
	iters: 300, epoch: 14 | loss: 0.1700151
	speed: 0.1507s/iter; left time: 2894.1694s
	iters: 400, epoch: 14 | loss: 0.3478703
	speed: 0.1544s/iter; left time: 2949.0175s
	iters: 500, epoch: 14 | loss: 0.1391529
	speed: 0.1438s/iter; left time: 2732.3270s
Epoch: 14 cost time: 79.19343113899231
Epoch: 14, Steps: 527 | Train Loss: 0.2068801 Vali Loss: 0.1144522 Test Loss: 0.1628226
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1578940
	speed: 1.0841s/iter; left time: 20459.3586s
	iters: 200, epoch: 15 | loss: 0.1145240
	speed: 0.1564s/iter; left time: 2935.4395s
	iters: 300, epoch: 15 | loss: 0.1909784
	speed: 0.1561s/iter; left time: 2914.4969s
	iters: 400, epoch: 15 | loss: 0.1874384
	speed: 0.1558s/iter; left time: 2894.5220s
	iters: 500, epoch: 15 | loss: 0.1534992
	speed: 0.1585s/iter; left time: 2927.4406s
Epoch: 15 cost time: 83.0945394039154
Epoch: 15, Steps: 527 | Train Loss: 0.2067971 Vali Loss: 0.1144049 Test Loss: 0.1625725
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1627996265888214, mae:0.25336211919784546, rse:0.32713189721107483, corr:[0.5701046  0.5703889  0.5666022  0.5653686  0.5661994  0.5667993
 0.5661945  0.5652985  0.5650598  0.56542814 0.565621   0.5651167
 0.5642862  0.56373096 0.563684   0.563675   0.56318736 0.56212693
 0.5609291  0.56012875 0.55990785 0.5598549  0.5595259  0.55883104
 0.5580069  0.5574135  0.55717593 0.5570516  0.5567067  0.5561065
 0.555423   0.5549453  0.55459094 0.55408406 0.553351   0.5525614
 0.5518811  0.55137086 0.55085754 0.55018955 0.5493747  0.54855764
 0.5479555  0.54759544 0.547291   0.5467395  0.54587907 0.54489857
 0.5439787  0.54324675 0.5426111  0.5419102  0.5409729  0.5398611
 0.53884494 0.5381906  0.5377713  0.53732246 0.53663725 0.5357734
 0.5350088  0.53476375 0.53505987 0.5355585  0.53580934 0.5356629
 0.5351174  0.5345081  0.5341593  0.53411156 0.5340714  0.5337377
 0.53308207 0.5323576  0.5317788  0.531476   0.531154   0.5305279
 0.52968717 0.5291483  0.52888936 0.52866024 0.5279351  0.52663606
 0.52531093 0.5247462  0.5248016  0.5247699  0.52418965 0.5235354
 0.52382725 0.5248394  0.524898   0.52360356 0.52231485 0.52429444]
