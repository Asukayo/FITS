Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=122, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=122, out_features=138, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  15085056.0
params:  16974.0
Trainable parameters:  16974
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3162417
	speed: 0.1446s/iter; left time: 1886.8288s
	iters: 200, epoch: 1 | loss: 0.1862371
	speed: 0.1368s/iter; left time: 1771.7640s
Epoch: 1 cost time: 36.75406193733215
Epoch: 1, Steps: 263 | Train Loss: 0.2947385 Vali Loss: 0.1292711 Test Loss: 0.1795102
Validation loss decreased (inf --> 0.129271).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2713837
	speed: 0.6390s/iter; left time: 8171.5636s
	iters: 200, epoch: 2 | loss: 0.3536001
	speed: 0.1363s/iter; left time: 1729.5736s
Epoch: 2 cost time: 37.191880226135254
Epoch: 2, Steps: 263 | Train Loss: 0.2335294 Vali Loss: 0.1207589 Test Loss: 0.1706127
Validation loss decreased (0.129271 --> 0.120759).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3541869
	speed: 0.6372s/iter; left time: 7980.4327s
	iters: 200, epoch: 3 | loss: 0.2260457
	speed: 0.1403s/iter; left time: 1743.8126s
Epoch: 3 cost time: 37.85197877883911
Epoch: 3, Steps: 263 | Train Loss: 0.2215188 Vali Loss: 0.1182497 Test Loss: 0.1673492
Validation loss decreased (0.120759 --> 0.118250).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2389061
	speed: 0.6402s/iter; left time: 7850.4613s
	iters: 200, epoch: 4 | loss: 0.2469227
	speed: 0.1423s/iter; left time: 1730.2049s
Epoch: 4 cost time: 38.17529892921448
Epoch: 4, Steps: 263 | Train Loss: 0.2163702 Vali Loss: 0.1168921 Test Loss: 0.1658142
Validation loss decreased (0.118250 --> 0.116892).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1716973
	speed: 0.6135s/iter; left time: 7361.3569s
	iters: 200, epoch: 5 | loss: 0.2170883
	speed: 0.1386s/iter; left time: 1648.6823s
Epoch: 5 cost time: 36.601083517074585
Epoch: 5, Steps: 263 | Train Loss: 0.2133269 Vali Loss: 0.1161490 Test Loss: 0.1650039
Validation loss decreased (0.116892 --> 0.116149).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2688049
	speed: 0.6063s/iter; left time: 7115.1889s
	iters: 200, epoch: 6 | loss: 0.2387384
	speed: 0.1028s/iter; left time: 1195.7098s
Epoch: 6 cost time: 30.131641626358032
Epoch: 6, Steps: 263 | Train Loss: 0.2120648 Vali Loss: 0.1157352 Test Loss: 0.1645001
Validation loss decreased (0.116149 --> 0.115735).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2738350
	speed: 0.4405s/iter; left time: 5053.9817s
	iters: 200, epoch: 7 | loss: 0.1784056
	speed: 0.1278s/iter; left time: 1453.8565s
Epoch: 7 cost time: 33.41217398643494
Epoch: 7, Steps: 263 | Train Loss: 0.2111313 Vali Loss: 0.1155553 Test Loss: 0.1639952
Validation loss decreased (0.115735 --> 0.115555).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1714229
	speed: 0.6377s/iter; left time: 7149.0187s
	iters: 200, epoch: 8 | loss: 0.1712838
	speed: 0.1063s/iter; left time: 1180.5538s
Epoch: 8 cost time: 29.078798532485962
Epoch: 8, Steps: 263 | Train Loss: 0.2103356 Vali Loss: 0.1152379 Test Loss: 0.1636366
Validation loss decreased (0.115555 --> 0.115238).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1720786
	speed: 0.6353s/iter; left time: 6954.1848s
	iters: 200, epoch: 9 | loss: 0.4009768
	speed: 0.1389s/iter; left time: 1506.4754s
Epoch: 9 cost time: 37.67851638793945
Epoch: 9, Steps: 263 | Train Loss: 0.2095033 Vali Loss: 0.1153924 Test Loss: 0.1635993
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2184340
	speed: 0.6510s/iter; left time: 6955.3722s
	iters: 200, epoch: 10 | loss: 0.1909791
	speed: 0.1380s/iter; left time: 1460.1046s
Epoch: 10 cost time: 37.158504009246826
Epoch: 10, Steps: 263 | Train Loss: 0.2090051 Vali Loss: 0.1153962 Test Loss: 0.1637267
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3061223
	speed: 0.4295s/iter; left time: 4475.8940s
	iters: 200, epoch: 11 | loss: 0.2258008
	speed: 0.1070s/iter; left time: 1104.2338s
Epoch: 11 cost time: 29.109139919281006
Epoch: 11, Steps: 263 | Train Loss: 0.2085754 Vali Loss: 0.1147788 Test Loss: 0.1629901
Validation loss decreased (0.115238 --> 0.114779).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2028342
	speed: 0.6616s/iter; left time: 6720.8828s
	iters: 200, epoch: 12 | loss: 0.2332899
	speed: 0.1397s/iter; left time: 1404.6973s
Epoch: 12 cost time: 38.19969630241394
Epoch: 12, Steps: 263 | Train Loss: 0.2081903 Vali Loss: 0.1148113 Test Loss: 0.1629025
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2132727
	speed: 0.6289s/iter; left time: 6222.5591s
	iters: 200, epoch: 13 | loss: 0.1540162
	speed: 0.1296s/iter; left time: 1269.1769s
Epoch: 13 cost time: 33.20672416687012
Epoch: 13, Steps: 263 | Train Loss: 0.2079442 Vali Loss: 0.1148353 Test Loss: 0.1628588
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3106886
	speed: 0.5284s/iter; left time: 5089.4247s
	iters: 200, epoch: 14 | loss: 0.3080576
	speed: 0.1253s/iter; left time: 1194.6830s
Epoch: 14 cost time: 33.96441841125488
Epoch: 14, Steps: 263 | Train Loss: 0.2078495 Vali Loss: 0.1145835 Test Loss: 0.1626210
Validation loss decreased (0.114779 --> 0.114584).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1666662
	speed: 0.5479s/iter; left time: 5133.6949s
	iters: 200, epoch: 15 | loss: 0.1622896
	speed: 0.1194s/iter; left time: 1106.3176s
Epoch: 15 cost time: 32.757975339889526
Epoch: 15, Steps: 263 | Train Loss: 0.2074308 Vali Loss: 0.1145488 Test Loss: 0.1625225
Validation loss decreased (0.114584 --> 0.114549).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2522427
	speed: 0.5804s/iter; left time: 5285.5366s
	iters: 200, epoch: 16 | loss: 0.2042506
	speed: 0.1233s/iter; left time: 1110.5420s
Epoch: 16 cost time: 33.8756320476532
Epoch: 16, Steps: 263 | Train Loss: 0.2074853 Vali Loss: 0.1144457 Test Loss: 0.1626145
Validation loss decreased (0.114549 --> 0.114446).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2279487
	speed: 0.5927s/iter; left time: 5241.1540s
	iters: 200, epoch: 17 | loss: 0.1497678
	speed: 0.1260s/iter; left time: 1101.9507s
Epoch: 17 cost time: 34.18981909751892
Epoch: 17, Steps: 263 | Train Loss: 0.2072560 Vali Loss: 0.1144723 Test Loss: 0.1626935
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2461797
	speed: 0.5707s/iter; left time: 4896.4437s
	iters: 200, epoch: 18 | loss: 0.1963690
	speed: 0.1239s/iter; left time: 1050.8341s
Epoch: 18 cost time: 32.360065937042236
Epoch: 18, Steps: 263 | Train Loss: 0.2067782 Vali Loss: 0.1146013 Test Loss: 0.1626185
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2916547
	speed: 0.4806s/iter; left time: 3997.3486s
	iters: 200, epoch: 19 | loss: 0.2177833
	speed: 0.1131s/iter; left time: 929.4287s
Epoch: 19 cost time: 30.2549090385437
Epoch: 19, Steps: 263 | Train Loss: 0.2066895 Vali Loss: 0.1145220 Test Loss: 0.1624793
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16310614347457886, mae:0.25411292910575867, rse:0.32743969559669495, corr:[0.5681679  0.57022357 0.5663009  0.56474066 0.5658202  0.5670686
 0.5666415  0.56524175 0.56437385 0.5645678  0.5652181  0.5653812
 0.56486654 0.56417257 0.5638332  0.56376904 0.5635709  0.5629283
 0.5620257  0.5612713  0.5609036  0.560703   0.56028384 0.55946815
 0.55850184 0.55780184 0.5574983  0.5573153  0.55686826 0.5560668
 0.55512655 0.55446965 0.5541251  0.5538126  0.55331624 0.55262756
 0.5518624  0.55120873 0.55064243 0.55004984 0.5493457  0.54853404
 0.54779047 0.54727495 0.54695475 0.5465379  0.5458247  0.544833
 0.5436802  0.54264504 0.5419335  0.54152054 0.5410308  0.5402009
 0.53913265 0.53817755 0.5375089  0.5371416  0.53685296 0.5364095
 0.5357912  0.5352904  0.53504944 0.53502095 0.5349946  0.53482157
 0.5343283  0.5336771  0.5331102  0.5327435  0.5325241  0.5323278
 0.53208864 0.5318839  0.5316463  0.5313267  0.53080523 0.53012305
 0.5294754  0.5291651  0.5288243  0.52812463 0.52687204 0.52542984
 0.52451015 0.5244601  0.52447224 0.523748   0.5222428  0.52097714
 0.52123994 0.52232575 0.5221054  0.5204079  0.5198183  0.5234356 ]
