Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=90, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=90, out_features=102, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4112640.0
params:  9282.0
Trainable parameters:  9282
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2480556
	speed: 0.1264s/iter; left time: 3319.0296s
	iters: 200, epoch: 1 | loss: 0.1347829
	speed: 0.1144s/iter; left time: 2991.3746s
	iters: 300, epoch: 1 | loss: 0.1655302
	speed: 0.1112s/iter; left time: 2896.0811s
	iters: 400, epoch: 1 | loss: 0.2306150
	speed: 0.1142s/iter; left time: 2962.3705s
	iters: 500, epoch: 1 | loss: 0.1804733
	speed: 0.1066s/iter; left time: 2755.7743s
Epoch: 1 cost time: 60.54176211357117
Epoch: 1, Steps: 527 | Train Loss: 0.2198082 Vali Loss: 0.1617097 Test Loss: 0.2108006
Validation loss decreased (inf --> 0.161710).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1298594
	speed: 0.8297s/iter; left time: 21344.4409s
	iters: 200, epoch: 2 | loss: 0.0805939
	speed: 0.1112s/iter; left time: 2848.6664s
	iters: 300, epoch: 2 | loss: 0.0647794
	speed: 0.1105s/iter; left time: 2820.8402s
	iters: 400, epoch: 2 | loss: 0.1066177
	speed: 0.1108s/iter; left time: 2817.4459s
	iters: 500, epoch: 2 | loss: 0.0740820
	speed: 0.1104s/iter; left time: 2796.4328s
Epoch: 2 cost time: 60.26622915267944
Epoch: 2, Steps: 527 | Train Loss: 0.1024538 Vali Loss: 0.1470755 Test Loss: 0.1945760
Validation loss decreased (0.161710 --> 0.147076).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.0560234
	speed: 0.8316s/iter; left time: 20952.6954s
	iters: 200, epoch: 3 | loss: 0.0703615
	speed: 0.1187s/iter; left time: 2978.8892s
	iters: 300, epoch: 3 | loss: 0.0497253
	speed: 0.1208s/iter; left time: 3018.4744s
	iters: 400, epoch: 3 | loss: 0.0518300
	speed: 0.1128s/iter; left time: 2807.7568s
	iters: 500, epoch: 3 | loss: 0.0745864
	speed: 0.1011s/iter; left time: 2505.9850s
Epoch: 3 cost time: 62.10991835594177
Epoch: 3, Steps: 527 | Train Loss: 0.0667544 Vali Loss: 0.1346189 Test Loss: 0.1818005
Validation loss decreased (0.147076 --> 0.134619).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.0434333
	speed: 0.7541s/iter; left time: 18603.3799s
	iters: 200, epoch: 4 | loss: 0.0645165
	speed: 0.1122s/iter; left time: 2756.8395s
	iters: 300, epoch: 4 | loss: 0.0471423
	speed: 0.1077s/iter; left time: 2634.5138s
	iters: 400, epoch: 4 | loss: 0.0410568
	speed: 0.1061s/iter; left time: 2585.8027s
	iters: 500, epoch: 4 | loss: 0.0359038
	speed: 0.1093s/iter; left time: 2653.1084s
Epoch: 4 cost time: 58.68994069099426
Epoch: 4, Steps: 527 | Train Loss: 0.0505670 Vali Loss: 0.1276080 Test Loss: 0.1747577
Validation loss decreased (0.134619 --> 0.127608).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0449357
	speed: 0.7466s/iter; left time: 18025.2872s
	iters: 200, epoch: 5 | loss: 0.0376022
	speed: 0.1113s/iter; left time: 2675.4083s
	iters: 300, epoch: 5 | loss: 0.0342237
	speed: 0.1096s/iter; left time: 2623.3580s
	iters: 400, epoch: 5 | loss: 0.0368705
	speed: 0.1133s/iter; left time: 2701.3939s
	iters: 500, epoch: 5 | loss: 0.0420619
	speed: 0.1182s/iter; left time: 2807.4766s
Epoch: 5 cost time: 62.232847690582275
Epoch: 5, Steps: 527 | Train Loss: 0.0431747 Vali Loss: 0.1234628 Test Loss: 0.1710133
Validation loss decreased (0.127608 --> 0.123463).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0362917
	speed: 0.7482s/iter; left time: 17670.0040s
	iters: 200, epoch: 6 | loss: 0.0430234
	speed: 0.1154s/iter; left time: 2712.8929s
	iters: 300, epoch: 6 | loss: 0.0590522
	speed: 0.1169s/iter; left time: 2736.3263s
	iters: 400, epoch: 6 | loss: 0.0293631
	speed: 0.1147s/iter; left time: 2673.7781s
	iters: 500, epoch: 6 | loss: 0.0325529
	speed: 0.1178s/iter; left time: 2735.8035s
Epoch: 6 cost time: 59.23725390434265
Epoch: 6, Steps: 527 | Train Loss: 0.0400737 Vali Loss: 0.1216047 Test Loss: 0.1701516
Validation loss decreased (0.123463 --> 0.121605).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0613561
	speed: 0.7443s/iter; left time: 17185.5059s
	iters: 200, epoch: 7 | loss: 0.0336465
	speed: 0.1164s/iter; left time: 2676.1230s
	iters: 300, epoch: 7 | loss: 0.0326978
	speed: 0.1137s/iter; left time: 2603.5912s
	iters: 400, epoch: 7 | loss: 0.0303281
	speed: 0.1101s/iter; left time: 2509.5020s
	iters: 500, epoch: 7 | loss: 0.0323742
	speed: 0.1047s/iter; left time: 2376.5185s
Epoch: 7 cost time: 59.33726620674133
Epoch: 7, Steps: 527 | Train Loss: 0.0388948 Vali Loss: 0.1203522 Test Loss: 0.1690812
Validation loss decreased (0.121605 --> 0.120352).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0435738
	speed: 0.8116s/iter; left time: 18311.1058s
	iters: 200, epoch: 8 | loss: 0.0311092
	speed: 0.1269s/iter; left time: 2850.3297s
	iters: 300, epoch: 8 | loss: 0.0356405
	speed: 0.1286s/iter; left time: 2874.9057s
	iters: 400, epoch: 8 | loss: 0.0470670
	speed: 0.1186s/iter; left time: 2640.9254s
	iters: 500, epoch: 8 | loss: 0.0270883
	speed: 0.1203s/iter; left time: 2666.9338s
Epoch: 8 cost time: 65.31139922142029
Epoch: 8, Steps: 527 | Train Loss: 0.0385128 Vali Loss: 0.1193924 Test Loss: 0.1687205
Validation loss decreased (0.120352 --> 0.119392).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0496497
	speed: 0.6854s/iter; left time: 15102.8313s
	iters: 200, epoch: 9 | loss: 0.0301524
	speed: 0.1063s/iter; left time: 2332.4901s
	iters: 300, epoch: 9 | loss: 0.0344139
	speed: 0.1094s/iter; left time: 2389.7403s
	iters: 400, epoch: 9 | loss: 0.0383050
	speed: 0.1018s/iter; left time: 2211.8324s
	iters: 500, epoch: 9 | loss: 0.0322566
	speed: 0.1052s/iter; left time: 2276.1532s
Epoch: 9 cost time: 53.314924478530884
Epoch: 9, Steps: 527 | Train Loss: 0.0384180 Vali Loss: 0.1196695 Test Loss: 0.1685005
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0435024
	speed: 0.7510s/iter; left time: 16152.6316s
	iters: 200, epoch: 10 | loss: 0.0486907
	speed: 0.0961s/iter; left time: 2057.8400s
	iters: 300, epoch: 10 | loss: 0.0386517
	speed: 0.0891s/iter; left time: 1898.0897s
	iters: 400, epoch: 10 | loss: 0.0371744
	speed: 0.1055s/iter; left time: 2237.6751s
	iters: 500, epoch: 10 | loss: 0.0292202
	speed: 0.1119s/iter; left time: 2362.8168s
Epoch: 10 cost time: 56.3532497882843
Epoch: 10, Steps: 527 | Train Loss: 0.0384003 Vali Loss: 0.1194013 Test Loss: 0.1684012
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0520243
	speed: 0.6759s/iter; left time: 14181.1746s
	iters: 200, epoch: 11 | loss: 0.0470411
	speed: 0.0977s/iter; left time: 2039.8183s
	iters: 300, epoch: 11 | loss: 0.0646275
	speed: 0.1008s/iter; left time: 2094.7917s
	iters: 400, epoch: 11 | loss: 0.0510083
	speed: 0.0933s/iter; left time: 1929.2281s
	iters: 500, epoch: 11 | loss: 0.0379689
	speed: 0.1084s/iter; left time: 2231.2841s
Epoch: 11 cost time: 52.13434314727783
Epoch: 11, Steps: 527 | Train Loss: 0.0383856 Vali Loss: 0.1195295 Test Loss: 0.1691948
EarlyStopping counter: 3 out of 3
Early stopping
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=90, out_features=102, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4112640.0
params:  9282.0
Trainable parameters:  9282
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2676069
	speed: 0.0961s/iter; left time: 2522.3293s
	iters: 200, epoch: 1 | loss: 0.2862259
	speed: 0.1212s/iter; left time: 3169.4032s
	iters: 300, epoch: 1 | loss: 0.3706726
	speed: 0.0987s/iter; left time: 2572.2247s
	iters: 400, epoch: 1 | loss: 0.1337716
	speed: 0.0897s/iter; left time: 2326.9277s
	iters: 500, epoch: 1 | loss: 0.3676531
	speed: 0.1097s/iter; left time: 2835.5044s
Epoch: 1 cost time: 54.422993183135986
Epoch: 1, Steps: 527 | Train Loss: 0.2137273 Vali Loss: 0.1157582 Test Loss: 0.1651568
Validation loss decreased (inf --> 0.115758).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3592711
	speed: 0.7156s/iter; left time: 18408.4037s
	iters: 200, epoch: 2 | loss: 0.2475214
	speed: 0.1012s/iter; left time: 2592.0578s
	iters: 300, epoch: 2 | loss: 0.1928843
	speed: 0.1166s/iter; left time: 2975.1908s
	iters: 400, epoch: 2 | loss: 0.2160538
	speed: 0.1074s/iter; left time: 2729.7226s
	iters: 500, epoch: 2 | loss: 0.2750046
	speed: 0.1155s/iter; left time: 2924.7753s
Epoch: 2 cost time: 60.18128252029419
Epoch: 2, Steps: 527 | Train Loss: 0.2105018 Vali Loss: 0.1161524 Test Loss: 0.1642114
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1891423
	speed: 0.8964s/iter; left time: 22586.3528s
	iters: 200, epoch: 3 | loss: 0.2061897
	speed: 0.1223s/iter; left time: 3069.4633s
	iters: 300, epoch: 3 | loss: 0.1472311
	speed: 0.1244s/iter; left time: 3108.4785s
	iters: 400, epoch: 3 | loss: 0.2391148
	speed: 0.1193s/iter; left time: 2970.8280s
	iters: 500, epoch: 3 | loss: 0.2126645
	speed: 0.1160s/iter; left time: 2875.4546s
Epoch: 3 cost time: 64.1251871585846
Epoch: 3, Steps: 527 | Train Loss: 0.2092573 Vali Loss: 0.1158270 Test Loss: 0.1638498
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1340958
	speed: 0.7243s/iter; left time: 17867.5220s
	iters: 200, epoch: 4 | loss: 0.2058853
	speed: 0.1001s/iter; left time: 2460.0222s
	iters: 300, epoch: 4 | loss: 0.2586006
	speed: 0.1043s/iter; left time: 2552.7403s
	iters: 400, epoch: 4 | loss: 0.2701625
	speed: 0.1106s/iter; left time: 2696.1000s
	iters: 500, epoch: 4 | loss: 0.2261264
	speed: 0.1005s/iter; left time: 2438.2794s
Epoch: 4 cost time: 54.61801743507385
Epoch: 4, Steps: 527 | Train Loss: 0.2087300 Vali Loss: 0.1154405 Test Loss: 0.1637741
Validation loss decreased (0.115758 --> 0.115441).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2870188
	speed: 0.6390s/iter; left time: 15427.0257s
	iters: 200, epoch: 5 | loss: 0.1968814
	speed: 0.0490s/iter; left time: 1177.8123s
	iters: 300, epoch: 5 | loss: 0.2485639
	speed: 0.1241s/iter; left time: 2970.3551s
	iters: 400, epoch: 5 | loss: 0.1717689
	speed: 0.1256s/iter; left time: 2994.4207s
	iters: 500, epoch: 5 | loss: 0.1425709
	speed: 0.0973s/iter; left time: 2309.1607s
Epoch: 5 cost time: 48.51884412765503
Epoch: 5, Steps: 527 | Train Loss: 0.2083635 Vali Loss: 0.1153472 Test Loss: 0.1634306
Validation loss decreased (0.115441 --> 0.115347).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1851394
	speed: 0.6402s/iter; left time: 15118.6097s
	iters: 200, epoch: 6 | loss: 0.3718749
	speed: 0.1137s/iter; left time: 2672.7743s
	iters: 300, epoch: 6 | loss: 0.1611766
	speed: 0.0954s/iter; left time: 2233.6739s
	iters: 400, epoch: 6 | loss: 0.2841843
	speed: 0.1051s/iter; left time: 2451.3573s
	iters: 500, epoch: 6 | loss: 0.2753310
	speed: 0.1037s/iter; left time: 2406.4050s
Epoch: 6 cost time: 56.62075471878052
Epoch: 6, Steps: 527 | Train Loss: 0.2080616 Vali Loss: 0.1151535 Test Loss: 0.1629164
Validation loss decreased (0.115347 --> 0.115154).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2216216
	speed: 0.7821s/iter; left time: 18057.9235s
	iters: 200, epoch: 7 | loss: 0.2552040
	speed: 0.1023s/iter; left time: 2352.2177s
	iters: 300, epoch: 7 | loss: 0.2908223
	speed: 0.0938s/iter; left time: 2146.7883s
	iters: 400, epoch: 7 | loss: 0.2058995
	speed: 0.1037s/iter; left time: 2362.4335s
	iters: 500, epoch: 7 | loss: 0.1944971
	speed: 0.0982s/iter; left time: 2228.0265s
Epoch: 7 cost time: 55.505653619766235
Epoch: 7, Steps: 527 | Train Loss: 0.2078931 Vali Loss: 0.1152096 Test Loss: 0.1633691
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1439276
	speed: 0.8012s/iter; left time: 18076.8252s
	iters: 200, epoch: 8 | loss: 0.1825053
	speed: 0.1227s/iter; left time: 2756.9221s
	iters: 300, epoch: 8 | loss: 0.2030714
	speed: 0.1167s/iter; left time: 2608.9534s
	iters: 400, epoch: 8 | loss: 0.1889379
	speed: 0.1336s/iter; left time: 2974.3955s
	iters: 500, epoch: 8 | loss: 0.2076817
	speed: 0.1154s/iter; left time: 2556.7181s
Epoch: 8 cost time: 64.13884568214417
Epoch: 8, Steps: 527 | Train Loss: 0.2077431 Vali Loss: 0.1151150 Test Loss: 0.1631115
Validation loss decreased (0.115154 --> 0.115115).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1964751
	speed: 0.8950s/iter; left time: 19722.0554s
	iters: 200, epoch: 9 | loss: 0.1605786
	speed: 0.1116s/iter; left time: 2447.6391s
	iters: 300, epoch: 9 | loss: 0.1573685
	speed: 0.1108s/iter; left time: 2419.2634s
	iters: 400, epoch: 9 | loss: 0.2558414
	speed: 0.1068s/iter; left time: 2320.6049s
	iters: 500, epoch: 9 | loss: 0.2703446
	speed: 0.1145s/iter; left time: 2477.9254s
Epoch: 9 cost time: 61.96122360229492
Epoch: 9, Steps: 527 | Train Loss: 0.2076964 Vali Loss: 0.1154978 Test Loss: 0.1631111
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2511170
	speed: 0.7793s/iter; left time: 16761.5217s
	iters: 200, epoch: 10 | loss: 0.1452312
	speed: 0.1188s/iter; left time: 2542.8180s
	iters: 300, epoch: 10 | loss: 0.1626504
	speed: 0.1207s/iter; left time: 2571.9801s
	iters: 400, epoch: 10 | loss: 0.2132875
	speed: 0.1086s/iter; left time: 2303.7723s
	iters: 500, epoch: 10 | loss: 0.2518071
	speed: 0.0915s/iter; left time: 1932.0556s
Epoch: 10 cost time: 59.421637296676636
Epoch: 10, Steps: 527 | Train Loss: 0.2075803 Vali Loss: 0.1153198 Test Loss: 0.1634934
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2279593
	speed: 0.9071s/iter; left time: 19031.8914s
	iters: 200, epoch: 11 | loss: 0.4020463
	speed: 0.1241s/iter; left time: 2591.5086s
	iters: 300, epoch: 11 | loss: 0.5129746
	speed: 0.1250s/iter; left time: 2597.9391s
	iters: 400, epoch: 11 | loss: 0.1381617
	speed: 0.1164s/iter; left time: 2406.4212s
	iters: 500, epoch: 11 | loss: 0.1317527
	speed: 0.1122s/iter; left time: 2309.3627s
Epoch: 11 cost time: 64.52236151695251
Epoch: 11, Steps: 527 | Train Loss: 0.2074841 Vali Loss: 0.1153578 Test Loss: 0.1631692
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.1632625013589859, mae:0.25413230061531067, rse:0.32759660482406616, corr:[0.5694174  0.57081246 0.5697832  0.5678161  0.5664143  0.5659869
 0.5661344  0.5661941  0.56576425 0.564939   0.5640894  0.5635275
 0.56336784 0.56343216 0.5634674  0.56314504 0.56246066 0.56154877
 0.5606092  0.5597852  0.5591598  0.55864936 0.55818236 0.5576917
 0.5571223  0.55652195 0.55595803 0.5554483  0.55497587 0.55455536
 0.5541428  0.55381745 0.5535305  0.55315316 0.55265784 0.5520725
 0.5513677  0.5505588  0.549664   0.5487681  0.5479468  0.54724467
 0.5467008  0.54629004 0.5459417  0.54549664 0.5448872  0.5441471
 0.5432498  0.54225904 0.5413235  0.5405833  0.53996426 0.53932095
 0.5385751  0.5377958  0.5369942  0.5362211  0.5355723  0.5351397
 0.5348568  0.5346887  0.5345252  0.5342891  0.5339844  0.53378886
 0.5337035  0.5337333  0.5337743  0.53366005 0.5333149  0.5327715
 0.53213066 0.53157735 0.53117913 0.53092813 0.5306414  0.5301674
 0.5294815  0.5288223  0.52823055 0.5278315  0.5274774  0.5269445
 0.52613884 0.5251617  0.52410525 0.523386   0.523335   0.52376586
 0.52414185 0.5240292  0.5231494  0.5219076  0.52155113 0.5227124 ]
