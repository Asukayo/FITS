Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=90, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=90, out_features=102, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  8225280.0
params:  9282.0
Trainable parameters:  9282
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2680306
	speed: 0.1142s/iter; left time: 1490.2969s
	iters: 200, epoch: 1 | loss: 0.1873581
	speed: 0.1016s/iter; left time: 1315.5657s
Epoch: 1 cost time: 29.211102962493896
Epoch: 1, Steps: 263 | Train Loss: 0.2739913 Vali Loss: 0.1778555 Test Loss: 0.2308164
Validation loss decreased (inf --> 0.177856).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1981184
	speed: 0.5521s/iter; left time: 7059.7461s
	iters: 200, epoch: 2 | loss: 0.1742990
	speed: 0.1179s/iter; left time: 1495.5055s
Epoch: 2 cost time: 31.44050431251526
Epoch: 2, Steps: 263 | Train Loss: 0.1577844 Vali Loss: 0.1644604 Test Loss: 0.2129230
Validation loss decreased (0.177856 --> 0.164460).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1310542
	speed: 0.4547s/iter; left time: 5695.3208s
	iters: 200, epoch: 3 | loss: 0.1126056
	speed: 0.1028s/iter; left time: 1277.2745s
Epoch: 3 cost time: 25.92221975326538
Epoch: 3, Steps: 263 | Train Loss: 0.1142339 Vali Loss: 0.1556610 Test Loss: 0.2032291
Validation loss decreased (0.164460 --> 0.155661).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.0820302
	speed: 0.4879s/iter; left time: 5982.1849s
	iters: 200, epoch: 4 | loss: 0.0827326
	speed: 0.1545s/iter; left time: 1879.3257s
Epoch: 4 cost time: 37.25333881378174
Epoch: 4, Steps: 263 | Train Loss: 0.0897362 Vali Loss: 0.1477593 Test Loss: 0.1948382
Validation loss decreased (0.155661 --> 0.147759).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0789466
	speed: 0.7830s/iter; left time: 9395.1129s
	iters: 200, epoch: 5 | loss: 0.0656370
	speed: 0.1718s/iter; left time: 2044.2089s
Epoch: 5 cost time: 45.61306309700012
Epoch: 5, Steps: 263 | Train Loss: 0.0737639 Vali Loss: 0.1411825 Test Loss: 0.1880279
Validation loss decreased (0.147759 --> 0.141183).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0644613
	speed: 0.7965s/iter; left time: 9348.1849s
	iters: 200, epoch: 6 | loss: 0.0547016
	speed: 0.1764s/iter; left time: 2052.2113s
Epoch: 6 cost time: 47.05476760864258
Epoch: 6, Steps: 263 | Train Loss: 0.0627371 Vali Loss: 0.1356332 Test Loss: 0.1824154
Validation loss decreased (0.141183 --> 0.135633).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0641863
	speed: 0.8284s/iter; left time: 9504.6133s
	iters: 200, epoch: 7 | loss: 0.0436153
	speed: 0.1757s/iter; left time: 1998.5185s
Epoch: 7 cost time: 47.771912813186646
Epoch: 7, Steps: 263 | Train Loss: 0.0551174 Vali Loss: 0.1317027 Test Loss: 0.1785233
Validation loss decreased (0.135633 --> 0.131703).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0426843
	speed: 0.7555s/iter; left time: 8468.9373s
	iters: 200, epoch: 8 | loss: 0.0524582
	speed: 0.1680s/iter; left time: 1866.6045s
Epoch: 8 cost time: 40.779224157333374
Epoch: 8, Steps: 263 | Train Loss: 0.0497493 Vali Loss: 0.1287209 Test Loss: 0.1755424
Validation loss decreased (0.131703 --> 0.128721).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0409490
	speed: 0.7274s/iter; left time: 7963.3083s
	iters: 200, epoch: 9 | loss: 0.0482304
	speed: 0.1624s/iter; left time: 1761.5364s
Epoch: 9 cost time: 45.54068875312805
Epoch: 9, Steps: 263 | Train Loss: 0.0460253 Vali Loss: 0.1261695 Test Loss: 0.1732656
Validation loss decreased (0.128721 --> 0.126170).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0424980
	speed: 0.7676s/iter; left time: 8201.4832s
	iters: 200, epoch: 10 | loss: 0.0436981
	speed: 0.1785s/iter; left time: 1889.4456s
Epoch: 10 cost time: 45.98912692070007
Epoch: 10, Steps: 263 | Train Loss: 0.0434550 Vali Loss: 0.1244434 Test Loss: 0.1717764
Validation loss decreased (0.126170 --> 0.124443).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0406604
	speed: 0.7893s/iter; left time: 8225.8097s
	iters: 200, epoch: 11 | loss: 0.0413009
	speed: 0.1696s/iter; left time: 1750.1833s
Epoch: 11 cost time: 45.70566654205322
Epoch: 11, Steps: 263 | Train Loss: 0.0416673 Vali Loss: 0.1232880 Test Loss: 0.1709641
Validation loss decreased (0.124443 --> 0.123288).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0490095
	speed: 0.8025s/iter; left time: 8151.3230s
	iters: 200, epoch: 12 | loss: 0.0312425
	speed: 0.1751s/iter; left time: 1761.2878s
Epoch: 12 cost time: 48.087660789489746
Epoch: 12, Steps: 263 | Train Loss: 0.0405050 Vali Loss: 0.1220217 Test Loss: 0.1699408
Validation loss decreased (0.123288 --> 0.122022).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0372838
	speed: 0.8488s/iter; left time: 8399.3213s
	iters: 200, epoch: 13 | loss: 0.0329955
	speed: 0.1951s/iter; left time: 1910.7791s
Epoch: 13 cost time: 52.01750683784485
Epoch: 13, Steps: 263 | Train Loss: 0.0397170 Vali Loss: 0.1215608 Test Loss: 0.1695202
Validation loss decreased (0.122022 --> 0.121561).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0369097
	speed: 0.7332s/iter; left time: 7062.5567s
	iters: 200, epoch: 14 | loss: 0.0468186
	speed: 0.1667s/iter; left time: 1589.4457s
Epoch: 14 cost time: 42.54090976715088
Epoch: 14, Steps: 263 | Train Loss: 0.0392065 Vali Loss: 0.1209604 Test Loss: 0.1691681
Validation loss decreased (0.121561 --> 0.120960).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0338938
	speed: 0.7201s/iter; left time: 6746.9070s
	iters: 200, epoch: 15 | loss: 0.0437955
	speed: 0.1440s/iter; left time: 1335.1448s
Epoch: 15 cost time: 40.381242752075195
Epoch: 15, Steps: 263 | Train Loss: 0.0388099 Vali Loss: 0.1203514 Test Loss: 0.1687971
Validation loss decreased (0.120960 --> 0.120351).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0473507
	speed: 0.7689s/iter; left time: 7001.5698s
	iters: 200, epoch: 16 | loss: 0.0361418
	speed: 0.1717s/iter; left time: 1546.3060s
Epoch: 16 cost time: 46.743069648742676
Epoch: 16, Steps: 263 | Train Loss: 0.0386457 Vali Loss: 0.1200362 Test Loss: 0.1686828
Validation loss decreased (0.120351 --> 0.120036).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0526348
	speed: 0.7452s/iter; left time: 6589.3956s
	iters: 200, epoch: 17 | loss: 0.0389867
	speed: 0.1598s/iter; left time: 1397.4845s
Epoch: 17 cost time: 42.82864499092102
Epoch: 17, Steps: 263 | Train Loss: 0.0385218 Vali Loss: 0.1197893 Test Loss: 0.1683420
Validation loss decreased (0.120036 --> 0.119789).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0419887
	speed: 0.6793s/iter; left time: 5828.5845s
	iters: 200, epoch: 18 | loss: 0.0366814
	speed: 0.1417s/iter; left time: 1201.5372s
Epoch: 18 cost time: 40.14731526374817
Epoch: 18, Steps: 263 | Train Loss: 0.0384333 Vali Loss: 0.1196274 Test Loss: 0.1685446
Validation loss decreased (0.119789 --> 0.119627).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0333413
	speed: 0.7077s/iter; left time: 5885.7254s
	iters: 200, epoch: 19 | loss: 0.0512014
	speed: 0.1497s/iter; left time: 1229.6749s
Epoch: 19 cost time: 40.082865476608276
Epoch: 19, Steps: 263 | Train Loss: 0.0383754 Vali Loss: 0.1194974 Test Loss: 0.1683164
Validation loss decreased (0.119627 --> 0.119497).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0331787
	speed: 0.6971s/iter; left time: 5614.4249s
	iters: 200, epoch: 20 | loss: 0.0385951
	speed: 0.1563s/iter; left time: 1242.8609s
Epoch: 20 cost time: 42.95486807823181
Epoch: 20, Steps: 263 | Train Loss: 0.0383586 Vali Loss: 0.1195771 Test Loss: 0.1683318
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0333458
	speed: 0.7435s/iter; left time: 5792.9610s
	iters: 200, epoch: 21 | loss: 0.0452441
	speed: 0.1652s/iter; left time: 1270.8445s
Epoch: 21 cost time: 44.19162154197693
Epoch: 21, Steps: 263 | Train Loss: 0.0383545 Vali Loss: 0.1194500 Test Loss: 0.1683963
Validation loss decreased (0.119497 --> 0.119450).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0444571
	speed: 0.6918s/iter; left time: 5207.6717s
	iters: 200, epoch: 22 | loss: 0.0266435
	speed: 0.1478s/iter; left time: 1097.6167s
Epoch: 22 cost time: 38.44304037094116
Epoch: 22, Steps: 263 | Train Loss: 0.0383425 Vali Loss: 0.1194278 Test Loss: 0.1683688
Validation loss decreased (0.119450 --> 0.119428).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0384160
	speed: 0.7283s/iter; left time: 5291.0633s
	iters: 200, epoch: 23 | loss: 0.0413876
	speed: 0.1733s/iter; left time: 1241.7533s
Epoch: 23 cost time: 46.312376976013184
Epoch: 23, Steps: 263 | Train Loss: 0.0383218 Vali Loss: 0.1191734 Test Loss: 0.1682404
Validation loss decreased (0.119428 --> 0.119173).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0320702
	speed: 0.7486s/iter; left time: 5241.8855s
	iters: 200, epoch: 24 | loss: 0.0364224
	speed: 0.1481s/iter; left time: 1022.4351s
Epoch: 24 cost time: 40.89001536369324
Epoch: 24, Steps: 263 | Train Loss: 0.0383292 Vali Loss: 0.1192046 Test Loss: 0.1681969
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0319083
	speed: 0.6923s/iter; left time: 4665.7382s
	iters: 200, epoch: 25 | loss: 0.0473749
	speed: 0.1574s/iter; left time: 1044.7531s
Epoch: 25 cost time: 42.75215029716492
Epoch: 25, Steps: 263 | Train Loss: 0.0382948 Vali Loss: 0.1192308 Test Loss: 0.1682507
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0411152
	speed: 0.7232s/iter; left time: 4683.2687s
	iters: 200, epoch: 26 | loss: 0.0326428
	speed: 0.1532s/iter; left time: 976.5945s
Epoch: 26 cost time: 41.1853768825531
Epoch: 26, Steps: 263 | Train Loss: 0.0382915 Vali Loss: 0.1192682 Test Loss: 0.1682925
EarlyStopping counter: 3 out of 3
Early stopping
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=90, out_features=102, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  8225280.0
params:  9282.0
Trainable parameters:  9282
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2600294
	speed: 0.1699s/iter; left time: 2217.3857s
	iters: 200, epoch: 1 | loss: 0.2016162
	speed: 0.1634s/iter; left time: 2116.3110s
Epoch: 1 cost time: 43.55150651931763
Epoch: 1, Steps: 263 | Train Loss: 0.2141950 Vali Loss: 0.1157999 Test Loss: 0.1645492
Validation loss decreased (inf --> 0.115800).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1869411
	speed: 0.7614s/iter; left time: 9737.3714s
	iters: 200, epoch: 2 | loss: 0.2083448
	speed: 0.1641s/iter; left time: 2081.6278s
Epoch: 2 cost time: 43.94917678833008
Epoch: 2, Steps: 263 | Train Loss: 0.2112556 Vali Loss: 0.1157916 Test Loss: 0.1643078
Validation loss decreased (0.115800 --> 0.115792).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2109900
	speed: 0.6865s/iter; left time: 8598.1864s
	iters: 200, epoch: 3 | loss: 0.3582665
	speed: 0.1488s/iter; left time: 1849.0678s
Epoch: 3 cost time: 39.98139476776123
Epoch: 3, Steps: 263 | Train Loss: 0.2096283 Vali Loss: 0.1150414 Test Loss: 0.1633397
Validation loss decreased (0.115792 --> 0.115041).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1884403
	speed: 0.7215s/iter; left time: 8847.2840s
	iters: 200, epoch: 4 | loss: 0.1646028
	speed: 0.1633s/iter; left time: 1986.0929s
Epoch: 4 cost time: 43.11092972755432
Epoch: 4, Steps: 263 | Train Loss: 0.2092170 Vali Loss: 0.1153269 Test Loss: 0.1635902
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2015043
	speed: 0.7106s/iter; left time: 8526.9686s
	iters: 200, epoch: 5 | loss: 0.1541153
	speed: 0.1215s/iter; left time: 1445.6951s
Epoch: 5 cost time: 34.552358627319336
Epoch: 5, Steps: 263 | Train Loss: 0.2086418 Vali Loss: 0.1151545 Test Loss: 0.1630926
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1743743
	speed: 0.7132s/iter; left time: 8369.6819s
	iters: 200, epoch: 6 | loss: 0.1915235
	speed: 0.1548s/iter; left time: 1800.7664s
Epoch: 6 cost time: 42.63833498954773
Epoch: 6, Steps: 263 | Train Loss: 0.2082160 Vali Loss: 0.1153536 Test Loss: 0.1633023
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16376478970050812, mae:0.254863440990448, rse:0.32810014486312866, corr:[0.5678709  0.5708231  0.571257   0.5697115  0.5678922  0.5668884
 0.5667737  0.56709796 0.5673038  0.5670666  0.56642663 0.5656833
 0.56514955 0.56491643 0.56487703 0.56473726 0.5642992  0.5634882
 0.5624448  0.56138146 0.5605113  0.5598925  0.5594895  0.5591785
 0.5587914  0.5582568  0.55761987 0.5569582  0.5563442  0.5558311
 0.5553699  0.55494326 0.55443877 0.55374444 0.5528962  0.5520332
 0.5512453  0.5505965  0.55004936 0.5495367  0.54898894 0.54835606
 0.5476345  0.54685503 0.54608905 0.5453579  0.5446735  0.54401356
 0.5432497  0.5423349  0.54133207 0.5403949  0.539588   0.538904
 0.53826976 0.5376494  0.5369741  0.53625077 0.53555226 0.5349911
 0.53461957 0.53449756 0.5345107  0.534482   0.53429675 0.5340339
 0.53373605 0.5335499  0.53354603 0.53363323 0.53364617 0.5334456
 0.5329896  0.532376   0.53172    0.53121674 0.53090996 0.53071207
 0.5304442  0.53003806 0.52926385 0.5281665  0.5268438  0.52551055
 0.52441317 0.52373326 0.52329415 0.5229193  0.5223644  0.5214136
 0.5201559  0.51900864 0.5184439  0.5189457  0.5199291  0.51952595]
