Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=74, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=74, out_features=83, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  5503232.0
params:  6225.0
Trainable parameters:  6225
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.4859264
	speed: 0.1465s/iter; left time: 1912.5874s
	iters: 200, epoch: 1 | loss: 0.1859001
	speed: 0.1372s/iter; left time: 1777.3320s
Epoch: 1 cost time: 36.78003454208374
Epoch: 1, Steps: 263 | Train Loss: 0.3126883 Vali Loss: 0.1323639 Test Loss: 0.1820023
Validation loss decreased (inf --> 0.132364).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2859853
	speed: 0.6234s/iter; left time: 7971.7366s
	iters: 200, epoch: 2 | loss: 0.2310713
	speed: 0.1440s/iter; left time: 1826.9082s
Epoch: 2 cost time: 38.16902756690979
Epoch: 2, Steps: 263 | Train Loss: 0.2389451 Vali Loss: 0.1232259 Test Loss: 0.1723176
Validation loss decreased (0.132364 --> 0.123226).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1716570
	speed: 0.6710s/iter; left time: 8404.6533s
	iters: 200, epoch: 3 | loss: 0.1951519
	speed: 0.1519s/iter; left time: 1887.9173s
Epoch: 3 cost time: 39.98609972000122
Epoch: 3, Steps: 263 | Train Loss: 0.2255411 Vali Loss: 0.1199409 Test Loss: 0.1690293
Validation loss decreased (0.123226 --> 0.119941).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1637163
	speed: 0.7092s/iter; left time: 8696.0751s
	iters: 200, epoch: 4 | loss: 0.2657578
	speed: 0.1461s/iter; left time: 1777.0089s
Epoch: 4 cost time: 39.23202443122864
Epoch: 4, Steps: 263 | Train Loss: 0.2199283 Vali Loss: 0.1189752 Test Loss: 0.1677814
Validation loss decreased (0.119941 --> 0.118975).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1913109
	speed: 0.6835s/iter; left time: 8201.3532s
	iters: 200, epoch: 5 | loss: 0.2025103
	speed: 0.1469s/iter; left time: 1748.4879s
Epoch: 5 cost time: 39.882625102996826
Epoch: 5, Steps: 263 | Train Loss: 0.2173883 Vali Loss: 0.1184724 Test Loss: 0.1669398
Validation loss decreased (0.118975 --> 0.118472).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2054198
	speed: 0.6499s/iter; left time: 7627.0510s
	iters: 200, epoch: 6 | loss: 0.1415337
	speed: 0.1322s/iter; left time: 1538.0226s
Epoch: 6 cost time: 35.617053270339966
Epoch: 6, Steps: 263 | Train Loss: 0.2155103 Vali Loss: 0.1175784 Test Loss: 0.1662899
Validation loss decreased (0.118472 --> 0.117578).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2300943
	speed: 0.5956s/iter; left time: 6833.0165s
	iters: 200, epoch: 7 | loss: 0.2383932
	speed: 0.1290s/iter; left time: 1467.2007s
Epoch: 7 cost time: 35.34020280838013
Epoch: 7, Steps: 263 | Train Loss: 0.2143552 Vali Loss: 0.1174364 Test Loss: 0.1657785
Validation loss decreased (0.117578 --> 0.117436).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2055411
	speed: 0.5962s/iter; left time: 6682.8460s
	iters: 200, epoch: 8 | loss: 0.2144172
	speed: 0.1241s/iter; left time: 1378.3714s
Epoch: 8 cost time: 33.7578022480011
Epoch: 8, Steps: 263 | Train Loss: 0.2134136 Vali Loss: 0.1173480 Test Loss: 0.1654960
Validation loss decreased (0.117436 --> 0.117348).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3021418
	speed: 0.5996s/iter; left time: 6564.3341s
	iters: 200, epoch: 9 | loss: 0.1745183
	speed: 0.1349s/iter; left time: 1462.8486s
Epoch: 9 cost time: 37.43117666244507
Epoch: 9, Steps: 263 | Train Loss: 0.2124288 Vali Loss: 0.1170180 Test Loss: 0.1651630
Validation loss decreased (0.117348 --> 0.117018).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2047948
	speed: 0.6665s/iter; left time: 7121.0221s
	iters: 200, epoch: 10 | loss: 0.2028665
	speed: 0.1428s/iter; left time: 1511.1934s
Epoch: 10 cost time: 39.17766356468201
Epoch: 10, Steps: 263 | Train Loss: 0.2121419 Vali Loss: 0.1165699 Test Loss: 0.1645560
Validation loss decreased (0.117018 --> 0.116570).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1427584
	speed: 0.6654s/iter; left time: 6934.5865s
	iters: 200, epoch: 11 | loss: 0.1907389
	speed: 0.1280s/iter; left time: 1321.4096s
Epoch: 11 cost time: 35.859782218933105
Epoch: 11, Steps: 263 | Train Loss: 0.2116969 Vali Loss: 0.1168025 Test Loss: 0.1647517
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1635097
	speed: 0.5762s/iter; left time: 5853.0673s
	iters: 200, epoch: 12 | loss: 0.1423485
	speed: 0.1395s/iter; left time: 1403.0140s
Epoch: 12 cost time: 36.73109436035156
Epoch: 12, Steps: 263 | Train Loss: 0.2112026 Vali Loss: 0.1166458 Test Loss: 0.1644766
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1993036
	speed: 0.6113s/iter; left time: 6048.9209s
	iters: 200, epoch: 13 | loss: 0.2261190
	speed: 0.1316s/iter; left time: 1288.6813s
Epoch: 13 cost time: 35.25078010559082
Epoch: 13, Steps: 263 | Train Loss: 0.2108281 Vali Loss: 0.1165962 Test Loss: 0.1643275
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16505615413188934, mae:0.25593310594558716, rse:0.329391211271286, corr:[0.5603233  0.5662973  0.5691642  0.5686755  0.5668241  0.5652767
 0.56460786 0.5647448  0.56536    0.5660247  0.5663153  0.5660309
 0.56531185 0.5644407  0.56371427 0.56321836 0.5629732  0.56285745
 0.5627091  0.5623477  0.5617203  0.56084126 0.55987203 0.5589924
 0.5582792  0.5577645  0.5574201  0.55716306 0.5568785  0.5564871
 0.55592775 0.55529875 0.55464345 0.55395555 0.5532819  0.5526944
 0.55217516 0.55170006 0.5511882  0.5505898  0.5498822  0.549077
 0.5482137  0.5473488  0.54655725 0.5458597  0.5452776  0.54479283
 0.54423714 0.54348    0.5424889  0.541369   0.54020417 0.53909856
 0.5381504  0.5375046  0.5371514  0.5370098  0.53692925 0.536787
 0.53646725 0.53602284 0.53550106 0.5349674  0.5344922  0.5342073
 0.53405297 0.5340021  0.53398633 0.53387475 0.5335749  0.5330688
 0.53240514 0.53169864 0.53102446 0.53047466 0.53001714 0.5295421
 0.52892816 0.52820003 0.5272306  0.52615434 0.5251054  0.52425593
 0.52370226 0.5234012  0.5229773  0.52220696 0.5209636  0.5192955
 0.51760215 0.51653236 0.51645195 0.5172854  0.51769936 0.5154172 ]
