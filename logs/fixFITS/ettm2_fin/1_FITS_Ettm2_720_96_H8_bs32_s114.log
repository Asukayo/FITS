Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=74, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=74, out_features=83, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2751616.0
params:  6225.0
Trainable parameters:  6225
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3676371
	speed: 0.1817s/iter; left time: 4768.8250s
	iters: 200, epoch: 1 | loss: 0.2241749
	speed: 0.1819s/iter; left time: 4756.2544s
	iters: 300, epoch: 1 | loss: 0.1678271
	speed: 0.1768s/iter; left time: 4605.0406s
	iters: 400, epoch: 1 | loss: 0.2999711
	speed: 0.1798s/iter; left time: 4665.8349s
	iters: 500, epoch: 1 | loss: 0.2244317
	speed: 0.1689s/iter; left time: 4366.2043s
Epoch: 1 cost time: 93.75203013420105
Epoch: 1, Steps: 527 | Train Loss: 0.2805362 Vali Loss: 0.1250664 Test Loss: 0.1753712
Validation loss decreased (inf --> 0.125066).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2666608
	speed: 1.2097s/iter; left time: 31117.6274s
	iters: 200, epoch: 2 | loss: 0.1303581
	speed: 0.1668s/iter; left time: 4274.4568s
	iters: 300, epoch: 2 | loss: 0.2016584
	speed: 0.1647s/iter; left time: 4203.5818s
	iters: 400, epoch: 2 | loss: 0.1924460
	speed: 0.1715s/iter; left time: 4359.2452s
	iters: 500, epoch: 2 | loss: 0.2810403
	speed: 0.1642s/iter; left time: 4157.8537s
Epoch: 2 cost time: 89.04295086860657
Epoch: 2, Steps: 527 | Train Loss: 0.2259313 Vali Loss: 0.1193608 Test Loss: 0.1687031
Validation loss decreased (0.125066 --> 0.119361).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2777613
	speed: 1.1845s/iter; left time: 29845.5627s
	iters: 200, epoch: 3 | loss: 0.3379513
	speed: 0.1663s/iter; left time: 4172.9732s
	iters: 300, epoch: 3 | loss: 0.2360611
	speed: 0.1716s/iter; left time: 4290.7298s
	iters: 400, epoch: 3 | loss: 0.1226224
	speed: 0.1709s/iter; left time: 4255.9955s
	iters: 500, epoch: 3 | loss: 0.2456395
	speed: 0.1814s/iter; left time: 4498.9503s
Epoch: 3 cost time: 91.89391160011292
Epoch: 3, Steps: 527 | Train Loss: 0.2182324 Vali Loss: 0.1180750 Test Loss: 0.1670807
Validation loss decreased (0.119361 --> 0.118075).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1461967
	speed: 1.2796s/iter; left time: 31566.5895s
	iters: 200, epoch: 4 | loss: 0.2525153
	speed: 0.1692s/iter; left time: 4156.0878s
	iters: 300, epoch: 4 | loss: 0.1850691
	speed: 0.1713s/iter; left time: 4190.9366s
	iters: 400, epoch: 4 | loss: 0.2873901
	speed: 0.1713s/iter; left time: 4174.4570s
	iters: 500, epoch: 4 | loss: 0.1442525
	speed: 0.1661s/iter; left time: 4030.7732s
Epoch: 4 cost time: 90.60326147079468
Epoch: 4, Steps: 527 | Train Loss: 0.2152278 Vali Loss: 0.1173014 Test Loss: 0.1659930
Validation loss decreased (0.118075 --> 0.117301).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1543228
	speed: 1.1897s/iter; left time: 28723.1928s
	iters: 200, epoch: 5 | loss: 0.3211453
	speed: 0.1553s/iter; left time: 3733.8617s
	iters: 300, epoch: 5 | loss: 0.1731333
	speed: 0.1487s/iter; left time: 3561.4643s
	iters: 400, epoch: 5 | loss: 0.2593774
	speed: 0.1499s/iter; left time: 3573.0345s
	iters: 500, epoch: 5 | loss: 0.2037765
	speed: 0.1538s/iter; left time: 3651.7091s
Epoch: 5 cost time: 81.90856504440308
Epoch: 5, Steps: 527 | Train Loss: 0.2134513 Vali Loss: 0.1168473 Test Loss: 0.1651737
Validation loss decreased (0.117301 --> 0.116847).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1291705
	speed: 1.1132s/iter; left time: 26289.0654s
	iters: 200, epoch: 6 | loss: 0.1642373
	speed: 0.1480s/iter; left time: 3481.3555s
	iters: 300, epoch: 6 | loss: 0.1451521
	speed: 0.1465s/iter; left time: 3429.5584s
	iters: 400, epoch: 6 | loss: 0.2254524
	speed: 0.1454s/iter; left time: 3391.1059s
	iters: 500, epoch: 6 | loss: 0.1914047
	speed: 0.1402s/iter; left time: 3255.3820s
Epoch: 6 cost time: 77.9970588684082
Epoch: 6, Steps: 527 | Train Loss: 0.2122597 Vali Loss: 0.1169141 Test Loss: 0.1650668
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2342130
	speed: 1.0113s/iter; left time: 23350.9651s
	iters: 200, epoch: 7 | loss: 0.1849911
	speed: 0.1567s/iter; left time: 3602.8703s
	iters: 300, epoch: 7 | loss: 0.1141099
	speed: 0.1633s/iter; left time: 3736.9356s
	iters: 400, epoch: 7 | loss: 0.3377555
	speed: 0.1578s/iter; left time: 3595.5499s
	iters: 500, epoch: 7 | loss: 0.1365617
	speed: 0.1508s/iter; left time: 3421.6732s
Epoch: 7 cost time: 82.58128094673157
Epoch: 7, Steps: 527 | Train Loss: 0.2116368 Vali Loss: 0.1164526 Test Loss: 0.1651651
Validation loss decreased (0.116847 --> 0.116453).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2488410
	speed: 1.1835s/iter; left time: 26702.3028s
	iters: 200, epoch: 8 | loss: 0.1852024
	speed: 0.1676s/iter; left time: 3764.6524s
	iters: 300, epoch: 8 | loss: 0.1343299
	speed: 0.1675s/iter; left time: 3745.0556s
	iters: 400, epoch: 8 | loss: 0.2019290
	speed: 0.1674s/iter; left time: 3725.5820s
	iters: 500, epoch: 8 | loss: 0.3089263
	speed: 0.1618s/iter; left time: 3584.8133s
Epoch: 8 cost time: 90.39727210998535
Epoch: 8, Steps: 527 | Train Loss: 0.2110808 Vali Loss: 0.1165067 Test Loss: 0.1647281
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1770411
	speed: 1.1236s/iter; left time: 24759.5244s
	iters: 200, epoch: 9 | loss: 0.2041514
	speed: 0.1619s/iter; left time: 3551.5909s
	iters: 300, epoch: 9 | loss: 0.1169755
	speed: 0.1572s/iter; left time: 3433.1823s
	iters: 400, epoch: 9 | loss: 0.2288578
	speed: 0.1567s/iter; left time: 3406.2799s
	iters: 500, epoch: 9 | loss: 0.1403783
	speed: 0.1499s/iter; left time: 3243.6193s
Epoch: 9 cost time: 82.78919291496277
Epoch: 9, Steps: 527 | Train Loss: 0.2105774 Vali Loss: 0.1168537 Test Loss: 0.1648235
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1403736
	speed: 1.0900s/iter; left time: 23443.0692s
	iters: 200, epoch: 10 | loss: 0.1604627
	speed: 0.1722s/iter; left time: 3685.7682s
	iters: 300, epoch: 10 | loss: 0.2454725
	speed: 0.1578s/iter; left time: 3361.5814s
	iters: 400, epoch: 10 | loss: 0.2193172
	speed: 0.1625s/iter; left time: 3446.7988s
	iters: 500, epoch: 10 | loss: 0.1693079
	speed: 0.1623s/iter; left time: 3426.7134s
Epoch: 10 cost time: 87.34715127944946
Epoch: 10, Steps: 527 | Train Loss: 0.2103400 Vali Loss: 0.1162108 Test Loss: 0.1641345
Validation loss decreased (0.116453 --> 0.116211).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1510916
	speed: 1.1393s/iter; left time: 23904.3147s
	iters: 200, epoch: 11 | loss: 0.3215428
	speed: 0.1675s/iter; left time: 3496.5694s
	iters: 300, epoch: 11 | loss: 0.2345683
	speed: 0.1708s/iter; left time: 3548.4726s
	iters: 400, epoch: 11 | loss: 0.1907604
	speed: 0.1629s/iter; left time: 3368.3432s
	iters: 500, epoch: 11 | loss: 0.1743951
	speed: 0.1669s/iter; left time: 3434.7218s
Epoch: 11 cost time: 89.98823881149292
Epoch: 11, Steps: 527 | Train Loss: 0.2100683 Vali Loss: 0.1162579 Test Loss: 0.1644765
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1649352
	speed: 1.0796s/iter; left time: 22083.1583s
	iters: 200, epoch: 12 | loss: 0.1691863
	speed: 0.1518s/iter; left time: 3089.3209s
	iters: 300, epoch: 12 | loss: 0.1646161
	speed: 0.1497s/iter; left time: 3032.6071s
	iters: 400, epoch: 12 | loss: 0.1648982
	speed: 0.1557s/iter; left time: 3138.7392s
	iters: 500, epoch: 12 | loss: 0.1484568
	speed: 0.1552s/iter; left time: 3113.0570s
Epoch: 12 cost time: 81.36923050880432
Epoch: 12, Steps: 527 | Train Loss: 0.2098851 Vali Loss: 0.1163279 Test Loss: 0.1645239
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1586015
	speed: 1.0718s/iter; left time: 21358.5741s
	iters: 200, epoch: 13 | loss: 0.2603703
	speed: 0.1516s/iter; left time: 3006.7439s
	iters: 300, epoch: 13 | loss: 0.1731530
	speed: 0.1432s/iter; left time: 2824.4795s
	iters: 400, epoch: 13 | loss: 0.1424162
	speed: 0.1504s/iter; left time: 2950.9936s
	iters: 500, epoch: 13 | loss: 0.1685271
	speed: 0.1539s/iter; left time: 3005.6440s
Epoch: 13 cost time: 80.74256539344788
Epoch: 13, Steps: 527 | Train Loss: 0.2097774 Vali Loss: 0.1160925 Test Loss: 0.1642673
Validation loss decreased (0.116211 --> 0.116092).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1828237
	speed: 0.8796s/iter; left time: 17063.8515s
	iters: 200, epoch: 14 | loss: 0.0972676
	speed: 0.1329s/iter; left time: 2565.5122s
	iters: 300, epoch: 14 | loss: 0.1366434
	speed: 0.1271s/iter; left time: 2440.3330s
	iters: 400, epoch: 14 | loss: 0.1711505
	speed: 0.1211s/iter; left time: 2312.7036s
	iters: 500, epoch: 14 | loss: 0.2284122
	speed: 0.1295s/iter; left time: 2459.9978s
Epoch: 14 cost time: 68.87181615829468
Epoch: 14, Steps: 527 | Train Loss: 0.2096686 Vali Loss: 0.1160045 Test Loss: 0.1639355
Validation loss decreased (0.116092 --> 0.116004).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1145680
	speed: 1.0049s/iter; left time: 18966.2615s
	iters: 200, epoch: 15 | loss: 0.2758601
	speed: 0.1489s/iter; left time: 2794.5666s
	iters: 300, epoch: 15 | loss: 0.2508105
	speed: 0.1390s/iter; left time: 2596.1672s
	iters: 400, epoch: 15 | loss: 0.1183126
	speed: 0.1355s/iter; left time: 2516.5249s
	iters: 500, epoch: 15 | loss: 0.2174545
	speed: 0.1314s/iter; left time: 2428.0890s
Epoch: 15 cost time: 74.84917998313904
Epoch: 15, Steps: 527 | Train Loss: 0.2092210 Vali Loss: 0.1163917 Test Loss: 0.1642603
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1527086
	speed: 0.8450s/iter; left time: 15503.2379s
	iters: 200, epoch: 16 | loss: 0.2087684
	speed: 0.1150s/iter; left time: 2098.1357s
	iters: 300, epoch: 16 | loss: 0.2509251
	speed: 0.1110s/iter; left time: 2014.4781s
	iters: 400, epoch: 16 | loss: 0.2037957
	speed: 0.1207s/iter; left time: 2178.3547s
	iters: 500, epoch: 16 | loss: 0.2420011
	speed: 0.1194s/iter; left time: 2143.5588s
Epoch: 16 cost time: 62.01698541641235
Epoch: 16, Steps: 527 | Train Loss: 0.2094116 Vali Loss: 0.1162832 Test Loss: 0.1644136
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2152501
	speed: 0.8055s/iter; left time: 14352.3475s
	iters: 200, epoch: 17 | loss: 0.2981412
	speed: 0.1216s/iter; left time: 2153.8866s
	iters: 300, epoch: 17 | loss: 0.1767750
	speed: 0.1239s/iter; left time: 2183.8041s
	iters: 400, epoch: 17 | loss: 0.2500915
	speed: 0.1280s/iter; left time: 2243.1672s
	iters: 500, epoch: 17 | loss: 0.1812574
	speed: 0.1240s/iter; left time: 2160.3324s
Epoch: 17 cost time: 66.4788510799408
Epoch: 17, Steps: 527 | Train Loss: 0.2092342 Vali Loss: 0.1160083 Test Loss: 0.1638973
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16409224271774292, mae:0.254860520362854, rse:0.3284280300140381, corr:[0.56551594 0.56851846 0.5684263  0.566871   0.56537956 0.5645997
 0.56451166 0.5647584  0.56495094 0.564866   0.5644921  0.56396514
 0.56347203 0.56309915 0.56290054 0.5627283  0.5624882  0.56204414
 0.561355   0.56048566 0.55959594 0.55876064 0.55808705 0.5576342
 0.55733895 0.55711824 0.5568655  0.55647874 0.55592483 0.5552721
 0.5545696  0.55397624 0.55348915 0.5529929  0.5524445  0.5518645
 0.5512158  0.55051744 0.54977137 0.5490323  0.5483517  0.5477631
 0.5472657  0.54682285 0.5463932  0.5458832  0.5452679  0.54456997
 0.5437195  0.5427125  0.5416265  0.5406215  0.5397539  0.5390212
 0.5383869  0.5378726  0.5374024  0.53693074 0.53645045 0.5360131
 0.5356227  0.5353527  0.5351624  0.5349618  0.5346671  0.5343217
 0.5338735  0.5334283  0.5331256  0.5330009  0.5329981  0.53299516
 0.5328505  0.53250664 0.53193    0.5312375  0.5305533  0.52999306
 0.529588   0.5293493  0.5289805  0.5283674  0.52741873 0.52618676
 0.5248885  0.5238918  0.52335995 0.5233606  0.523612   0.52368355
 0.52336884 0.5226751  0.5216566  0.5210261  0.52168536 0.5228704 ]
