Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=74, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_192_FITS_ETTm2_ftM_sl720_ll48_pl192_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33649
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=74, out_features=93, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  6166272.0
params:  6975.0
Trainable parameters:  6975
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2558494
	speed: 0.0709s/iter; left time: 921.8064s
	iters: 200, epoch: 1 | loss: 0.2697956
	speed: 0.0682s/iter; left time: 880.3005s
Epoch: 1 cost time: 17.559348344802856
Epoch: 1, Steps: 262 | Train Loss: 0.2925237 Vali Loss: 0.2000194 Test Loss: 0.2661172
Validation loss decreased (inf --> 0.200019).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2018327
	speed: 0.3039s/iter; left time: 3871.1626s
	iters: 200, epoch: 2 | loss: 0.1481237
	speed: 0.0645s/iter; left time: 814.8137s
Epoch: 2 cost time: 18.858248710632324
Epoch: 2, Steps: 262 | Train Loss: 0.1795713 Vali Loss: 0.1850935 Test Loss: 0.2493084
Validation loss decreased (0.200019 --> 0.185094).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1130775
	speed: 0.3102s/iter; left time: 3870.7408s
	iters: 200, epoch: 3 | loss: 0.1095943
	speed: 0.0686s/iter; left time: 848.6249s
Epoch: 3 cost time: 18.35311484336853
Epoch: 3, Steps: 262 | Train Loss: 0.1385945 Vali Loss: 0.1779551 Test Loss: 0.2424814
Validation loss decreased (0.185094 --> 0.177955).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1301966
	speed: 0.3075s/iter; left time: 3755.9745s
	iters: 200, epoch: 4 | loss: 0.0768588
	speed: 0.0824s/iter; left time: 998.0534s
Epoch: 4 cost time: 22.04153037071228
Epoch: 4, Steps: 262 | Train Loss: 0.1158923 Vali Loss: 0.1727839 Test Loss: 0.2374161
Validation loss decreased (0.177955 --> 0.172784).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0945547
	speed: 0.3628s/iter; left time: 4337.0013s
	iters: 200, epoch: 5 | loss: 0.0896597
	speed: 0.0835s/iter; left time: 989.2171s
Epoch: 5 cost time: 21.642436265945435
Epoch: 5, Steps: 262 | Train Loss: 0.1018335 Vali Loss: 0.1683041 Test Loss: 0.2328790
Validation loss decreased (0.172784 --> 0.168304).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0805159
	speed: 0.3355s/iter; left time: 3922.0817s
	iters: 200, epoch: 6 | loss: 0.0795366
	speed: 0.0637s/iter; left time: 738.0242s
Epoch: 6 cost time: 19.59756112098694
Epoch: 6, Steps: 262 | Train Loss: 0.0929687 Vali Loss: 0.1646509 Test Loss: 0.2294056
Validation loss decreased (0.168304 --> 0.164651).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0640494
	speed: 0.2995s/iter; left time: 3423.1280s
	iters: 200, epoch: 7 | loss: 0.1119895
	speed: 0.0641s/iter; left time: 726.5380s
Epoch: 7 cost time: 18.68092441558838
Epoch: 7, Steps: 262 | Train Loss: 0.0872881 Vali Loss: 0.1622211 Test Loss: 0.2271257
Validation loss decreased (0.164651 --> 0.162221).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0903389
	speed: 0.2707s/iter; left time: 3023.3007s
	iters: 200, epoch: 8 | loss: 0.0829894
	speed: 0.0738s/iter; left time: 816.6346s
Epoch: 8 cost time: 17.966871976852417
Epoch: 8, Steps: 262 | Train Loss: 0.0837672 Vali Loss: 0.1603772 Test Loss: 0.2253684
Validation loss decreased (0.162221 --> 0.160377).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0772861
	speed: 0.2691s/iter; left time: 2934.4931s
	iters: 200, epoch: 9 | loss: 0.0652473
	speed: 0.0683s/iter; left time: 737.5885s
Epoch: 9 cost time: 18.42483115196228
Epoch: 9, Steps: 262 | Train Loss: 0.0812680 Vali Loss: 0.1594135 Test Loss: 0.2244746
Validation loss decreased (0.160377 --> 0.159414).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0819394
	speed: 0.2934s/iter; left time: 3122.5544s
	iters: 200, epoch: 10 | loss: 0.0928178
	speed: 0.0653s/iter; left time: 688.4421s
Epoch: 10 cost time: 17.606709003448486
Epoch: 10, Steps: 262 | Train Loss: 0.0799328 Vali Loss: 0.1582355 Test Loss: 0.2236222
Validation loss decreased (0.159414 --> 0.158236).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0736832
	speed: 0.2880s/iter; left time: 2989.9814s
	iters: 200, epoch: 11 | loss: 0.0822300
	speed: 0.0548s/iter; left time: 563.8368s
Epoch: 11 cost time: 15.493274211883545
Epoch: 11, Steps: 262 | Train Loss: 0.0789792 Vali Loss: 0.1577578 Test Loss: 0.2232902
Validation loss decreased (0.158236 --> 0.157758).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0713023
	speed: 0.1221s/iter; left time: 1235.1995s
	iters: 200, epoch: 12 | loss: 0.0806305
	speed: 0.0536s/iter; left time: 536.5380s
Epoch: 12 cost time: 14.891697645187378
Epoch: 12, Steps: 262 | Train Loss: 0.0784684 Vali Loss: 0.1573848 Test Loss: 0.2228801
Validation loss decreased (0.157758 --> 0.157385).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0990542
	speed: 0.2941s/iter; left time: 2898.7563s
	iters: 200, epoch: 13 | loss: 0.0837007
	speed: 0.0654s/iter; left time: 637.7415s
Epoch: 13 cost time: 17.238615036010742
Epoch: 13, Steps: 262 | Train Loss: 0.0781428 Vali Loss: 0.1573968 Test Loss: 0.2227947
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0845171
	speed: 0.2740s/iter; left time: 2628.9203s
	iters: 200, epoch: 14 | loss: 0.0604654
	speed: 0.0637s/iter; left time: 605.2716s
Epoch: 14 cost time: 17.71813440322876
Epoch: 14, Steps: 262 | Train Loss: 0.0778239 Vali Loss: 0.1569711 Test Loss: 0.2226364
Validation loss decreased (0.157385 --> 0.156971).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0558446
	speed: 0.2890s/iter; left time: 2697.5487s
	iters: 200, epoch: 15 | loss: 0.0911594
	speed: 0.0671s/iter; left time: 619.7893s
Epoch: 15 cost time: 18.177589416503906
Epoch: 15, Steps: 262 | Train Loss: 0.0778247 Vali Loss: 0.1570046 Test Loss: 0.2227021
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0672013
	speed: 0.2785s/iter; left time: 2526.0419s
	iters: 200, epoch: 16 | loss: 0.0871722
	speed: 0.0673s/iter; left time: 603.3150s
Epoch: 16 cost time: 18.797483205795288
Epoch: 16, Steps: 262 | Train Loss: 0.0776880 Vali Loss: 0.1569968 Test Loss: 0.2228506
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0880656
	speed: 0.2724s/iter; left time: 2399.8037s
	iters: 200, epoch: 17 | loss: 0.0805142
	speed: 0.0696s/iter; left time: 606.5073s
Epoch: 17 cost time: 18.11384677886963
Epoch: 17, Steps: 262 | Train Loss: 0.0776640 Vali Loss: 0.1568313 Test Loss: 0.2226230
Validation loss decreased (0.156971 --> 0.156831).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0577584
	speed: 0.2639s/iter; left time: 2255.8060s
	iters: 200, epoch: 18 | loss: 0.0656524
	speed: 0.0651s/iter; left time: 549.6340s
Epoch: 18 cost time: 17.302431344985962
Epoch: 18, Steps: 262 | Train Loss: 0.0776590 Vali Loss: 0.1567246 Test Loss: 0.2226909
Validation loss decreased (0.156831 --> 0.156725).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0611644
	speed: 0.2894s/iter; left time: 2397.5698s
	iters: 200, epoch: 19 | loss: 0.0713457
	speed: 0.0669s/iter; left time: 547.2612s
Epoch: 19 cost time: 18.244246006011963
Epoch: 19, Steps: 262 | Train Loss: 0.0775922 Vali Loss: 0.1569699 Test Loss: 0.2227982
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0811557
	speed: 0.3267s/iter; left time: 2621.1167s
	iters: 200, epoch: 20 | loss: 0.0617136
	speed: 0.0766s/iter; left time: 606.7989s
Epoch: 20 cost time: 20.515490531921387
Epoch: 20, Steps: 262 | Train Loss: 0.0775901 Vali Loss: 0.1568814 Test Loss: 0.2227650
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0761949
	speed: 0.3312s/iter; left time: 2570.4545s
	iters: 200, epoch: 21 | loss: 0.0794475
	speed: 0.0681s/iter; left time: 521.9393s
Epoch: 21 cost time: 20.518173694610596
Epoch: 21, Steps: 262 | Train Loss: 0.0776337 Vali Loss: 0.1568488 Test Loss: 0.2225110
EarlyStopping counter: 3 out of 3
Early stopping
train 33649
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=74, out_features=93, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  6166272.0
params:  6975.0
Trainable parameters:  6975
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3495792
	speed: 0.0791s/iter; left time: 1027.7931s
	iters: 200, epoch: 1 | loss: 0.3379562
	speed: 0.0680s/iter; left time: 876.8257s
Epoch: 1 cost time: 19.081647396087646
Epoch: 1, Steps: 262 | Train Loss: 0.2970660 Vali Loss: 0.1541877 Test Loss: 0.2196693
Validation loss decreased (inf --> 0.154188).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2360632
	speed: 0.2827s/iter; left time: 3601.8006s
	iters: 200, epoch: 2 | loss: 0.2213923
	speed: 0.0677s/iter; left time: 855.0294s
Epoch: 2 cost time: 18.657392978668213
Epoch: 2, Steps: 262 | Train Loss: 0.2945133 Vali Loss: 0.1537539 Test Loss: 0.2190355
Validation loss decreased (0.154188 --> 0.153754).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2444063
	speed: 0.2825s/iter; left time: 3524.6365s
	iters: 200, epoch: 3 | loss: 0.2034302
	speed: 0.0687s/iter; left time: 849.8403s
Epoch: 3 cost time: 18.86733317375183
Epoch: 3, Steps: 262 | Train Loss: 0.2934796 Vali Loss: 0.1535938 Test Loss: 0.2182538
Validation loss decreased (0.153754 --> 0.153594).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2022926
	speed: 0.2886s/iter; left time: 3524.7480s
	iters: 200, epoch: 4 | loss: 0.2672473
	speed: 0.0683s/iter; left time: 827.1085s
Epoch: 4 cost time: 18.218494415283203
Epoch: 4, Steps: 262 | Train Loss: 0.2926920 Vali Loss: 0.1531060 Test Loss: 0.2179608
Validation loss decreased (0.153594 --> 0.153106).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2811183
	speed: 0.2970s/iter; left time: 3550.5356s
	iters: 200, epoch: 5 | loss: 0.2760994
	speed: 0.0718s/iter; left time: 851.4088s
Epoch: 5 cost time: 19.176211833953857
Epoch: 5, Steps: 262 | Train Loss: 0.2917665 Vali Loss: 0.1532446 Test Loss: 0.2179967
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2504301
	speed: 0.2909s/iter; left time: 3400.5728s
	iters: 200, epoch: 6 | loss: 0.3403268
	speed: 0.0571s/iter; left time: 661.6492s
Epoch: 6 cost time: 17.522417306900024
Epoch: 6, Steps: 262 | Train Loss: 0.2916795 Vali Loss: 0.1530368 Test Loss: 0.2179513
Validation loss decreased (0.153106 --> 0.153037).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3760842
	speed: 0.1576s/iter; left time: 1801.1071s
	iters: 200, epoch: 7 | loss: 0.2146640
	speed: 0.0197s/iter; left time: 223.4130s
Epoch: 7 cost time: 6.574524641036987
Epoch: 7, Steps: 262 | Train Loss: 0.2914525 Vali Loss: 0.1531755 Test Loss: 0.2179223
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2585328
	speed: 0.0911s/iter; left time: 1016.7593s
	iters: 200, epoch: 8 | loss: 0.2971040
	speed: 0.0225s/iter; left time: 248.8448s
Epoch: 8 cost time: 6.991098642349243
Epoch: 8, Steps: 262 | Train Loss: 0.2917463 Vali Loss: 0.1531337 Test Loss: 0.2176941
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3998398
	speed: 0.2706s/iter; left time: 2951.2913s
	iters: 200, epoch: 9 | loss: 0.2337654
	speed: 0.0669s/iter; left time: 722.7612s
Epoch: 9 cost time: 18.68896222114563
Epoch: 9, Steps: 262 | Train Loss: 0.2910156 Vali Loss: 0.1529441 Test Loss: 0.2174494
Validation loss decreased (0.153037 --> 0.152944).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2766596
	speed: 0.4252s/iter; left time: 4525.2025s
	iters: 200, epoch: 10 | loss: 0.3670857
	speed: 0.0634s/iter; left time: 668.6243s
Epoch: 10 cost time: 17.43578004837036
Epoch: 10, Steps: 262 | Train Loss: 0.2912604 Vali Loss: 0.1528950 Test Loss: 0.2174891
Validation loss decreased (0.152944 --> 0.152895).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.4147027
	speed: 0.2785s/iter; left time: 2891.5117s
	iters: 200, epoch: 11 | loss: 0.2530845
	speed: 0.0665s/iter; left time: 683.9743s
Epoch: 11 cost time: 18.840417623519897
Epoch: 11, Steps: 262 | Train Loss: 0.2910148 Vali Loss: 0.1529117 Test Loss: 0.2174135
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2701715
	speed: 0.2981s/iter; left time: 3016.7501s
	iters: 200, epoch: 12 | loss: 0.2376509
	speed: 0.0608s/iter; left time: 609.5413s
Epoch: 12 cost time: 17.596763372421265
Epoch: 12, Steps: 262 | Train Loss: 0.2910658 Vali Loss: 0.1526737 Test Loss: 0.2174515
Validation loss decreased (0.152895 --> 0.152674).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2983281
	speed: 0.2899s/iter; left time: 2857.8054s
	iters: 200, epoch: 13 | loss: 0.2212433
	speed: 0.0671s/iter; left time: 655.0134s
Epoch: 13 cost time: 17.301759719848633
Epoch: 13, Steps: 262 | Train Loss: 0.2908559 Vali Loss: 0.1528948 Test Loss: 0.2174576
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2699713
	speed: 0.2906s/iter; left time: 2788.0164s
	iters: 200, epoch: 14 | loss: 0.3846374
	speed: 0.0747s/iter; left time: 708.8490s
Epoch: 14 cost time: 20.665727376937866
Epoch: 14, Steps: 262 | Train Loss: 0.2906545 Vali Loss: 0.1528651 Test Loss: 0.2174692
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1781992
	speed: 0.3432s/iter; left time: 3202.6869s
	iters: 200, epoch: 15 | loss: 0.2547882
	speed: 0.0721s/iter; left time: 665.3482s
Epoch: 15 cost time: 20.75313425064087
Epoch: 15, Steps: 262 | Train Loss: 0.2905231 Vali Loss: 0.1528103 Test Loss: 0.2171644
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_192_FITS_ETTm2_ftM_sl720_ll48_pl192_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.21801483631134033, mae:0.2923698425292969, rse:0.37795329093933105, corr:[0.561766   0.56390023 0.56417245 0.5629308  0.5613275  0.560196
 0.5597703  0.55990857 0.5602907  0.56057584 0.56051415 0.5600713
 0.55942327 0.55874777 0.5582387  0.55787224 0.557615   0.5573352
 0.556909   0.5562603  0.5554557  0.5545777  0.553771   0.55314523
 0.552718   0.55245113 0.55225235 0.55201364 0.5516556  0.55115616
 0.5505372  0.5499289  0.5493627  0.54880226 0.54825306 0.54774624
 0.5472387  0.5467066  0.5461297  0.54551035 0.5448678  0.54420733
 0.54356164 0.542943   0.542367   0.5418009  0.54122746 0.5406341
 0.539931   0.53907776 0.53810024 0.5371062  0.5361506  0.5352926
 0.5345733  0.5340618  0.5337053  0.5334234  0.53316975 0.5329183
 0.53264415 0.53240436 0.53220445 0.5320406  0.5318716  0.5317205
 0.53150517 0.53124684 0.53097326 0.53067845 0.5303534  0.53001976
 0.52968997 0.5293835  0.5290739  0.52875066 0.52837163 0.5278873
 0.5272803  0.526606   0.5258311  0.5250241  0.5242514  0.5235778
 0.5230375  0.5226772  0.5223707  0.52209485 0.5218029  0.52146137
 0.5210706  0.520632   0.52000576 0.5191744  0.5181187  0.5168223
 0.5153592  0.5139088  0.51252806 0.51123387 0.5100446  0.5089329
 0.5079079  0.506917   0.5058871  0.5047996  0.50371057 0.502741
 0.50185746 0.50105613 0.5003314  0.4996358  0.49903843 0.49846506
 0.49783686 0.4971631  0.49647972 0.49577364 0.49511972 0.4944334
 0.49377146 0.49306178 0.4923593  0.49161234 0.49073848 0.48971558
 0.4886349  0.4875896  0.48664728 0.4858173  0.48509988 0.48442912
 0.48379114 0.48316234 0.48255095 0.48192927 0.48123026 0.4805534
 0.47988623 0.47927374 0.47868383 0.47811988 0.4775869  0.47696376
 0.47620592 0.47521472 0.4742127  0.47328317 0.472559   0.4719801
 0.47157383 0.4713405  0.47113284 0.4707917  0.4702721  0.469715
 0.4691958  0.46878016 0.46838003 0.4680953  0.46776995 0.46740904
 0.46696135 0.46651867 0.46616888 0.46599096 0.46589598 0.4657804
 0.46558264 0.46531242 0.46486077 0.46429238 0.46370512 0.46324757
 0.46305364 0.46310696 0.46327123 0.46333915 0.4630257  0.46241924
 0.4615176  0.46048245 0.45970237 0.45938078 0.45943213 0.4595941
 0.4595563  0.45922244 0.45857707 0.45779303 0.4571799  0.45656943]
