Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=122, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=122, out_features=138, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  15085056.0
params:  16974.0
Trainable parameters:  16974
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3212005
	speed: 0.1501s/iter; left time: 1958.7790s
	iters: 200, epoch: 1 | loss: 0.1809737
	speed: 0.1401s/iter; left time: 1814.6177s
Epoch: 1 cost time: 38.02582359313965
Epoch: 1, Steps: 263 | Train Loss: 0.2750067 Vali Loss: 0.1775613 Test Loss: 0.2288984
Validation loss decreased (inf --> 0.177561).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2192544
	speed: 0.6547s/iter; left time: 8372.3324s
	iters: 200, epoch: 2 | loss: 0.1956493
	speed: 0.1201s/iter; left time: 1523.1965s
Epoch: 2 cost time: 35.36573338508606
Epoch: 2, Steps: 263 | Train Loss: 0.1638959 Vali Loss: 0.1664048 Test Loss: 0.2151951
Validation loss decreased (0.177561 --> 0.166405).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1856538
	speed: 0.6484s/iter; left time: 8120.8743s
	iters: 200, epoch: 3 | loss: 0.1156097
	speed: 0.1501s/iter; left time: 1864.5193s
Epoch: 3 cost time: 39.516321659088135
Epoch: 3, Steps: 263 | Train Loss: 0.1209240 Vali Loss: 0.1588850 Test Loss: 0.2069028
Validation loss decreased (0.166405 --> 0.158885).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1063123
	speed: 0.6197s/iter; left time: 7598.4356s
	iters: 200, epoch: 4 | loss: 0.0916262
	speed: 0.1349s/iter; left time: 1640.0460s
Epoch: 4 cost time: 36.05395150184631
Epoch: 4, Steps: 263 | Train Loss: 0.0949215 Vali Loss: 0.1503322 Test Loss: 0.1978292
Validation loss decreased (0.158885 --> 0.150332).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0557131
	speed: 0.6164s/iter; left time: 7396.0590s
	iters: 200, epoch: 5 | loss: 0.0789314
	speed: 0.1315s/iter; left time: 1564.2399s
Epoch: 5 cost time: 35.68796229362488
Epoch: 5, Steps: 263 | Train Loss: 0.0772848 Vali Loss: 0.1428230 Test Loss: 0.1898481
Validation loss decreased (0.150332 --> 0.142823).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0836692
	speed: 0.5647s/iter; left time: 6627.1466s
	iters: 200, epoch: 6 | loss: 0.0708246
	speed: 0.1065s/iter; left time: 1239.5953s
Epoch: 6 cost time: 30.696103811264038
Epoch: 6, Steps: 263 | Train Loss: 0.0649951 Vali Loss: 0.1370032 Test Loss: 0.1838968
Validation loss decreased (0.142823 --> 0.137003).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0643343
	speed: 0.5416s/iter; left time: 6213.8317s
	iters: 200, epoch: 7 | loss: 0.0519419
	speed: 0.1052s/iter; left time: 1196.6555s
Epoch: 7 cost time: 29.36784315109253
Epoch: 7, Steps: 263 | Train Loss: 0.0562096 Vali Loss: 0.1330097 Test Loss: 0.1797055
Validation loss decreased (0.137003 --> 0.133010).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0488614
	speed: 0.5587s/iter; left time: 6263.1160s
	iters: 200, epoch: 8 | loss: 0.0473317
	speed: 0.1352s/iter; left time: 1502.1718s
Epoch: 8 cost time: 36.01214003562927
Epoch: 8, Steps: 263 | Train Loss: 0.0499086 Vali Loss: 0.1294253 Test Loss: 0.1762644
Validation loss decreased (0.133010 --> 0.129425).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0419204
	speed: 0.5490s/iter; left time: 6010.3375s
	iters: 200, epoch: 9 | loss: 0.0720120
	speed: 0.1073s/iter; left time: 1163.8426s
Epoch: 9 cost time: 25.282833576202393
Epoch: 9, Steps: 263 | Train Loss: 0.0454094 Vali Loss: 0.1270941 Test Loss: 0.1739758
Validation loss decreased (0.129425 --> 0.127094).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0432174
	speed: 0.4196s/iter; left time: 4483.5019s
	iters: 200, epoch: 10 | loss: 0.0390182
	speed: 0.0780s/iter; left time: 825.0890s
Epoch: 10 cost time: 21.5857036113739
Epoch: 10, Steps: 263 | Train Loss: 0.0422064 Vali Loss: 0.1248633 Test Loss: 0.1719899
Validation loss decreased (0.127094 --> 0.124863).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0560832
	speed: 0.1865s/iter; left time: 1943.1116s
	iters: 200, epoch: 11 | loss: 0.0459849
	speed: 0.0431s/iter; left time: 444.5516s
Epoch: 11 cost time: 8.136175155639648
Epoch: 11, Steps: 263 | Train Loss: 0.0399144 Vali Loss: 0.1229911 Test Loss: 0.1704000
Validation loss decreased (0.124863 --> 0.122991).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0382696
	speed: 0.1756s/iter; left time: 1783.7869s
	iters: 200, epoch: 12 | loss: 0.0430918
	speed: 0.0454s/iter; left time: 457.0714s
Epoch: 12 cost time: 14.079319715499878
Epoch: 12, Steps: 263 | Train Loss: 0.0382982 Vali Loss: 0.1219772 Test Loss: 0.1695422
Validation loss decreased (0.122991 --> 0.121977).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0370203
	speed: 0.1683s/iter; left time: 1665.3132s
	iters: 200, epoch: 13 | loss: 0.0289523
	speed: 0.0460s/iter; left time: 450.5545s
Epoch: 13 cost time: 11.896373987197876
Epoch: 13, Steps: 263 | Train Loss: 0.0371835 Vali Loss: 0.1211538 Test Loss: 0.1689108
Validation loss decreased (0.121977 --> 0.121154).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0512096
	speed: 0.2694s/iter; left time: 2594.7201s
	iters: 200, epoch: 14 | loss: 0.0485628
	speed: 0.1061s/iter; left time: 1011.5593s
Epoch: 14 cost time: 27.890541791915894
Epoch: 14, Steps: 263 | Train Loss: 0.0364162 Vali Loss: 0.1202083 Test Loss: 0.1682065
Validation loss decreased (0.121154 --> 0.120208).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0307818
	speed: 0.4719s/iter; left time: 4421.2135s
	iters: 200, epoch: 15 | loss: 0.0299097
	speed: 0.1083s/iter; left time: 1003.5491s
Epoch: 15 cost time: 28.64036512374878
Epoch: 15, Steps: 263 | Train Loss: 0.0358724 Vali Loss: 0.1196795 Test Loss: 0.1679083
Validation loss decreased (0.120208 --> 0.119679).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0423775
	speed: 0.4491s/iter; left time: 4089.3219s
	iters: 200, epoch: 16 | loss: 0.0356694
	speed: 0.0863s/iter; left time: 776.9446s
Epoch: 16 cost time: 24.853933095932007
Epoch: 16, Steps: 263 | Train Loss: 0.0355538 Vali Loss: 0.1192225 Test Loss: 0.1677990
Validation loss decreased (0.119679 --> 0.119222).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0375466
	speed: 0.4813s/iter; left time: 4256.4203s
	iters: 200, epoch: 17 | loss: 0.0278447
	speed: 0.1071s/iter; left time: 936.0254s
Epoch: 17 cost time: 29.026427507400513
Epoch: 17, Steps: 263 | Train Loss: 0.0353235 Vali Loss: 0.1190028 Test Loss: 0.1678095
Validation loss decreased (0.119222 --> 0.119003).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0405675
	speed: 0.4409s/iter; left time: 3782.8964s
	iters: 200, epoch: 18 | loss: 0.0319669
	speed: 0.1110s/iter; left time: 941.1223s
Epoch: 18 cost time: 28.60244131088257
Epoch: 18, Steps: 263 | Train Loss: 0.0351380 Vali Loss: 0.1189402 Test Loss: 0.1677461
Validation loss decreased (0.119003 --> 0.118940).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0466182
	speed: 0.5319s/iter; left time: 4423.4771s
	iters: 200, epoch: 19 | loss: 0.0361354
	speed: 0.1209s/iter; left time: 993.1829s
Epoch: 19 cost time: 32.417341232299805
Epoch: 19, Steps: 263 | Train Loss: 0.0350539 Vali Loss: 0.1186742 Test Loss: 0.1675972
Validation loss decreased (0.118940 --> 0.118674).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0320060
	speed: 0.5054s/iter; left time: 4070.1965s
	iters: 200, epoch: 20 | loss: 0.0350029
	speed: 0.1044s/iter; left time: 830.4857s
Epoch: 20 cost time: 28.457544326782227
Epoch: 20, Steps: 263 | Train Loss: 0.0350195 Vali Loss: 0.1182511 Test Loss: 0.1672657
Validation loss decreased (0.118674 --> 0.118251).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0372970
	speed: 0.4206s/iter; left time: 3276.5454s
	iters: 200, epoch: 21 | loss: 0.0293284
	speed: 0.0906s/iter; left time: 696.7162s
Epoch: 21 cost time: 24.003859281539917
Epoch: 21, Steps: 263 | Train Loss: 0.0350020 Vali Loss: 0.1183873 Test Loss: 0.1675315
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0378533
	speed: 0.4683s/iter; left time: 3525.4460s
	iters: 200, epoch: 22 | loss: 0.0372716
	speed: 0.1102s/iter; left time: 818.3476s
Epoch: 22 cost time: 29.959232330322266
Epoch: 22, Steps: 263 | Train Loss: 0.0349921 Vali Loss: 0.1184453 Test Loss: 0.1674361
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0371963
	speed: 0.5295s/iter; left time: 3846.8991s
	iters: 200, epoch: 23 | loss: 0.0331664
	speed: 0.1197s/iter; left time: 857.3189s
Epoch: 23 cost time: 32.0865216255188
Epoch: 23, Steps: 263 | Train Loss: 0.0349705 Vali Loss: 0.1182757 Test Loss: 0.1673418
EarlyStopping counter: 3 out of 3
Early stopping
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=122, out_features=138, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  15085056.0
params:  16974.0
Trainable parameters:  16974
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1765365
	speed: 0.1222s/iter; left time: 1594.5477s
	iters: 200, epoch: 1 | loss: 0.1693284
	speed: 0.1020s/iter; left time: 1321.3635s
Epoch: 1 cost time: 29.283586978912354
Epoch: 1, Steps: 263 | Train Loss: 0.2131449 Vali Loss: 0.1152559 Test Loss: 0.1637545
Validation loss decreased (inf --> 0.115256).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1785083
	speed: 0.5441s/iter; left time: 6957.5472s
	iters: 200, epoch: 2 | loss: 0.1989353
	speed: 0.1340s/iter; left time: 1700.7264s
Epoch: 2 cost time: 36.404481172561646
Epoch: 2, Steps: 263 | Train Loss: 0.2094868 Vali Loss: 0.1144855 Test Loss: 0.1632907
Validation loss decreased (0.115256 --> 0.114486).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1799379
	speed: 0.5614s/iter; left time: 7032.1382s
	iters: 200, epoch: 3 | loss: 0.1675819
	speed: 0.1173s/iter; left time: 1457.5517s
Epoch: 3 cost time: 31.849387168884277
Epoch: 3, Steps: 263 | Train Loss: 0.2082980 Vali Loss: 0.1143462 Test Loss: 0.1627997
Validation loss decreased (0.114486 --> 0.114346).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1696168
	speed: 0.5629s/iter; left time: 6902.0245s
	iters: 200, epoch: 4 | loss: 0.2047118
	speed: 0.1214s/iter; left time: 1477.0659s
Epoch: 4 cost time: 32.15855526924133
Epoch: 4, Steps: 263 | Train Loss: 0.2079851 Vali Loss: 0.1143777 Test Loss: 0.1624445
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2026909
	speed: 0.5029s/iter; left time: 6034.3177s
	iters: 200, epoch: 5 | loss: 0.1601630
	speed: 0.1197s/iter; left time: 1424.3688s
Epoch: 5 cost time: 32.1148362159729
Epoch: 5, Steps: 263 | Train Loss: 0.2075150 Vali Loss: 0.1142534 Test Loss: 0.1626046
Validation loss decreased (0.114346 --> 0.114253).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3169426
	speed: 0.5481s/iter; left time: 6433.0232s
	iters: 200, epoch: 6 | loss: 0.1939997
	speed: 0.1099s/iter; left time: 1278.2899s
Epoch: 6 cost time: 31.543108463287354
Epoch: 6, Steps: 263 | Train Loss: 0.2073664 Vali Loss: 0.1142657 Test Loss: 0.1625595
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2475906
	speed: 0.6937s/iter; left time: 7958.9718s
	iters: 200, epoch: 7 | loss: 0.1721302
	speed: 0.1544s/iter; left time: 1756.4772s
Epoch: 7 cost time: 41.21176242828369
Epoch: 7, Steps: 263 | Train Loss: 0.2065582 Vali Loss: 0.1141586 Test Loss: 0.1626308
Validation loss decreased (0.114253 --> 0.114159).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2147523
	speed: 0.5907s/iter; left time: 6621.4309s
	iters: 200, epoch: 8 | loss: 0.1471220
	speed: 0.0957s/iter; left time: 1062.7485s
Epoch: 8 cost time: 26.27405595779419
Epoch: 8, Steps: 263 | Train Loss: 0.2067613 Vali Loss: 0.1142283 Test Loss: 0.1624724
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1581010
	speed: 0.5324s/iter; left time: 5827.6966s
	iters: 200, epoch: 9 | loss: 0.1372049
	speed: 0.1022s/iter; left time: 1108.4593s
Epoch: 9 cost time: 29.68496870994568
Epoch: 9, Steps: 263 | Train Loss: 0.2065898 Vali Loss: 0.1143265 Test Loss: 0.1622259
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2406672
	speed: 0.5814s/iter; left time: 6212.1386s
	iters: 200, epoch: 10 | loss: 0.2526112
	speed: 0.1301s/iter; left time: 1377.0109s
Epoch: 10 cost time: 34.2817006111145
Epoch: 10, Steps: 263 | Train Loss: 0.2066997 Vali Loss: 0.1144634 Test Loss: 0.1622502
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16310253739356995, mae:0.25389429926872253, rse:0.32743608951568604, corr:[0.5705163  0.5720429  0.5693927  0.56726307 0.566998   0.56747794
 0.56723875 0.566162   0.5652075  0.5650046  0.5653336  0.5655108
 0.56514645 0.5644863  0.56403923 0.56382453 0.56351674 0.5627577
 0.56163836 0.56061596 0.5600521  0.5598234  0.5595665  0.55900604
 0.5581927  0.5574373  0.5569405  0.55660015 0.55613565 0.5554232
 0.5546013  0.5540368  0.55375874 0.55351084 0.5530733  0.5524074
 0.5516048  0.5508352  0.5501568  0.54955536 0.54893005 0.54819953
 0.5474429  0.5468003  0.5463736  0.5460041  0.5454435  0.5446287
 0.5436228  0.5425893  0.5417057  0.54109746 0.54056084 0.5398699
 0.539046   0.5383075  0.5376861  0.53715384 0.53666866 0.53624725
 0.53592914 0.535837   0.53582406 0.5356495  0.53524345 0.5348344
 0.53452665 0.534414   0.53435034 0.53405267 0.533441   0.5327779
 0.53247106 0.5326452  0.5327813  0.5324549  0.53163517 0.53068197
 0.53004766 0.5299581  0.5297584  0.5290259  0.527725   0.5263309
 0.5255503  0.52556574 0.5255268  0.52490944 0.5238734  0.52310556
 0.5231912  0.5235345  0.5228767  0.5212188  0.52029496 0.52197075]
