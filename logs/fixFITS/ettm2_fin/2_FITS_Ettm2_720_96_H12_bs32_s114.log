Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=106, d_ff=2048, d_layers=1, d_model=512, data='ETTm2', data_path='ETTm2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=5, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm2_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:5
>>>>>>>start training : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=106, out_features=120, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  5698560.0
params:  12840.0
Trainable parameters:  12840
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2248972
	speed: 0.1578s/iter; left time: 4142.3243s
	iters: 200, epoch: 1 | loss: 0.2366048
	speed: 0.1407s/iter; left time: 3678.2319s
	iters: 300, epoch: 1 | loss: 0.2334174
	speed: 0.1418s/iter; left time: 3694.9850s
	iters: 400, epoch: 1 | loss: 0.1587053
	speed: 0.1370s/iter; left time: 3555.9477s
	iters: 500, epoch: 1 | loss: 0.1746520
	speed: 0.1399s/iter; left time: 3616.0020s
Epoch: 1 cost time: 75.59489822387695
Epoch: 1, Steps: 527 | Train Loss: 0.2133581 Vali Loss: 0.1621987 Test Loss: 0.2121329
Validation loss decreased (inf --> 0.162199).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1674847
	speed: 0.8550s/iter; left time: 21994.2521s
	iters: 200, epoch: 2 | loss: 0.1005523
	speed: 0.1218s/iter; left time: 3121.9808s
	iters: 300, epoch: 2 | loss: 0.0850177
	speed: 0.0955s/iter; left time: 2437.6857s
	iters: 400, epoch: 2 | loss: 0.0831737
	speed: 0.1013s/iter; left time: 2575.1548s
	iters: 500, epoch: 2 | loss: 0.0767216
	speed: 0.1149s/iter; left time: 2910.7474s
Epoch: 2 cost time: 60.50438690185547
Epoch: 2, Steps: 527 | Train Loss: 0.0993973 Vali Loss: 0.1466183 Test Loss: 0.1942977
Validation loss decreased (0.162199 --> 0.146618).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.0721948
	speed: 0.7949s/iter; left time: 20028.9840s
	iters: 200, epoch: 3 | loss: 0.0672359
	speed: 0.1018s/iter; left time: 2555.9708s
	iters: 300, epoch: 3 | loss: 0.0502184
	speed: 0.1067s/iter; left time: 2668.0264s
	iters: 400, epoch: 3 | loss: 0.0509255
	speed: 0.1356s/iter; left time: 3376.4381s
	iters: 500, epoch: 3 | loss: 0.0703572
	speed: 0.1182s/iter; left time: 2931.9481s
Epoch: 3 cost time: 61.70059084892273
Epoch: 3, Steps: 527 | Train Loss: 0.0638746 Vali Loss: 0.1336183 Test Loss: 0.1808022
Validation loss decreased (0.146618 --> 0.133618).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.0466083
	speed: 0.8452s/iter; left time: 20852.2853s
	iters: 200, epoch: 4 | loss: 0.0497064
	speed: 0.1192s/iter; left time: 2929.3091s
	iters: 300, epoch: 4 | loss: 0.0337452
	speed: 0.1183s/iter; left time: 2894.5820s
	iters: 400, epoch: 4 | loss: 0.0456852
	speed: 0.1146s/iter; left time: 2793.7505s
	iters: 500, epoch: 4 | loss: 0.0483669
	speed: 0.1361s/iter; left time: 3303.4121s
Epoch: 4 cost time: 64.92549109458923
Epoch: 4, Steps: 527 | Train Loss: 0.0478721 Vali Loss: 0.1262173 Test Loss: 0.1737856
Validation loss decreased (0.133618 --> 0.126217).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0327093
	speed: 0.9049s/iter; left time: 21847.8595s
	iters: 200, epoch: 5 | loss: 0.0371246
	speed: 0.1219s/iter; left time: 2930.1604s
	iters: 300, epoch: 5 | loss: 0.0412703
	speed: 0.1260s/iter; left time: 3016.5125s
	iters: 400, epoch: 5 | loss: 0.0557338
	speed: 0.1458s/iter; left time: 3476.6113s
	iters: 500, epoch: 5 | loss: 0.0349659
	speed: 0.1443s/iter; left time: 3426.5734s
Epoch: 5 cost time: 70.4222514629364
Epoch: 5, Steps: 527 | Train Loss: 0.0407806 Vali Loss: 0.1223399 Test Loss: 0.1707540
Validation loss decreased (0.126217 --> 0.122340).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0376936
	speed: 0.9264s/iter; left time: 21876.6936s
	iters: 200, epoch: 6 | loss: 0.0388820
	speed: 0.1115s/iter; left time: 2621.0030s
	iters: 300, epoch: 6 | loss: 0.0337747
	speed: 0.1118s/iter; left time: 2618.4127s
	iters: 400, epoch: 6 | loss: 0.0303147
	speed: 0.1144s/iter; left time: 2666.6089s
	iters: 500, epoch: 6 | loss: 0.0437086
	speed: 0.1159s/iter; left time: 2691.7249s
Epoch: 6 cost time: 61.882755756378174
Epoch: 6, Steps: 527 | Train Loss: 0.0378676 Vali Loss: 0.1202953 Test Loss: 0.1690806
Validation loss decreased (0.122340 --> 0.120295).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0338431
	speed: 0.8370s/iter; left time: 19324.7759s
	iters: 200, epoch: 7 | loss: 0.0346790
	speed: 0.1194s/iter; left time: 2745.1243s
	iters: 300, epoch: 7 | loss: 0.0465192
	speed: 0.1154s/iter; left time: 2642.1128s
	iters: 400, epoch: 7 | loss: 0.0357165
	speed: 0.1147s/iter; left time: 2614.9186s
	iters: 500, epoch: 7 | loss: 0.0438501
	speed: 0.1014s/iter; left time: 2300.0430s
Epoch: 7 cost time: 61.51689863204956
Epoch: 7, Steps: 527 | Train Loss: 0.0368001 Vali Loss: 0.1194265 Test Loss: 0.1687256
Validation loss decreased (0.120295 --> 0.119427).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0404861
	speed: 0.8139s/iter; left time: 18362.9709s
	iters: 200, epoch: 8 | loss: 0.0335391
	speed: 0.1194s/iter; left time: 2681.5860s
	iters: 300, epoch: 8 | loss: 0.0563282
	speed: 0.1092s/iter; left time: 2441.4470s
	iters: 400, epoch: 8 | loss: 0.0364065
	speed: 0.1088s/iter; left time: 2423.1858s
	iters: 500, epoch: 8 | loss: 0.0299988
	speed: 0.1143s/iter; left time: 2532.1284s
Epoch: 8 cost time: 60.92162895202637
Epoch: 8, Steps: 527 | Train Loss: 0.0364623 Vali Loss: 0.1191810 Test Loss: 0.1684057
Validation loss decreased (0.119427 --> 0.119181).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0403643
	speed: 0.7702s/iter; left time: 16970.9398s
	iters: 200, epoch: 9 | loss: 0.0274204
	speed: 0.1039s/iter; left time: 2278.0313s
	iters: 300, epoch: 9 | loss: 0.0312082
	speed: 0.1310s/iter; left time: 2859.7434s
	iters: 400, epoch: 9 | loss: 0.0423572
	speed: 0.1199s/iter; left time: 2607.0502s
	iters: 500, epoch: 9 | loss: 0.0337547
	speed: 0.1185s/iter; left time: 2564.0563s
Epoch: 9 cost time: 62.35548758506775
Epoch: 9, Steps: 527 | Train Loss: 0.0363585 Vali Loss: 0.1188499 Test Loss: 0.1684525
Validation loss decreased (0.119181 --> 0.118850).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0294611
	speed: 0.8553s/iter; left time: 18394.9495s
	iters: 200, epoch: 10 | loss: 0.0295624
	speed: 0.1208s/iter; left time: 2587.1249s
	iters: 300, epoch: 10 | loss: 0.0490826
	speed: 0.1141s/iter; left time: 2430.9135s
	iters: 400, epoch: 10 | loss: 0.0440444
	speed: 0.1115s/iter; left time: 2364.0296s
	iters: 500, epoch: 10 | loss: 0.0389669
	speed: 0.1184s/iter; left time: 2498.9386s
Epoch: 10 cost time: 61.99170279502869
Epoch: 10, Steps: 527 | Train Loss: 0.0363165 Vali Loss: 0.1185792 Test Loss: 0.1683082
Validation loss decreased (0.118850 --> 0.118579).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0332046
	speed: 0.7840s/iter; left time: 16450.0771s
	iters: 200, epoch: 11 | loss: 0.0303669
	speed: 0.1313s/iter; left time: 2742.6067s
	iters: 300, epoch: 11 | loss: 0.0425200
	speed: 0.1297s/iter; left time: 2694.3541s
	iters: 400, epoch: 11 | loss: 0.0504969
	speed: 0.1243s/iter; left time: 2570.9699s
	iters: 500, epoch: 11 | loss: 0.0289169
	speed: 0.1261s/iter; left time: 2595.0855s
Epoch: 11 cost time: 68.41660690307617
Epoch: 11, Steps: 527 | Train Loss: 0.0363207 Vali Loss: 0.1188625 Test Loss: 0.1684537
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0229329
	speed: 0.9177s/iter; left time: 18770.9388s
	iters: 200, epoch: 12 | loss: 0.0335991
	speed: 0.1101s/iter; left time: 2241.8849s
	iters: 300, epoch: 12 | loss: 0.0357147
	speed: 0.1086s/iter; left time: 2199.2267s
	iters: 400, epoch: 12 | loss: 0.0257681
	speed: 0.1254s/iter; left time: 2526.4094s
	iters: 500, epoch: 12 | loss: 0.0317457
	speed: 0.1113s/iter; left time: 2232.1483s
Epoch: 12 cost time: 61.4206645488739
Epoch: 12, Steps: 527 | Train Loss: 0.0363171 Vali Loss: 0.1185520 Test Loss: 0.1680910
Validation loss decreased (0.118579 --> 0.118552).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0291441
	speed: 0.7211s/iter; left time: 14369.0043s
	iters: 200, epoch: 13 | loss: 0.0334925
	speed: 0.0701s/iter; left time: 1388.9934s
	iters: 300, epoch: 13 | loss: 0.0382614
	speed: 0.0938s/iter; left time: 1851.2253s
	iters: 400, epoch: 13 | loss: 0.0347986
	speed: 0.1137s/iter; left time: 2231.4089s
	iters: 500, epoch: 13 | loss: 0.0269823
	speed: 0.0968s/iter; left time: 1890.9456s
Epoch: 13 cost time: 48.781322717666626
Epoch: 13, Steps: 527 | Train Loss: 0.0363042 Vali Loss: 0.1184701 Test Loss: 0.1682983
Validation loss decreased (0.118552 --> 0.118470).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0358231
	speed: 0.6231s/iter; left time: 12088.7635s
	iters: 200, epoch: 14 | loss: 0.0294226
	speed: 0.0465s/iter; left time: 897.7561s
	iters: 300, epoch: 14 | loss: 0.0341418
	speed: 0.0573s/iter; left time: 1099.7395s
	iters: 400, epoch: 14 | loss: 0.0410513
	speed: 0.0673s/iter; left time: 1285.2795s
	iters: 500, epoch: 14 | loss: 0.0307085
	speed: 0.1162s/iter; left time: 2208.2289s
Epoch: 14 cost time: 36.775646924972534
Epoch: 14, Steps: 527 | Train Loss: 0.0362991 Vali Loss: 0.1186098 Test Loss: 0.1683419
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0325063
	speed: 0.9583s/iter; left time: 18086.7500s
	iters: 200, epoch: 15 | loss: 0.0390125
	speed: 0.1443s/iter; left time: 2708.2882s
	iters: 300, epoch: 15 | loss: 0.0424011
	speed: 0.1428s/iter; left time: 2666.8267s
	iters: 400, epoch: 15 | loss: 0.0306939
	speed: 0.1447s/iter; left time: 2687.1882s
	iters: 500, epoch: 15 | loss: 0.0514927
	speed: 0.1446s/iter; left time: 2670.8809s
Epoch: 15 cost time: 76.59788703918457
Epoch: 15, Steps: 527 | Train Loss: 0.0362987 Vali Loss: 0.1188400 Test Loss: 0.1682910
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0258205
	speed: 0.8511s/iter; left time: 15615.0436s
	iters: 200, epoch: 16 | loss: 0.0365877
	speed: 0.1077s/iter; left time: 1965.0968s
	iters: 300, epoch: 16 | loss: 0.0321147
	speed: 0.1132s/iter; left time: 2053.4187s
	iters: 400, epoch: 16 | loss: 0.0313545
	speed: 0.1147s/iter; left time: 2069.0157s
	iters: 500, epoch: 16 | loss: 0.0397210
	speed: 0.1069s/iter; left time: 1918.9915s
Epoch: 16 cost time: 59.77391600608826
Epoch: 16, Steps: 527 | Train Loss: 0.0362959 Vali Loss: 0.1185827 Test Loss: 0.1681946
EarlyStopping counter: 3 out of 3
Early stopping
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=106, out_features=120, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  5698560.0
params:  12840.0
Trainable parameters:  12840
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2167930
	speed: 0.1185s/iter; left time: 3109.5762s
	iters: 200, epoch: 1 | loss: 0.1545448
	speed: 0.1113s/iter; left time: 2909.8257s
	iters: 300, epoch: 1 | loss: 0.1943749
	speed: 0.1123s/iter; left time: 2925.7995s
	iters: 400, epoch: 1 | loss: 0.3724512
	speed: 0.1170s/iter; left time: 3036.2487s
	iters: 500, epoch: 1 | loss: 0.1324076
	speed: 0.1072s/iter; left time: 2772.0392s
Epoch: 1 cost time: 59.454527854919434
Epoch: 1, Steps: 527 | Train Loss: 0.2129896 Vali Loss: 0.1152430 Test Loss: 0.1640313
Validation loss decreased (inf --> 0.115243).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2491748
	speed: 0.7882s/iter; left time: 20276.9366s
	iters: 200, epoch: 2 | loss: 0.1285061
	speed: 0.1223s/iter; left time: 3133.0014s
	iters: 300, epoch: 2 | loss: 0.2015090
	speed: 0.1237s/iter; left time: 3157.4153s
	iters: 400, epoch: 2 | loss: 0.1522657
	speed: 0.1228s/iter; left time: 3121.2006s
	iters: 500, epoch: 2 | loss: 0.1120504
	speed: 0.1146s/iter; left time: 2901.6745s
Epoch: 2 cost time: 66.1538474559784
Epoch: 2, Steps: 527 | Train Loss: 0.2098055 Vali Loss: 0.1148847 Test Loss: 0.1636916
Validation loss decreased (0.115243 --> 0.114885).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2342596
	speed: 0.6790s/iter; left time: 17109.7618s
	iters: 200, epoch: 3 | loss: 0.2163820
	speed: 0.1037s/iter; left time: 2603.1749s
	iters: 300, epoch: 3 | loss: 0.2005945
	speed: 0.1216s/iter; left time: 3040.6303s
	iters: 400, epoch: 3 | loss: 0.1539049
	speed: 0.0674s/iter; left time: 1678.3171s
	iters: 500, epoch: 3 | loss: 0.3749752
	speed: 0.0586s/iter; left time: 1453.8713s
Epoch: 3 cost time: 47.298020362854004
Epoch: 3, Steps: 527 | Train Loss: 0.2086169 Vali Loss: 0.1144247 Test Loss: 0.1628260
Validation loss decreased (0.114885 --> 0.114425).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2154124
	speed: 0.7614s/iter; left time: 18784.2370s
	iters: 200, epoch: 4 | loss: 0.2045771
	speed: 0.1439s/iter; left time: 3536.7886s
	iters: 300, epoch: 4 | loss: 0.2732899
	speed: 0.1303s/iter; left time: 3187.2987s
	iters: 400, epoch: 4 | loss: 0.5020456
	speed: 0.1397s/iter; left time: 3405.0104s
	iters: 500, epoch: 4 | loss: 0.1580526
	speed: 0.1098s/iter; left time: 2664.9576s
Epoch: 4 cost time: 68.74553632736206
Epoch: 4, Steps: 527 | Train Loss: 0.2076818 Vali Loss: 0.1145288 Test Loss: 0.1632122
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2761171
	speed: 0.8902s/iter; left time: 21493.0619s
	iters: 200, epoch: 5 | loss: 0.1529459
	speed: 0.1276s/iter; left time: 3067.8800s
	iters: 300, epoch: 5 | loss: 0.2920854
	speed: 0.1070s/iter; left time: 2562.9425s
	iters: 400, epoch: 5 | loss: 0.2023937
	speed: 0.1109s/iter; left time: 2644.1039s
	iters: 500, epoch: 5 | loss: 0.2719064
	speed: 0.1033s/iter; left time: 2453.8191s
Epoch: 5 cost time: 61.042765378952026
Epoch: 5, Steps: 527 | Train Loss: 0.2076034 Vali Loss: 0.1147701 Test Loss: 0.1634128
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1312890
	speed: 0.8408s/iter; left time: 19855.7888s
	iters: 200, epoch: 6 | loss: 0.2452230
	speed: 0.1139s/iter; left time: 2678.3398s
	iters: 300, epoch: 6 | loss: 0.1236073
	speed: 0.1056s/iter; left time: 2472.7484s
	iters: 400, epoch: 6 | loss: 0.2071952
	speed: 0.1075s/iter; left time: 2506.8607s
	iters: 500, epoch: 6 | loss: 0.2474598
	speed: 0.1036s/iter; left time: 2405.2082s
Epoch: 6 cost time: 58.6411919593811
Epoch: 6, Steps: 527 | Train Loss: 0.2073818 Vali Loss: 0.1148025 Test Loss: 0.1632570
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm2_720_96_FITS_ETTm2_ftM_sl720_ll48_pl96_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.16297009587287903, mae:0.25442254543304443, rse:0.32730311155319214, corr:[0.56911194 0.5725013  0.57129765 0.5685306  0.56705755 0.56719387
 0.56785256 0.5677843  0.5666671  0.5652467  0.5643594  0.5642612
 0.5646412  0.5648546  0.5644884  0.56355244 0.5624622  0.5615574
 0.5609768  0.56059694 0.56021124 0.5596417  0.55896074 0.55835265
 0.55790734 0.55759335 0.55727994 0.5568246  0.55618703 0.55547273
 0.5547975  0.5543298  0.55400217 0.55360097 0.5530176  0.5522833
 0.5514411  0.55057365 0.5497229  0.5489483  0.5482815  0.5477119
 0.54722744 0.5467916  0.54636467 0.5458639  0.54526865 0.5445754
 0.54372376 0.542803   0.5419602  0.5412206  0.5404131  0.5394419
 0.53834236 0.5373288  0.5365939  0.5362261  0.5360628  0.5358582
 0.5354218  0.53478426 0.53406686 0.53357667 0.5335363  0.53383005
 0.533971   0.53376496 0.53332275 0.5329141  0.5327955  0.532917
 0.53297216 0.53275746 0.5321733  0.5314292  0.5308572  0.53061634
 0.53040624 0.52995354 0.52900773 0.52779275 0.52666676 0.525963
 0.5255812  0.52509576 0.5240914  0.5228167  0.52194947 0.5219727
 0.5225013  0.5225418  0.5214688  0.5200041  0.5198721  0.52104205]
