Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=320, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Traffic_720_j96_H10', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : Traffic_720_j96_H10_FITS_custom_ftM_sl720_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1661
test 3413
Model(
  (freq_upsampler): Linear(in_features=320, out_features=362, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  6390661120.0
params:  116202.0
Trainable parameters:  116202
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2931870
	speed: 0.4335s/iter; left time: 3837.2667s
Epoch: 1 cost time: 79.05672192573547
Epoch: 1, Steps: 179 | Train Loss: 0.4254985 Vali Loss: 0.3363933 Test Loss: 0.3989628
Validation loss decreased (inf --> 0.336393).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2275030
	speed: 1.2396s/iter; left time: 10749.5709s
Epoch: 2 cost time: 70.01625442504883
Epoch: 2, Steps: 179 | Train Loss: 0.2342816 Vali Loss: 0.3268482 Test Loss: 0.3906328
Validation loss decreased (0.336393 --> 0.326848).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2237993
	speed: 1.1711s/iter; left time: 9946.4207s
Epoch: 3 cost time: 80.67782664299011
Epoch: 3, Steps: 179 | Train Loss: 0.2324458 Vali Loss: 0.3272007 Test Loss: 0.3893857
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2352695
	speed: 1.3167s/iter; left time: 10946.7052s
Epoch: 4 cost time: 78.23421382904053
Epoch: 4, Steps: 179 | Train Loss: 0.2320100 Vali Loss: 0.3253441 Test Loss: 0.3893099
Validation loss decreased (0.326848 --> 0.325344).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2247572
	speed: 1.2218s/iter; left time: 9939.3461s
Epoch: 5 cost time: 76.97438764572144
Epoch: 5, Steps: 179 | Train Loss: 0.2319019 Vali Loss: 0.3251599 Test Loss: 0.3879921
Validation loss decreased (0.325344 --> 0.325160).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2208857
	speed: 1.2196s/iter; left time: 9703.5242s
Epoch: 6 cost time: 76.14149856567383
Epoch: 6, Steps: 179 | Train Loss: 0.2316851 Vali Loss: 0.3255998 Test Loss: 0.3876623
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2184572
	speed: 1.2168s/iter; left time: 9462.9265s
Epoch: 7 cost time: 69.338219165802
Epoch: 7, Steps: 179 | Train Loss: 0.2315598 Vali Loss: 0.3248995 Test Loss: 0.3883736
Validation loss decreased (0.325160 --> 0.324900).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2354086
	speed: 1.2894s/iter; left time: 9796.8223s
Epoch: 8 cost time: 88.28583216667175
Epoch: 8, Steps: 179 | Train Loss: 0.2314889 Vali Loss: 0.3256920 Test Loss: 0.3873896
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2213162
	speed: 1.3612s/iter; left time: 10099.1066s
Epoch: 9 cost time: 80.43816590309143
Epoch: 9, Steps: 179 | Train Loss: 0.2313780 Vali Loss: 0.3255047 Test Loss: 0.3877345
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2327897
	speed: 1.2763s/iter; left time: 9240.2962s
Epoch: 10 cost time: 78.27425503730774
Epoch: 10, Steps: 179 | Train Loss: 0.2313180 Vali Loss: 0.3248022 Test Loss: 0.3878346
Validation loss decreased (0.324900 --> 0.324802).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2346268
	speed: 1.2005s/iter; left time: 8476.6212s
Epoch: 11 cost time: 73.1111011505127
Epoch: 11, Steps: 179 | Train Loss: 0.2311766 Vali Loss: 0.3254341 Test Loss: 0.3874766
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2255491
	speed: 1.2866s/iter; left time: 8854.4926s
Epoch: 12 cost time: 86.52830481529236
Epoch: 12, Steps: 179 | Train Loss: 0.2311996 Vali Loss: 0.3251015 Test Loss: 0.3875387
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2378952
	speed: 1.4143s/iter; left time: 9480.2667s
Epoch: 13 cost time: 79.6287956237793
Epoch: 13, Steps: 179 | Train Loss: 0.2311090 Vali Loss: 0.3236021 Test Loss: 0.3876744
Validation loss decreased (0.324802 --> 0.323602).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2456151
	speed: 1.2182s/iter; left time: 7947.2564s
Epoch: 14 cost time: 75.33952689170837
Epoch: 14, Steps: 179 | Train Loss: 0.2310441 Vali Loss: 0.3253226 Test Loss: 0.3871789
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2275964
	speed: 1.2047s/iter; left time: 7643.7175s
Epoch: 15 cost time: 78.88593459129333
Epoch: 15, Steps: 179 | Train Loss: 0.2310259 Vali Loss: 0.3249615 Test Loss: 0.3868431
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2315311
	speed: 1.3022s/iter; left time: 8029.6070s
Epoch: 16 cost time: 80.42059993743896
Epoch: 16, Steps: 179 | Train Loss: 0.2309643 Vali Loss: 0.3248404 Test Loss: 0.3869533
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2362023
	speed: 1.4448s/iter; left time: 8650.2283s
Epoch: 17 cost time: 95.98036742210388
Epoch: 17, Steps: 179 | Train Loss: 0.2308753 Vali Loss: 0.3247806 Test Loss: 0.3864945
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2452106
	speed: 1.2860s/iter; left time: 7469.1911s
Epoch: 18 cost time: 73.50813412666321
Epoch: 18, Steps: 179 | Train Loss: 0.2309037 Vali Loss: 0.3241178 Test Loss: 0.3865287
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2166242
	speed: 1.2080s/iter; left time: 6799.6115s
Epoch: 19 cost time: 75.8504741191864
Epoch: 19, Steps: 179 | Train Loss: 0.2308595 Vali Loss: 0.3245217 Test Loss: 0.3868553
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.2108243
	speed: 1.2005s/iter; left time: 6542.4856s
Epoch: 20 cost time: 76.27396392822266
Epoch: 20, Steps: 179 | Train Loss: 0.2307724 Vali Loss: 0.3243889 Test Loss: 0.3871461
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.2192033
	speed: 1.2320s/iter; left time: 6493.9248s
Epoch: 21 cost time: 80.6549162864685
Epoch: 21, Steps: 179 | Train Loss: 0.2308125 Vali Loss: 0.3248315 Test Loss: 0.3866158
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.2331150
	speed: 1.3904s/iter; left time: 7080.1262s
Epoch: 22 cost time: 90.0590991973877
Epoch: 22, Steps: 179 | Train Loss: 0.2306945 Vali Loss: 0.3243511 Test Loss: 0.3865778
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.2302331
	speed: 1.4120s/iter; left time: 6937.1497s
Epoch: 23 cost time: 85.95524907112122
Epoch: 23, Steps: 179 | Train Loss: 0.2306812 Vali Loss: 0.3241761 Test Loss: 0.3866757
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.2234681
	speed: 1.2856s/iter; left time: 6085.8616s
Epoch: 24 cost time: 78.64435267448425
Epoch: 24, Steps: 179 | Train Loss: 0.2306617 Vali Loss: 0.3244581 Test Loss: 0.3866196
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.2217395
	speed: 1.2353s/iter; left time: 5626.6917s
Epoch: 25 cost time: 79.44253039360046
Epoch: 25, Steps: 179 | Train Loss: 0.2306311 Vali Loss: 0.3245310 Test Loss: 0.3867095
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.2309786
	speed: 1.3634s/iter; left time: 5966.1960s
Epoch: 26 cost time: 89.1687388420105
Epoch: 26, Steps: 179 | Train Loss: 0.2305402 Vali Loss: 0.3237997 Test Loss: 0.3865913
EarlyStopping counter: 13 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.2265270
	speed: 1.3595s/iter; left time: 5705.8544s
Epoch: 27 cost time: 81.44951891899109
Epoch: 27, Steps: 179 | Train Loss: 0.2305119 Vali Loss: 0.3235663 Test Loss: 0.3864260
Validation loss decreased (0.323602 --> 0.323566).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2578645
	speed: 1.2724s/iter; left time: 5112.4342s
Epoch: 28 cost time: 77.25748705863953
Epoch: 28, Steps: 179 | Train Loss: 0.2305383 Vali Loss: 0.3252336 Test Loss: 0.3868246
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.2182337
	speed: 1.2286s/iter; left time: 4716.6085s
Epoch: 29 cost time: 79.81637763977051
Epoch: 29, Steps: 179 | Train Loss: 0.2304864 Vali Loss: 0.3236264 Test Loss: 0.3864827
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.2340270
	speed: 1.2906s/iter; left time: 4723.5411s
Epoch: 30 cost time: 84.52873134613037
Epoch: 30, Steps: 179 | Train Loss: 0.2304684 Vali Loss: 0.3238674 Test Loss: 0.3864848
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.2225593
	speed: 1.3997s/iter; left time: 4872.5156s
Epoch: 31 cost time: 83.98879909515381
Epoch: 31, Steps: 179 | Train Loss: 0.2304502 Vali Loss: 0.3241394 Test Loss: 0.3862940
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2330471
	speed: 1.3597s/iter; left time: 4489.8196s
Epoch: 32 cost time: 81.82747030258179
Epoch: 32, Steps: 179 | Train Loss: 0.2304077 Vali Loss: 0.3245018 Test Loss: 0.3864000
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2071623
	speed: 1.2594s/iter; left time: 3933.1681s
Epoch: 33 cost time: 76.9119040966034
Epoch: 33, Steps: 179 | Train Loss: 0.2303739 Vali Loss: 0.3234993 Test Loss: 0.3867389
Validation loss decreased (0.323566 --> 0.323499).  Saving model ...
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.2319416
	speed: 1.2712s/iter; left time: 3742.4643s
Epoch: 34 cost time: 83.04255104064941
Epoch: 34, Steps: 179 | Train Loss: 0.2303046 Vali Loss: 0.3241270 Test Loss: 0.3856970
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.2210405
	speed: 1.3755s/iter; left time: 3803.2604s
Epoch: 35 cost time: 85.95678544044495
Epoch: 35, Steps: 179 | Train Loss: 0.2303474 Vali Loss: 0.3241661 Test Loss: 0.3863450
EarlyStopping counter: 2 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.2306813
	speed: 1.2780s/iter; left time: 3304.8540s
Epoch: 36 cost time: 77.58902597427368
Epoch: 36, Steps: 179 | Train Loss: 0.2303391 Vali Loss: 0.3246343 Test Loss: 0.3858865
EarlyStopping counter: 3 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.2340694
	speed: 1.2553s/iter; left time: 3021.4970s
Epoch: 37 cost time: 80.92143487930298
Epoch: 37, Steps: 179 | Train Loss: 0.2302736 Vali Loss: 0.3236947 Test Loss: 0.3859987
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.2394574
	speed: 1.2884s/iter; left time: 2870.5950s
Epoch: 38 cost time: 81.521066904068
Epoch: 38, Steps: 179 | Train Loss: 0.2302717 Vali Loss: 0.3235674 Test Loss: 0.3859362
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.2391485
	speed: 1.3650s/iter; left time: 2796.7832s
Epoch: 39 cost time: 87.01121783256531
Epoch: 39, Steps: 179 | Train Loss: 0.2302114 Vali Loss: 0.3241968 Test Loss: 0.3860662
EarlyStopping counter: 6 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.2344531
	speed: 1.2996s/iter; left time: 2430.1766s
Epoch: 40 cost time: 75.62258100509644
Epoch: 40, Steps: 179 | Train Loss: 0.2302756 Vali Loss: 0.3237130 Test Loss: 0.3862516
EarlyStopping counter: 7 out of 20
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.2226359
	speed: 1.2150s/iter; left time: 2054.4888s
Epoch: 41 cost time: 72.90524053573608
Epoch: 41, Steps: 179 | Train Loss: 0.2302374 Vali Loss: 0.3237093 Test Loss: 0.3860229
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.2220795
	speed: 1.1303s/iter; left time: 1708.9849s
Epoch: 42 cost time: 73.94566035270691
Epoch: 42, Steps: 179 | Train Loss: 0.2302201 Vali Loss: 0.3234909 Test Loss: 0.3861712
Validation loss decreased (0.323499 --> 0.323491).  Saving model ...
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.2362662
	speed: 1.2976s/iter; left time: 1729.7265s
Epoch: 43 cost time: 84.63551926612854
Epoch: 43, Steps: 179 | Train Loss: 0.2301602 Vali Loss: 0.3241205 Test Loss: 0.3864040
EarlyStopping counter: 1 out of 20
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.2414080
	speed: 1.3517s/iter; left time: 1559.8414s
Epoch: 44 cost time: 82.4909896850586
Epoch: 44, Steps: 179 | Train Loss: 0.2301703 Vali Loss: 0.3240859 Test Loss: 0.3859943
EarlyStopping counter: 2 out of 20
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.2265571
	speed: 1.2719s/iter; left time: 1240.1231s
Epoch: 45 cost time: 75.94429993629456
Epoch: 45, Steps: 179 | Train Loss: 0.2301865 Vali Loss: 0.3239264 Test Loss: 0.3859562
EarlyStopping counter: 3 out of 20
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.2275703
	speed: 1.2264s/iter; left time: 976.1931s
Epoch: 46 cost time: 77.22654366493225
Epoch: 46, Steps: 179 | Train Loss: 0.2301316 Vali Loss: 0.3241458 Test Loss: 0.3862150
EarlyStopping counter: 4 out of 20
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.2346821
	speed: 1.2961s/iter; left time: 799.7144s
Epoch: 47 cost time: 85.93524527549744
Epoch: 47, Steps: 179 | Train Loss: 0.2301660 Vali Loss: 0.3237095 Test Loss: 0.3862020
EarlyStopping counter: 5 out of 20
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.2446136
	speed: 1.4519s/iter; left time: 635.9346s
Epoch: 48 cost time: 87.42132496833801
Epoch: 48, Steps: 179 | Train Loss: 0.2301131 Vali Loss: 0.3230666 Test Loss: 0.3859532
Validation loss decreased (0.323491 --> 0.323067).  Saving model ...
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.2164375
	speed: 1.3170s/iter; left time: 341.1128s
Epoch: 49 cost time: 79.27827167510986
Epoch: 49, Steps: 179 | Train Loss: 0.2301424 Vali Loss: 0.3249649 Test Loss: 0.3861820
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.2157134
	speed: 1.2303s/iter; left time: 98.4253s
Epoch: 50 cost time: 79.10665678977966
Epoch: 50, Steps: 179 | Train Loss: 0.2301200 Vali Loss: 0.3245472 Test Loss: 0.3860518
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.0497355408796396e-05
>>>>>>>testing : Traffic_720_j96_H10_FITS_custom_ftM_sl720_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.385630339384079, mae:0.26843467354774475, rse:0.5142082571983337, corr:[0.27586168 0.2925374  0.2923342  0.29261234 0.29224974 0.292815
 0.29251084 0.2925056  0.29287127 0.29280847 0.29289755 0.29263678
 0.29249015 0.29204342 0.2920709  0.29198942 0.29174837 0.29212162
 0.29232672 0.29226118 0.29204524 0.29210928 0.29203087 0.29166833
 0.29305443 0.2933031  0.29312336 0.2929623  0.29275247 0.29286847
 0.29260805 0.2925547  0.2927915  0.29271084 0.29303905 0.29311177
 0.2929813  0.29277247 0.29245323 0.29237404 0.29236236 0.29255688
 0.29238766 0.29237908 0.29261777 0.2926212  0.29266593 0.29249167
 0.2929022  0.29300082 0.29250252 0.2922767  0.29235905 0.29248244
 0.29227677 0.2921589  0.29249975 0.29234788 0.2923746  0.2921873
 0.29181227 0.29185766 0.2914259  0.29172733 0.29203543 0.29189512
 0.29202533 0.2917635  0.2918915  0.29198822 0.29196936 0.2922243
 0.2920321  0.29188967 0.29159066 0.29157922 0.29196227 0.2917237
 0.2913953  0.2913528  0.29133588 0.2911423  0.29142016 0.29156876
 0.29132345 0.29163    0.29126644 0.29130954 0.29123658 0.29095393
 0.29105857 0.2904937  0.2907032  0.28950027 0.29103512 0.2915459 ]
