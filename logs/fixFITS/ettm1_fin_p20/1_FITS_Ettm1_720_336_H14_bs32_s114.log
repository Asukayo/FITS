Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=122, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_336', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=20, pred_len=336, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTm1_720_336_FITS_ETTm1_ftM_sl720_ll48_pl336_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33505
val 11185
test 11185
Model(
  (freq_upsampler): Linear(in_features=122, out_features=178, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  9728768.0
params:  21894.0
Trainable parameters:  21894
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3707329
	speed: 0.1278s/iter; left time: 3328.8609s
	iters: 200, epoch: 1 | loss: 0.3818050
	speed: 0.1198s/iter; left time: 3108.0500s
	iters: 300, epoch: 1 | loss: 0.3544000
	speed: 0.1253s/iter; left time: 3239.1688s
	iters: 400, epoch: 1 | loss: 0.3755364
	speed: 0.1234s/iter; left time: 3177.3687s
	iters: 500, epoch: 1 | loss: 0.3350034
	speed: 0.1197s/iter; left time: 3071.5634s
Epoch: 1 cost time: 64.48803877830505
Epoch: 1, Steps: 523 | Train Loss: 0.3916969 Vali Loss: 0.6908887 Test Loss: 0.3681287
Validation loss decreased (inf --> 0.690889).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3487071
	speed: 0.8948s/iter; left time: 22841.4418s
	iters: 200, epoch: 2 | loss: 0.3257140
	speed: 0.1292s/iter; left time: 3285.5283s
	iters: 300, epoch: 2 | loss: 0.3017485
	speed: 0.1423s/iter; left time: 3604.5057s
	iters: 400, epoch: 2 | loss: 0.3467057
	speed: 0.1566s/iter; left time: 3951.9092s
	iters: 500, epoch: 2 | loss: 0.3843762
	speed: 0.1356s/iter; left time: 3406.1466s
Epoch: 2 cost time: 74.39135384559631
Epoch: 2, Steps: 523 | Train Loss: 0.3411916 Vali Loss: 0.6702926 Test Loss: 0.3668477
Validation loss decreased (0.690889 --> 0.670293).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3716893
	speed: 0.8852s/iter; left time: 22134.1249s
	iters: 200, epoch: 3 | loss: 0.3554907
	speed: 0.1188s/iter; left time: 2958.1076s
	iters: 300, epoch: 3 | loss: 0.3417513
	speed: 0.1379s/iter; left time: 3420.1934s
	iters: 400, epoch: 3 | loss: 0.3504614
	speed: 0.1293s/iter; left time: 3194.8523s
	iters: 500, epoch: 3 | loss: 0.3149876
	speed: 0.1398s/iter; left time: 3440.8051s
Epoch: 3 cost time: 65.71052670478821
Epoch: 3, Steps: 523 | Train Loss: 0.3385491 Vali Loss: 0.6617051 Test Loss: 0.3666943
Validation loss decreased (0.670293 --> 0.661705).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3784200
	speed: 0.8648s/iter; left time: 21172.9455s
	iters: 200, epoch: 4 | loss: 0.4182978
	speed: 0.1234s/iter; left time: 3007.8441s
	iters: 300, epoch: 4 | loss: 0.3591255
	speed: 0.1181s/iter; left time: 2867.4091s
	iters: 400, epoch: 4 | loss: 0.2817628
	speed: 0.1206s/iter; left time: 2917.2806s
	iters: 500, epoch: 4 | loss: 0.3170643
	speed: 0.1113s/iter; left time: 2680.4308s
Epoch: 4 cost time: 64.11068367958069
Epoch: 4, Steps: 523 | Train Loss: 0.3376482 Vali Loss: 0.6582654 Test Loss: 0.3674900
Validation loss decreased (0.661705 --> 0.658265).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3787327
	speed: 0.7090s/iter; left time: 16987.0607s
	iters: 200, epoch: 5 | loss: 0.3207573
	speed: 0.1039s/iter; left time: 2478.1684s
	iters: 300, epoch: 5 | loss: 0.3300050
	speed: 0.0893s/iter; left time: 2122.2508s
	iters: 400, epoch: 5 | loss: 0.3102961
	speed: 0.0845s/iter; left time: 2000.1454s
	iters: 500, epoch: 5 | loss: 0.3622571
	speed: 0.0849s/iter; left time: 2000.0688s
Epoch: 5 cost time: 50.05575489997864
Epoch: 5, Steps: 523 | Train Loss: 0.3373074 Vali Loss: 0.6579524 Test Loss: 0.3659339
Validation loss decreased (0.658265 --> 0.657952).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3612802
	speed: 0.5568s/iter; left time: 13050.0454s
	iters: 200, epoch: 6 | loss: 0.3601065
	speed: 0.0877s/iter; left time: 2045.5032s
	iters: 300, epoch: 6 | loss: 0.2929933
	speed: 0.0884s/iter; left time: 2053.5679s
	iters: 400, epoch: 6 | loss: 0.3433380
	speed: 0.1047s/iter; left time: 2421.2803s
	iters: 500, epoch: 6 | loss: 0.3258768
	speed: 0.0884s/iter; left time: 2037.4004s
Epoch: 6 cost time: 47.46597385406494
Epoch: 6, Steps: 523 | Train Loss: 0.3369850 Vali Loss: 0.6564192 Test Loss: 0.3665478
Validation loss decreased (0.657952 --> 0.656419).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.3519975
	speed: 0.8230s/iter; left time: 18857.2845s
	iters: 200, epoch: 7 | loss: 0.3314019
	speed: 0.1281s/iter; left time: 2922.9190s
	iters: 300, epoch: 7 | loss: 0.3648149
	speed: 0.1272s/iter; left time: 2889.7414s
	iters: 400, epoch: 7 | loss: 0.3634175
	speed: 0.1300s/iter; left time: 2939.1836s
	iters: 500, epoch: 7 | loss: 0.3429022
	speed: 0.1292s/iter; left time: 2908.5301s
Epoch: 7 cost time: 68.39907741546631
Epoch: 7, Steps: 523 | Train Loss: 0.3368729 Vali Loss: 0.6596495 Test Loss: 0.3667205
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.3384134
	speed: 0.9076s/iter; left time: 20321.2683s
	iters: 200, epoch: 8 | loss: 0.3507920
	speed: 0.1311s/iter; left time: 2923.1693s
	iters: 300, epoch: 8 | loss: 0.3645328
	speed: 0.1264s/iter; left time: 2804.9046s
	iters: 400, epoch: 8 | loss: 0.3323050
	speed: 0.1261s/iter; left time: 2784.5802s
	iters: 500, epoch: 8 | loss: 0.3160103
	speed: 0.1249s/iter; left time: 2747.0192s
Epoch: 8 cost time: 67.61341381072998
Epoch: 8, Steps: 523 | Train Loss: 0.3366550 Vali Loss: 0.6531783 Test Loss: 0.3675136
Validation loss decreased (0.656419 --> 0.653178).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3511348
	speed: 0.9009s/iter; left time: 19700.5740s
	iters: 200, epoch: 9 | loss: 0.3501178
	speed: 0.1263s/iter; left time: 2748.1982s
	iters: 300, epoch: 9 | loss: 0.3398495
	speed: 0.1268s/iter; left time: 2746.5703s
	iters: 400, epoch: 9 | loss: 0.3427826
	speed: 0.1303s/iter; left time: 2809.3391s
	iters: 500, epoch: 9 | loss: 0.3322234
	speed: 0.1211s/iter; left time: 2598.7621s
Epoch: 9 cost time: 67.0453667640686
Epoch: 9, Steps: 523 | Train Loss: 0.3366267 Vali Loss: 0.6561401 Test Loss: 0.3668739
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.3847783
	speed: 0.8493s/iter; left time: 18127.6625s
	iters: 200, epoch: 10 | loss: 0.3461296
	speed: 0.1210s/iter; left time: 2570.1907s
	iters: 300, epoch: 10 | loss: 0.3478420
	speed: 0.1308s/iter; left time: 2765.1473s
	iters: 400, epoch: 10 | loss: 0.3046376
	speed: 0.1120s/iter; left time: 2357.4884s
	iters: 500, epoch: 10 | loss: 0.3359780
	speed: 0.0980s/iter; left time: 2052.0868s
Epoch: 10 cost time: 63.454872131347656
Epoch: 10, Steps: 523 | Train Loss: 0.3364309 Vali Loss: 0.6554130 Test Loss: 0.3665783
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.3298725
	speed: 0.9345s/iter; left time: 19458.1187s
	iters: 200, epoch: 11 | loss: 0.3434837
	speed: 0.1279s/iter; left time: 2650.9620s
	iters: 300, epoch: 11 | loss: 0.3441348
	speed: 0.1316s/iter; left time: 2712.8545s
	iters: 400, epoch: 11 | loss: 0.3372432
	speed: 0.1318s/iter; left time: 2703.7450s
	iters: 500, epoch: 11 | loss: 0.3641515
	speed: 0.1284s/iter; left time: 2622.7138s
Epoch: 11 cost time: 69.05295372009277
Epoch: 11, Steps: 523 | Train Loss: 0.3364359 Vali Loss: 0.6551245 Test Loss: 0.3666414
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.3212501
	speed: 0.8996s/iter; left time: 18259.3674s
	iters: 200, epoch: 12 | loss: 0.2885869
	speed: 0.1403s/iter; left time: 2833.7017s
	iters: 300, epoch: 12 | loss: 0.3420736
	speed: 0.1306s/iter; left time: 2624.0627s
	iters: 400, epoch: 12 | loss: 0.4370009
	speed: 0.1328s/iter; left time: 2656.6505s
	iters: 500, epoch: 12 | loss: 0.2810909
	speed: 0.1326s/iter; left time: 2639.4014s
Epoch: 12 cost time: 70.92564034461975
Epoch: 12, Steps: 523 | Train Loss: 0.3363652 Vali Loss: 0.6562700 Test Loss: 0.3668705
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2996816
	speed: 0.9156s/iter; left time: 18106.9179s
	iters: 200, epoch: 13 | loss: 0.3459212
	speed: 0.1282s/iter; left time: 2521.6959s
	iters: 300, epoch: 13 | loss: 0.3338078
	speed: 0.1362s/iter; left time: 2666.9292s
	iters: 400, epoch: 13 | loss: 0.2899638
	speed: 0.1322s/iter; left time: 2574.5593s
	iters: 500, epoch: 13 | loss: 0.3336879
	speed: 0.1303s/iter; left time: 2524.9648s
Epoch: 13 cost time: 69.992915391922
Epoch: 13, Steps: 523 | Train Loss: 0.3363096 Vali Loss: 0.6555702 Test Loss: 0.3666888
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.3264392
	speed: 0.8505s/iter; left time: 16372.9436s
	iters: 200, epoch: 14 | loss: 0.3444988
	speed: 0.0960s/iter; left time: 1839.3981s
	iters: 300, epoch: 14 | loss: 0.3335165
	speed: 0.1113s/iter; left time: 2121.2879s
	iters: 400, epoch: 14 | loss: 0.3429874
	speed: 0.1333s/iter; left time: 2526.8234s
	iters: 500, epoch: 14 | loss: 0.3300228
	speed: 0.1324s/iter; left time: 2495.5648s
Epoch: 14 cost time: 62.58418869972229
Epoch: 14, Steps: 523 | Train Loss: 0.3362840 Vali Loss: 0.6534004 Test Loss: 0.3666455
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.3822892
	speed: 0.9331s/iter; left time: 17476.1066s
	iters: 200, epoch: 15 | loss: 0.3680017
	speed: 0.1257s/iter; left time: 2341.5614s
	iters: 300, epoch: 15 | loss: 0.3355954
	speed: 0.1207s/iter; left time: 2236.7035s
	iters: 400, epoch: 15 | loss: 0.3414054
	speed: 0.1327s/iter; left time: 2444.9103s
	iters: 500, epoch: 15 | loss: 0.3665287
	speed: 0.1305s/iter; left time: 2391.9841s
Epoch: 15 cost time: 67.89153385162354
Epoch: 15, Steps: 523 | Train Loss: 0.3362748 Vali Loss: 0.6532311 Test Loss: 0.3666819
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.3355823
	speed: 0.8823s/iter; left time: 16063.2177s
	iters: 200, epoch: 16 | loss: 0.3640705
	speed: 0.1252s/iter; left time: 2267.2721s
	iters: 300, epoch: 16 | loss: 0.3674075
	speed: 0.1243s/iter; left time: 2238.7650s
	iters: 400, epoch: 16 | loss: 0.3501377
	speed: 0.1277s/iter; left time: 2286.1941s
	iters: 500, epoch: 16 | loss: 0.2988926
	speed: 0.1237s/iter; left time: 2203.4328s
Epoch: 16 cost time: 66.92054390907288
Epoch: 16, Steps: 523 | Train Loss: 0.3361435 Vali Loss: 0.6545471 Test Loss: 0.3665858
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.3104362
	speed: 0.9959s/iter; left time: 17610.7371s
	iters: 200, epoch: 17 | loss: 0.3294693
	speed: 0.1551s/iter; left time: 2727.0777s
	iters: 300, epoch: 17 | loss: 0.2859578
	speed: 0.1571s/iter; left time: 2746.4559s
	iters: 400, epoch: 17 | loss: 0.3442408
	speed: 0.1615s/iter; left time: 2807.5934s
	iters: 500, epoch: 17 | loss: 0.3285514
	speed: 0.1390s/iter; left time: 2402.7176s
Epoch: 17 cost time: 80.90117764472961
Epoch: 17, Steps: 523 | Train Loss: 0.3361421 Vali Loss: 0.6530579 Test Loss: 0.3667751
Validation loss decreased (0.653178 --> 0.653058).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.3231459
	speed: 0.8565s/iter; left time: 14698.3045s
	iters: 200, epoch: 18 | loss: 0.3129251
	speed: 0.1267s/iter; left time: 2161.7553s
	iters: 300, epoch: 18 | loss: 0.3455286
	speed: 0.1291s/iter; left time: 2188.7165s
	iters: 400, epoch: 18 | loss: 0.3520806
	speed: 0.1229s/iter; left time: 2071.8715s
	iters: 500, epoch: 18 | loss: 0.3619160
	speed: 0.1205s/iter; left time: 2019.6502s
Epoch: 18 cost time: 64.41171860694885
Epoch: 18, Steps: 523 | Train Loss: 0.3360569 Vali Loss: 0.6536990 Test Loss: 0.3667075
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.3744525
	speed: 0.8380s/iter; left time: 13941.7444s
	iters: 200, epoch: 19 | loss: 0.3474375
	speed: 0.1213s/iter; left time: 2006.4710s
	iters: 300, epoch: 19 | loss: 0.3195364
	speed: 0.1201s/iter; left time: 1974.5836s
	iters: 400, epoch: 19 | loss: 0.3026414
	speed: 0.1266s/iter; left time: 2068.8985s
	iters: 500, epoch: 19 | loss: 0.3423055
	speed: 0.1162s/iter; left time: 1887.2073s
Epoch: 19 cost time: 64.9937002658844
Epoch: 19, Steps: 523 | Train Loss: 0.3359629 Vali Loss: 0.6539595 Test Loss: 0.3665306
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.3020439
	speed: 0.7409s/iter; left time: 11939.1542s
	iters: 200, epoch: 20 | loss: 0.3444691
	speed: 0.1172s/iter; left time: 1876.4715s
	iters: 300, epoch: 20 | loss: 0.3279981
	speed: 0.1184s/iter; left time: 1884.4385s
	iters: 400, epoch: 20 | loss: 0.3918943
	speed: 0.1181s/iter; left time: 1867.2199s
	iters: 500, epoch: 20 | loss: 0.3241556
	speed: 0.1194s/iter; left time: 1876.3173s
Epoch: 20 cost time: 60.89522051811218
Epoch: 20, Steps: 523 | Train Loss: 0.3360589 Vali Loss: 0.6527840 Test Loss: 0.3672539
Validation loss decreased (0.653058 --> 0.652784).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.3110266
	speed: 0.8269s/iter; left time: 12892.4890s
	iters: 200, epoch: 21 | loss: 0.3321865
	speed: 0.1287s/iter; left time: 1993.6582s
	iters: 300, epoch: 21 | loss: 0.3693446
	speed: 0.1231s/iter; left time: 1894.8127s
	iters: 400, epoch: 21 | loss: 0.3824846
	speed: 0.1086s/iter; left time: 1660.9729s
	iters: 500, epoch: 21 | loss: 0.3380546
	speed: 0.1173s/iter; left time: 1781.6043s
Epoch: 21 cost time: 64.26877498626709
Epoch: 21, Steps: 523 | Train Loss: 0.3360715 Vali Loss: 0.6532852 Test Loss: 0.3668113
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.3626350
	speed: 0.8586s/iter; left time: 12937.6234s
	iters: 200, epoch: 22 | loss: 0.3206284
	speed: 0.1190s/iter; left time: 1780.8811s
	iters: 300, epoch: 22 | loss: 0.3193761
	speed: 0.1265s/iter; left time: 1881.1350s
	iters: 400, epoch: 22 | loss: 0.3244624
	speed: 0.1222s/iter; left time: 1805.0669s
	iters: 500, epoch: 22 | loss: 0.3720976
	speed: 0.1217s/iter; left time: 1784.8100s
Epoch: 22 cost time: 65.5271987915039
Epoch: 22, Steps: 523 | Train Loss: 0.3360310 Vali Loss: 0.6530361 Test Loss: 0.3666518
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.3499472
	speed: 0.8530s/iter; left time: 12407.0508s
	iters: 200, epoch: 23 | loss: 0.3261814
	speed: 0.1195s/iter; left time: 1726.3447s
	iters: 300, epoch: 23 | loss: 0.2989065
	speed: 0.1180s/iter; left time: 1692.5522s
	iters: 400, epoch: 23 | loss: 0.3118805
	speed: 0.1210s/iter; left time: 1723.2192s
	iters: 500, epoch: 23 | loss: 0.3467416
	speed: 0.1237s/iter; left time: 1750.4046s
Epoch: 23 cost time: 64.86741185188293
Epoch: 23, Steps: 523 | Train Loss: 0.3359991 Vali Loss: 0.6544676 Test Loss: 0.3662543
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.3095844
	speed: 0.8134s/iter; left time: 11405.9748s
	iters: 200, epoch: 24 | loss: 0.3538123
	speed: 0.1199s/iter; left time: 1669.3536s
	iters: 300, epoch: 24 | loss: 0.3573693
	speed: 0.1233s/iter; left time: 1704.9278s
	iters: 400, epoch: 24 | loss: 0.3373092
	speed: 0.1196s/iter; left time: 1641.0259s
	iters: 500, epoch: 24 | loss: 0.3588627
	speed: 0.1226s/iter; left time: 1670.6563s
Epoch: 24 cost time: 64.11204624176025
Epoch: 24, Steps: 523 | Train Loss: 0.3359603 Vali Loss: 0.6534550 Test Loss: 0.3667758
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.3315865
	speed: 0.8448s/iter; left time: 11404.6180s
	iters: 200, epoch: 25 | loss: 0.3754077
	speed: 0.1364s/iter; left time: 1827.5609s
	iters: 300, epoch: 25 | loss: 0.3625726
	speed: 0.1427s/iter; left time: 1897.3861s
	iters: 400, epoch: 25 | loss: 0.3111389
	speed: 0.1410s/iter; left time: 1860.7921s
	iters: 500, epoch: 25 | loss: 0.3605160
	speed: 0.1432s/iter; left time: 1876.2088s
Epoch: 25 cost time: 73.31993556022644
Epoch: 25, Steps: 523 | Train Loss: 0.3359565 Vali Loss: 0.6547353 Test Loss: 0.3665688
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.3094757
	speed: 0.9585s/iter; left time: 12438.0164s
	iters: 200, epoch: 26 | loss: 0.3563001
	speed: 0.1107s/iter; left time: 1425.5398s
	iters: 300, epoch: 26 | loss: 0.3439118
	speed: 0.1015s/iter; left time: 1296.6269s
	iters: 400, epoch: 26 | loss: 0.3577388
	speed: 0.1419s/iter; left time: 1798.2297s
	iters: 500, epoch: 26 | loss: 0.3392165
	speed: 0.1531s/iter; left time: 1925.8632s
Epoch: 26 cost time: 67.4419777393341
Epoch: 26, Steps: 523 | Train Loss: 0.3359101 Vali Loss: 0.6534865 Test Loss: 0.3664069
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.3173451
	speed: 0.9500s/iter; left time: 11830.0171s
	iters: 200, epoch: 27 | loss: 0.3390902
	speed: 0.1197s/iter; left time: 1478.4385s
	iters: 300, epoch: 27 | loss: 0.3512795
	speed: 0.1185s/iter; left time: 1452.2287s
	iters: 400, epoch: 27 | loss: 0.3386014
	speed: 0.1286s/iter; left time: 1563.4612s
	iters: 500, epoch: 27 | loss: 0.3206342
	speed: 0.1044s/iter; left time: 1258.7263s
Epoch: 27 cost time: 63.28445482254028
Epoch: 27, Steps: 523 | Train Loss: 0.3359027 Vali Loss: 0.6533262 Test Loss: 0.3665872
EarlyStopping counter: 7 out of 20
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.2939667
	speed: 0.7475s/iter; left time: 8917.3483s
	iters: 200, epoch: 28 | loss: 0.3390284
	speed: 0.1193s/iter; left time: 1411.0440s
	iters: 300, epoch: 28 | loss: 0.3161472
	speed: 0.1240s/iter; left time: 1454.6847s
	iters: 400, epoch: 28 | loss: 0.3198125
	speed: 0.1184s/iter; left time: 1377.3447s
	iters: 500, epoch: 28 | loss: 0.3917974
	speed: 0.1195s/iter; left time: 1378.2543s
Epoch: 28 cost time: 63.89931654930115
Epoch: 28, Steps: 523 | Train Loss: 0.3358692 Vali Loss: 0.6528246 Test Loss: 0.3665210
EarlyStopping counter: 8 out of 20
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.3225503
	speed: 0.8233s/iter; left time: 9391.3608s
	iters: 200, epoch: 29 | loss: 0.3031506
	speed: 0.1210s/iter; left time: 1367.6679s
	iters: 300, epoch: 29 | loss: 0.3300259
	speed: 0.1317s/iter; left time: 1476.2771s
	iters: 400, epoch: 29 | loss: 0.3188907
	speed: 0.1275s/iter; left time: 1416.0845s
	iters: 500, epoch: 29 | loss: 0.2825156
	speed: 0.1334s/iter; left time: 1468.2304s
Epoch: 29 cost time: 67.12984609603882
Epoch: 29, Steps: 523 | Train Loss: 0.3359032 Vali Loss: 0.6536331 Test Loss: 0.3664014
EarlyStopping counter: 9 out of 20
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.3189492
	speed: 0.8800s/iter; left time: 9577.3859s
	iters: 200, epoch: 30 | loss: 0.3352806
	speed: 0.1074s/iter; left time: 1157.9260s
	iters: 300, epoch: 30 | loss: 0.3317827
	speed: 0.1001s/iter; left time: 1068.9829s
	iters: 400, epoch: 30 | loss: 0.3674553
	speed: 0.1067s/iter; left time: 1129.5536s
	iters: 500, epoch: 30 | loss: 0.3564222
	speed: 0.1364s/iter; left time: 1429.8495s
Epoch: 30 cost time: 61.41596245765686
Epoch: 30, Steps: 523 | Train Loss: 0.3358150 Vali Loss: 0.6537660 Test Loss: 0.3660769
EarlyStopping counter: 10 out of 20
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.3395999
	speed: 0.9497s/iter; left time: 9840.0242s
	iters: 200, epoch: 31 | loss: 0.3126576
	speed: 0.1259s/iter; left time: 1292.0775s
	iters: 300, epoch: 31 | loss: 0.2679500
	speed: 0.1381s/iter; left time: 1402.9982s
	iters: 400, epoch: 31 | loss: 0.3524196
	speed: 0.1383s/iter; left time: 1391.4084s
	iters: 500, epoch: 31 | loss: 0.3423183
	speed: 0.1354s/iter; left time: 1349.1405s
Epoch: 31 cost time: 71.44041037559509
Epoch: 31, Steps: 523 | Train Loss: 0.3358036 Vali Loss: 0.6530989 Test Loss: 0.3665905
EarlyStopping counter: 11 out of 20
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.2954339
	speed: 0.9366s/iter; left time: 9214.4219s
	iters: 200, epoch: 32 | loss: 0.3330984
	speed: 0.1349s/iter; left time: 1313.8657s
	iters: 300, epoch: 32 | loss: 0.3158909
	speed: 0.1370s/iter; left time: 1320.2710s
	iters: 400, epoch: 32 | loss: 0.3350625
	speed: 0.1363s/iter; left time: 1299.9915s
	iters: 500, epoch: 32 | loss: 0.2755834
	speed: 0.1337s/iter; left time: 1261.6297s
Epoch: 32 cost time: 71.27667880058289
Epoch: 32, Steps: 523 | Train Loss: 0.3357722 Vali Loss: 0.6539525 Test Loss: 0.3663376
EarlyStopping counter: 12 out of 20
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.2909397
	speed: 0.9135s/iter; left time: 8509.3151s
	iters: 200, epoch: 33 | loss: 0.3092593
	speed: 0.1326s/iter; left time: 1221.6056s
	iters: 300, epoch: 33 | loss: 0.3160039
	speed: 0.1342s/iter; left time: 1223.4197s
	iters: 400, epoch: 33 | loss: 0.3409936
	speed: 0.1374s/iter; left time: 1238.4748s
	iters: 500, epoch: 33 | loss: 0.3238785
	speed: 0.1389s/iter; left time: 1237.9173s
Epoch: 33 cost time: 71.33720517158508
Epoch: 33, Steps: 523 | Train Loss: 0.3357534 Vali Loss: 0.6536520 Test Loss: 0.3665916
EarlyStopping counter: 13 out of 20
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.3536279
	speed: 0.9104s/iter; left time: 8003.8370s
	iters: 200, epoch: 34 | loss: 0.3523938
	speed: 0.1161s/iter; left time: 1008.7159s
	iters: 300, epoch: 34 | loss: 0.3718012
	speed: 0.1197s/iter; left time: 1028.6043s
	iters: 400, epoch: 34 | loss: 0.3119407
	speed: 0.1494s/iter; left time: 1268.5741s
	iters: 500, epoch: 34 | loss: 0.4029149
	speed: 0.1468s/iter; left time: 1232.3177s
Epoch: 34 cost time: 70.01421976089478
Epoch: 34, Steps: 523 | Train Loss: 0.3357653 Vali Loss: 0.6527964 Test Loss: 0.3667098
EarlyStopping counter: 14 out of 20
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.3324713
	speed: 0.9647s/iter; left time: 7976.7093s
	iters: 200, epoch: 35 | loss: 0.3362448
	speed: 0.1333s/iter; left time: 1089.2875s
	iters: 300, epoch: 35 | loss: 0.3777085
	speed: 0.1374s/iter; left time: 1108.5609s
	iters: 400, epoch: 35 | loss: 0.3266295
	speed: 0.1283s/iter; left time: 1022.0764s
	iters: 500, epoch: 35 | loss: 0.3512322
	speed: 0.1342s/iter; left time: 1055.8009s
Epoch: 35 cost time: 69.94156527519226
Epoch: 35, Steps: 523 | Train Loss: 0.3357735 Vali Loss: 0.6545669 Test Loss: 0.3666021
EarlyStopping counter: 15 out of 20
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.3252249
	speed: 0.9451s/iter; left time: 7320.4658s
	iters: 200, epoch: 36 | loss: 0.3544613
	speed: 0.1314s/iter; left time: 1004.4317s
	iters: 300, epoch: 36 | loss: 0.3001263
	speed: 0.1270s/iter; left time: 958.6100s
	iters: 400, epoch: 36 | loss: 0.3374356
	speed: 0.1294s/iter; left time: 963.8469s
	iters: 500, epoch: 36 | loss: 0.3375216
	speed: 0.1274s/iter; left time: 935.7305s
Epoch: 36 cost time: 68.82786202430725
Epoch: 36, Steps: 523 | Train Loss: 0.3357570 Vali Loss: 0.6536455 Test Loss: 0.3663661
EarlyStopping counter: 16 out of 20
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.3312607
	speed: 0.9022s/iter; left time: 6516.2426s
	iters: 200, epoch: 37 | loss: 0.3838682
	speed: 0.1344s/iter; left time: 957.2799s
	iters: 300, epoch: 37 | loss: 0.3423661
	speed: 0.1375s/iter; left time: 965.4695s
	iters: 400, epoch: 37 | loss: 0.3131053
	speed: 0.1309s/iter; left time: 906.4044s
	iters: 500, epoch: 37 | loss: 0.3697357
	speed: 0.1349s/iter; left time: 920.2471s
Epoch: 37 cost time: 71.29951167106628
Epoch: 37, Steps: 523 | Train Loss: 0.3357595 Vali Loss: 0.6544938 Test Loss: 0.3663966
EarlyStopping counter: 17 out of 20
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.3090617
	speed: 0.9286s/iter; left time: 6221.7253s
	iters: 200, epoch: 38 | loss: 0.3007642
	speed: 0.1339s/iter; left time: 883.9855s
	iters: 300, epoch: 38 | loss: 0.3531080
	speed: 0.1368s/iter; left time: 888.8753s
	iters: 400, epoch: 38 | loss: 0.3437353
	speed: 0.1351s/iter; left time: 864.3518s
	iters: 500, epoch: 38 | loss: 0.3263460
	speed: 0.1349s/iter; left time: 849.5862s
Epoch: 38 cost time: 71.2490622997284
Epoch: 38, Steps: 523 | Train Loss: 0.3357493 Vali Loss: 0.6535305 Test Loss: 0.3663893
EarlyStopping counter: 18 out of 20
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.3146965
	speed: 0.8674s/iter; left time: 5357.9819s
	iters: 200, epoch: 39 | loss: 0.3163440
	speed: 0.1338s/iter; left time: 812.9823s
	iters: 300, epoch: 39 | loss: 0.3059753
	speed: 0.1368s/iter; left time: 817.5865s
	iters: 400, epoch: 39 | loss: 0.3345810
	speed: 0.1335s/iter; left time: 784.8478s
	iters: 500, epoch: 39 | loss: 0.2988445
	speed: 0.1284s/iter; left time: 741.9705s
Epoch: 39 cost time: 71.05512428283691
Epoch: 39, Steps: 523 | Train Loss: 0.3357585 Vali Loss: 0.6536965 Test Loss: 0.3664792
EarlyStopping counter: 19 out of 20
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.3095499
	speed: 0.9790s/iter; left time: 5535.0347s
	iters: 200, epoch: 40 | loss: 0.3378941
	speed: 0.1341s/iter; left time: 744.7108s
	iters: 300, epoch: 40 | loss: 0.3586695
	speed: 0.1350s/iter; left time: 736.4197s
	iters: 400, epoch: 40 | loss: 0.2952445
	speed: 0.1361s/iter; left time: 728.8921s
	iters: 500, epoch: 40 | loss: 0.3666462
	speed: 0.1346s/iter; left time: 707.3449s
Epoch: 40 cost time: 71.69934844970703
Epoch: 40, Steps: 523 | Train Loss: 0.3356615 Vali Loss: 0.6538222 Test Loss: 0.3666623
EarlyStopping counter: 20 out of 20
Early stopping
>>>>>>>testing : ETTm1_720_336_FITS_ETTm1_ftM_sl720_ll48_pl336_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11185
mse:0.3671506345272064, mae:0.3851087987422943, rse:0.5765944719314575, corr:[0.53784543 0.5450703  0.5476341  0.5487552  0.55035377 0.5524192
 0.55388415 0.5544575  0.5548474  0.5556064  0.55677205 0.55780506
 0.55838144 0.5584609  0.55815464 0.55751187 0.5566219  0.5556482
 0.55461514 0.5535425  0.5523324  0.55080354 0.5489844  0.54725426
 0.5456384  0.5443886  0.5434905  0.542775   0.5424359  0.5425714
 0.5432096  0.5442402  0.5451659  0.5457352  0.54573905 0.54568887
 0.5456769  0.5457873  0.54588294 0.5457506  0.5455548  0.5453356
 0.5451725  0.5451096  0.5449158  0.54458344 0.5444036  0.5444656
 0.54455906 0.5443911  0.5439996  0.5435226  0.5432693  0.54330504
 0.5436205  0.5439848  0.54415727 0.5440119  0.54374284 0.5433953
 0.54307455 0.5428052  0.54259986 0.5424334  0.5425553  0.54300493
 0.5435738  0.5440212  0.5442611  0.5443065  0.5442983  0.5442675
 0.5441601  0.54395413 0.54374623 0.5435528  0.5433604  0.54315424
 0.5428659  0.54250026 0.54212856 0.5418136  0.54159826 0.5414003
 0.54119515 0.5409382  0.54075134 0.54074454 0.5410015  0.54151136
 0.5420476  0.54237324 0.54241365 0.5423032  0.5422181  0.54221535
 0.54222804 0.5421291  0.54164886 0.54088366 0.5401021  0.5395796
 0.5394159  0.53941226 0.5394389  0.53943    0.5392633  0.53906083
 0.5388237  0.5386016  0.5383817  0.53812164 0.5378526  0.5376438
 0.53748685 0.53734386 0.5371612  0.53690857 0.536683   0.53661644
 0.5366803  0.5367789  0.53678256 0.5367404  0.53665745 0.5364331
 0.5360532  0.5356333  0.53527623 0.5351343  0.5351415  0.5351745
 0.5351817  0.5350798  0.5348231  0.53456306 0.53449273 0.5345038
 0.53461766 0.53480214 0.5349274  0.53503025 0.53512937 0.53520733
 0.5352628  0.5352704  0.53533983 0.5354564  0.53556514 0.53549933
 0.53524494 0.53500664 0.53491473 0.53499824 0.53514    0.5352668
 0.5352754  0.53513455 0.53498447 0.5347904  0.5346591  0.534588
 0.5346379  0.53488487 0.53538156 0.5360166  0.53656346 0.53684545
 0.5367928  0.53655076 0.5364674  0.5366711  0.53694737 0.53705335
 0.536866   0.536466   0.5360562  0.535848   0.53587246 0.5360773
 0.53630924 0.5364864  0.53655    0.53657776 0.53657    0.5365042
 0.5364273  0.53653264 0.53692526 0.5375099  0.5380781  0.538392
 0.5382857  0.5378464  0.53716314 0.53640866 0.53572935 0.5351603
 0.5345596  0.5338269  0.53297997 0.53218377 0.53156567 0.5311579
 0.53084844 0.53042656 0.5297477  0.5289036  0.528073   0.52741647
 0.5269546  0.5266479  0.52632535 0.52588356 0.5252639  0.52464616
 0.524156   0.5237326  0.523384   0.5230876  0.52293646 0.5230331
 0.5233617  0.5236331  0.52374405 0.5236849  0.52352023 0.52343464
 0.52353704 0.5237948  0.5240669  0.524175   0.52413243 0.52407223
 0.5241021  0.52431196 0.5245264  0.5248244  0.52509004 0.52533007
 0.5254895  0.5254734  0.52539    0.5253365  0.52535844 0.5253469
 0.5252612  0.52516204 0.5250406  0.5249292  0.5247246  0.5244998
 0.5242359  0.5241282  0.52415156 0.52423376 0.52429956 0.5242769
 0.5241689  0.5240821  0.5241135  0.52431804 0.5246255  0.5249713
 0.5251395  0.5250938  0.5249609  0.5249286  0.5250267  0.52511936
 0.5251575  0.52508545 0.5249601  0.5248571  0.5247465  0.52459115
 0.5243371  0.52413636 0.52404636 0.52422523 0.52457577 0.5249297
 0.52518326 0.525288   0.5252394  0.5251178  0.52491635 0.5245544
 0.5240655  0.5236018  0.5232191  0.52280736 0.5223423  0.5217739
 0.52111757 0.5203492  0.51964957 0.5190217  0.5184378  0.517877
 0.5173247  0.5168776  0.5166109  0.5164313  0.5161721  0.5156823
 0.5151611  0.51470083 0.51442415 0.51430315 0.5142728  0.51415795
 0.5139491  0.5138171  0.51375985 0.5137472  0.5136857  0.51360136
 0.51357615 0.5136706  0.51391757 0.5141608  0.5141209  0.513654
 0.5129349  0.51242954 0.5123534  0.5126716  0.51300234 0.5130498
 0.5129375  0.5128646  0.5130157  0.51344335 0.5136532  0.5118421 ]
