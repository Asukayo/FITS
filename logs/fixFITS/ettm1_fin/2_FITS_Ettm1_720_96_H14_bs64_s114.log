Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=122, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=6, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:6
>>>>>>>start training : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=122, out_features=138, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  15085056.0
params:  16974.0
Trainable parameters:  16974
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3564827
	speed: 0.1455s/iter; left time: 1899.3779s
	iters: 200, epoch: 1 | loss: 0.2734513
	speed: 0.1403s/iter; left time: 1816.9473s
Epoch: 1 cost time: 37.201594829559326
Epoch: 1, Steps: 263 | Train Loss: 0.3542643 Vali Loss: 0.6558377 Test Loss: 0.4608999
Validation loss decreased (inf --> 0.655838).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2038237
	speed: 0.5871s/iter; left time: 7507.9991s
	iters: 200, epoch: 2 | loss: 0.1862581
	speed: 0.1334s/iter; left time: 1693.0451s
Epoch: 2 cost time: 35.00200629234314
Epoch: 2, Steps: 263 | Train Loss: 0.1982243 Vali Loss: 0.6147363 Test Loss: 0.4525211
Validation loss decreased (0.655838 --> 0.614736).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1527531
	speed: 0.5877s/iter; left time: 7360.8427s
	iters: 200, epoch: 3 | loss: 0.1305307
	speed: 0.1285s/iter; left time: 1597.1880s
Epoch: 3 cost time: 34.5581841468811
Epoch: 3, Steps: 263 | Train Loss: 0.1450481 Vali Loss: 0.5837135 Test Loss: 0.4385962
Validation loss decreased (0.614736 --> 0.583713).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1137179
	speed: 0.6062s/iter; left time: 7433.0516s
	iters: 200, epoch: 4 | loss: 0.1074450
	speed: 0.1276s/iter; left time: 1552.3650s
Epoch: 4 cost time: 34.5068473815918
Epoch: 4, Steps: 263 | Train Loss: 0.1134180 Vali Loss: 0.5517941 Test Loss: 0.4236217
Validation loss decreased (0.583713 --> 0.551794).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0946705
	speed: 0.6016s/iter; left time: 7219.0595s
	iters: 200, epoch: 5 | loss: 0.0843131
	speed: 0.1325s/iter; left time: 1576.8494s
Epoch: 5 cost time: 35.30856919288635
Epoch: 5, Steps: 263 | Train Loss: 0.0926512 Vali Loss: 0.5303097 Test Loss: 0.4103497
Validation loss decreased (0.551794 --> 0.530310).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0789870
	speed: 0.4897s/iter; left time: 5747.4454s
	iters: 200, epoch: 6 | loss: 0.0773078
	speed: 0.0921s/iter; left time: 1072.0528s
Epoch: 6 cost time: 27.067402124404907
Epoch: 6, Steps: 263 | Train Loss: 0.0787165 Vali Loss: 0.5097665 Test Loss: 0.3979763
Validation loss decreased (0.530310 --> 0.509766).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0721990
	speed: 0.5702s/iter; left time: 6541.6650s
	iters: 200, epoch: 7 | loss: 0.0672856
	speed: 0.1402s/iter; left time: 1594.7681s
Epoch: 7 cost time: 37.25399661064148
Epoch: 7, Steps: 263 | Train Loss: 0.0691931 Vali Loss: 0.4940471 Test Loss: 0.3864833
Validation loss decreased (0.509766 --> 0.494047).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0610477
	speed: 0.6073s/iter; left time: 6808.2529s
	iters: 200, epoch: 8 | loss: 0.0629636
	speed: 0.1362s/iter; left time: 1513.6489s
Epoch: 8 cost time: 36.99482011795044
Epoch: 8, Steps: 263 | Train Loss: 0.0625211 Vali Loss: 0.4815664 Test Loss: 0.3771752
Validation loss decreased (0.494047 --> 0.481566).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0580395
	speed: 0.6195s/iter; left time: 6781.8764s
	iters: 200, epoch: 9 | loss: 0.0588078
	speed: 0.1244s/iter; left time: 1349.2627s
Epoch: 9 cost time: 33.54282212257385
Epoch: 9, Steps: 263 | Train Loss: 0.0578257 Vali Loss: 0.4720938 Test Loss: 0.3698096
Validation loss decreased (0.481566 --> 0.472094).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0537377
	speed: 0.5874s/iter; left time: 6275.7040s
	iters: 200, epoch: 10 | loss: 0.0532811
	speed: 0.1260s/iter; left time: 1333.5912s
Epoch: 10 cost time: 33.83903908729553
Epoch: 10, Steps: 263 | Train Loss: 0.0544615 Vali Loss: 0.4601513 Test Loss: 0.3628923
Validation loss decreased (0.472094 --> 0.460151).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0541134
	speed: 0.5705s/iter; left time: 5944.7539s
	iters: 200, epoch: 11 | loss: 0.0526636
	speed: 0.1321s/iter; left time: 1363.1917s
Epoch: 11 cost time: 35.092787981033325
Epoch: 11, Steps: 263 | Train Loss: 0.0520362 Vali Loss: 0.4550944 Test Loss: 0.3565923
Validation loss decreased (0.460151 --> 0.455094).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0500021
	speed: 0.5757s/iter; left time: 5848.1429s
	iters: 200, epoch: 12 | loss: 0.0478589
	speed: 0.1374s/iter; left time: 1381.6743s
Epoch: 12 cost time: 36.995091676712036
Epoch: 12, Steps: 263 | Train Loss: 0.0502698 Vali Loss: 0.4480943 Test Loss: 0.3517693
Validation loss decreased (0.455094 --> 0.448094).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0537725
	speed: 0.5803s/iter; left time: 5742.3942s
	iters: 200, epoch: 13 | loss: 0.0478888
	speed: 0.1046s/iter; left time: 1024.6966s
Epoch: 13 cost time: 29.373001098632812
Epoch: 13, Steps: 263 | Train Loss: 0.0489854 Vali Loss: 0.4414393 Test Loss: 0.3458491
Validation loss decreased (0.448094 --> 0.441439).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0488161
	speed: 0.4551s/iter; left time: 4383.6341s
	iters: 200, epoch: 14 | loss: 0.0497313
	speed: 0.1248s/iter; left time: 1189.1295s
Epoch: 14 cost time: 33.13190293312073
Epoch: 14, Steps: 263 | Train Loss: 0.0480272 Vali Loss: 0.4370073 Test Loss: 0.3423749
Validation loss decreased (0.441439 --> 0.437007).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0449592
	speed: 0.6256s/iter; left time: 5860.8554s
	iters: 200, epoch: 15 | loss: 0.0456005
	speed: 0.1138s/iter; left time: 1055.0500s
Epoch: 15 cost time: 34.20055627822876
Epoch: 15, Steps: 263 | Train Loss: 0.0473374 Vali Loss: 0.4344891 Test Loss: 0.3386090
Validation loss decreased (0.437007 --> 0.434489).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0527534
	speed: 0.5894s/iter; left time: 5367.2490s
	iters: 200, epoch: 16 | loss: 0.0430200
	speed: 0.1313s/iter; left time: 1182.4840s
Epoch: 16 cost time: 35.85719966888428
Epoch: 16, Steps: 263 | Train Loss: 0.0468247 Vali Loss: 0.4337312 Test Loss: 0.3357050
Validation loss decreased (0.434489 --> 0.433731).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0492751
	speed: 0.5755s/iter; left time: 5089.3129s
	iters: 200, epoch: 17 | loss: 0.0439527
	speed: 0.1250s/iter; left time: 1093.0901s
Epoch: 17 cost time: 34.37074303627014
Epoch: 17, Steps: 263 | Train Loss: 0.0464583 Vali Loss: 0.4291542 Test Loss: 0.3328303
Validation loss decreased (0.433731 --> 0.429154).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0460377
	speed: 0.5874s/iter; left time: 5040.0968s
	iters: 200, epoch: 18 | loss: 0.0503717
	speed: 0.1267s/iter; left time: 1074.2922s
Epoch: 18 cost time: 33.462846994400024
Epoch: 18, Steps: 263 | Train Loss: 0.0461714 Vali Loss: 0.4266547 Test Loss: 0.3307267
Validation loss decreased (0.429154 --> 0.426655).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0477568
	speed: 0.5790s/iter; left time: 4815.9582s
	iters: 200, epoch: 19 | loss: 0.0435480
	speed: 0.1256s/iter; left time: 1031.8583s
Epoch: 19 cost time: 33.84636378288269
Epoch: 19, Steps: 263 | Train Loss: 0.0459645 Vali Loss: 0.4244221 Test Loss: 0.3294641
Validation loss decreased (0.426655 --> 0.424422).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0496207
	speed: 0.5767s/iter; left time: 4644.4727s
	iters: 200, epoch: 20 | loss: 0.0461057
	speed: 0.1310s/iter; left time: 1041.7583s
Epoch: 20 cost time: 34.16934514045715
Epoch: 20, Steps: 263 | Train Loss: 0.0458148 Vali Loss: 0.4227929 Test Loss: 0.3274226
Validation loss decreased (0.424422 --> 0.422793).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0477801
	speed: 0.4032s/iter; left time: 3141.3024s
	iters: 200, epoch: 21 | loss: 0.0444738
	speed: 0.1127s/iter; left time: 866.7602s
Epoch: 21 cost time: 28.75592017173767
Epoch: 21, Steps: 263 | Train Loss: 0.0456995 Vali Loss: 0.4241658 Test Loss: 0.3266265
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0479378
	speed: 0.5506s/iter; left time: 4144.9422s
	iters: 200, epoch: 22 | loss: 0.0474455
	speed: 0.1186s/iter; left time: 881.2845s
Epoch: 22 cost time: 30.20983099937439
Epoch: 22, Steps: 263 | Train Loss: 0.0456268 Vali Loss: 0.4226114 Test Loss: 0.3248832
Validation loss decreased (0.422793 --> 0.422611).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0458828
	speed: 0.4107s/iter; left time: 2983.4651s
	iters: 200, epoch: 23 | loss: 0.0420759
	speed: 0.1367s/iter; left time: 979.3438s
Epoch: 23 cost time: 32.558268785476685
Epoch: 23, Steps: 263 | Train Loss: 0.0455574 Vali Loss: 0.4232310 Test Loss: 0.3242854
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0449994
	speed: 0.4343s/iter; left time: 3040.6447s
	iters: 200, epoch: 24 | loss: 0.0473287
	speed: 0.0855s/iter; left time: 589.8720s
Epoch: 24 cost time: 27.532496690750122
Epoch: 24, Steps: 263 | Train Loss: 0.0455234 Vali Loss: 0.4202614 Test Loss: 0.3235651
Validation loss decreased (0.422611 --> 0.420261).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0472030
	speed: 0.5959s/iter; left time: 4015.5638s
	iters: 200, epoch: 25 | loss: 0.0414610
	speed: 0.1215s/iter; left time: 806.6583s
Epoch: 25 cost time: 33.01125717163086
Epoch: 25, Steps: 263 | Train Loss: 0.0454995 Vali Loss: 0.4219367 Test Loss: 0.3233004
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0439333
	speed: 0.5732s/iter; left time: 3712.0252s
	iters: 200, epoch: 26 | loss: 0.0441807
	speed: 0.1197s/iter; left time: 762.9790s
Epoch: 26 cost time: 32.31895589828491
Epoch: 26, Steps: 263 | Train Loss: 0.0454830 Vali Loss: 0.4215973 Test Loss: 0.3230274
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0485087
	speed: 0.5257s/iter; left time: 3266.2672s
	iters: 200, epoch: 27 | loss: 0.0417618
	speed: 0.1216s/iter; left time: 743.1450s
Epoch: 27 cost time: 33.067044496536255
Epoch: 27, Steps: 263 | Train Loss: 0.0454631 Vali Loss: 0.4208021 Test Loss: 0.3229320
EarlyStopping counter: 3 out of 3
Early stopping
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=122, out_features=138, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  15085056.0
params:  16974.0
Trainable parameters:  16974
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2731251
	speed: 0.1348s/iter; left time: 1758.9131s
	iters: 200, epoch: 1 | loss: 0.2700417
	speed: 0.1225s/iter; left time: 1586.0271s
Epoch: 1 cost time: 34.841153144836426
Epoch: 1, Steps: 263 | Train Loss: 0.2671621 Vali Loss: 0.4017083 Test Loss: 0.3121180
Validation loss decreased (inf --> 0.401708).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2616915
	speed: 0.6148s/iter; left time: 7862.5392s
	iters: 200, epoch: 2 | loss: 0.2704425
	speed: 0.1226s/iter; left time: 1555.5364s
Epoch: 2 cost time: 33.29676604270935
Epoch: 2, Steps: 263 | Train Loss: 0.2643926 Vali Loss: 0.3979808 Test Loss: 0.3079683
Validation loss decreased (0.401708 --> 0.397981).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2729227
	speed: 0.5873s/iter; left time: 7355.7837s
	iters: 200, epoch: 3 | loss: 0.2534641
	speed: 0.1186s/iter; left time: 1473.5728s
Epoch: 3 cost time: 32.94060921669006
Epoch: 3, Steps: 263 | Train Loss: 0.2633334 Vali Loss: 0.3987484 Test Loss: 0.3095174
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2535317
	speed: 0.5842s/iter; left time: 7162.8557s
	iters: 200, epoch: 4 | loss: 0.2502792
	speed: 0.1305s/iter; left time: 1586.6239s
Epoch: 4 cost time: 35.41846179962158
Epoch: 4, Steps: 263 | Train Loss: 0.2628863 Vali Loss: 0.3957241 Test Loss: 0.3091740
Validation loss decreased (0.397981 --> 0.395724).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2604067
	speed: 0.5625s/iter; left time: 6749.1304s
	iters: 200, epoch: 5 | loss: 0.2625346
	speed: 0.1294s/iter; left time: 1540.1006s
Epoch: 5 cost time: 33.588648557662964
Epoch: 5, Steps: 263 | Train Loss: 0.2625884 Vali Loss: 0.3982682 Test Loss: 0.3083944
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2737577
	speed: 0.5635s/iter; left time: 6612.8156s
	iters: 200, epoch: 6 | loss: 0.2655935
	speed: 0.1244s/iter; left time: 1447.4909s
Epoch: 6 cost time: 33.03629159927368
Epoch: 6, Steps: 263 | Train Loss: 0.2623888 Vali Loss: 0.4006491 Test Loss: 0.3091187
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2463282
	speed: 0.5424s/iter; left time: 6223.2767s
	iters: 200, epoch: 7 | loss: 0.2677567
	speed: 0.1133s/iter; left time: 1288.3101s
Epoch: 7 cost time: 30.3636372089386
Epoch: 7, Steps: 263 | Train Loss: 0.2621440 Vali Loss: 0.3952647 Test Loss: 0.3087024
Validation loss decreased (0.395724 --> 0.395265).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2808951
	speed: 0.5589s/iter; left time: 6265.4729s
	iters: 200, epoch: 8 | loss: 0.2606885
	speed: 0.1234s/iter; left time: 1370.6329s
Epoch: 8 cost time: 32.862077951431274
Epoch: 8, Steps: 263 | Train Loss: 0.2620703 Vali Loss: 0.3942840 Test Loss: 0.3085235
Validation loss decreased (0.395265 --> 0.394284).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2542784
	speed: 0.4832s/iter; left time: 5290.0443s
	iters: 200, epoch: 9 | loss: 0.2485616
	speed: 0.1281s/iter; left time: 1389.5627s
Epoch: 9 cost time: 31.36544680595398
Epoch: 9, Steps: 263 | Train Loss: 0.2618071 Vali Loss: 0.3945809 Test Loss: 0.3079456
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2611252
	speed: 0.5228s/iter; left time: 5585.1692s
	iters: 200, epoch: 10 | loss: 0.2537541
	speed: 0.1261s/iter; left time: 1335.0480s
Epoch: 10 cost time: 33.137319564819336
Epoch: 10, Steps: 263 | Train Loss: 0.2619543 Vali Loss: 0.3974793 Test Loss: 0.3078493
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2457099
	speed: 0.6042s/iter; left time: 6296.6364s
	iters: 200, epoch: 11 | loss: 0.2374314
	speed: 0.1254s/iter; left time: 1294.7216s
Epoch: 11 cost time: 33.813026666641235
Epoch: 11, Steps: 263 | Train Loss: 0.2617561 Vali Loss: 0.3964526 Test Loss: 0.3084604
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.31015753746032715, mae:0.3523811995983124, rse:0.5299355983734131, corr:[0.54537994 0.55483323 0.55858195 0.56029785 0.56292486 0.5660528
 0.56781006 0.5677946  0.56734955 0.5676764  0.5688257  0.5697559
 0.5698063  0.5691854  0.56851274 0.56802267 0.5674383  0.56648344
 0.56513554 0.56369394 0.5623798  0.561027   0.55938524 0.5575899
 0.5557361  0.55432975 0.553563   0.55312186 0.5528482  0.55267835
 0.5527722  0.55327123 0.5539199  0.5544903  0.55463946 0.5547036
 0.5546903  0.5546529  0.55442655 0.55382043 0.55320656 0.55292475
 0.5531724  0.5537847  0.55410624 0.55390924 0.55362236 0.5536852
 0.5540848  0.5543908  0.5543293  0.55382264 0.5532163  0.55282253
 0.55283237 0.5529603  0.55282664 0.5523171  0.55186707 0.5516714
 0.55175793 0.55182207 0.55157125 0.5508648  0.5502137  0.5500899
 0.55047905 0.5510495  0.55153984 0.5517573  0.5517472  0.5515649
 0.551296   0.5510291  0.55094385 0.5508984  0.5506682  0.5501672
 0.5494342  0.5486476  0.5480543  0.54771554 0.54762274 0.5475821
 0.54756755 0.5474992  0.54736394 0.5470645  0.54671854 0.546686
 0.5470871  0.5477266  0.5483104  0.5488747  0.54975826 0.5509436 ]
