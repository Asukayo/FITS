Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=74, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=6, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_720', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=720, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:6
>>>>>>>start training : ETTm1_720_720_FITS_ETTm1_ftM_sl720_ll48_pl720_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33121
val 10801
test 10801
Model(
  (freq_upsampler): Linear(in_features=74, out_features=148, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4906496.0
params:  11100.0
Trainable parameters:  11100
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.5038861
	speed: 0.1897s/iter; left time: 4885.5716s
	iters: 200, epoch: 1 | loss: 0.4434310
	speed: 0.1802s/iter; left time: 4623.2616s
	iters: 300, epoch: 1 | loss: 0.4792714
	speed: 0.1816s/iter; left time: 4641.0361s
	iters: 400, epoch: 1 | loss: 0.3842121
	speed: 0.1852s/iter; left time: 4714.3504s
	iters: 500, epoch: 1 | loss: 0.3992698
	speed: 0.1889s/iter; left time: 4788.5203s
Epoch: 1 cost time: 95.88034915924072
Epoch: 1, Steps: 517 | Train Loss: 0.4700077 Vali Loss: 0.9720299 Test Loss: 0.4215903
Validation loss decreased (inf --> 0.972030).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3789485
	speed: 1.1648s/iter; left time: 29393.7240s
	iters: 200, epoch: 2 | loss: 0.4186436
	speed: 0.1610s/iter; left time: 4046.5100s
	iters: 300, epoch: 2 | loss: 0.4113219
	speed: 0.1663s/iter; left time: 4163.3156s
	iters: 400, epoch: 2 | loss: 0.4259454
	speed: 0.1607s/iter; left time: 4006.6559s
	iters: 500, epoch: 2 | loss: 0.4389037
	speed: 0.1622s/iter; left time: 4027.4583s
Epoch: 2 cost time: 85.91884303092957
Epoch: 2, Steps: 517 | Train Loss: 0.4031963 Vali Loss: 0.9466947 Test Loss: 0.4141191
Validation loss decreased (0.972030 --> 0.946695).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3744378
	speed: 1.0605s/iter; left time: 26213.3247s
	iters: 200, epoch: 3 | loss: 0.4261226
	speed: 0.1769s/iter; left time: 4353.6482s
	iters: 300, epoch: 3 | loss: 0.4140534
	speed: 0.1616s/iter; left time: 3961.5533s
	iters: 400, epoch: 3 | loss: 0.4326310
	speed: 0.1564s/iter; left time: 3818.6585s
	iters: 500, epoch: 3 | loss: 0.4461265
	speed: 0.1575s/iter; left time: 3829.3665s
Epoch: 3 cost time: 85.7405731678009
Epoch: 3, Steps: 517 | Train Loss: 0.3994750 Vali Loss: 0.9401349 Test Loss: 0.4150996
Validation loss decreased (0.946695 --> 0.940135).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3416472
	speed: 1.0173s/iter; left time: 24619.2317s
	iters: 200, epoch: 4 | loss: 0.4021545
	speed: 0.1372s/iter; left time: 3306.2574s
	iters: 300, epoch: 4 | loss: 0.3529643
	speed: 0.1306s/iter; left time: 3134.1003s
	iters: 400, epoch: 4 | loss: 0.3666441
	speed: 0.1410s/iter; left time: 3370.8410s
	iters: 500, epoch: 4 | loss: 0.4021384
	speed: 0.1508s/iter; left time: 3589.0031s
Epoch: 4 cost time: 74.28858852386475
Epoch: 4, Steps: 517 | Train Loss: 0.3986297 Vali Loss: 0.9358925 Test Loss: 0.4161730
Validation loss decreased (0.940135 --> 0.935892).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.4296501
	speed: 1.3045s/iter; left time: 30894.6976s
	iters: 200, epoch: 5 | loss: 0.4550599
	speed: 0.1936s/iter; left time: 4566.1005s
	iters: 300, epoch: 5 | loss: 0.3752937
	speed: 0.1802s/iter; left time: 4231.2885s
	iters: 400, epoch: 5 | loss: 0.4144154
	speed: 0.1568s/iter; left time: 3667.2169s
	iters: 500, epoch: 5 | loss: 0.4686385
	speed: 0.1629s/iter; left time: 3792.3113s
Epoch: 5 cost time: 95.01771903038025
Epoch: 5, Steps: 517 | Train Loss: 0.3982452 Vali Loss: 0.9344436 Test Loss: 0.4158193
Validation loss decreased (0.935892 --> 0.934444).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.4001361
	speed: 1.0757s/iter; left time: 24918.5528s
	iters: 200, epoch: 6 | loss: 0.3997238
	speed: 0.1510s/iter; left time: 3483.6514s
	iters: 300, epoch: 6 | loss: 0.4134038
	speed: 0.1516s/iter; left time: 3482.2483s
	iters: 400, epoch: 6 | loss: 0.3606589
	speed: 0.1498s/iter; left time: 3425.9350s
	iters: 500, epoch: 6 | loss: 0.4156011
	speed: 0.1663s/iter; left time: 3785.8285s
Epoch: 6 cost time: 81.0400288105011
Epoch: 6, Steps: 517 | Train Loss: 0.3980621 Vali Loss: 0.9351039 Test Loss: 0.4164684
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.4015507
	speed: 1.2725s/iter; left time: 28820.6920s
	iters: 200, epoch: 7 | loss: 0.4068608
	speed: 0.1816s/iter; left time: 4093.9665s
	iters: 300, epoch: 7 | loss: 0.4153801
	speed: 0.1849s/iter; left time: 4150.4236s
