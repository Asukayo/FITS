Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=90, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=6, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_192', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=192, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:6
>>>>>>>start training : ETTm1_720_192_FITS_ETTm1_ftM_sl720_ll48_pl192_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33649
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=90, out_features=114, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  9192960.0
params:  10374.0
Trainable parameters:  10374
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3803429
	speed: 0.1297s/iter; left time: 1686.5127s
	iters: 200, epoch: 1 | loss: 0.3044580
	speed: 0.1223s/iter; left time: 1577.2201s
Epoch: 1 cost time: 33.0793354511261
Epoch: 1, Steps: 262 | Train Loss: 0.3679778 Vali Loss: 0.7354929 Test Loss: 0.4567736
Validation loss decreased (inf --> 0.735493).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2190901
	speed: 0.5511s/iter; left time: 7020.7684s
	iters: 200, epoch: 2 | loss: 0.1857283
	speed: 0.1261s/iter; left time: 1593.6444s
Epoch: 2 cost time: 32.445899963378906
Epoch: 2, Steps: 262 | Train Loss: 0.2108290 Vali Loss: 0.6636040 Test Loss: 0.4324567
Validation loss decreased (0.735493 --> 0.663604).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1594903
	speed: 0.5588s/iter; left time: 6971.5829s
	iters: 200, epoch: 3 | loss: 0.1454720
	speed: 0.1208s/iter; left time: 1495.3224s
Epoch: 3 cost time: 33.12731051445007
Epoch: 3, Steps: 262 | Train Loss: 0.1610741 Vali Loss: 0.6294360 Test Loss: 0.4190887
Validation loss decreased (0.663604 --> 0.629436).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1357280
	speed: 0.5515s/iter; left time: 6736.8531s
	iters: 200, epoch: 4 | loss: 0.1280470
	speed: 0.1147s/iter; left time: 1389.0425s
Epoch: 4 cost time: 31.424694538116455
Epoch: 4, Steps: 262 | Train Loss: 0.1334606 Vali Loss: 0.6094214 Test Loss: 0.4069180
Validation loss decreased (0.629436 --> 0.609421).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1170897
	speed: 0.5562s/iter; left time: 6648.2821s
	iters: 200, epoch: 5 | loss: 0.1111891
	speed: 0.1313s/iter; left time: 1556.0351s
Epoch: 5 cost time: 33.90744638442993
Epoch: 5, Steps: 262 | Train Loss: 0.1160344 Vali Loss: 0.5914824 Test Loss: 0.3983925
Validation loss decreased (0.609421 --> 0.591482).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1050930
	speed: 0.5670s/iter; left time: 6628.9485s
	iters: 200, epoch: 6 | loss: 0.1065017
	speed: 0.1261s/iter; left time: 1461.3054s
Epoch: 6 cost time: 32.848323583602905
Epoch: 6, Steps: 262 | Train Loss: 0.1046311 Vali Loss: 0.5820891 Test Loss: 0.3897876
Validation loss decreased (0.591482 --> 0.582089).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1054856
	speed: 0.5657s/iter; left time: 6465.0532s
	iters: 200, epoch: 7 | loss: 0.0969644
	speed: 0.1210s/iter; left time: 1370.3618s
Epoch: 7 cost time: 32.16913890838623
Epoch: 7, Steps: 262 | Train Loss: 0.0970667 Vali Loss: 0.5703413 Test Loss: 0.3829668
Validation loss decreased (0.582089 --> 0.570341).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0955142
	speed: 0.5065s/iter; left time: 5655.7337s
	iters: 200, epoch: 8 | loss: 0.0960734
	speed: 0.1258s/iter; left time: 1392.5303s
Epoch: 8 cost time: 30.37378716468811
Epoch: 8, Steps: 262 | Train Loss: 0.0919005 Vali Loss: 0.5632153 Test Loss: 0.3778511
Validation loss decreased (0.570341 --> 0.563215).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0851457
	speed: 0.4642s/iter; left time: 5062.6125s
	iters: 200, epoch: 9 | loss: 0.0851324
	speed: 0.1254s/iter; left time: 1355.4746s
Epoch: 9 cost time: 31.018574714660645
Epoch: 9, Steps: 262 | Train Loss: 0.0883686 Vali Loss: 0.5591980 Test Loss: 0.3734435
Validation loss decreased (0.563215 --> 0.559198).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0889378
	speed: 0.5696s/iter; left time: 6062.1297s
	iters: 200, epoch: 10 | loss: 0.0965172
	speed: 0.1132s/iter; left time: 1193.0168s
Epoch: 10 cost time: 31.767943382263184
Epoch: 10, Steps: 262 | Train Loss: 0.0858719 Vali Loss: 0.5535053 Test Loss: 0.3697425
Validation loss decreased (0.559198 --> 0.553505).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0832067
	speed: 0.4980s/iter; left time: 5169.3074s
	iters: 200, epoch: 11 | loss: 0.0820509
	speed: 0.1155s/iter; left time: 1186.9624s
Epoch: 11 cost time: 30.432989597320557
Epoch: 11, Steps: 262 | Train Loss: 0.0841570 Vali Loss: 0.5493667 Test Loss: 0.3669870
Validation loss decreased (0.553505 --> 0.549367).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0925039
	speed: 0.5217s/iter; left time: 5279.3361s
	iters: 200, epoch: 12 | loss: 0.0866696
	speed: 0.1255s/iter; left time: 1257.5901s
Epoch: 12 cost time: 33.19580793380737
Epoch: 12, Steps: 262 | Train Loss: 0.0829142 Vali Loss: 0.5467358 Test Loss: 0.3640814
Validation loss decreased (0.549367 --> 0.546736).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0804562
	speed: 0.5928s/iter; left time: 5843.4589s
	iters: 200, epoch: 13 | loss: 0.0884586
	speed: 0.1239s/iter; left time: 1209.2342s
Epoch: 13 cost time: 34.2269012928009
Epoch: 13, Steps: 262 | Train Loss: 0.0820060 Vali Loss: 0.5433583 Test Loss: 0.3615808
Validation loss decreased (0.546736 --> 0.543358).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0795319
	speed: 0.5686s/iter; left time: 5455.5117s
	iters: 200, epoch: 14 | loss: 0.0890995
	speed: 0.1200s/iter; left time: 1139.5607s
Epoch: 14 cost time: 31.10724139213562
Epoch: 14, Steps: 262 | Train Loss: 0.0813113 Vali Loss: 0.5423580 Test Loss: 0.3593692
Validation loss decreased (0.543358 --> 0.542358).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0817032
	speed: 0.5318s/iter; left time: 4963.1461s
	iters: 200, epoch: 15 | loss: 0.0748171
	speed: 0.1294s/iter; left time: 1194.8837s
Epoch: 15 cost time: 33.559521198272705
Epoch: 15, Steps: 262 | Train Loss: 0.0808384 Vali Loss: 0.5405789 Test Loss: 0.3574567
Validation loss decreased (0.542358 --> 0.540579).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0818166
	speed: 0.5176s/iter; left time: 4695.1743s
	iters: 200, epoch: 16 | loss: 0.0842975
	speed: 0.1286s/iter; left time: 1153.2574s
Epoch: 16 cost time: 33.38049530982971
Epoch: 16, Steps: 262 | Train Loss: 0.0805151 Vali Loss: 0.5389636 Test Loss: 0.3559380
Validation loss decreased (0.540579 --> 0.538964).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0773705
	speed: 0.6124s/iter; left time: 5395.0691s
	iters: 200, epoch: 17 | loss: 0.0824658
	speed: 0.1394s/iter; left time: 1213.8777s
Epoch: 17 cost time: 37.12634587287903
Epoch: 17, Steps: 262 | Train Loss: 0.0802045 Vali Loss: 0.5386988 Test Loss: 0.3545756
Validation loss decreased (0.538964 --> 0.538699).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0790454
	speed: 0.5929s/iter; left time: 5067.8184s
	iters: 200, epoch: 18 | loss: 0.0800734
	speed: 0.1335s/iter; left time: 1127.7058s
Epoch: 18 cost time: 34.27581810951233
Epoch: 18, Steps: 262 | Train Loss: 0.0800012 Vali Loss: 0.5389202 Test Loss: 0.3532489
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0783012
	speed: 0.5277s/iter; left time: 4371.7058s
	iters: 200, epoch: 19 | loss: 0.0842239
	speed: 0.1169s/iter; left time: 957.1038s
Epoch: 19 cost time: 29.71185564994812
Epoch: 19, Steps: 262 | Train Loss: 0.0798621 Vali Loss: 0.5367543 Test Loss: 0.3520931
Validation loss decreased (0.538699 --> 0.536754).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0884023
	speed: 0.4399s/iter; left time: 3529.2418s
	iters: 200, epoch: 20 | loss: 0.0889592
	speed: 0.1059s/iter; left time: 839.1070s
Epoch: 20 cost time: 29.71186661720276
Epoch: 20, Steps: 262 | Train Loss: 0.0797288 Vali Loss: 0.5362952 Test Loss: 0.3509658
Validation loss decreased (0.536754 --> 0.536295).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0784761
	speed: 0.4951s/iter; left time: 3842.1576s
	iters: 200, epoch: 21 | loss: 0.0853990
	speed: 0.1154s/iter; left time: 883.8989s
Epoch: 21 cost time: 30.801432847976685
Epoch: 21, Steps: 262 | Train Loss: 0.0796735 Vali Loss: 0.5350420 Test Loss: 0.3508568
Validation loss decreased (0.536295 --> 0.535042).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0787622
	speed: 0.4884s/iter; left time: 3662.2356s
	iters: 200, epoch: 22 | loss: 0.0807289
	speed: 0.1105s/iter; left time: 817.8037s
Epoch: 22 cost time: 30.25302767753601
Epoch: 22, Steps: 262 | Train Loss: 0.0796010 Vali Loss: 0.5364475 Test Loss: 0.3496547
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0800056
	speed: 0.5164s/iter; left time: 3737.5332s
	iters: 200, epoch: 23 | loss: 0.0739064
	speed: 0.1024s/iter; left time: 730.8255s
Epoch: 23 cost time: 29.72317385673523
Epoch: 23, Steps: 262 | Train Loss: 0.0795532 Vali Loss: 0.5360657 Test Loss: 0.3496250
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0840827
	speed: 0.5547s/iter; left time: 3869.2839s
	iters: 200, epoch: 24 | loss: 0.0803017
	speed: 0.1151s/iter; left time: 791.5973s
Epoch: 24 cost time: 31.28076672554016
Epoch: 24, Steps: 262 | Train Loss: 0.0795224 Vali Loss: 0.5347404 Test Loss: 0.3492029
Validation loss decreased (0.535042 --> 0.534740).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0799339
	speed: 0.5366s/iter; left time: 3602.4454s
	iters: 200, epoch: 25 | loss: 0.0822276
	speed: 0.1181s/iter; left time: 780.9213s
Epoch: 25 cost time: 32.13666558265686
Epoch: 25, Steps: 262 | Train Loss: 0.0794829 Vali Loss: 0.5348750 Test Loss: 0.3484615
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0805991
	speed: 0.5854s/iter; left time: 3776.2899s
	iters: 200, epoch: 26 | loss: 0.0808811
	speed: 0.1410s/iter; left time: 895.5153s
Epoch: 26 cost time: 37.0644257068634
Epoch: 26, Steps: 262 | Train Loss: 0.0794923 Vali Loss: 0.5350370 Test Loss: 0.3484455
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0765815
	speed: 0.5837s/iter; left time: 3612.2435s
	iters: 200, epoch: 27 | loss: 0.0769104
	speed: 0.1130s/iter; left time: 687.7990s
Epoch: 27 cost time: 32.38176465034485
Epoch: 27, Steps: 262 | Train Loss: 0.0794777 Vali Loss: 0.5354567 Test Loss: 0.3480348
EarlyStopping counter: 3 out of 3
Early stopping
train 33649
val 11329
test 11329
Model(
  (freq_upsampler): Linear(in_features=90, out_features=114, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  9192960.0
params:  10374.0
Trainable parameters:  10374
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3081976
	speed: 0.1209s/iter; left time: 1571.6218s
	iters: 200, epoch: 1 | loss: 0.3078048
	speed: 0.1175s/iter; left time: 1515.3107s
Epoch: 1 cost time: 31.80948805809021
Epoch: 1, Steps: 262 | Train Loss: 0.3017620 Vali Loss: 0.5190874 Test Loss: 0.3414560
Validation loss decreased (inf --> 0.519087).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.3054946
	speed: 0.5369s/iter; left time: 6839.9317s
	iters: 200, epoch: 2 | loss: 0.3029221
	speed: 0.1149s/iter; left time: 1451.7537s
Epoch: 2 cost time: 31.087138175964355
Epoch: 2, Steps: 262 | Train Loss: 0.2998760 Vali Loss: 0.5150115 Test Loss: 0.3404621
Validation loss decreased (0.519087 --> 0.515012).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2977888
	speed: 0.4607s/iter; left time: 5747.9361s
	iters: 200, epoch: 3 | loss: 0.3387714
	speed: 0.1061s/iter; left time: 1313.4019s
Epoch: 3 cost time: 25.67278003692627
Epoch: 3, Steps: 262 | Train Loss: 0.2992726 Vali Loss: 0.5125042 Test Loss: 0.3400993
Validation loss decreased (0.515012 --> 0.512504).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2941293
	speed: 0.5054s/iter; left time: 6173.6482s
	iters: 200, epoch: 4 | loss: 0.2686584
	speed: 0.1146s/iter; left time: 1388.3042s
Epoch: 4 cost time: 30.695250749588013
Epoch: 4, Steps: 262 | Train Loss: 0.2988217 Vali Loss: 0.5156472 Test Loss: 0.3393584
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3178360
	speed: 0.5565s/iter; left time: 6651.2912s
	iters: 200, epoch: 5 | loss: 0.3263217
	speed: 0.1234s/iter; left time: 1462.4363s
Epoch: 5 cost time: 34.1969678401947
Epoch: 5, Steps: 262 | Train Loss: 0.2987745 Vali Loss: 0.5153282 Test Loss: 0.3399633
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.3147412
	speed: 0.5817s/iter; left time: 6801.1594s
	iters: 200, epoch: 6 | loss: 0.2700275
	speed: 0.1182s/iter; left time: 1369.7322s
Epoch: 6 cost time: 32.80157446861267
Epoch: 6, Steps: 262 | Train Loss: 0.2985089 Vali Loss: 0.5125101 Test Loss: 0.3391005
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_720_192_FITS_ETTm1_ftM_sl720_ll48_pl192_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11329
mse:0.3400803208351135, mae:0.36981889605522156, rse:0.5551269054412842, corr:[0.54332197 0.55393255 0.5610004  0.563508   0.563334   0.5628409
 0.56315994 0.5643755  0.5659034  0.56695217 0.56714624 0.56664646
 0.56598485 0.56551176 0.5652389  0.56494313 0.5643549  0.5633246
 0.5618442  0.5601141  0.55842435 0.55688995 0.55552495 0.5543597
 0.5531977  0.5521059  0.5512122  0.55058575 0.5503875  0.55058134
 0.55098426 0.5513973  0.5515671  0.5515523  0.55145127 0.5515629
 0.5517957  0.552035   0.5520875  0.55172545 0.55105305 0.5502499
 0.54966    0.549609   0.550013   0.5505789  0.5510482  0.5511765
 0.5508447  0.5501976  0.5496143  0.54934037 0.5494514  0.5497144
 0.54995143 0.55003566 0.54994226 0.54968166 0.54941744 0.5491416
 0.5488865  0.54864055 0.5483705  0.548021   0.5477472  0.5476807
 0.54783803 0.5481537  0.5485131  0.5487632  0.54887813 0.5488552
 0.54874533 0.54863834 0.54862577 0.5486423  0.5485876  0.54841363
 0.54812276 0.5477935  0.54751676 0.54732096 0.54722327 0.5471377
 0.54702806 0.5468168  0.5465161  0.5461429  0.5458106  0.54568326
 0.5458147  0.5461409  0.54654455 0.54689157 0.5470709  0.5470114
 0.54676265 0.5464466  0.546015   0.5455231  0.5450056  0.5444936
 0.5440212  0.5435627  0.54322225 0.5431186  0.54320645 0.5435089
 0.5439126  0.54432577 0.5446314  0.5447092  0.5445233  0.5441043
 0.54351294 0.5428408  0.5421717  0.5415384  0.540992   0.54059416
 0.5403257  0.5401415  0.53999597 0.5399601  0.5400542  0.5402061
 0.5403579  0.5405038  0.5405807  0.54059845 0.54049677 0.54028904
 0.5400714  0.53987306 0.539636   0.53941137 0.53929555 0.5392013
 0.5392152  0.5393926  0.53962344 0.53988373 0.54015356 0.54039544
 0.540549   0.5405025  0.5403084  0.5400177  0.5397659  0.5395612
 0.5394118  0.53942525 0.539519   0.5395815  0.53949165 0.5392985
 0.53901803 0.53865427 0.53836954 0.5381543  0.5381671  0.5383531
 0.53862816 0.5388163  0.5388526  0.5387644  0.53868276 0.53873295
 0.5389262  0.53917146 0.539472   0.53975755 0.53981924 0.53962195
 0.53922975 0.5387556  0.5382636  0.5377823  0.53724474 0.5367466
 0.536352   0.5361747  0.53617203 0.5363692  0.5365948  0.53653926
 0.5359095  0.53509104 0.534855   0.5358599  0.537977   0.54018736]
