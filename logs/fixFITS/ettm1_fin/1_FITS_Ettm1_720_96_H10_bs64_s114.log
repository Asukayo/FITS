Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=90, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=6, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:6
>>>>>>>start training : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=90, out_features=102, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  8225280.0
params:  9282.0
Trainable parameters:  9282
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2995008
	speed: 0.1384s/iter; left time: 1806.7355s
	iters: 200, epoch: 1 | loss: 0.3040550
	speed: 0.1365s/iter; left time: 1767.4574s
Epoch: 1 cost time: 36.1511390209198
Epoch: 1, Steps: 263 | Train Loss: 0.3196636 Vali Loss: 0.4364877 Test Loss: 0.3154390
Validation loss decreased (inf --> 0.436488).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2614377
	speed: 0.6041s/iter; left time: 7725.4212s
	iters: 200, epoch: 2 | loss: 0.2586731
	speed: 0.1451s/iter; left time: 1840.7981s
Epoch: 2 cost time: 38.077393531799316
Epoch: 2, Steps: 263 | Train Loss: 0.2711345 Vali Loss: 0.4160001 Test Loss: 0.3110864
Validation loss decreased (0.436488 --> 0.416000).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2680033
	speed: 0.6225s/iter; left time: 7796.7176s
	iters: 200, epoch: 3 | loss: 0.2804214
	speed: 0.1492s/iter; left time: 1854.0908s
Epoch: 3 cost time: 36.36355400085449
Epoch: 3, Steps: 263 | Train Loss: 0.2672079 Vali Loss: 0.4061695 Test Loss: 0.3099775
Validation loss decreased (0.416000 --> 0.406170).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3021474
	speed: 0.3291s/iter; left time: 4035.7308s
	iters: 200, epoch: 4 | loss: 0.2410740
	speed: 0.1134s/iter; left time: 1379.2491s
Epoch: 4 cost time: 30.510047912597656
Epoch: 4, Steps: 263 | Train Loss: 0.2655829 Vali Loss: 0.4036398 Test Loss: 0.3091121
Validation loss decreased (0.406170 --> 0.403640).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2694594
	speed: 0.5091s/iter; left time: 6109.1294s
	iters: 200, epoch: 5 | loss: 0.2865119
	speed: 0.1300s/iter; left time: 1546.8649s
Epoch: 5 cost time: 35.49620532989502
Epoch: 5, Steps: 263 | Train Loss: 0.2647108 Vali Loss: 0.4033125 Test Loss: 0.3088860
Validation loss decreased (0.403640 --> 0.403313).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2452762
	speed: 0.6486s/iter; left time: 7612.2488s
	iters: 200, epoch: 6 | loss: 0.2560616
	speed: 0.1436s/iter; left time: 1671.0289s
Epoch: 6 cost time: 37.94014310836792
Epoch: 6, Steps: 263 | Train Loss: 0.2640570 Vali Loss: 0.3999636 Test Loss: 0.3089003
Validation loss decreased (0.403313 --> 0.399964).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2778721
	speed: 0.6531s/iter; left time: 7492.6705s
	iters: 200, epoch: 7 | loss: 0.2767904
	speed: 0.1459s/iter; left time: 1658.9322s
Epoch: 7 cost time: 38.580628395080566
Epoch: 7, Steps: 263 | Train Loss: 0.2637148 Vali Loss: 0.4006013 Test Loss: 0.3082568
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2801204
	speed: 0.5983s/iter; left time: 6707.3722s
	iters: 200, epoch: 8 | loss: 0.2601843
	speed: 0.1350s/iter; left time: 1499.8524s
Epoch: 8 cost time: 36.28457045555115
Epoch: 8, Steps: 263 | Train Loss: 0.2634997 Vali Loss: 0.4010321 Test Loss: 0.3091989
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.3026360
	speed: 0.6069s/iter; left time: 6643.3206s
	iters: 200, epoch: 9 | loss: 0.2866186
	speed: 0.1293s/iter; left time: 1402.2330s
Epoch: 9 cost time: 35.26397204399109
Epoch: 9, Steps: 263 | Train Loss: 0.2633464 Vali Loss: 0.3962389 Test Loss: 0.3090760
Validation loss decreased (0.399964 --> 0.396239).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2436256
	speed: 0.6112s/iter; left time: 6530.5188s
	iters: 200, epoch: 10 | loss: 0.2560628
	speed: 0.1393s/iter; left time: 1474.0821s
Epoch: 10 cost time: 37.07122349739075
Epoch: 10, Steps: 263 | Train Loss: 0.2631630 Vali Loss: 0.3973370 Test Loss: 0.3088803
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2271670
	speed: 0.6197s/iter; left time: 6457.4615s
	iters: 200, epoch: 11 | loss: 0.2666506
	speed: 0.1348s/iter; left time: 1391.6039s
Epoch: 11 cost time: 37.17291879653931
Epoch: 11, Steps: 263 | Train Loss: 0.2631543 Vali Loss: 0.3988217 Test Loss: 0.3088719
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2549483
	speed: 0.6525s/iter; left time: 6627.6185s
	iters: 200, epoch: 12 | loss: 0.2628040
	speed: 0.1514s/iter; left time: 1522.5957s
Epoch: 12 cost time: 40.03020668029785
Epoch: 12, Steps: 263 | Train Loss: 0.2630521 Vali Loss: 0.3966857 Test Loss: 0.3086708
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3106100857257843, mae:0.352904349565506, rse:0.5303220152854919, corr:[0.54511636 0.55470604 0.5605905  0.56259865 0.5629029  0.5634272
 0.5646805  0.5663495  0.56786734 0.56880254 0.5692102  0.5692915
 0.5693688  0.56946594 0.5693734  0.5688711  0.5679295  0.56667274
 0.5652242  0.56374997 0.5624181  0.5612082  0.560031   0.55893415
 0.55774665 0.55664    0.555727   0.55499035 0.5545902  0.55455106
 0.5548014  0.555235   0.55560434 0.55586916 0.55589324 0.55584
 0.5556083  0.5553127  0.5550616  0.5548423  0.5548014  0.55485535
 0.55490667 0.55493295 0.55475    0.55434906 0.55397546 0.5538048
 0.5538161  0.5538569  0.55387586 0.5537778  0.5535786  0.55321735
 0.55286026 0.5526863  0.5527717  0.552965   0.55317605 0.55317634
 0.55296844 0.55266196 0.5524285  0.55231446 0.552433   0.5526999
 0.5528995  0.55288506 0.55267453 0.5523551  0.55213434 0.5520836
 0.55214304 0.552191   0.5521744  0.5519492  0.55146825 0.55083096
 0.5502091  0.5497645  0.5495804  0.5495523  0.5495315  0.5492499
 0.5486741  0.54788554 0.5471285  0.5465039  0.54607815 0.5458838
 0.5457574  0.5456611  0.5457902  0.5463114  0.54704016 0.5468766 ]
