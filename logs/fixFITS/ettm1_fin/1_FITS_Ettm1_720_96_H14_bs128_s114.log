Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=256, c_out=7, checkpoints='./checkpoints/', cut_freq=122, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=6, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:6
>>>>>>>start training : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=122, out_features=138, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  30170112.0
params:  16974.0
Trainable parameters:  16974
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3032770
	speed: 0.1559s/iter; left time: 1005.9771s
Epoch: 1 cost time: 20.552295446395874
Epoch: 1, Steps: 131 | Train Loss: 0.3484091 Vali Loss: 0.4653190 Test Loss: 0.3195022
Validation loss decreased (inf --> 0.465319).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2685606
	speed: 0.4359s/iter; left time: 2754.7728s
Epoch: 2 cost time: 19.50486135482788
Epoch: 2, Steps: 131 | Train Loss: 0.2778761 Vali Loss: 0.4312923 Test Loss: 0.3126571
Validation loss decreased (0.465319 --> 0.431292).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2895501
	speed: 0.3951s/iter; left time: 2445.5059s
Epoch: 3 cost time: 19.751083612442017
Epoch: 3, Steps: 131 | Train Loss: 0.2706099 Vali Loss: 0.4170189 Test Loss: 0.3108948
Validation loss decreased (0.431292 --> 0.417019).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2678990
	speed: 0.3494s/iter; left time: 2116.4511s
Epoch: 4 cost time: 15.726341485977173
Epoch: 4, Steps: 131 | Train Loss: 0.2673182 Vali Loss: 0.4128766 Test Loss: 0.3106035
Validation loss decreased (0.417019 --> 0.412877).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2652589
	speed: 0.3358s/iter; left time: 1990.2549s
Epoch: 5 cost time: 18.069376945495605
Epoch: 5, Steps: 131 | Train Loss: 0.2656574 Vali Loss: 0.4077960 Test Loss: 0.3099463
Validation loss decreased (0.412877 --> 0.407796).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2542030
	speed: 0.4339s/iter; left time: 2514.8628s
Epoch: 6 cost time: 20.2810800075531
Epoch: 6, Steps: 131 | Train Loss: 0.2645745 Vali Loss: 0.4033239 Test Loss: 0.3095558
Validation loss decreased (0.407796 --> 0.403324).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2954805
	speed: 0.4167s/iter; left time: 2360.7044s
Epoch: 7 cost time: 20.29025650024414
Epoch: 7, Steps: 131 | Train Loss: 0.2639516 Vali Loss: 0.4019080 Test Loss: 0.3094687
Validation loss decreased (0.403324 --> 0.401908).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2675738
	speed: 0.3659s/iter; left time: 2025.0491s
Epoch: 8 cost time: 15.979920864105225
Epoch: 8, Steps: 131 | Train Loss: 0.2635373 Vali Loss: 0.4014950 Test Loss: 0.3094002
Validation loss decreased (0.401908 --> 0.401495).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2810467
	speed: 0.3727s/iter; left time: 2013.8750s
Epoch: 9 cost time: 20.422818899154663
Epoch: 9, Steps: 131 | Train Loss: 0.2632635 Vali Loss: 0.4002936 Test Loss: 0.3092392
Validation loss decreased (0.401495 --> 0.400294).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2524705
	speed: 0.4243s/iter; left time: 2236.6626s
Epoch: 10 cost time: 19.326449871063232
Epoch: 10, Steps: 131 | Train Loss: 0.2628760 Vali Loss: 0.4016273 Test Loss: 0.3097297
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2837558
	speed: 0.4039s/iter; left time: 2076.6429s
Epoch: 11 cost time: 19.447065591812134
Epoch: 11, Steps: 131 | Train Loss: 0.2626876 Vali Loss: 0.3989403 Test Loss: 0.3092152
Validation loss decreased (0.400294 --> 0.398940).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2569152
	speed: 0.3927s/iter; left time: 1967.3049s
Epoch: 12 cost time: 17.808568239212036
Epoch: 12, Steps: 131 | Train Loss: 0.2625385 Vali Loss: 0.3968565 Test Loss: 0.3092493
Validation loss decreased (0.398940 --> 0.396856).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2591181
	speed: 0.3860s/iter; left time: 1883.2535s
Epoch: 13 cost time: 18.267221689224243
Epoch: 13, Steps: 131 | Train Loss: 0.2624806 Vali Loss: 0.3977850 Test Loss: 0.3088112
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2841737
	speed: 0.3921s/iter; left time: 1861.5194s
Epoch: 14 cost time: 18.824036359786987
Epoch: 14, Steps: 131 | Train Loss: 0.2623776 Vali Loss: 0.3976182 Test Loss: 0.3087298
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2587074
	speed: 0.3349s/iter; left time: 1546.3709s
Epoch: 15 cost time: 15.277853012084961
Epoch: 15, Steps: 131 | Train Loss: 0.2622311 Vali Loss: 0.3983235 Test Loss: 0.3091448
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3093615174293518, mae:0.3520468771457672, rse:0.5292550921440125, corr:[0.54437757 0.5565339  0.56059235 0.5607416  0.56169426 0.56422913
 0.5666521  0.5677047  0.5680255  0.5686422  0.56977606 0.57074
 0.5709775  0.5705561  0.5699079  0.56923014 0.56841683 0.5673441
 0.56601846 0.56470865 0.5635786  0.56241673 0.56103665 0.5595644
 0.55803984 0.5568267  0.5559307  0.55506337 0.5543401  0.55392545
 0.5540877  0.554922   0.55592066 0.5566093  0.5566036  0.55638415
 0.5562634  0.5563931  0.55643886 0.555996   0.55524266 0.5545101
 0.55422914 0.5544169  0.55442303 0.55393285 0.553309   0.55312145
 0.5535371  0.5540509  0.55414456 0.55357355 0.5526816  0.55204415
 0.5521499  0.55273885 0.55319494 0.55311686 0.55278206 0.55253845
 0.5526477  0.5528522  0.5528406  0.55242455 0.5520037  0.55194896
 0.55222034 0.55245227 0.55241483 0.55215085 0.5520044  0.5521149
 0.55230784 0.55229497 0.5520103  0.5514653  0.5509203  0.5506307
 0.5505902  0.5506143  0.5504425  0.5499113  0.549328   0.5488826
 0.5486507  0.5483762  0.54786533 0.54715604 0.54665077 0.5466509
 0.54669756 0.5462923  0.5459098  0.5466332  0.5484836  0.5480259 ]
