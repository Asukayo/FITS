Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=90, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=6, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:6
>>>>>>>start training : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=90, out_features=102, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4112640.0
params:  9282.0
Trainable parameters:  9282
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3710517
	speed: 0.1107s/iter; left time: 2905.4407s
	iters: 200, epoch: 1 | loss: 0.2796938
	speed: 0.1139s/iter; left time: 2977.3349s
	iters: 300, epoch: 1 | loss: 0.2212874
	speed: 0.1119s/iter; left time: 2915.4293s
	iters: 400, epoch: 1 | loss: 0.1979140
	speed: 0.1147s/iter; left time: 2976.2476s
	iters: 500, epoch: 1 | loss: 0.1840181
	speed: 0.1208s/iter; left time: 3123.8813s
Epoch: 1 cost time: 60.499006509780884
Epoch: 1, Steps: 527 | Train Loss: 0.2851485 Vali Loss: 0.6135203 Test Loss: 0.4620295
Validation loss decreased (inf --> 0.613520).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1428043
	speed: 0.8707s/iter; left time: 22397.0460s
	iters: 200, epoch: 2 | loss: 0.1324278
	speed: 0.1282s/iter; left time: 3285.3600s
	iters: 300, epoch: 2 | loss: 0.1233845
	speed: 0.1344s/iter; left time: 3431.3914s
	iters: 400, epoch: 2 | loss: 0.1177485
	speed: 0.1215s/iter; left time: 3087.9891s
	iters: 500, epoch: 2 | loss: 0.1044600
	speed: 0.1201s/iter; left time: 3041.1414s
Epoch: 2 cost time: 66.39720225334167
Epoch: 2, Steps: 527 | Train Loss: 0.1298035 Vali Loss: 0.5508810 Test Loss: 0.4307428
Validation loss decreased (0.613520 --> 0.550881).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.0901208
	speed: 0.7372s/iter; left time: 18574.2218s
	iters: 200, epoch: 3 | loss: 0.0942505
	speed: 0.1126s/iter; left time: 2825.1656s
	iters: 300, epoch: 3 | loss: 0.0785208
	speed: 0.1131s/iter; left time: 2827.1380s
	iters: 400, epoch: 3 | loss: 0.0810157
	speed: 0.1207s/iter; left time: 3005.4339s
	iters: 500, epoch: 3 | loss: 0.0727230
	speed: 0.1107s/iter; left time: 2745.4611s
Epoch: 3 cost time: 60.768171548843384
Epoch: 3, Steps: 527 | Train Loss: 0.0853429 Vali Loss: 0.5038769 Test Loss: 0.3975970
Validation loss decreased (0.550881 --> 0.503877).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.0693673
	speed: 0.7914s/iter; left time: 19524.1421s
	iters: 200, epoch: 4 | loss: 0.0707999
	speed: 0.1081s/iter; left time: 2656.7026s
	iters: 300, epoch: 4 | loss: 0.0674202
	speed: 0.1069s/iter; left time: 2615.4745s
	iters: 400, epoch: 4 | loss: 0.0591597
	speed: 0.1087s/iter; left time: 2648.1600s
	iters: 500, epoch: 4 | loss: 0.0625610
	speed: 0.1104s/iter; left time: 2680.1130s
Epoch: 4 cost time: 58.530210971832275
Epoch: 4, Steps: 527 | Train Loss: 0.0659079 Vali Loss: 0.4743375 Test Loss: 0.3750128
Validation loss decreased (0.503877 --> 0.474337).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0612343
	speed: 0.7582s/iter; left time: 18304.8042s
	iters: 200, epoch: 5 | loss: 0.0612603
	speed: 0.1000s/iter; left time: 2404.7058s
	iters: 300, epoch: 5 | loss: 0.0552528
	speed: 0.1084s/iter; left time: 2595.4595s
	iters: 400, epoch: 5 | loss: 0.0548085
	speed: 0.1029s/iter; left time: 2452.9860s
	iters: 500, epoch: 5 | loss: 0.0556625
	speed: 0.1096s/iter; left time: 2601.5383s
Epoch: 5 cost time: 57.227893114089966
Epoch: 5, Steps: 527 | Train Loss: 0.0569940 Vali Loss: 0.4534828 Test Loss: 0.3566866
Validation loss decreased (0.474337 --> 0.453483).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0514036
	speed: 0.7691s/iter; left time: 18163.8323s
	iters: 200, epoch: 6 | loss: 0.0498511
	speed: 0.1049s/iter; left time: 2465.7912s
	iters: 300, epoch: 6 | loss: 0.0535607
	speed: 0.1072s/iter; left time: 2509.3810s
	iters: 400, epoch: 6 | loss: 0.0584595
	speed: 0.1110s/iter; left time: 2588.3801s
	iters: 500, epoch: 6 | loss: 0.0497348
	speed: 0.1060s/iter; left time: 2460.9829s
Epoch: 6 cost time: 56.83672571182251
Epoch: 6, Steps: 527 | Train Loss: 0.0527895 Vali Loss: 0.4386970 Test Loss: 0.3466945
Validation loss decreased (0.453483 --> 0.438697).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0601189
	speed: 0.7423s/iter; left time: 17138.3652s
	iters: 200, epoch: 7 | loss: 0.0505731
	speed: 0.1092s/iter; left time: 2510.6084s
	iters: 300, epoch: 7 | loss: 0.0483365
	speed: 0.1039s/iter; left time: 2377.0957s
	iters: 400, epoch: 7 | loss: 0.0534583
	speed: 0.1260s/iter; left time: 2870.7193s
	iters: 500, epoch: 7 | loss: 0.0481796
	speed: 0.1191s/iter; left time: 2702.3468s
Epoch: 7 cost time: 60.34778356552124
Epoch: 7, Steps: 527 | Train Loss: 0.0507931 Vali Loss: 0.4332161 Test Loss: 0.3358760
Validation loss decreased (0.438697 --> 0.433216).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0507550
	speed: 0.8928s/iter; left time: 20142.9008s
	iters: 200, epoch: 8 | loss: 0.0543210
	speed: 0.1238s/iter; left time: 2779.9190s
	iters: 300, epoch: 8 | loss: 0.0484287
	speed: 0.1257s/iter; left time: 2810.9501s
	iters: 400, epoch: 8 | loss: 0.0486489
	speed: 0.0987s/iter; left time: 2196.6401s
	iters: 500, epoch: 8 | loss: 0.0476120
	speed: 0.1037s/iter; left time: 2297.6003s
Epoch: 8 cost time: 61.03558015823364
Epoch: 8, Steps: 527 | Train Loss: 0.0498487 Vali Loss: 0.4277098 Test Loss: 0.3319106
Validation loss decreased (0.433216 --> 0.427710).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0499182
	speed: 0.6765s/iter; left time: 14906.3978s
	iters: 200, epoch: 9 | loss: 0.0456562
	speed: 0.1019s/iter; left time: 2235.2811s
	iters: 300, epoch: 9 | loss: 0.0514289
	speed: 0.0906s/iter; left time: 1978.8328s
	iters: 400, epoch: 9 | loss: 0.0508050
	speed: 0.1016s/iter; left time: 2207.9359s
	iters: 500, epoch: 9 | loss: 0.0499331
	speed: 0.1080s/iter; left time: 2336.7073s
Epoch: 9 cost time: 53.13587713241577
Epoch: 9, Steps: 527 | Train Loss: 0.0494018 Vali Loss: 0.4261216 Test Loss: 0.3288154
Validation loss decreased (0.427710 --> 0.426122).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0471538
	speed: 0.6683s/iter; left time: 14374.3019s
	iters: 200, epoch: 10 | loss: 0.0517055
	speed: 0.1096s/iter; left time: 2346.3052s
	iters: 300, epoch: 10 | loss: 0.0479145
	speed: 0.0763s/iter; left time: 1626.0580s
	iters: 400, epoch: 10 | loss: 0.0447181
	speed: 0.0678s/iter; left time: 1437.3065s
	iters: 500, epoch: 10 | loss: 0.0482266
	speed: 0.1019s/iter; left time: 2150.9953s
Epoch: 10 cost time: 45.60124921798706
Epoch: 10, Steps: 527 | Train Loss: 0.0492054 Vali Loss: 0.4253337 Test Loss: 0.3262433
Validation loss decreased (0.426122 --> 0.425334).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0506092
	speed: 0.7059s/iter; left time: 14810.6671s
	iters: 200, epoch: 11 | loss: 0.0477851
	speed: 0.1078s/iter; left time: 2250.2185s
	iters: 300, epoch: 11 | loss: 0.0489072
	speed: 0.1002s/iter; left time: 2081.7140s
	iters: 400, epoch: 11 | loss: 0.0472961
	speed: 0.1072s/iter; left time: 2216.0461s
	iters: 500, epoch: 11 | loss: 0.0536121
	speed: 0.1092s/iter; left time: 2247.4219s
Epoch: 11 cost time: 56.63274049758911
Epoch: 11, Steps: 527 | Train Loss: 0.0491399 Vali Loss: 0.4277895 Test Loss: 0.3252505
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0517913
	speed: 0.6994s/iter; left time: 14305.0119s
	iters: 200, epoch: 12 | loss: 0.0467464
	speed: 0.0974s/iter; left time: 1982.4841s
	iters: 300, epoch: 12 | loss: 0.0514169
	speed: 0.0946s/iter; left time: 1915.5875s
	iters: 400, epoch: 12 | loss: 0.0489329
	speed: 0.1039s/iter; left time: 2094.5932s
	iters: 500, epoch: 12 | loss: 0.0483819
	speed: 0.1102s/iter; left time: 2210.0977s
Epoch: 12 cost time: 54.09854578971863
Epoch: 12, Steps: 527 | Train Loss: 0.0491179 Vali Loss: 0.4220084 Test Loss: 0.3250630
Validation loss decreased (0.425334 --> 0.422008).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0479303
	speed: 0.7014s/iter; left time: 13977.6924s
	iters: 200, epoch: 13 | loss: 0.0454414
	speed: 0.1005s/iter; left time: 1993.0794s
	iters: 300, epoch: 13 | loss: 0.0505571
	speed: 0.0870s/iter; left time: 1717.1560s
	iters: 400, epoch: 13 | loss: 0.0512036
	speed: 0.1009s/iter; left time: 1980.0436s
	iters: 500, epoch: 13 | loss: 0.0461770
	speed: 0.1239s/iter; left time: 2420.2062s
Epoch: 13 cost time: 55.31619095802307
Epoch: 13, Steps: 527 | Train Loss: 0.0491155 Vali Loss: 0.4278351 Test Loss: 0.3246736
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0473180
	speed: 0.7990s/iter; left time: 15500.2882s
	iters: 200, epoch: 14 | loss: 0.0518183
	speed: 0.1099s/iter; left time: 2121.4953s
	iters: 300, epoch: 14 | loss: 0.0481517
	speed: 0.1129s/iter; left time: 2168.1250s
	iters: 400, epoch: 14 | loss: 0.0447983
	speed: 0.1158s/iter; left time: 2211.4938s
	iters: 500, epoch: 14 | loss: 0.0478258
	speed: 0.1114s/iter; left time: 2117.2474s
Epoch: 14 cost time: 59.5860800743103
Epoch: 14, Steps: 527 | Train Loss: 0.0491051 Vali Loss: 0.4229138 Test Loss: 0.3245461
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0525060
	speed: 0.7378s/iter; left time: 13924.5569s
	iters: 200, epoch: 15 | loss: 0.0494498
	speed: 0.0919s/iter; left time: 1726.0646s
	iters: 300, epoch: 15 | loss: 0.0499609
	speed: 0.1175s/iter; left time: 2194.4435s
	iters: 400, epoch: 15 | loss: 0.0482366
	speed: 0.1015s/iter; left time: 1885.4653s
	iters: 500, epoch: 15 | loss: 0.0520710
	speed: 0.1036s/iter; left time: 1913.8090s
Epoch: 15 cost time: 55.22880983352661
Epoch: 15, Steps: 527 | Train Loss: 0.0491083 Vali Loss: 0.4233156 Test Loss: 0.3243785
EarlyStopping counter: 3 out of 3
Early stopping
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=90, out_features=102, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4112640.0
params:  9282.0
Trainable parameters:  9282
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2949204
	speed: 0.1287s/iter; left time: 3379.1380s
	iters: 200, epoch: 1 | loss: 0.2955488
	speed: 0.1078s/iter; left time: 2818.0840s
	iters: 300, epoch: 1 | loss: 0.2784829
	speed: 0.0806s/iter; left time: 2100.8786s
	iters: 400, epoch: 1 | loss: 0.2779238
	speed: 0.0630s/iter; left time: 1633.6879s
	iters: 500, epoch: 1 | loss: 0.2601799
	speed: 0.0765s/iter; left time: 1977.4121s
Epoch: 1 cost time: 48.73351860046387
Epoch: 1, Steps: 527 | Train Loss: 0.2678765 Vali Loss: 0.4016509 Test Loss: 0.3142143
Validation loss decreased (inf --> 0.401651).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2599638
	speed: 0.6864s/iter; left time: 17656.1297s
	iters: 200, epoch: 2 | loss: 0.2447315
	speed: 0.1013s/iter; left time: 2595.5664s
	iters: 300, epoch: 2 | loss: 0.2724714
	speed: 0.0960s/iter; left time: 2450.0239s
	iters: 400, epoch: 2 | loss: 0.3024964
	speed: 0.0947s/iter; left time: 2407.9844s
	iters: 500, epoch: 2 | loss: 0.2780715
	speed: 0.1002s/iter; left time: 2536.4473s
Epoch: 2 cost time: 52.02281165122986
Epoch: 2, Steps: 527 | Train Loss: 0.2650960 Vali Loss: 0.4012181 Test Loss: 0.3115768
Validation loss decreased (0.401651 --> 0.401218).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2470138
	speed: 0.7347s/iter; left time: 18511.2864s
	iters: 200, epoch: 3 | loss: 0.2646629
	speed: 0.1089s/iter; left time: 2732.8748s
	iters: 300, epoch: 3 | loss: 0.3140204
	speed: 0.1065s/iter; left time: 2660.9792s
	iters: 400, epoch: 3 | loss: 0.3355577
	speed: 0.1027s/iter; left time: 2556.6947s
	iters: 500, epoch: 3 | loss: 0.2585507
	speed: 0.1101s/iter; left time: 2730.9154s
Epoch: 3 cost time: 57.72156095504761
Epoch: 3, Steps: 527 | Train Loss: 0.2643307 Vali Loss: 0.3974124 Test Loss: 0.3121175
Validation loss decreased (0.401218 --> 0.397412).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2934575
	speed: 0.7881s/iter; left time: 19443.5228s
	iters: 200, epoch: 4 | loss: 0.2769119
	speed: 0.1169s/iter; left time: 2871.6562s
	iters: 300, epoch: 4 | loss: 0.2949957
	speed: 0.1153s/iter; left time: 2820.9695s
	iters: 400, epoch: 4 | loss: 0.2461623
	speed: 0.1105s/iter; left time: 2692.6105s
	iters: 500, epoch: 4 | loss: 0.2460074
	speed: 0.1152s/iter; left time: 2795.5794s
Epoch: 4 cost time: 61.279468059539795
Epoch: 4, Steps: 527 | Train Loss: 0.2638522 Vali Loss: 0.3941128 Test Loss: 0.3119312
Validation loss decreased (0.397412 --> 0.394113).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2628846
	speed: 0.7763s/iter; left time: 18741.2370s
	iters: 200, epoch: 5 | loss: 0.2481493
	speed: 0.0647s/iter; left time: 1554.9720s
	iters: 300, epoch: 5 | loss: 0.2669879
	speed: 0.1044s/iter; left time: 2500.8232s
	iters: 400, epoch: 5 | loss: 0.2764829
	speed: 0.0738s/iter; left time: 1760.6508s
	iters: 500, epoch: 5 | loss: 0.3151282
	speed: 0.0618s/iter; left time: 1466.2771s
Epoch: 5 cost time: 41.53340172767639
Epoch: 5, Steps: 527 | Train Loss: 0.2635344 Vali Loss: 0.3947769 Test Loss: 0.3104481
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2956453
	speed: 0.6666s/iter; left time: 15742.7515s
	iters: 200, epoch: 6 | loss: 0.2791643
	speed: 0.0990s/iter; left time: 2328.1894s
	iters: 300, epoch: 6 | loss: 0.3342420
	speed: 0.0988s/iter; left time: 2314.5642s
	iters: 400, epoch: 6 | loss: 0.2381970
	speed: 0.1032s/iter; left time: 2406.4568s
	iters: 500, epoch: 6 | loss: 0.2575185
	speed: 0.0992s/iter; left time: 2302.7961s
Epoch: 6 cost time: 54.63757658004761
Epoch: 6, Steps: 527 | Train Loss: 0.2634462 Vali Loss: 0.3983722 Test Loss: 0.3106088
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2049870
	speed: 0.6895s/iter; left time: 15918.8918s
	iters: 200, epoch: 7 | loss: 0.2718573
	speed: 0.1083s/iter; left time: 2490.4148s
	iters: 300, epoch: 7 | loss: 0.2610978
	speed: 0.0927s/iter; left time: 2120.7407s
	iters: 400, epoch: 7 | loss: 0.2809078
	speed: 0.1015s/iter; left time: 2313.0762s
	iters: 500, epoch: 7 | loss: 0.2837263
	speed: 0.0990s/iter; left time: 2245.7212s
Epoch: 7 cost time: 54.38823938369751
Epoch: 7, Steps: 527 | Train Loss: 0.2632845 Vali Loss: 0.3990313 Test Loss: 0.3106040
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3124536871910095, mae:0.3543126881122589, rse:0.5318935513496399, corr:[0.54656225 0.5565323  0.56263334 0.5646362  0.56478006 0.56511056
 0.56618875 0.56768054 0.5689401  0.56943744 0.5692428  0.5687296
 0.5684092  0.56838363 0.5683712  0.5680125  0.56714875 0.5658487
 0.5642777  0.5626978  0.5613408  0.5601916  0.5591187  0.5580854
 0.5568522  0.55559486 0.55454576 0.55381733 0.55359703 0.55380285
 0.55417806 0.5544622  0.55441225 0.55420506 0.5539842  0.5540846
 0.5543532  0.55469656 0.55497515 0.5549847  0.5548414  0.55462277
 0.55444944 0.5544619  0.5544811  0.55435055 0.55411875 0.55382967
 0.5535398  0.5533304  0.5533544  0.5535492  0.5538274  0.55395335
 0.55391115 0.55377483 0.55363756 0.55346006 0.55327463 0.55289805
 0.5523372  0.55168617 0.551119   0.5507376  0.5507479  0.55113363
 0.5516631  0.552082   0.55225396 0.55214065 0.5519018  0.5516582
 0.5514497  0.5512116  0.5508807  0.55029446 0.5494176  0.5484131
 0.5475695  0.5471688  0.5473137  0.5477943  0.5482833  0.5483649
 0.5479462  0.5471304  0.5462682  0.5456234  0.5453803  0.545575
 0.545921   0.54620755 0.54660493 0.5475306  0.5492228  0.55092996]
