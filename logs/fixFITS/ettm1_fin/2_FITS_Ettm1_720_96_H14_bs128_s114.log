Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=256, c_out=7, checkpoints='./checkpoints/', cut_freq=122, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=6, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:6
>>>>>>>start training : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=122, out_features=138, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  30170112.0
params:  16974.0
Trainable parameters:  16974
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3683735
	speed: 0.1372s/iter; left time: 884.9528s
Epoch: 1 cost time: 17.530316829681396
Epoch: 1, Steps: 131 | Train Loss: 0.4306580 Vali Loss: 0.7193052 Test Loss: 0.4864107
Validation loss decreased (inf --> 0.719305).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2518961
	speed: 0.3656s/iter; left time: 2310.4403s
Epoch: 2 cost time: 17.76306462287903
Epoch: 2, Steps: 131 | Train Loss: 0.2765443 Vali Loss: 0.6584642 Test Loss: 0.4641123
Validation loss decreased (0.719305 --> 0.658464).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2079814
	speed: 0.3532s/iter; left time: 2185.8425s
Epoch: 3 cost time: 17.07701587677002
Epoch: 3, Steps: 131 | Train Loss: 0.2171320 Vali Loss: 0.6372448 Test Loss: 0.4624104
Validation loss decreased (0.658464 --> 0.637245).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1769756
	speed: 0.3546s/iter; left time: 2148.3545s
Epoch: 4 cost time: 16.784820556640625
Epoch: 4, Steps: 131 | Train Loss: 0.1830049 Vali Loss: 0.6205572 Test Loss: 0.4577824
Validation loss decreased (0.637245 --> 0.620557).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1557458
	speed: 0.3481s/iter; left time: 2063.3594s
Epoch: 5 cost time: 16.367999792099
Epoch: 5, Steps: 131 | Train Loss: 0.1591606 Vali Loss: 0.6040059 Test Loss: 0.4502549
Validation loss decreased (0.620557 --> 0.604006).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1368598
	speed: 0.3532s/iter; left time: 2046.9098s
Epoch: 6 cost time: 16.41048002243042
Epoch: 6, Steps: 131 | Train Loss: 0.1408568 Vali Loss: 0.5891177 Test Loss: 0.4445244
Validation loss decreased (0.604006 --> 0.589118).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1252120
	speed: 0.2769s/iter; left time: 1568.3974s
Epoch: 7 cost time: 12.530649900436401
Epoch: 7, Steps: 131 | Train Loss: 0.1263013 Vali Loss: 0.5756317 Test Loss: 0.4379443
Validation loss decreased (0.589118 --> 0.575632).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1093727
	speed: 0.3621s/iter; left time: 2003.9385s
Epoch: 8 cost time: 19.114957571029663
Epoch: 8, Steps: 131 | Train Loss: 0.1144848 Vali Loss: 0.5631674 Test Loss: 0.4297948
Validation loss decreased (0.575632 --> 0.563167).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1037863
	speed: 0.3779s/iter; left time: 2041.7929s
Epoch: 9 cost time: 16.477455854415894
Epoch: 9, Steps: 131 | Train Loss: 0.1048383 Vali Loss: 0.5524013 Test Loss: 0.4237019
Validation loss decreased (0.563167 --> 0.552401).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0935704
	speed: 0.3739s/iter; left time: 1971.1162s
Epoch: 10 cost time: 19.743767499923706
Epoch: 10, Steps: 131 | Train Loss: 0.0968310 Vali Loss: 0.5450423 Test Loss: 0.4188991
Validation loss decreased (0.552401 --> 0.545042).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0915867
	speed: 0.3989s/iter; left time: 2050.9126s
Epoch: 11 cost time: 19.7976496219635
Epoch: 11, Steps: 131 | Train Loss: 0.0901579 Vali Loss: 0.5342255 Test Loss: 0.4136268
Validation loss decreased (0.545042 --> 0.534226).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0828776
	speed: 0.3944s/iter; left time: 1975.8818s
Epoch: 12 cost time: 19.28308129310608
Epoch: 12, Steps: 131 | Train Loss: 0.0845877 Vali Loss: 0.5247752 Test Loss: 0.4081774
Validation loss decreased (0.534226 --> 0.524775).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0791140
	speed: 0.3819s/iter; left time: 1863.3764s
Epoch: 13 cost time: 18.917062282562256
Epoch: 13, Steps: 131 | Train Loss: 0.0798494 Vali Loss: 0.5194210 Test Loss: 0.4043217
Validation loss decreased (0.524775 --> 0.519421).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0770417
	speed: 0.3603s/iter; left time: 1710.8009s
Epoch: 14 cost time: 15.847225904464722
Epoch: 14, Steps: 131 | Train Loss: 0.0758393 Vali Loss: 0.5130568 Test Loss: 0.4000050
Validation loss decreased (0.519421 --> 0.513057).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0720870
	speed: 0.3355s/iter; left time: 1548.7961s
Epoch: 15 cost time: 18.59090304374695
Epoch: 15, Steps: 131 | Train Loss: 0.0723950 Vali Loss: 0.5080042 Test Loss: 0.3960110
Validation loss decreased (0.513057 --> 0.508004).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0654983
	speed: 0.3526s/iter; left time: 1581.9728s
Epoch: 16 cost time: 15.412033319473267
Epoch: 16, Steps: 131 | Train Loss: 0.0694435 Vali Loss: 0.5027570 Test Loss: 0.3926089
Validation loss decreased (0.508004 --> 0.502757).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0663525
	speed: 0.3622s/iter; left time: 1577.2038s
Epoch: 17 cost time: 18.034133911132812
Epoch: 17, Steps: 131 | Train Loss: 0.0669008 Vali Loss: 0.4963319 Test Loss: 0.3884836
Validation loss decreased (0.502757 --> 0.496332).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0657416
	speed: 0.3104s/iter; left time: 1311.2269s
Epoch: 18 cost time: 15.026982545852661
Epoch: 18, Steps: 131 | Train Loss: 0.0646925 Vali Loss: 0.4920816 Test Loss: 0.3854401
Validation loss decreased (0.496332 --> 0.492082).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0611237
	speed: 0.3238s/iter; left time: 1325.1405s
Epoch: 19 cost time: 16.26914954185486
Epoch: 19, Steps: 131 | Train Loss: 0.0627634 Vali Loss: 0.4877197 Test Loss: 0.3821724
Validation loss decreased (0.492082 --> 0.487720).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0654768
	speed: 0.3291s/iter; left time: 1304.0114s
Epoch: 20 cost time: 16.115962266921997
Epoch: 20, Steps: 131 | Train Loss: 0.0610687 Vali Loss: 0.4826685 Test Loss: 0.3791300
Validation loss decreased (0.487720 --> 0.482669).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0592501
	speed: 0.3476s/iter; left time: 1331.8457s
Epoch: 21 cost time: 18.057822465896606
Epoch: 21, Steps: 131 | Train Loss: 0.0595942 Vali Loss: 0.4795303 Test Loss: 0.3765080
Validation loss decreased (0.482669 --> 0.479530).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0582567
	speed: 0.3719s/iter; left time: 1376.1213s
Epoch: 22 cost time: 16.388910055160522
Epoch: 22, Steps: 131 | Train Loss: 0.0582853 Vali Loss: 0.4742742 Test Loss: 0.3738494
Validation loss decreased (0.479530 --> 0.474274).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0592182
	speed: 0.3849s/iter; left time: 1373.6591s
Epoch: 23 cost time: 18.6366024017334
Epoch: 23, Steps: 131 | Train Loss: 0.0571034 Vali Loss: 0.4737941 Test Loss: 0.3717337
Validation loss decreased (0.474274 --> 0.473794).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0553930
	speed: 0.4049s/iter; left time: 1392.1145s
Epoch: 24 cost time: 18.841756105422974
Epoch: 24, Steps: 131 | Train Loss: 0.0560857 Vali Loss: 0.4692042 Test Loss: 0.3692849
Validation loss decreased (0.473794 --> 0.469204).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0530541
	speed: 0.3815s/iter; left time: 1261.5388s
Epoch: 25 cost time: 17.84000539779663
Epoch: 25, Steps: 131 | Train Loss: 0.0551423 Vali Loss: 0.4658612 Test Loss: 0.3671678
Validation loss decreased (0.469204 --> 0.465861).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0563470
	speed: 0.3850s/iter; left time: 1222.6893s
Epoch: 26 cost time: 18.628992319107056
Epoch: 26, Steps: 131 | Train Loss: 0.0543436 Vali Loss: 0.4653956 Test Loss: 0.3648833
Validation loss decreased (0.465861 --> 0.465396).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0518534
	speed: 0.4310s/iter; left time: 1312.2984s
Epoch: 27 cost time: 21.72521662712097
Epoch: 27, Steps: 131 | Train Loss: 0.0535925 Vali Loss: 0.4620421 Test Loss: 0.3628412
Validation loss decreased (0.465396 --> 0.462042).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0518067
	speed: 0.3833s/iter; left time: 1116.8519s
Epoch: 28 cost time: 15.412618637084961
Epoch: 28, Steps: 131 | Train Loss: 0.0529208 Vali Loss: 0.4604091 Test Loss: 0.3610910
Validation loss decreased (0.462042 --> 0.460409).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0532226
	speed: 0.4102s/iter; left time: 1141.6774s
Epoch: 29 cost time: 20.269652605056763
Epoch: 29, Steps: 131 | Train Loss: 0.0523336 Vali Loss: 0.4584219 Test Loss: 0.3593570
Validation loss decreased (0.460409 --> 0.458422).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.0510296
	speed: 0.4062s/iter; left time: 1077.2876s
Epoch: 30 cost time: 19.925665616989136
Epoch: 30, Steps: 131 | Train Loss: 0.0517716 Vali Loss: 0.4562421 Test Loss: 0.3578105
Validation loss decreased (0.458422 --> 0.456242).  Saving model ...
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0497642
	speed: 0.4148s/iter; left time: 1045.7679s
Epoch: 31 cost time: 20.435877561569214
Epoch: 31, Steps: 131 | Train Loss: 0.0512971 Vali Loss: 0.4536737 Test Loss: 0.3562256
Validation loss decreased (0.456242 --> 0.453674).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.0504958
	speed: 0.4181s/iter; left time: 999.1864s
Epoch: 32 cost time: 20.34480619430542
Epoch: 32, Steps: 131 | Train Loss: 0.0508525 Vali Loss: 0.4525019 Test Loss: 0.3549942
Validation loss decreased (0.453674 --> 0.452502).  Saving model ...
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0522923
	speed: 0.4026s/iter; left time: 909.5323s
Epoch: 33 cost time: 17.986709594726562
Epoch: 33, Steps: 131 | Train Loss: 0.0504442 Vali Loss: 0.4507684 Test Loss: 0.3533610
Validation loss decreased (0.452502 --> 0.450768).  Saving model ...
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0499925
	speed: 0.3364s/iter; left time: 715.8306s
Epoch: 34 cost time: 17.28206491470337
Epoch: 34, Steps: 131 | Train Loss: 0.0500577 Vali Loss: 0.4495853 Test Loss: 0.3521714
Validation loss decreased (0.450768 --> 0.449585).  Saving model ...
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.0479379
	speed: 0.4184s/iter; left time: 835.6292s
Epoch: 35 cost time: 20.140719652175903
Epoch: 35, Steps: 131 | Train Loss: 0.0497447 Vali Loss: 0.4480195 Test Loss: 0.3510078
Validation loss decreased (0.449585 --> 0.448020).  Saving model ...
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.0486915
	speed: 0.4220s/iter; left time: 787.4310s
Epoch: 36 cost time: 20.03130531311035
Epoch: 36, Steps: 131 | Train Loss: 0.0494289 Vali Loss: 0.4468318 Test Loss: 0.3495981
Validation loss decreased (0.448020 --> 0.446832).  Saving model ...
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.0476192
	speed: 0.4186s/iter; left time: 726.2048s
Epoch: 37 cost time: 20.31867742538452
Epoch: 37, Steps: 131 | Train Loss: 0.0491734 Vali Loss: 0.4451368 Test Loss: 0.3487611
Validation loss decreased (0.446832 --> 0.445137).  Saving model ...
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.0475619
	speed: 0.3912s/iter; left time: 627.5572s
Epoch: 38 cost time: 18.056051015853882
Epoch: 38, Steps: 131 | Train Loss: 0.0488920 Vali Loss: 0.4439025 Test Loss: 0.3477129
Validation loss decreased (0.445137 --> 0.443902).  Saving model ...
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.0497971
	speed: 0.3369s/iter; left time: 496.3225s
Epoch: 39 cost time: 15.949199914932251
Epoch: 39, Steps: 131 | Train Loss: 0.0486625 Vali Loss: 0.4433165 Test Loss: 0.3466784
Validation loss decreased (0.443902 --> 0.443316).  Saving model ...
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.0505051
	speed: 0.3152s/iter; left time: 422.9412s
Epoch: 40 cost time: 14.828900337219238
Epoch: 40, Steps: 131 | Train Loss: 0.0484416 Vali Loss: 0.4429820 Test Loss: 0.3457790
Validation loss decreased (0.443316 --> 0.442982).  Saving model ...
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.0495774
	speed: 0.2910s/iter; left time: 352.4565s
Epoch: 41 cost time: 12.859642744064331
Epoch: 41, Steps: 131 | Train Loss: 0.0482693 Vali Loss: 0.4411961 Test Loss: 0.3449319
Validation loss decreased (0.442982 --> 0.441196).  Saving model ...
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.0455008
	speed: 0.2691s/iter; left time: 290.6717s
Epoch: 42 cost time: 13.690239191055298
Epoch: 42, Steps: 131 | Train Loss: 0.0480794 Vali Loss: 0.4396386 Test Loss: 0.3440688
Validation loss decreased (0.441196 --> 0.439639).  Saving model ...
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.0498654
	speed: 0.2735s/iter; left time: 259.5913s
Epoch: 43 cost time: 13.754706621170044
Epoch: 43, Steps: 131 | Train Loss: 0.0479001 Vali Loss: 0.4394556 Test Loss: 0.3434145
Validation loss decreased (0.439639 --> 0.439456).  Saving model ...
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.0471707
	speed: 0.2924s/iter; left time: 239.1852s
Epoch: 44 cost time: 13.530166387557983
Epoch: 44, Steps: 131 | Train Loss: 0.0477714 Vali Loss: 0.4379043 Test Loss: 0.3425182
Validation loss decreased (0.439456 --> 0.437904).  Saving model ...
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.0476912
	speed: 0.3039s/iter; left time: 208.7932s
Epoch: 45 cost time: 15.610201597213745
Epoch: 45, Steps: 131 | Train Loss: 0.0476150 Vali Loss: 0.4380507 Test Loss: 0.3418385
EarlyStopping counter: 1 out of 3
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.0478654
	speed: 0.2692s/iter; left time: 149.6740s
Epoch: 46 cost time: 13.685850381851196
Epoch: 46, Steps: 131 | Train Loss: 0.0475069 Vali Loss: 0.4368704 Test Loss: 0.3412108
Validation loss decreased (0.437904 --> 0.436870).  Saving model ...
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.0467976
	speed: 0.2853s/iter; left time: 121.2511s
Epoch: 47 cost time: 12.982627630233765
Epoch: 47, Steps: 131 | Train Loss: 0.0473836 Vali Loss: 0.4351419 Test Loss: 0.3406326
Validation loss decreased (0.436870 --> 0.435142).  Saving model ...
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.0470413
	speed: 0.2883s/iter; left time: 84.7657s
Epoch: 48 cost time: 14.650532484054565
Epoch: 48, Steps: 131 | Train Loss: 0.0472758 Vali Loss: 0.4357660 Test Loss: 0.3400597
EarlyStopping counter: 1 out of 3
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.0482696
	speed: 0.3379s/iter; left time: 55.0807s
Epoch: 49 cost time: 16.89243197441101
Epoch: 49, Steps: 131 | Train Loss: 0.0471719 Vali Loss: 0.4349056 Test Loss: 0.3394704
Validation loss decreased (0.435142 --> 0.434906).  Saving model ...
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.0470878
	speed: 0.3680s/iter; left time: 11.7774s
Epoch: 50 cost time: 17.83321976661682
Epoch: 50, Steps: 131 | Train Loss: 0.0470786 Vali Loss: 0.4344663 Test Loss: 0.3390006
Validation loss decreased (0.434906 --> 0.434466).  Saving model ...
Updating learning rate to 4.0497355408796396e-05
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=122, out_features=138, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  30170112.0
params:  16974.0
Trainable parameters:  16974
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2830635
	speed: 0.1148s/iter; left time: 740.8117s
Epoch: 1 cost time: 15.393877029418945
Epoch: 1, Steps: 131 | Train Loss: 0.2686484 Vali Loss: 0.4022155 Test Loss: 0.3149777
Validation loss decreased (inf --> 0.402215).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2448258
	speed: 0.4125s/iter; left time: 2606.9075s
Epoch: 2 cost time: 19.959196090698242
Epoch: 2, Steps: 131 | Train Loss: 0.2648196 Vali Loss: 0.3994984 Test Loss: 0.3114274
Validation loss decreased (0.402215 --> 0.399498).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2798002
	speed: 0.4100s/iter; left time: 2537.3906s
Epoch: 3 cost time: 21.705617904663086
Epoch: 3, Steps: 131 | Train Loss: 0.2637915 Vali Loss: 0.3984030 Test Loss: 0.3117842
Validation loss decreased (0.399498 --> 0.398403).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2385133
	speed: 0.4428s/iter; left time: 2682.1854s
Epoch: 4 cost time: 21.030019760131836
Epoch: 4, Steps: 131 | Train Loss: 0.2632241 Vali Loss: 0.3958341 Test Loss: 0.3096846
Validation loss decreased (0.398403 --> 0.395834).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2649247
	speed: 0.4198s/iter; left time: 2488.0722s
Epoch: 5 cost time: 19.664461851119995
Epoch: 5, Steps: 131 | Train Loss: 0.2628704 Vali Loss: 0.3974048 Test Loss: 0.3117596
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2405110
	speed: 0.3471s/iter; left time: 2011.5459s
Epoch: 6 cost time: 17.533788919448853
Epoch: 6, Steps: 131 | Train Loss: 0.2624435 Vali Loss: 0.3960696 Test Loss: 0.3102379
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2582288
	speed: 0.4370s/iter; left time: 2475.7711s
Epoch: 7 cost time: 20.436633110046387
Epoch: 7, Steps: 131 | Train Loss: 0.2624279 Vali Loss: 0.3953983 Test Loss: 0.3103210
Validation loss decreased (0.395834 --> 0.395398).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2466060
	speed: 0.4330s/iter; left time: 2396.3946s
Epoch: 8 cost time: 21.010578870773315
Epoch: 8, Steps: 131 | Train Loss: 0.2622117 Vali Loss: 0.3965783 Test Loss: 0.3099811
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2708575
	speed: 0.4566s/iter; left time: 2466.9272s
Epoch: 9 cost time: 21.93428087234497
Epoch: 9, Steps: 131 | Train Loss: 0.2620946 Vali Loss: 0.3952819 Test Loss: 0.3098954
Validation loss decreased (0.395398 --> 0.395282).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2468859
	speed: 0.4567s/iter; left time: 2407.5765s
Epoch: 10 cost time: 21.935513257980347
Epoch: 10, Steps: 131 | Train Loss: 0.2619859 Vali Loss: 0.3942324 Test Loss: 0.3100049
Validation loss decreased (0.395282 --> 0.394232).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2566417
	speed: 0.4436s/iter; left time: 2280.3109s
Epoch: 11 cost time: 21.14997673034668
Epoch: 11, Steps: 131 | Train Loss: 0.2618445 Vali Loss: 0.3952298 Test Loss: 0.3095076
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2811629
	speed: 0.4522s/iter; left time: 2265.5199s
Epoch: 12 cost time: 21.52255868911743
Epoch: 12, Steps: 131 | Train Loss: 0.2617199 Vali Loss: 0.3965780 Test Loss: 0.3094600
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2505346
	speed: 0.4088s/iter; left time: 1994.5218s
Epoch: 13 cost time: 19.868061065673828
Epoch: 13, Steps: 131 | Train Loss: 0.2618226 Vali Loss: 0.3942276 Test Loss: 0.3094653
Validation loss decreased (0.394232 --> 0.394228).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2713349
	speed: 0.4458s/iter; left time: 2116.7321s
Epoch: 14 cost time: 21.015496253967285
Epoch: 14, Steps: 131 | Train Loss: 0.2616964 Vali Loss: 0.3956383 Test Loss: 0.3096021
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2680281
	speed: 0.4484s/iter; left time: 2070.0638s
Epoch: 15 cost time: 21.49489712715149
Epoch: 15, Steps: 131 | Train Loss: 0.2614987 Vali Loss: 0.3951283 Test Loss: 0.3095790
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2649854
	speed: 0.4443s/iter; left time: 1992.9722s
Epoch: 16 cost time: 21.84178328514099
Epoch: 16, Steps: 131 | Train Loss: 0.2615607 Vali Loss: 0.3927833 Test Loss: 0.3092225
Validation loss decreased (0.394228 --> 0.392783).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.2742543
	speed: 0.4380s/iter; left time: 1907.3341s
Epoch: 17 cost time: 18.519753456115723
Epoch: 17, Steps: 131 | Train Loss: 0.2614329 Vali Loss: 0.3947257 Test Loss: 0.3100350
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.2516946
	speed: 0.3343s/iter; left time: 1411.9240s
Epoch: 18 cost time: 14.917760372161865
Epoch: 18, Steps: 131 | Train Loss: 0.2615318 Vali Loss: 0.3936850 Test Loss: 0.3094178
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.2661408
	speed: 0.3410s/iter; left time: 1395.6786s
Epoch: 19 cost time: 17.649311780929565
Epoch: 19, Steps: 131 | Train Loss: 0.2613071 Vali Loss: 0.3944055 Test Loss: 0.3096134
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3093682825565338, mae:0.35192230343818665, rse:0.5292608737945557, corr:[0.5470083  0.55658776 0.5594644  0.5602841  0.56218374 0.56492054
 0.5667197  0.5670589  0.56701237 0.5675125  0.5685534  0.5693573
 0.56956595 0.5694174  0.56926763 0.5690125  0.56826574 0.56688404
 0.5650727  0.56332237 0.5619452  0.5607432  0.5594052  0.55802846
 0.5566512  0.55563813 0.55496705 0.55425054 0.5534877  0.55287385
 0.55283356 0.5535846  0.55461663 0.5553651  0.5553244  0.55498004
 0.5546812  0.5547491  0.55498344 0.5549372  0.55466884 0.554326
 0.5541796  0.5543518  0.5543998  0.5541078  0.5537609  0.5536273
 0.55367213 0.55358684 0.55326843 0.55276436 0.5524277  0.5524386
 0.55280733 0.55318815 0.55322796 0.55281925 0.552374   0.5520925
 0.5521043  0.5522143  0.55220264 0.5518875  0.55156624 0.55146515
 0.5515324  0.5515946  0.5516096  0.5515926  0.55164677 0.5516841
 0.55156773 0.55125415 0.55097085 0.5507959  0.55067    0.5504882
 0.55015427 0.54969275 0.5492245  0.5487795  0.5484207  0.5480313
 0.5476465  0.54725707 0.54690844 0.5465115  0.5461262  0.5460061
 0.5461928  0.54650795 0.54672945 0.54698956 0.54792637 0.5499792 ]
