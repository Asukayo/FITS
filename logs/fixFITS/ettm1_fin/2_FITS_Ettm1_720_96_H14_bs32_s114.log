Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=122, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=6, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:6
>>>>>>>start training : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=122, out_features=138, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  7542528.0
params:  16974.0
Trainable parameters:  16974
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3825836
	speed: 0.1552s/iter; left time: 4074.0267s
	iters: 200, epoch: 1 | loss: 0.2675789
	speed: 0.1433s/iter; left time: 3747.0403s
	iters: 300, epoch: 1 | loss: 0.2313504
	speed: 0.1412s/iter; left time: 3677.8134s
	iters: 400, epoch: 1 | loss: 0.1871254
	speed: 0.1210s/iter; left time: 3140.7841s
	iters: 500, epoch: 1 | loss: 0.1607365
	speed: 0.1191s/iter; left time: 3077.8723s
Epoch: 1 cost time: 71.3189070224762
Epoch: 1, Steps: 527 | Train Loss: 0.2794210 Vali Loss: 0.6138521 Test Loss: 0.4493251
Validation loss decreased (inf --> 0.613852).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1414212
	speed: 0.9333s/iter; left time: 24009.0635s
	iters: 200, epoch: 2 | loss: 0.1296040
	speed: 0.1142s/iter; left time: 2925.3262s
	iters: 300, epoch: 2 | loss: 0.1245363
	speed: 0.1222s/iter; left time: 3118.4924s
	iters: 400, epoch: 2 | loss: 0.1050592
	speed: 0.1269s/iter; left time: 3227.1070s
	iters: 500, epoch: 2 | loss: 0.1005094
	speed: 0.1489s/iter; left time: 3770.6556s
Epoch: 2 cost time: 68.2834849357605
Epoch: 2, Steps: 527 | Train Loss: 0.1282482 Vali Loss: 0.5533152 Test Loss: 0.4220302
Validation loss decreased (0.613852 --> 0.553315).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.0945478
	speed: 1.0264s/iter; left time: 25863.4346s
	iters: 200, epoch: 3 | loss: 0.0908844
	speed: 0.1406s/iter; left time: 3528.6904s
	iters: 300, epoch: 3 | loss: 0.0830733
	speed: 0.1405s/iter; left time: 3511.0310s
	iters: 400, epoch: 3 | loss: 0.0752145
	speed: 0.1400s/iter; left time: 3485.9727s
	iters: 500, epoch: 3 | loss: 0.0720598
	speed: 0.1426s/iter; left time: 3537.0354s
Epoch: 3 cost time: 75.85229325294495
Epoch: 3, Steps: 527 | Train Loss: 0.0828006 Vali Loss: 0.5045192 Test Loss: 0.3944964
Validation loss decreased (0.553315 --> 0.504519).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.0587317
	speed: 1.0021s/iter; left time: 24721.5781s
	iters: 200, epoch: 4 | loss: 0.0637819
	speed: 0.1424s/iter; left time: 3499.9001s
	iters: 300, epoch: 4 | loss: 0.0609591
	speed: 0.1451s/iter; left time: 3551.0802s
	iters: 400, epoch: 4 | loss: 0.0554994
	speed: 0.1395s/iter; left time: 3399.1968s
	iters: 500, epoch: 4 | loss: 0.0552337
	speed: 0.1413s/iter; left time: 3429.4307s
Epoch: 4 cost time: 76.49608731269836
Epoch: 4, Steps: 527 | Train Loss: 0.0628095 Vali Loss: 0.4741149 Test Loss: 0.3735903
Validation loss decreased (0.504519 --> 0.474115).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0527254
	speed: 0.9122s/iter; left time: 22022.2841s
	iters: 200, epoch: 5 | loss: 0.0587459
	speed: 0.1462s/iter; left time: 3515.3734s
	iters: 300, epoch: 5 | loss: 0.0518846
	speed: 0.1409s/iter; left time: 3374.4456s
	iters: 400, epoch: 5 | loss: 0.0501854
	speed: 0.1444s/iter; left time: 3442.5449s
	iters: 500, epoch: 5 | loss: 0.0533078
	speed: 0.1359s/iter; left time: 3227.5663s
Epoch: 5 cost time: 74.76076173782349
Epoch: 5, Steps: 527 | Train Loss: 0.0536256 Vali Loss: 0.4523188 Test Loss: 0.3575279
Validation loss decreased (0.474115 --> 0.452319).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0492674
	speed: 0.9714s/iter; left time: 22941.0460s
	iters: 200, epoch: 6 | loss: 0.0497368
	speed: 0.1327s/iter; left time: 3121.7041s
	iters: 300, epoch: 6 | loss: 0.0484127
	speed: 0.1384s/iter; left time: 3240.0180s
	iters: 400, epoch: 6 | loss: 0.0462247
	speed: 0.1390s/iter; left time: 3241.3571s
	iters: 500, epoch: 6 | loss: 0.0548293
	speed: 0.1434s/iter; left time: 3329.6792s
Epoch: 6 cost time: 74.07324242591858
Epoch: 6, Steps: 527 | Train Loss: 0.0492982 Vali Loss: 0.4421634 Test Loss: 0.3446446
Validation loss decreased (0.452319 --> 0.442163).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0496337
	speed: 0.8734s/iter; left time: 20165.4103s
	iters: 200, epoch: 7 | loss: 0.0565484
	speed: 0.1426s/iter; left time: 3278.7882s
	iters: 300, epoch: 7 | loss: 0.0482963
	speed: 0.1448s/iter; left time: 3314.6288s
	iters: 400, epoch: 7 | loss: 0.0441869
	speed: 0.1430s/iter; left time: 3258.3769s
	iters: 500, epoch: 7 | loss: 0.0566746
	speed: 0.1455s/iter; left time: 3301.1998s
Epoch: 7 cost time: 77.39675068855286
Epoch: 7, Steps: 527 | Train Loss: 0.0472562 Vali Loss: 0.4304390 Test Loss: 0.3373034
Validation loss decreased (0.442163 --> 0.430439).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0485827
	speed: 1.0427s/iter; left time: 23526.0816s
	iters: 200, epoch: 8 | loss: 0.0479478
	speed: 0.1443s/iter; left time: 3240.8215s
	iters: 300, epoch: 8 | loss: 0.0454342
	speed: 0.1395s/iter; left time: 3118.9683s
	iters: 400, epoch: 8 | loss: 0.0470013
	speed: 0.1387s/iter; left time: 3086.9372s
	iters: 500, epoch: 8 | loss: 0.0424454
	speed: 0.1380s/iter; left time: 3057.6328s
Epoch: 8 cost time: 75.68220019340515
Epoch: 8, Steps: 527 | Train Loss: 0.0462844 Vali Loss: 0.4278011 Test Loss: 0.3310899
Validation loss decreased (0.430439 --> 0.427801).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0403963
	speed: 0.9084s/iter; left time: 20016.7053s
	iters: 200, epoch: 9 | loss: 0.0433686
	speed: 0.1421s/iter; left time: 3117.9610s
	iters: 300, epoch: 9 | loss: 0.0467896
	speed: 0.1415s/iter; left time: 3088.8454s
	iters: 400, epoch: 9 | loss: 0.0471237
	speed: 0.1430s/iter; left time: 3107.0410s
	iters: 500, epoch: 9 | loss: 0.0446347
	speed: 0.1410s/iter; left time: 3050.5182s
Epoch: 9 cost time: 75.72529196739197
Epoch: 9, Steps: 527 | Train Loss: 0.0458337 Vali Loss: 0.4257587 Test Loss: 0.3283449
Validation loss decreased (0.427801 --> 0.425759).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0436115
	speed: 0.9628s/iter; left time: 20708.8948s
	iters: 200, epoch: 10 | loss: 0.0509278
	speed: 0.1350s/iter; left time: 2890.6807s
	iters: 300, epoch: 10 | loss: 0.0455685
	speed: 0.1427s/iter; left time: 3039.6859s
	iters: 400, epoch: 10 | loss: 0.0491624
	speed: 0.1429s/iter; left time: 3031.1377s
	iters: 500, epoch: 10 | loss: 0.0440391
	speed: 0.1400s/iter; left time: 2954.9259s
Epoch: 10 cost time: 74.56711387634277
Epoch: 10, Steps: 527 | Train Loss: 0.0456301 Vali Loss: 0.4210717 Test Loss: 0.3248428
Validation loss decreased (0.425759 --> 0.421072).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0439780
	speed: 0.9770s/iter; left time: 20498.5581s
	iters: 200, epoch: 11 | loss: 0.0448283
	speed: 0.1155s/iter; left time: 2410.8706s
	iters: 300, epoch: 11 | loss: 0.0512533
	speed: 0.1182s/iter; left time: 2455.2968s
	iters: 400, epoch: 11 | loss: 0.0455163
	speed: 0.1349s/iter; left time: 2790.3404s
	iters: 500, epoch: 11 | loss: 0.0483982
	speed: 0.1408s/iter; left time: 2898.7052s
Epoch: 11 cost time: 68.91732621192932
Epoch: 11, Steps: 527 | Train Loss: 0.0455568 Vali Loss: 0.4180426 Test Loss: 0.3234424
Validation loss decreased (0.421072 --> 0.418043).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0466528
	speed: 0.8876s/iter; left time: 18154.3604s
	iters: 200, epoch: 12 | loss: 0.0407075
	speed: 0.1162s/iter; left time: 2365.0873s
	iters: 300, epoch: 12 | loss: 0.0488418
	speed: 0.1183s/iter; left time: 2395.3679s
	iters: 400, epoch: 12 | loss: 0.0424496
	speed: 0.1225s/iter; left time: 2468.6836s
	iters: 500, epoch: 12 | loss: 0.0431566
	speed: 0.1207s/iter; left time: 2420.3429s
Epoch: 12 cost time: 62.93115043640137
Epoch: 12, Steps: 527 | Train Loss: 0.0455332 Vali Loss: 0.4190344 Test Loss: 0.3240092
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0415387
	speed: 0.7614s/iter; left time: 15171.5162s
	iters: 200, epoch: 13 | loss: 0.0502927
	speed: 0.1379s/iter; left time: 2733.3548s
	iters: 300, epoch: 13 | loss: 0.0441780
	speed: 0.1375s/iter; left time: 2712.7795s
	iters: 400, epoch: 13 | loss: 0.0428944
	speed: 0.1331s/iter; left time: 2612.6616s
	iters: 500, epoch: 13 | loss: 0.0502061
	speed: 0.1313s/iter; left time: 2564.8349s
Epoch: 13 cost time: 70.47499132156372
Epoch: 13, Steps: 527 | Train Loss: 0.0455217 Vali Loss: 0.4197026 Test Loss: 0.3228828
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0425067
	speed: 0.9089s/iter; left time: 17633.1531s
	iters: 200, epoch: 14 | loss: 0.0469288
	speed: 0.1364s/iter; left time: 2632.3792s
	iters: 300, epoch: 14 | loss: 0.0480616
	speed: 0.1404s/iter; left time: 2696.3310s
	iters: 400, epoch: 14 | loss: 0.0462363
	speed: 0.1446s/iter; left time: 2762.0904s
	iters: 500, epoch: 14 | loss: 0.0518549
	speed: 0.1433s/iter; left time: 2721.9082s
Epoch: 14 cost time: 73.96995067596436
Epoch: 14, Steps: 527 | Train Loss: 0.0455200 Vali Loss: 0.4190952 Test Loss: 0.3225712
EarlyStopping counter: 3 out of 3
Early stopping
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=122, out_features=138, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  7542528.0
params:  16974.0
Trainable parameters:  16974
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2566337
	speed: 0.1518s/iter; left time: 3986.0083s
	iters: 200, epoch: 1 | loss: 0.2106677
	speed: 0.1333s/iter; left time: 3485.2946s
	iters: 300, epoch: 1 | loss: 0.2537470
	speed: 0.1347s/iter; left time: 3509.1598s
	iters: 400, epoch: 1 | loss: 0.2152279
	speed: 0.1363s/iter; left time: 3536.0621s
	iters: 500, epoch: 1 | loss: 0.2244802
	speed: 0.1350s/iter; left time: 3490.2335s
Epoch: 1 cost time: 73.05789804458618
Epoch: 1, Steps: 527 | Train Loss: 0.2667426 Vali Loss: 0.3982594 Test Loss: 0.3114813
Validation loss decreased (inf --> 0.398259).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2824197
	speed: 0.8060s/iter; left time: 20732.2673s
	iters: 200, epoch: 2 | loss: 0.2983714
	speed: 0.1389s/iter; left time: 3558.2946s
	iters: 300, epoch: 2 | loss: 0.2605465
	speed: 0.1387s/iter; left time: 3540.8439s
	iters: 400, epoch: 2 | loss: 0.2188627
	speed: 0.1358s/iter; left time: 3451.3261s
	iters: 500, epoch: 2 | loss: 0.2470871
	speed: 0.1140s/iter; left time: 2885.7144s
Epoch: 2 cost time: 70.02419996261597
Epoch: 2, Steps: 527 | Train Loss: 0.2640547 Vali Loss: 0.4033812 Test Loss: 0.3112007
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2675877
	speed: 0.8706s/iter; left time: 21937.2295s
	iters: 200, epoch: 3 | loss: 0.2646135
	speed: 0.1343s/iter; left time: 3369.3375s
	iters: 300, epoch: 3 | loss: 0.3140635
	speed: 0.1378s/iter; left time: 3445.0958s
	iters: 400, epoch: 3 | loss: 0.2521503
	speed: 0.1373s/iter; left time: 3417.2309s
	iters: 500, epoch: 3 | loss: 0.2818387
	speed: 0.1409s/iter; left time: 3492.9937s
Epoch: 3 cost time: 73.4061050415039
Epoch: 3, Steps: 527 | Train Loss: 0.2633718 Vali Loss: 0.3978254 Test Loss: 0.3116389
Validation loss decreased (0.398259 --> 0.397825).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2640799
	speed: 0.9638s/iter; left time: 23778.0776s
	iters: 200, epoch: 4 | loss: 0.2897351
	speed: 0.1334s/iter; left time: 3277.2327s
	iters: 300, epoch: 4 | loss: 0.2467089
	speed: 0.1320s/iter; left time: 3230.0180s
	iters: 400, epoch: 4 | loss: 0.3191338
	speed: 0.1287s/iter; left time: 3135.2784s
	iters: 500, epoch: 4 | loss: 0.2597570
	speed: 0.1381s/iter; left time: 3351.0720s
Epoch: 4 cost time: 71.55137872695923
Epoch: 4, Steps: 527 | Train Loss: 0.2628365 Vali Loss: 0.3944255 Test Loss: 0.3096537
Validation loss decreased (0.397825 --> 0.394425).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2535447
	speed: 0.8910s/iter; left time: 21511.7965s
	iters: 200, epoch: 5 | loss: 0.3264950
	speed: 0.1359s/iter; left time: 3266.4889s
	iters: 300, epoch: 5 | loss: 0.2260908
	speed: 0.1366s/iter; left time: 3269.4937s
	iters: 400, epoch: 5 | loss: 0.2515733
	speed: 0.1318s/iter; left time: 3143.4399s
	iters: 500, epoch: 5 | loss: 0.2367216
	speed: 0.1147s/iter; left time: 2722.4775s
Epoch: 5 cost time: 70.11415076255798
Epoch: 5, Steps: 527 | Train Loss: 0.2626094 Vali Loss: 0.3929892 Test Loss: 0.3108507
Validation loss decreased (0.394425 --> 0.392989).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2522451
	speed: 0.9439s/iter; left time: 22290.2650s
	iters: 200, epoch: 6 | loss: 0.2942285
	speed: 0.1371s/iter; left time: 3222.8999s
	iters: 300, epoch: 6 | loss: 0.2501159
	speed: 0.1390s/iter; left time: 3254.8081s
	iters: 400, epoch: 6 | loss: 0.2440843
	speed: 0.1397s/iter; left time: 3257.4392s
	iters: 500, epoch: 6 | loss: 0.2287356
	speed: 0.1403s/iter; left time: 3256.6952s
Epoch: 6 cost time: 74.36908555030823
Epoch: 6, Steps: 527 | Train Loss: 0.2623558 Vali Loss: 0.3945623 Test Loss: 0.3100773
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2109125
	speed: 0.9553s/iter; left time: 22057.2506s
	iters: 200, epoch: 7 | loss: 0.2951401
	speed: 0.1337s/iter; left time: 3073.4481s
	iters: 300, epoch: 7 | loss: 0.2784656
	speed: 0.1342s/iter; left time: 3071.8477s
	iters: 400, epoch: 7 | loss: 0.2250572
	speed: 0.1423s/iter; left time: 3242.6746s
	iters: 500, epoch: 7 | loss: 0.2895408
	speed: 0.1386s/iter; left time: 3144.8109s
Epoch: 7 cost time: 73.30361151695251
Epoch: 7, Steps: 527 | Train Loss: 0.2622768 Vali Loss: 0.3945645 Test Loss: 0.3102442
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2971134
	speed: 0.8717s/iter; left time: 19667.8268s
	iters: 200, epoch: 8 | loss: 0.3015023
	speed: 0.1090s/iter; left time: 2447.5613s
	iters: 300, epoch: 8 | loss: 0.2677117
	speed: 0.1246s/iter; left time: 2785.2057s
	iters: 400, epoch: 8 | loss: 0.2749984
	speed: 0.1296s/iter; left time: 2884.3697s
	iters: 500, epoch: 8 | loss: 0.2765487
	speed: 0.1259s/iter; left time: 2789.1050s
Epoch: 8 cost time: 64.76299571990967
Epoch: 8, Steps: 527 | Train Loss: 0.2621605 Vali Loss: 0.3948104 Test Loss: 0.3085714
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.31136518716812134, mae:0.35346096754074097, rse:0.5309662222862244, corr:[0.548563   0.5566523  0.5584682  0.55882394 0.56072223 0.56377757
 0.56593174 0.5664443  0.5665034  0.5672709  0.5687728  0.5700035
 0.57029474 0.5697803  0.56899697 0.5682099  0.5673162  0.56617147
 0.5647628  0.56334245 0.56213737 0.56100196 0.55969363 0.5582711
 0.55669    0.55529565 0.5541793  0.5531243  0.5522154  0.5516251
 0.5516865  0.55256826 0.5537134  0.5544942  0.55442417 0.5539706
 0.55344415 0.5531448  0.55294466 0.55250424 0.55198216 0.5515868
 0.5515281  0.5517727  0.55177444 0.55129397 0.5507181  0.55045664
 0.55055153 0.55066097 0.5505458  0.55017453 0.549975   0.55020684
 0.5508426  0.55138916 0.55136704 0.55068296 0.5499969  0.5497983
 0.5502488  0.55092865 0.5513063  0.55097574 0.55025226 0.5496128
 0.5492466  0.5490922  0.5490868  0.54917705 0.54943395 0.5497884
 0.5500955  0.5501923  0.5501391  0.5499474  0.5497021  0.5494967
 0.5493146  0.54907376 0.5486814  0.5481036  0.54759896 0.54726154
 0.5471476  0.54697245 0.54639596 0.5452616  0.544063   0.5437156
 0.5445792  0.5460452  0.54708517 0.54730034 0.54718834 0.54751354]
