Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=256, c_out=7, checkpoints='./checkpoints/', cut_freq=106, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=6, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:6
>>>>>>>start training : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=106, out_features=120, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  22794240.0
params:  12840.0
Trainable parameters:  12840
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3885976
	speed: 0.1304s/iter; left time: 840.9306s
Epoch: 1 cost time: 17.15968680381775
Epoch: 1, Steps: 131 | Train Loss: 0.4446853 Vali Loss: 0.7488133 Test Loss: 0.5122216
Validation loss decreased (inf --> 0.748813).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2607217
	speed: 0.3593s/iter; left time: 2270.9360s
Epoch: 2 cost time: 17.38979148864746
Epoch: 2, Steps: 131 | Train Loss: 0.2859027 Vali Loss: 0.6729565 Test Loss: 0.4854696
Validation loss decreased (0.748813 --> 0.672957).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2037100
	speed: 0.3953s/iter; left time: 2446.8119s
Epoch: 3 cost time: 20.547289609909058
Epoch: 3, Steps: 131 | Train Loss: 0.2217257 Vali Loss: 0.6450313 Test Loss: 0.4778094
Validation loss decreased (0.672957 --> 0.645031).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1714783
	speed: 0.4270s/iter; left time: 2586.6844s
Epoch: 4 cost time: 19.926834106445312
Epoch: 4, Steps: 131 | Train Loss: 0.1849378 Vali Loss: 0.6228314 Test Loss: 0.4692495
Validation loss decreased (0.645031 --> 0.622831).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1586731
	speed: 0.4201s/iter; left time: 2489.7192s
Epoch: 5 cost time: 20.244072914123535
Epoch: 5, Steps: 131 | Train Loss: 0.1597540 Vali Loss: 0.6020742 Test Loss: 0.4598933
Validation loss decreased (0.622831 --> 0.602074).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1446637
	speed: 0.4191s/iter; left time: 2428.8708s
Epoch: 6 cost time: 21.139079332351685
Epoch: 6, Steps: 131 | Train Loss: 0.1408894 Vali Loss: 0.5885980 Test Loss: 0.4508391
Validation loss decreased (0.602074 --> 0.588598).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1213311
	speed: 0.4594s/iter; left time: 2602.6327s
Epoch: 7 cost time: 21.329596281051636
Epoch: 7, Steps: 131 | Train Loss: 0.1260642 Vali Loss: 0.5738253 Test Loss: 0.4434853
Validation loss decreased (0.588598 --> 0.573825).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1104052
	speed: 0.4094s/iter; left time: 2265.4547s
Epoch: 8 cost time: 20.05375909805298
Epoch: 8, Steps: 131 | Train Loss: 0.1141939 Vali Loss: 0.5573975 Test Loss: 0.4341515
Validation loss decreased (0.573825 --> 0.557398).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1032480
	speed: 0.3511s/iter; left time: 1897.1948s
Epoch: 9 cost time: 16.130717992782593
Epoch: 9, Steps: 131 | Train Loss: 0.1045530 Vali Loss: 0.5486416 Test Loss: 0.4294854
Validation loss decreased (0.557398 --> 0.548642).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0934961
	speed: 0.3577s/iter; left time: 1885.7678s
Epoch: 10 cost time: 16.842772006988525
Epoch: 10, Steps: 131 | Train Loss: 0.0966195 Vali Loss: 0.5379044 Test Loss: 0.4208797
Validation loss decreased (0.548642 --> 0.537904).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0882144
	speed: 0.3306s/iter; left time: 1699.5346s
Epoch: 11 cost time: 16.007766246795654
Epoch: 11, Steps: 131 | Train Loss: 0.0899992 Vali Loss: 0.5285735 Test Loss: 0.4148807
Validation loss decreased (0.537904 --> 0.528573).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0817138
	speed: 0.3292s/iter; left time: 1649.2362s
Epoch: 12 cost time: 15.715839385986328
Epoch: 12, Steps: 131 | Train Loss: 0.0844761 Vali Loss: 0.5177037 Test Loss: 0.4089002
Validation loss decreased (0.528573 --> 0.517704).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0756324
	speed: 0.3448s/iter; left time: 1682.2913s
Epoch: 13 cost time: 16.095693349838257
Epoch: 13, Steps: 131 | Train Loss: 0.0798274 Vali Loss: 0.5101548 Test Loss: 0.4037875
Validation loss decreased (0.517704 --> 0.510155).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0775054
	speed: 0.3546s/iter; left time: 1683.8177s
Epoch: 14 cost time: 16.587908029556274
Epoch: 14, Steps: 131 | Train Loss: 0.0759096 Vali Loss: 0.5042604 Test Loss: 0.3991798
Validation loss decreased (0.510155 --> 0.504260).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0731997
	speed: 0.3317s/iter; left time: 1531.2721s
Epoch: 15 cost time: 16.933995246887207
Epoch: 15, Steps: 131 | Train Loss: 0.0725569 Vali Loss: 0.4980305 Test Loss: 0.3943855
Validation loss decreased (0.504260 --> 0.498030).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0695953
	speed: 0.3754s/iter; left time: 1684.0415s
Epoch: 16 cost time: 18.47222375869751
Epoch: 16, Steps: 131 | Train Loss: 0.0696914 Vali Loss: 0.4930927 Test Loss: 0.3913619
Validation loss decreased (0.498030 --> 0.493093).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0631621
	speed: 0.3966s/iter; left time: 1727.0073s
Epoch: 17 cost time: 19.348204851150513
Epoch: 17, Steps: 131 | Train Loss: 0.0672529 Vali Loss: 0.4892265 Test Loss: 0.3877456
Validation loss decreased (0.493093 --> 0.489226).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0679566
	speed: 0.3977s/iter; left time: 1679.8758s
Epoch: 18 cost time: 18.343385934829712
Epoch: 18, Steps: 131 | Train Loss: 0.0651019 Vali Loss: 0.4840104 Test Loss: 0.3839801
Validation loss decreased (0.489226 --> 0.484010).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0637275
	speed: 0.3791s/iter; left time: 1551.7078s
Epoch: 19 cost time: 17.902202129364014
Epoch: 19, Steps: 131 | Train Loss: 0.0632726 Vali Loss: 0.4799146 Test Loss: 0.3808451
Validation loss decreased (0.484010 --> 0.479915).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0589065
	speed: 0.3684s/iter; left time: 1459.4254s
Epoch: 20 cost time: 16.671643257141113
Epoch: 20, Steps: 131 | Train Loss: 0.0616512 Vali Loss: 0.4755963 Test Loss: 0.3780901
Validation loss decreased (0.479915 --> 0.475596).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0570398
	speed: 0.3360s/iter; left time: 1287.1702s
Epoch: 21 cost time: 16.078225135803223
Epoch: 21, Steps: 131 | Train Loss: 0.0602398 Vali Loss: 0.4719380 Test Loss: 0.3757305
Validation loss decreased (0.475596 --> 0.471938).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0564582
	speed: 0.3440s/iter; left time: 1272.8858s
Epoch: 22 cost time: 16.722102165222168
Epoch: 22, Steps: 131 | Train Loss: 0.0589822 Vali Loss: 0.4699721 Test Loss: 0.3729574
Validation loss decreased (0.471938 --> 0.469972).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0596131
	speed: 0.3472s/iter; left time: 1239.3028s
Epoch: 23 cost time: 16.3205304145813
Epoch: 23, Steps: 131 | Train Loss: 0.0578830 Vali Loss: 0.4676013 Test Loss: 0.3704905
Validation loss decreased (0.469972 --> 0.467601).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0575175
	speed: 0.3586s/iter; left time: 1232.9108s
Epoch: 24 cost time: 17.937029600143433
Epoch: 24, Steps: 131 | Train Loss: 0.0569208 Vali Loss: 0.4641756 Test Loss: 0.3680958
Validation loss decreased (0.467601 --> 0.464176).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0557574
	speed: 0.3688s/iter; left time: 1219.5185s
Epoch: 25 cost time: 18.60579252243042
Epoch: 25, Steps: 131 | Train Loss: 0.0560636 Vali Loss: 0.4618673 Test Loss: 0.3656881
Validation loss decreased (0.464176 --> 0.461867).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0584373
	speed: 0.3618s/iter; left time: 1149.1669s
Epoch: 26 cost time: 15.320705652236938
Epoch: 26, Steps: 131 | Train Loss: 0.0553032 Vali Loss: 0.4587606 Test Loss: 0.3638968
Validation loss decreased (0.461867 --> 0.458761).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0538683
	speed: 0.3329s/iter; left time: 1013.5404s
Epoch: 27 cost time: 18.353227138519287
Epoch: 27, Steps: 131 | Train Loss: 0.0545853 Vali Loss: 0.4576402 Test Loss: 0.3619980
Validation loss decreased (0.458761 --> 0.457640).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0544363
	speed: 0.3585s/iter; left time: 1044.6790s
Epoch: 28 cost time: 18.81772470474243
Epoch: 28, Steps: 131 | Train Loss: 0.0539887 Vali Loss: 0.4552976 Test Loss: 0.3605824
Validation loss decreased (0.457640 --> 0.455298).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0536882
	speed: 0.3931s/iter; left time: 1093.9983s
Epoch: 29 cost time: 18.854869842529297
Epoch: 29, Steps: 131 | Train Loss: 0.0534351 Vali Loss: 0.4543363 Test Loss: 0.3587548
Validation loss decreased (0.455298 --> 0.454336).  Saving model ...
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.0549413
	speed: 0.3766s/iter; left time: 998.7821s
Epoch: 30 cost time: 18.016173601150513
Epoch: 30, Steps: 131 | Train Loss: 0.0529402 Vali Loss: 0.4515215 Test Loss: 0.3574209
Validation loss decreased (0.454336 --> 0.451521).  Saving model ...
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0526444
	speed: 0.3563s/iter; left time: 898.1462s
Epoch: 31 cost time: 14.984608888626099
Epoch: 31, Steps: 131 | Train Loss: 0.0524692 Vali Loss: 0.4506406 Test Loss: 0.3558978
Validation loss decreased (0.451521 --> 0.450641).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.0511067
	speed: 0.3858s/iter; left time: 922.0033s
Epoch: 32 cost time: 18.446232080459595
Epoch: 32, Steps: 131 | Train Loss: 0.0520673 Vali Loss: 0.4481418 Test Loss: 0.3542656
Validation loss decreased (0.450641 --> 0.448142).  Saving model ...
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0524182
	speed: 0.3353s/iter; left time: 757.5222s
Epoch: 33 cost time: 15.840395450592041
Epoch: 33, Steps: 131 | Train Loss: 0.0517004 Vali Loss: 0.4471693 Test Loss: 0.3528715
Validation loss decreased (0.448142 --> 0.447169).  Saving model ...
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0516944
	speed: 0.3488s/iter; left time: 742.2520s
Epoch: 34 cost time: 17.175893545150757
Epoch: 34, Steps: 131 | Train Loss: 0.0513616 Vali Loss: 0.4454391 Test Loss: 0.3519275
Validation loss decreased (0.447169 --> 0.445439).  Saving model ...
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.0482637
	speed: 0.3417s/iter; left time: 682.3280s
Epoch: 35 cost time: 16.54293656349182
Epoch: 35, Steps: 131 | Train Loss: 0.0510568 Vali Loss: 0.4438662 Test Loss: 0.3508189
Validation loss decreased (0.445439 --> 0.443866).  Saving model ...
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.0530675
	speed: 0.3513s/iter; left time: 655.5595s
Epoch: 36 cost time: 16.8101544380188
Epoch: 36, Steps: 131 | Train Loss: 0.0507587 Vali Loss: 0.4443844 Test Loss: 0.3496307
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.0514024
	speed: 0.3671s/iter; left time: 636.8627s
Epoch: 37 cost time: 17.148692846298218
Epoch: 37, Steps: 131 | Train Loss: 0.0504999 Vali Loss: 0.4417910 Test Loss: 0.3486228
Validation loss decreased (0.443866 --> 0.441791).  Saving model ...
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.0506030
	speed: 0.3515s/iter; left time: 563.8698s
Epoch: 38 cost time: 16.524475812911987
Epoch: 38, Steps: 131 | Train Loss: 0.0502721 Vali Loss: 0.4409926 Test Loss: 0.3477777
Validation loss decreased (0.441791 --> 0.440993).  Saving model ...
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.0512174
	speed: 0.3602s/iter; left time: 530.5332s
Epoch: 39 cost time: 16.837459802627563
Epoch: 39, Steps: 131 | Train Loss: 0.0500507 Vali Loss: 0.4408271 Test Loss: 0.3468122
Validation loss decreased (0.440993 --> 0.440827).  Saving model ...
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.0509716
	speed: 0.3442s/iter; left time: 461.8831s
Epoch: 40 cost time: 15.389035940170288
Epoch: 40, Steps: 131 | Train Loss: 0.0498565 Vali Loss: 0.4397892 Test Loss: 0.3457672
Validation loss decreased (0.440827 --> 0.439789).  Saving model ...
Updating learning rate to 6.763797713952796e-05
	iters: 100, epoch: 41 | loss: 0.0508360
	speed: 0.3953s/iter; left time: 478.7369s
Epoch: 41 cost time: 19.918330669403076
Epoch: 41, Steps: 131 | Train Loss: 0.0496909 Vali Loss: 0.4380842 Test Loss: 0.3450086
Validation loss decreased (0.439789 --> 0.438084).  Saving model ...
Updating learning rate to 6.425607828255156e-05
	iters: 100, epoch: 42 | loss: 0.0480784
	speed: 0.4227s/iter; left time: 456.5262s
Epoch: 42 cost time: 20.356319665908813
Epoch: 42, Steps: 131 | Train Loss: 0.0495224 Vali Loss: 0.4379300 Test Loss: 0.3442840
Validation loss decreased (0.438084 --> 0.437930).  Saving model ...
Updating learning rate to 6.104327436842398e-05
	iters: 100, epoch: 43 | loss: 0.0518243
	speed: 0.4226s/iter; left time: 401.0846s
Epoch: 43 cost time: 20.516451120376587
Epoch: 43, Steps: 131 | Train Loss: 0.0493575 Vali Loss: 0.4370418 Test Loss: 0.3435295
Validation loss decreased (0.437930 --> 0.437042).  Saving model ...
Updating learning rate to 5.799111065000278e-05
	iters: 100, epoch: 44 | loss: 0.0500606
	speed: 0.4077s/iter; left time: 333.5018s
Epoch: 44 cost time: 19.857518196105957
Epoch: 44, Steps: 131 | Train Loss: 0.0492157 Vali Loss: 0.4364479 Test Loss: 0.3428665
Validation loss decreased (0.437042 --> 0.436448).  Saving model ...
Updating learning rate to 5.509155511750264e-05
	iters: 100, epoch: 45 | loss: 0.0528436
	speed: 0.3803s/iter; left time: 261.2781s
Epoch: 45 cost time: 17.23956823348999
Epoch: 45, Steps: 131 | Train Loss: 0.0490920 Vali Loss: 0.4361222 Test Loss: 0.3422183
Validation loss decreased (0.436448 --> 0.436122).  Saving model ...
Updating learning rate to 5.2336977361627504e-05
	iters: 100, epoch: 46 | loss: 0.0507289
	speed: 0.3495s/iter; left time: 194.3460s
Epoch: 46 cost time: 14.64672327041626
Epoch: 46, Steps: 131 | Train Loss: 0.0489720 Vali Loss: 0.4355517 Test Loss: 0.3414693
Validation loss decreased (0.436122 --> 0.435552).  Saving model ...
Updating learning rate to 4.9720128493546124e-05
	iters: 100, epoch: 47 | loss: 0.0483955
	speed: 0.3025s/iter; left time: 128.5499s
Epoch: 47 cost time: 15.899139404296875
Epoch: 47, Steps: 131 | Train Loss: 0.0488375 Vali Loss: 0.4349680 Test Loss: 0.3408741
Validation loss decreased (0.435552 --> 0.434968).  Saving model ...
Updating learning rate to 4.7234122068868816e-05
	iters: 100, epoch: 48 | loss: 0.0499641
	speed: 0.3233s/iter; left time: 95.0638s
Epoch: 48 cost time: 15.551114797592163
Epoch: 48, Steps: 131 | Train Loss: 0.0487543 Vali Loss: 0.4341557 Test Loss: 0.3403798
Validation loss decreased (0.434968 --> 0.434156).  Saving model ...
Updating learning rate to 4.487241596542538e-05
	iters: 100, epoch: 49 | loss: 0.0490821
	speed: 0.3082s/iter; left time: 50.2414s
Epoch: 49 cost time: 14.553085803985596
Epoch: 49, Steps: 131 | Train Loss: 0.0486638 Vali Loss: 0.4336948 Test Loss: 0.3396941
Validation loss decreased (0.434156 --> 0.433695).  Saving model ...
Updating learning rate to 4.26287951671541e-05
	iters: 100, epoch: 50 | loss: 0.0529340
	speed: 0.3595s/iter; left time: 11.5051s
Epoch: 50 cost time: 18.19267463684082
Epoch: 50, Steps: 131 | Train Loss: 0.0485836 Vali Loss: 0.4335668 Test Loss: 0.3393165
Validation loss decreased (0.433695 --> 0.433567).  Saving model ...
Updating learning rate to 4.0497355408796396e-05
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=106, out_features=120, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  22794240.0
params:  12840.0
Trainable parameters:  12840
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2661014
	speed: 0.1181s/iter; left time: 761.5981s
Epoch: 1 cost time: 14.993410110473633
Epoch: 1, Steps: 131 | Train Loss: 0.2687810 Vali Loss: 0.4032367 Test Loss: 0.3145302
Validation loss decreased (inf --> 0.403237).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2484904
	speed: 0.3102s/iter; left time: 1960.6952s
Epoch: 2 cost time: 16.49163055419922
Epoch: 2, Steps: 131 | Train Loss: 0.2652439 Vali Loss: 0.3982968 Test Loss: 0.3123993
Validation loss decreased (0.403237 --> 0.398297).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2543992
	speed: 0.3941s/iter; left time: 2438.7986s
Epoch: 3 cost time: 20.543617486953735
Epoch: 3, Steps: 131 | Train Loss: 0.2640960 Vali Loss: 0.3996253 Test Loss: 0.3116410
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2718963
	speed: 0.3711s/iter; left time: 2248.3096s
Epoch: 4 cost time: 16.414405822753906
Epoch: 4, Steps: 131 | Train Loss: 0.2634588 Vali Loss: 0.4004039 Test Loss: 0.3109281
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2517487
	speed: 0.3455s/iter; left time: 2047.9418s
Epoch: 5 cost time: 15.2786386013031
Epoch: 5, Steps: 131 | Train Loss: 0.2630228 Vali Loss: 0.3974513 Test Loss: 0.3111396
Validation loss decreased (0.398297 --> 0.397451).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2545418
	speed: 0.2712s/iter; left time: 1572.0272s
Epoch: 6 cost time: 16.243213176727295
Epoch: 6, Steps: 131 | Train Loss: 0.2630425 Vali Loss: 0.3980404 Test Loss: 0.3113187
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2510948
	speed: 0.3895s/iter; left time: 2206.2404s
Epoch: 7 cost time: 18.528359413146973
Epoch: 7, Steps: 131 | Train Loss: 0.2628437 Vali Loss: 0.3955183 Test Loss: 0.3099391
Validation loss decreased (0.397451 --> 0.395518).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2506098
	speed: 0.3424s/iter; left time: 1894.8828s
Epoch: 8 cost time: 15.43092131614685
Epoch: 8, Steps: 131 | Train Loss: 0.2624365 Vali Loss: 0.3974690 Test Loss: 0.3103529
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2593431
	speed: 0.3551s/iter; left time: 1918.8319s
Epoch: 9 cost time: 17.662944555282593
Epoch: 9, Steps: 131 | Train Loss: 0.2623172 Vali Loss: 0.3969351 Test Loss: 0.3110600
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2450619
	speed: 0.4215s/iter; left time: 2222.0813s
Epoch: 10 cost time: 19.794854879379272
Epoch: 10, Steps: 131 | Train Loss: 0.2623820 Vali Loss: 0.3960534 Test Loss: 0.3102269
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3100380599498749, mae:0.352426141500473, rse:0.5298334956169128, corr:[0.5448527  0.5564248  0.56240463 0.5635699  0.5637043  0.56489956
 0.5669357  0.56866735 0.5693127  0.56908655 0.5688618  0.5690587
 0.56958115 0.5698998  0.56958586 0.56870997 0.5676504  0.56663996
 0.5655503  0.5642407  0.56267065 0.56084085 0.5589862  0.5575484
 0.5564712  0.5556869  0.55494744 0.554052   0.5533083  0.5530398
 0.5533954  0.5542647  0.55514836 0.55576575 0.5559606  0.5561548
 0.5563125  0.55637544 0.5561977  0.5555719  0.5547077  0.5539002
 0.5535348  0.5537678  0.55416936 0.5543648  0.5543569  0.55426365
 0.5542123  0.55423284 0.55430156 0.55421066 0.5539365  0.55352783
 0.5533256  0.55354017 0.55402637 0.55435914 0.55436885 0.55390847
 0.55320954 0.55265635 0.5524875  0.5524624  0.55241114 0.5522055
 0.5518553  0.5515521  0.55152595 0.55171204 0.5519231  0.55190593
 0.5515874  0.5511073  0.5507643  0.55058616 0.5504077  0.5500466
 0.5494097  0.5486191  0.547985   0.5477288  0.54788905 0.54805905
 0.5478436  0.5469749  0.5457149  0.5446148  0.5442825  0.544956
 0.5460791  0.54688585 0.54720926 0.5476469  0.5489146  0.5503232 ]
