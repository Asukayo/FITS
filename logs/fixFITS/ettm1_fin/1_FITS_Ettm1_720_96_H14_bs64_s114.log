Args in experiment:
Namespace(H_order=14, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=122, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=6, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:6
>>>>>>>start training : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H14_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=122, out_features=138, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  15085056.0
params:  16974.0
Trainable parameters:  16974
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2801057
	speed: 0.1490s/iter; left time: 1944.5079s
	iters: 200, epoch: 1 | loss: 0.2805129
	speed: 0.1368s/iter; left time: 1771.6904s
Epoch: 1 cost time: 37.175246238708496
Epoch: 1, Steps: 263 | Train Loss: 0.3154540 Vali Loss: 0.4330041 Test Loss: 0.3130811
Validation loss decreased (inf --> 0.433004).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2724889
	speed: 0.6349s/iter; left time: 8118.6792s
	iters: 200, epoch: 2 | loss: 0.2625110
	speed: 0.1196s/iter; left time: 1517.4980s
Epoch: 2 cost time: 32.889554262161255
Epoch: 2, Steps: 263 | Train Loss: 0.2701436 Vali Loss: 0.4158860 Test Loss: 0.3099016
Validation loss decreased (0.433004 --> 0.415886).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2638926
	speed: 0.5392s/iter; left time: 6753.2337s
	iters: 200, epoch: 3 | loss: 0.2418897
	speed: 0.1314s/iter; left time: 1632.7885s
Epoch: 3 cost time: 35.06310319900513
Epoch: 3, Steps: 263 | Train Loss: 0.2660583 Vali Loss: 0.4082201 Test Loss: 0.3078281
Validation loss decreased (0.415886 --> 0.408220).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2669902
	speed: 0.6203s/iter; left time: 7605.7980s
	iters: 200, epoch: 4 | loss: 0.2686293
	speed: 0.1388s/iter; left time: 1688.6403s
Epoch: 4 cost time: 36.57566714286804
Epoch: 4, Steps: 263 | Train Loss: 0.2645054 Vali Loss: 0.3993724 Test Loss: 0.3079109
Validation loss decreased (0.408220 --> 0.399372).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2608360
	speed: 0.6233s/iter; left time: 7479.5386s
	iters: 200, epoch: 5 | loss: 0.2472832
	speed: 0.1508s/iter; left time: 1794.1192s
Epoch: 5 cost time: 39.08296060562134
Epoch: 5, Steps: 263 | Train Loss: 0.2636274 Vali Loss: 0.3994985 Test Loss: 0.3082418
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2614010
	speed: 0.6686s/iter; left time: 7846.9871s
	iters: 200, epoch: 6 | loss: 0.2575606
	speed: 0.1418s/iter; left time: 1650.4306s
Epoch: 6 cost time: 38.39670205116272
Epoch: 6, Steps: 263 | Train Loss: 0.2631770 Vali Loss: 0.3979095 Test Loss: 0.3080936
Validation loss decreased (0.399372 --> 0.397909).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2794223
	speed: 0.6519s/iter; left time: 7478.8348s
	iters: 200, epoch: 7 | loss: 0.2747027
	speed: 0.1378s/iter; left time: 1567.1434s
Epoch: 7 cost time: 36.7697377204895
Epoch: 7, Steps: 263 | Train Loss: 0.2628543 Vali Loss: 0.3968359 Test Loss: 0.3080001
Validation loss decreased (0.397909 --> 0.396836).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2578405
	speed: 0.6552s/iter; left time: 7344.9229s
	iters: 200, epoch: 8 | loss: 0.2854208
	speed: 0.1205s/iter; left time: 1339.0136s
Epoch: 8 cost time: 34.34187436103821
Epoch: 8, Steps: 263 | Train Loss: 0.2624743 Vali Loss: 0.3982505 Test Loss: 0.3078986
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2525623
	speed: 0.5507s/iter; left time: 6028.6788s
	iters: 200, epoch: 9 | loss: 0.2645653
	speed: 0.1306s/iter; left time: 1416.8093s
Epoch: 9 cost time: 33.15014600753784
Epoch: 9, Steps: 263 | Train Loss: 0.2623464 Vali Loss: 0.3976668 Test Loss: 0.3078105
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2663003
	speed: 0.5361s/iter; left time: 5727.2257s
	iters: 200, epoch: 10 | loss: 0.2596109
	speed: 0.1200s/iter; left time: 1270.1426s
Epoch: 10 cost time: 31.74218249320984
Epoch: 10, Steps: 263 | Train Loss: 0.2621499 Vali Loss: 0.3945901 Test Loss: 0.3086108
Validation loss decreased (0.396836 --> 0.394590).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2690739
	speed: 0.6528s/iter; left time: 6802.5903s
	iters: 200, epoch: 11 | loss: 0.2616298
	speed: 0.1583s/iter; left time: 1633.3605s
Epoch: 11 cost time: 41.29489588737488
Epoch: 11, Steps: 263 | Train Loss: 0.2620774 Vali Loss: 0.3975728 Test Loss: 0.3090142
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2496545
	speed: 0.7031s/iter; left time: 7141.7453s
	iters: 200, epoch: 12 | loss: 0.2402067
	speed: 0.1600s/iter; left time: 1609.7587s
Epoch: 12 cost time: 42.682687759399414
Epoch: 12, Steps: 263 | Train Loss: 0.2619721 Vali Loss: 0.3963395 Test Loss: 0.3090396
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2991751
	speed: 0.6944s/iter; left time: 6871.3906s
	iters: 200, epoch: 13 | loss: 0.2518044
	speed: 0.1515s/iter; left time: 1484.1798s
Epoch: 13 cost time: 41.127399921417236
Epoch: 13, Steps: 263 | Train Loss: 0.2619239 Vali Loss: 0.3949469 Test Loss: 0.3080953
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H14_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3101520240306854, mae:0.3524269759654999, rse:0.529930830001831, corr:[0.5443236  0.55456257 0.5584183  0.5597163  0.5617926  0.5646762
 0.56666076 0.56708306 0.56694007 0.56726235 0.56820226 0.56902367
 0.56922895 0.5689225  0.56850004 0.5680476  0.5673362  0.5662088
 0.56473863 0.56328005 0.5621012  0.561079   0.5599915  0.5588931
 0.5576855  0.55663085 0.55573696 0.55481654 0.5541129  0.55385184
 0.55426633 0.5553213  0.55636746 0.5568404  0.5563341  0.5555396
 0.55500174 0.5550809  0.555494   0.55563724 0.55542314 0.5549801
 0.5547087  0.55487996 0.55514514 0.55521977 0.55518377 0.55517524
 0.5552006  0.5551011  0.5548454  0.55440754 0.55396914 0.5536176
 0.5534399  0.553254   0.55283964 0.5521394  0.55153257 0.5512117
 0.5512576  0.55142117 0.5514532  0.551207   0.55102044 0.5511508
 0.5515064  0.5517607  0.55172276 0.5515045  0.5514996  0.55178696
 0.55212533 0.5521799  0.55188805 0.5513042  0.5506927  0.55030817
 0.5501333  0.5499414  0.54951245 0.5487684  0.5479916  0.54734814
 0.5469108  0.54645795 0.54588526 0.5452475  0.5449097  0.54521406
 0.54582286 0.5461152  0.54600984 0.54622203 0.5474123  0.5485643 ]
