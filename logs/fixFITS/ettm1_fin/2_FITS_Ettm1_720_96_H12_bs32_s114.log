Args in experiment:
Namespace(H_order=12, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=96, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=106, d_ff=2048, d_layers=1, d_model=512, data='ETTm1', data_path='ETTm1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=6, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTm1_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:6
>>>>>>>start training : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H12_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=106, out_features=120, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  5698560.0
params:  12840.0
Trainable parameters:  12840
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.3687720
	speed: 0.1338s/iter; left time: 3512.2189s
	iters: 200, epoch: 1 | loss: 0.3008795
	speed: 0.1247s/iter; left time: 3261.8662s
	iters: 300, epoch: 1 | loss: 0.2671078
	speed: 0.1136s/iter; left time: 2959.0864s
	iters: 400, epoch: 1 | loss: 0.2064335
	speed: 0.1164s/iter; left time: 3020.8059s
	iters: 500, epoch: 1 | loss: 0.1904860
	speed: 0.1226s/iter; left time: 3169.5197s
Epoch: 1 cost time: 64.53065133094788
Epoch: 1, Steps: 527 | Train Loss: 0.2864455 Vali Loss: 0.6131365 Test Loss: 0.4599683
Validation loss decreased (inf --> 0.613137).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1464546
	speed: 0.9424s/iter; left time: 24242.4157s
	iters: 200, epoch: 2 | loss: 0.1452207
	speed: 0.1474s/iter; left time: 3776.8437s
	iters: 300, epoch: 2 | loss: 0.1170436
	speed: 0.1469s/iter; left time: 3749.9060s
	iters: 400, epoch: 2 | loss: 0.1072126
	speed: 0.0988s/iter; left time: 2511.2766s
	iters: 500, epoch: 2 | loss: 0.1015525
	speed: 0.0999s/iter; left time: 2529.1908s
Epoch: 2 cost time: 68.20624494552612
Epoch: 2, Steps: 527 | Train Loss: 0.1280980 Vali Loss: 0.5469832 Test Loss: 0.4238039
Validation loss decreased (0.613137 --> 0.546983).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.0912191
	speed: 0.6399s/iter; left time: 16123.7262s
	iters: 200, epoch: 3 | loss: 0.0903472
	speed: 0.0963s/iter; left time: 2415.6664s
	iters: 300, epoch: 3 | loss: 0.0800675
	speed: 0.1033s/iter; left time: 2581.4648s
	iters: 400, epoch: 3 | loss: 0.0705541
	speed: 0.0942s/iter; left time: 2344.7405s
	iters: 500, epoch: 3 | loss: 0.0710873
	speed: 0.0998s/iter; left time: 2474.1723s
Epoch: 3 cost time: 51.93683409690857
Epoch: 3, Steps: 527 | Train Loss: 0.0827142 Vali Loss: 0.4956113 Test Loss: 0.3917360
Validation loss decreased (0.546983 --> 0.495611).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.0646416
	speed: 0.8666s/iter; left time: 21378.6960s
	iters: 200, epoch: 4 | loss: 0.0692020
	speed: 0.1104s/iter; left time: 2712.3361s
	iters: 300, epoch: 4 | loss: 0.0608734
	speed: 0.0980s/iter; left time: 2398.7481s
	iters: 400, epoch: 4 | loss: 0.0555730
	speed: 0.0981s/iter; left time: 2389.7191s
	iters: 500, epoch: 4 | loss: 0.0574258
	speed: 0.1055s/iter; left time: 2560.3572s
Epoch: 4 cost time: 58.224857807159424
Epoch: 4, Steps: 527 | Train Loss: 0.0632811 Vali Loss: 0.4659303 Test Loss: 0.3704564
Validation loss decreased (0.495611 --> 0.465930).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.0544308
	speed: 0.7401s/iter; left time: 17868.7254s
	iters: 200, epoch: 5 | loss: 0.0580509
	speed: 0.1171s/iter; left time: 2815.0803s
	iters: 300, epoch: 5 | loss: 0.0518083
	speed: 0.1112s/iter; left time: 2662.0618s
	iters: 400, epoch: 5 | loss: 0.0557657
	speed: 0.1122s/iter; left time: 2676.2774s
	iters: 500, epoch: 5 | loss: 0.0551916
	speed: 0.1167s/iter; left time: 2770.5187s
Epoch: 5 cost time: 61.41646409034729
Epoch: 5, Steps: 527 | Train Loss: 0.0545978 Vali Loss: 0.4508702 Test Loss: 0.3551930
Validation loss decreased (0.465930 --> 0.450870).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.0492800
	speed: 0.9284s/iter; left time: 21924.6565s
	iters: 200, epoch: 6 | loss: 0.0532345
	speed: 0.1033s/iter; left time: 2429.2405s
	iters: 300, epoch: 6 | loss: 0.0471135
	speed: 0.1087s/iter; left time: 2545.7051s
	iters: 400, epoch: 6 | loss: 0.0487321
	speed: 0.1177s/iter; left time: 2745.2598s
	iters: 500, epoch: 6 | loss: 0.0528640
	speed: 0.1185s/iter; left time: 2750.0807s
Epoch: 6 cost time: 60.054445028305054
Epoch: 6, Steps: 527 | Train Loss: 0.0506142 Vali Loss: 0.4407942 Test Loss: 0.3446686
Validation loss decreased (0.450870 --> 0.440794).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0524276
	speed: 0.7295s/iter; left time: 16842.9126s
	iters: 200, epoch: 7 | loss: 0.0460437
	speed: 0.0991s/iter; left time: 2279.2054s
	iters: 300, epoch: 7 | loss: 0.0546341
	speed: 0.1012s/iter; left time: 2316.7486s
	iters: 400, epoch: 7 | loss: 0.0438731
	speed: 0.1030s/iter; left time: 2346.1544s
	iters: 500, epoch: 7 | loss: 0.0453551
	speed: 0.1042s/iter; left time: 2364.1641s
Epoch: 7 cost time: 55.72766327857971
Epoch: 7, Steps: 527 | Train Loss: 0.0487313 Vali Loss: 0.4299961 Test Loss: 0.3375638
Validation loss decreased (0.440794 --> 0.429996).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0482861
	speed: 0.8005s/iter; left time: 18060.6806s
	iters: 200, epoch: 8 | loss: 0.0494691
	speed: 0.0959s/iter; left time: 2154.5890s
	iters: 300, epoch: 8 | loss: 0.0537438
	speed: 0.0965s/iter; left time: 2157.2410s
	iters: 400, epoch: 8 | loss: 0.0450627
	speed: 0.1017s/iter; left time: 2263.2421s
	iters: 500, epoch: 8 | loss: 0.0480188
	speed: 0.1029s/iter; left time: 2280.1231s
Epoch: 8 cost time: 53.453566789627075
Epoch: 8, Steps: 527 | Train Loss: 0.0478233 Vali Loss: 0.4263646 Test Loss: 0.3335553
Validation loss decreased (0.429996 --> 0.426365).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0485902
	speed: 0.7115s/iter; left time: 15678.5096s
	iters: 200, epoch: 9 | loss: 0.0432762
	speed: 0.0988s/iter; left time: 2167.7091s
	iters: 300, epoch: 9 | loss: 0.0465306
	speed: 0.1008s/iter; left time: 2201.2310s
	iters: 400, epoch: 9 | loss: 0.0439186
	speed: 0.1074s/iter; left time: 2334.9601s
	iters: 500, epoch: 9 | loss: 0.0476534
	speed: 0.1108s/iter; left time: 2396.3683s
Epoch: 9 cost time: 55.44807410240173
Epoch: 9, Steps: 527 | Train Loss: 0.0473795 Vali Loss: 0.4265235 Test Loss: 0.3285606
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0429778
	speed: 0.7170s/iter; left time: 15420.1916s
	iters: 200, epoch: 10 | loss: 0.0406731
	speed: 0.0934s/iter; left time: 1999.1207s
	iters: 300, epoch: 10 | loss: 0.0481338
	speed: 0.0900s/iter; left time: 1917.0865s
	iters: 400, epoch: 10 | loss: 0.0478382
	speed: 0.1115s/iter; left time: 2365.2577s
	iters: 500, epoch: 10 | loss: 0.0462939
	speed: 0.1137s/iter; left time: 2400.6922s
Epoch: 10 cost time: 54.525771617889404
Epoch: 10, Steps: 527 | Train Loss: 0.0471732 Vali Loss: 0.4257817 Test Loss: 0.3260122
Validation loss decreased (0.426365 --> 0.425782).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0482738
	speed: 0.7496s/iter; left time: 15726.9207s
	iters: 200, epoch: 11 | loss: 0.0441053
	speed: 0.1207s/iter; left time: 2521.2742s
	iters: 300, epoch: 11 | loss: 0.0491453
	speed: 0.1303s/iter; left time: 2707.1731s
	iters: 400, epoch: 11 | loss: 0.0506149
	speed: 0.1277s/iter; left time: 2641.8507s
	iters: 500, epoch: 11 | loss: 0.0451994
	speed: 0.1254s/iter; left time: 2581.5753s
Epoch: 11 cost time: 65.3851227760315
Epoch: 11, Steps: 527 | Train Loss: 0.0470805 Vali Loss: 0.4216645 Test Loss: 0.3260704
Validation loss decreased (0.425782 --> 0.421664).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0469638
	speed: 0.6881s/iter; left time: 14075.3779s
	iters: 200, epoch: 12 | loss: 0.0474534
	speed: 0.0852s/iter; left time: 1733.7781s
	iters: 300, epoch: 12 | loss: 0.0428409
	speed: 0.0731s/iter; left time: 1479.8636s
	iters: 400, epoch: 12 | loss: 0.0482857
	speed: 0.0928s/iter; left time: 1869.8445s
	iters: 500, epoch: 12 | loss: 0.0445962
	speed: 0.0501s/iter; left time: 1005.1570s
Epoch: 12 cost time: 41.02791929244995
Epoch: 12, Steps: 527 | Train Loss: 0.0470535 Vali Loss: 0.4214841 Test Loss: 0.3240634
Validation loss decreased (0.421664 --> 0.421484).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0382584
	speed: 0.6233s/iter; left time: 12420.7509s
	iters: 200, epoch: 13 | loss: 0.0448548
	speed: 0.1106s/iter; left time: 2193.7116s
	iters: 300, epoch: 13 | loss: 0.0452807
	speed: 0.1225s/iter; left time: 2417.1676s
	iters: 400, epoch: 13 | loss: 0.0543005
	speed: 0.1154s/iter; left time: 2265.6952s
	iters: 500, epoch: 13 | loss: 0.0460264
	speed: 0.1179s/iter; left time: 2301.5374s
Epoch: 13 cost time: 60.43459630012512
Epoch: 13, Steps: 527 | Train Loss: 0.0470379 Vali Loss: 0.4262418 Test Loss: 0.3223310
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0462285
	speed: 0.6904s/iter; left time: 13393.7751s
	iters: 200, epoch: 14 | loss: 0.0467508
	speed: 0.0814s/iter; left time: 1571.0343s
	iters: 300, epoch: 14 | loss: 0.0479757
	speed: 0.0883s/iter; left time: 1695.9543s
	iters: 400, epoch: 14 | loss: 0.0458266
	speed: 0.0924s/iter; left time: 1764.5025s
	iters: 500, epoch: 14 | loss: 0.0483725
	speed: 0.0850s/iter; left time: 1614.7132s
Epoch: 14 cost time: 45.80543255805969
Epoch: 14, Steps: 527 | Train Loss: 0.0470278 Vali Loss: 0.4222894 Test Loss: 0.3239077
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0436710
	speed: 0.6343s/iter; left time: 11971.4375s
	iters: 200, epoch: 15 | loss: 0.0462331
	speed: 0.0945s/iter; left time: 1773.1181s
	iters: 300, epoch: 15 | loss: 0.0427735
	speed: 0.0931s/iter; left time: 1738.0114s
	iters: 400, epoch: 15 | loss: 0.0424453
	speed: 0.0898s/iter; left time: 1667.8540s
	iters: 500, epoch: 15 | loss: 0.0468825
	speed: 0.0932s/iter; left time: 1722.1608s
Epoch: 15 cost time: 50.26203966140747
Epoch: 15, Steps: 527 | Train Loss: 0.0470255 Vali Loss: 0.4209380 Test Loss: 0.3235875
Validation loss decreased (0.421484 --> 0.420938).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0424982
	speed: 0.7059s/iter; left time: 12950.8391s
	iters: 200, epoch: 16 | loss: 0.0473637
	speed: 0.0827s/iter; left time: 1508.0559s
	iters: 300, epoch: 16 | loss: 0.0426857
	speed: 0.0803s/iter; left time: 1457.8596s
	iters: 400, epoch: 16 | loss: 0.0494924
	speed: 0.0829s/iter; left time: 1495.9492s
	iters: 500, epoch: 16 | loss: 0.0451892
	speed: 0.0939s/iter; left time: 1684.4660s
Epoch: 16 cost time: 45.757019996643066
Epoch: 16, Steps: 527 | Train Loss: 0.0470218 Vali Loss: 0.4193442 Test Loss: 0.3242079
Validation loss decreased (0.420938 --> 0.419344).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0437148
	speed: 0.6277s/iter; left time: 11184.6046s
	iters: 200, epoch: 17 | loss: 0.0445248
	speed: 0.1221s/iter; left time: 2163.7024s
	iters: 300, epoch: 17 | loss: 0.0517753
	speed: 0.1261s/iter; left time: 2221.1201s
	iters: 400, epoch: 17 | loss: 0.0485786
	speed: 0.1134s/iter; left time: 1986.4695s
	iters: 500, epoch: 17 | loss: 0.0476047
	speed: 0.0971s/iter; left time: 1692.1645s
Epoch: 17 cost time: 59.87015175819397
Epoch: 17, Steps: 527 | Train Loss: 0.0470210 Vali Loss: 0.4232569 Test Loss: 0.3238514
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0452817
	speed: 0.6240s/iter; left time: 10789.6787s
	iters: 200, epoch: 18 | loss: 0.0448018
	speed: 0.0924s/iter; left time: 1587.8246s
	iters: 300, epoch: 18 | loss: 0.0482327
	speed: 0.0866s/iter; left time: 1479.8574s
	iters: 400, epoch: 18 | loss: 0.0520102
	speed: 0.0859s/iter; left time: 1459.1666s
	iters: 500, epoch: 18 | loss: 0.0480896
	speed: 0.1072s/iter; left time: 1811.3440s
Epoch: 18 cost time: 51.04680585861206
Epoch: 18, Steps: 527 | Train Loss: 0.0470100 Vali Loss: 0.4225421 Test Loss: 0.3231547
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0423471
	speed: 0.6990s/iter; left time: 11718.6038s
	iters: 200, epoch: 19 | loss: 0.0477441
	speed: 0.1094s/iter; left time: 1823.5558s
	iters: 300, epoch: 19 | loss: 0.0474028
	speed: 0.0876s/iter; left time: 1451.4701s
	iters: 400, epoch: 19 | loss: 0.0413449
	speed: 0.0961s/iter; left time: 1581.4744s
	iters: 500, epoch: 19 | loss: 0.0507675
	speed: 0.0929s/iter; left time: 1520.5673s
Epoch: 19 cost time: 53.08091640472412
Epoch: 19, Steps: 527 | Train Loss: 0.0470175 Vali Loss: 0.4217285 Test Loss: 0.3233275
EarlyStopping counter: 3 out of 3
Early stopping
train 33745
val 11425
test 11425
Model(
  (freq_upsampler): Linear(in_features=106, out_features=120, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  5698560.0
params:  12840.0
Trainable parameters:  12840
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2636558
	speed: 0.1072s/iter; left time: 2813.7421s
	iters: 200, epoch: 1 | loss: 0.2269966
	speed: 0.1050s/iter; left time: 2744.6926s
	iters: 300, epoch: 1 | loss: 0.2451737
	speed: 0.1005s/iter; left time: 2618.1490s
	iters: 400, epoch: 1 | loss: 0.2360812
	speed: 0.1043s/iter; left time: 2707.3281s
	iters: 500, epoch: 1 | loss: 0.3142311
	speed: 0.1046s/iter; left time: 2703.6643s
Epoch: 1 cost time: 54.84975266456604
Epoch: 1, Steps: 527 | Train Loss: 0.2671011 Vali Loss: 0.3945763 Test Loss: 0.3118450
Validation loss decreased (inf --> 0.394576).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2483373
	speed: 0.6844s/iter; left time: 17605.6861s
	iters: 200, epoch: 2 | loss: 0.2749605
	speed: 0.1007s/iter; left time: 2581.5708s
	iters: 300, epoch: 2 | loss: 0.2199577
	speed: 0.0774s/iter; left time: 1975.3660s
	iters: 400, epoch: 2 | loss: 0.2454349
	speed: 0.0608s/iter; left time: 1546.6125s
	iters: 500, epoch: 2 | loss: 0.2673919
	speed: 0.0992s/iter; left time: 2512.1956s
Epoch: 2 cost time: 46.40642833709717
Epoch: 2, Steps: 527 | Train Loss: 0.2643843 Vali Loss: 0.3994620 Test Loss: 0.3119979
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2637743
	speed: 0.4910s/iter; left time: 12371.9426s
	iters: 200, epoch: 3 | loss: 0.2745394
	speed: 0.0658s/iter; left time: 1652.3219s
	iters: 300, epoch: 3 | loss: 0.2757967
	speed: 0.0718s/iter; left time: 1795.0474s
	iters: 400, epoch: 3 | loss: 0.2694791
	speed: 0.0747s/iter; left time: 1858.8902s
	iters: 500, epoch: 3 | loss: 0.2357709
	speed: 0.0623s/iter; left time: 1545.3433s
Epoch: 3 cost time: 36.78208661079407
Epoch: 3, Steps: 527 | Train Loss: 0.2636631 Vali Loss: 0.3990189 Test Loss: 0.3108616
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2563443
	speed: 0.4492s/iter; left time: 11082.7624s
	iters: 200, epoch: 4 | loss: 0.2666345
	speed: 0.0774s/iter; left time: 1900.8696s
	iters: 300, epoch: 4 | loss: 0.2608011
	speed: 0.0598s/iter; left time: 1463.2875s
	iters: 400, epoch: 4 | loss: 0.3571233
	speed: 0.0967s/iter; left time: 2356.3791s
	iters: 500, epoch: 4 | loss: 0.2532350
	speed: 0.1230s/iter; left time: 2984.9891s
Epoch: 4 cost time: 46.89017868041992
Epoch: 4, Steps: 527 | Train Loss: 0.2632050 Vali Loss: 0.3967153 Test Loss: 0.3096292
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTm1_720_96_FITS_ETTm1_ftM_sl720_ll48_pl96_H12_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 11425
mse:0.3123722970485687, mae:0.3551064133644104, rse:0.5318242907524109, corr:[0.5492316  0.56109315 0.56744134 0.5685084  0.56771225 0.56774044
 0.5691735  0.57111263 0.5722651  0.57207364 0.57106566 0.57003725
 0.56953907 0.56952477 0.56948644 0.5689738  0.5679559  0.5666986
 0.5654147  0.5642172  0.5630543  0.56170106 0.5600699  0.55839425
 0.55680245 0.55558705 0.554864   0.5545293  0.55457085 0.5548809
 0.5553531  0.5558828  0.55620515 0.5562155  0.5558222  0.55544764
 0.55529964 0.5555271  0.55595136 0.55617565 0.5560714  0.555583
 0.5549094  0.55441797 0.55419147 0.55417097 0.55427366 0.5543218
 0.5541736  0.55387115 0.553676   0.55368257 0.5538876  0.5541103
 0.55428773 0.55433464 0.55412793 0.5535667  0.5527945  0.55188507
 0.5510654  0.55051696 0.55028623 0.55016    0.55009705 0.5500344
 0.54992276 0.5498297  0.54988384 0.5500843  0.55039865 0.55068153
 0.5508352  0.5508602  0.5508776  0.55082947 0.5506278  0.550242
 0.54971254 0.5491509  0.5486683  0.5481969  0.5475907  0.5464916
 0.54485345 0.5429211  0.5413073  0.5404892  0.5406027  0.54124904
 0.5415048  0.54090947 0.5401954  0.54087025 0.54372543 0.5467877 ]
