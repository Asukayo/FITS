Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=196, d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTh1_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_720_96_FITS_ETTh1_ftM_sl720_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=196, out_features=222, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  38986752.0
params:  43734.0
Trainable parameters:  43734
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 0.9105730056762695
Epoch: 1, Steps: 61 | Train Loss: 0.5685008 Vali Loss: 0.9363230 Test Loss: 0.4918450
Validation loss decreased (inf --> 0.936323).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 0.8805649280548096
Epoch: 2, Steps: 61 | Train Loss: 0.3965313 Vali Loss: 0.7974574 Test Loss: 0.4066410
Validation loss decreased (0.936323 --> 0.797457).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 0.8339593410491943
Epoch: 3, Steps: 61 | Train Loss: 0.3606924 Vali Loss: 0.7550759 Test Loss: 0.3862153
Validation loss decreased (0.797457 --> 0.755076).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 0.8921322822570801
Epoch: 4, Steps: 61 | Train Loss: 0.3491721 Vali Loss: 0.7385203 Test Loss: 0.3818085
Validation loss decreased (0.755076 --> 0.738520).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 1.009387493133545
Epoch: 5, Steps: 61 | Train Loss: 0.3445301 Vali Loss: 0.7324327 Test Loss: 0.3803210
Validation loss decreased (0.738520 --> 0.732433).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 0.9925694465637207
Epoch: 6, Steps: 61 | Train Loss: 0.3418995 Vali Loss: 0.7245774 Test Loss: 0.3797082
Validation loss decreased (0.732433 --> 0.724577).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 0.8605990409851074
Epoch: 7, Steps: 61 | Train Loss: 0.3398468 Vali Loss: 0.7220967 Test Loss: 0.3798560
Validation loss decreased (0.724577 --> 0.722097).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 0.9120211601257324
Epoch: 8, Steps: 61 | Train Loss: 0.3385066 Vali Loss: 0.7157629 Test Loss: 0.3795915
Validation loss decreased (0.722097 --> 0.715763).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 0.883286714553833
Epoch: 9, Steps: 61 | Train Loss: 0.3374576 Vali Loss: 0.7157894 Test Loss: 0.3795984
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 0.9483973979949951
Epoch: 10, Steps: 61 | Train Loss: 0.3366096 Vali Loss: 0.7134547 Test Loss: 0.3791715
Validation loss decreased (0.715763 --> 0.713455).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 0.9996778964996338
Epoch: 11, Steps: 61 | Train Loss: 0.3357724 Vali Loss: 0.7105839 Test Loss: 0.3794585
Validation loss decreased (0.713455 --> 0.710584).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 0.9057369232177734
Epoch: 12, Steps: 61 | Train Loss: 0.3352885 Vali Loss: 0.7120267 Test Loss: 0.3791972
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 0.8908853530883789
Epoch: 13, Steps: 61 | Train Loss: 0.3346446 Vali Loss: 0.7065989 Test Loss: 0.3796445
Validation loss decreased (0.710584 --> 0.706599).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 0.8821377754211426
Epoch: 14, Steps: 61 | Train Loss: 0.3339804 Vali Loss: 0.7063606 Test Loss: 0.3795700
Validation loss decreased (0.706599 --> 0.706361).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 1.020456314086914
Epoch: 15, Steps: 61 | Train Loss: 0.3335793 Vali Loss: 0.7087850 Test Loss: 0.3791859
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 0.9622828960418701
Epoch: 16, Steps: 61 | Train Loss: 0.3336740 Vali Loss: 0.7070720 Test Loss: 0.3792327
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 0.9007885456085205
Epoch: 17, Steps: 61 | Train Loss: 0.3330534 Vali Loss: 0.7004861 Test Loss: 0.3790785
Validation loss decreased (0.706361 --> 0.700486).  Saving model ...
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 0.9036562442779541
Epoch: 18, Steps: 61 | Train Loss: 0.3329386 Vali Loss: 0.7044963 Test Loss: 0.3792832
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 0.9011542797088623
Epoch: 19, Steps: 61 | Train Loss: 0.3329013 Vali Loss: 0.7073022 Test Loss: 0.3791137
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 0.9539215564727783
Epoch: 20, Steps: 61 | Train Loss: 0.3326267 Vali Loss: 0.7036482 Test Loss: 0.3793676
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 0.9803802967071533
Epoch: 21, Steps: 61 | Train Loss: 0.3324406 Vali Loss: 0.7072371 Test Loss: 0.3793353
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 0.9820141792297363
Epoch: 22, Steps: 61 | Train Loss: 0.3320414 Vali Loss: 0.7025012 Test Loss: 0.3794313
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 0.9004580974578857
Epoch: 23, Steps: 61 | Train Loss: 0.3319952 Vali Loss: 0.7016888 Test Loss: 0.3790300
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 0.8613286018371582
Epoch: 24, Steps: 61 | Train Loss: 0.3321535 Vali Loss: 0.6977922 Test Loss: 0.3792276
Validation loss decreased (0.700486 --> 0.697792).  Saving model ...
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 1.153639554977417
Epoch: 25, Steps: 61 | Train Loss: 0.3316755 Vali Loss: 0.6966750 Test Loss: 0.3794068
Validation loss decreased (0.697792 --> 0.696675).  Saving model ...
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 0.905327320098877
Epoch: 26, Steps: 61 | Train Loss: 0.3318050 Vali Loss: 0.6964806 Test Loss: 0.3792727
Validation loss decreased (0.696675 --> 0.696481).  Saving model ...
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 0.8656692504882812
Epoch: 27, Steps: 61 | Train Loss: 0.3317001 Vali Loss: 0.7005029 Test Loss: 0.3793233
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 0.8880167007446289
Epoch: 28, Steps: 61 | Train Loss: 0.3315419 Vali Loss: 0.7004332 Test Loss: 0.3794326
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 0.9169449806213379
Epoch: 29, Steps: 61 | Train Loss: 0.3311618 Vali Loss: 0.7032651 Test Loss: 0.3794063
EarlyStopping counter: 3 out of 20
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 0.9751510620117188
Epoch: 30, Steps: 61 | Train Loss: 0.3311012 Vali Loss: 0.6997708 Test Loss: 0.3795455
EarlyStopping counter: 4 out of 20
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 0.846337080001831
Epoch: 31, Steps: 61 | Train Loss: 0.3311361 Vali Loss: 0.7038617 Test Loss: 0.3795400
EarlyStopping counter: 5 out of 20
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 0.9158456325531006
Epoch: 32, Steps: 61 | Train Loss: 0.3312446 Vali Loss: 0.7027542 Test Loss: 0.3793995
EarlyStopping counter: 6 out of 20
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 0.8348286151885986
Epoch: 33, Steps: 61 | Train Loss: 0.3309741 Vali Loss: 0.7013763 Test Loss: 0.3793899
EarlyStopping counter: 7 out of 20
Updating learning rate to 9.685574222925044e-05
