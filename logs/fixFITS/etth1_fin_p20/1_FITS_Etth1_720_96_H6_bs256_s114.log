Args in experiment:
Namespace(H_order=6, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=512, c_out=7, checkpoints='./checkpoints/', cut_freq=196, d_ff=2048, d_layers=1, d_model=512, data='ETTh1', data_path='ETTh1.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=0, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTh1_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=20, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=100, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : ETTh1_720_96_FITS_ETTh1_ftM_sl720_ll48_pl96_H6_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=196, out_features=222, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  155947008.0
params:  43734.0
Trainable parameters:  43734
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 0.7210123538970947
Epoch: 1, Steps: 15 | Train Loss: 0.7321932 Vali Loss: 1.3401892 Test Loss: 0.7536857
Validation loss decreased (inf --> 1.340189).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 0.717252254486084
Epoch: 2, Steps: 15 | Train Loss: 0.5700388 Vali Loss: 1.1097687 Test Loss: 0.6202812
Validation loss decreased (1.340189 --> 1.109769).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 0.7961862087249756
Epoch: 3, Steps: 15 | Train Loss: 0.4908208 Vali Loss: 1.0027223 Test Loss: 0.5525378
Validation loss decreased (1.109769 --> 1.002722).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 0.7649116516113281
Epoch: 4, Steps: 15 | Train Loss: 0.4483756 Vali Loss: 0.9393948 Test Loss: 0.5101526
Validation loss decreased (1.002722 --> 0.939395).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 0.7397251129150391
Epoch: 5, Steps: 15 | Train Loss: 0.4227103 Vali Loss: 0.8912722 Test Loss: 0.4797577
Validation loss decreased (0.939395 --> 0.891272).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 0.6799933910369873
Epoch: 6, Steps: 15 | Train Loss: 0.4041391 Vali Loss: 0.8574384 Test Loss: 0.4576085
Validation loss decreased (0.891272 --> 0.857438).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 0.7182083129882812
Epoch: 7, Steps: 15 | Train Loss: 0.3907359 Vali Loss: 0.8317461 Test Loss: 0.4408863
Validation loss decreased (0.857438 --> 0.831746).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 0.7843122482299805
Epoch: 8, Steps: 15 | Train Loss: 0.3809568 Vali Loss: 0.8079782 Test Loss: 0.4286357
Validation loss decreased (0.831746 --> 0.807978).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 0.7419192790985107
Epoch: 9, Steps: 15 | Train Loss: 0.3723524 Vali Loss: 0.7913548 Test Loss: 0.4191202
Validation loss decreased (0.807978 --> 0.791355).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 0.7320506572723389
Epoch: 10, Steps: 15 | Train Loss: 0.3662760 Vali Loss: 0.7836758 Test Loss: 0.4122219
Validation loss decreased (0.791355 --> 0.783676).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 0.7171719074249268
Epoch: 11, Steps: 15 | Train Loss: 0.3610780 Vali Loss: 0.7831609 Test Loss: 0.4068880
Validation loss decreased (0.783676 --> 0.783161).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 0.7164096832275391
Epoch: 12, Steps: 15 | Train Loss: 0.3572603 Vali Loss: 0.7657551 Test Loss: 0.4027987
Validation loss decreased (0.783161 --> 0.765755).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 0.7001268863677979
Epoch: 13, Steps: 15 | Train Loss: 0.3555737 Vali Loss: 0.7589252 Test Loss: 0.3995332
Validation loss decreased (0.765755 --> 0.758925).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 0.7144010066986084
Epoch: 14, Steps: 15 | Train Loss: 0.3525145 Vali Loss: 0.7562186 Test Loss: 0.3971716
Validation loss decreased (0.758925 --> 0.756219).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 0.6858818531036377
Epoch: 15, Steps: 15 | Train Loss: 0.3511629 Vali Loss: 0.7547259 Test Loss: 0.3952559
Validation loss decreased (0.756219 --> 0.754726).  Saving model ...
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 0.7151544094085693
Epoch: 16, Steps: 15 | Train Loss: 0.3492024 Vali Loss: 0.7477762 Test Loss: 0.3937248
Validation loss decreased (0.754726 --> 0.747776).  Saving model ...
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 0.7155976295471191
Epoch: 17, Steps: 15 | Train Loss: 0.3482968 Vali Loss: 0.7440231 Test Loss: 0.3925941
Validation loss decreased (0.747776 --> 0.744023).  Saving model ...
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 0.7520678043365479
Epoch: 18, Steps: 15 | Train Loss: 0.3470475 Vali Loss: 0.7411829 Test Loss: 0.3916323
Validation loss decreased (0.744023 --> 0.741183).  Saving model ...
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 0.7895252704620361
Epoch: 19, Steps: 15 | Train Loss: 0.3468619 Vali Loss: 0.7412980 Test Loss: 0.3909051
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 0.7542374134063721
Epoch: 20, Steps: 15 | Train Loss: 0.3448316 Vali Loss: 0.7415212 Test Loss: 0.3902438
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 0.7341058254241943
Epoch: 21, Steps: 15 | Train Loss: 0.3445639 Vali Loss: 0.7375939 Test Loss: 0.3897338
Validation loss decreased (0.741183 --> 0.737594).  Saving model ...
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 0.7175793647766113
Epoch: 22, Steps: 15 | Train Loss: 0.3442422 Vali Loss: 0.7383703 Test Loss: 0.3893411
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 0.7064170837402344
Epoch: 23, Steps: 15 | Train Loss: 0.3436211 Vali Loss: 0.7349202 Test Loss: 0.3889331
Validation loss decreased (0.737594 --> 0.734920).  Saving model ...
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 0.8266284465789795
Epoch: 24, Steps: 15 | Train Loss: 0.3429810 Vali Loss: 0.7365605 Test Loss: 0.3887967
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 0.7206602096557617
Epoch: 25, Steps: 15 | Train Loss: 0.3427172 Vali Loss: 0.7369202 Test Loss: 0.3885311
EarlyStopping counter: 2 out of 20
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 0.7618331909179688
Epoch: 26, Steps: 15 | Train Loss: 0.3419587 Vali Loss: 0.7313157 Test Loss: 0.3882737
Validation loss decreased (0.734920 --> 0.731316).  Saving model ...
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 0.7743816375732422
Epoch: 27, Steps: 15 | Train Loss: 0.3418523 Vali Loss: 0.7320720 Test Loss: 0.3880368
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 0.6800057888031006
Epoch: 28, Steps: 15 | Train Loss: 0.3408394 Vali Loss: 0.7257351 Test Loss: 0.3879034
Validation loss decreased (0.731316 --> 0.725735).  Saving model ...
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 0.770188570022583
Epoch: 29, Steps: 15 | Train Loss: 0.3415121 Vali Loss: 0.7326461 Test Loss: 0.3877712
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 0.7069525718688965
Epoch: 30, Steps: 15 | Train Loss: 0.3410699 Vali Loss: 0.7251196 Test Loss: 0.3876059
Validation loss decreased (0.725735 --> 0.725120).  Saving model ...
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 0.7294082641601562
Epoch: 31, Steps: 15 | Train Loss: 0.3407236 Vali Loss: 0.7281739 Test Loss: 0.3874986
EarlyStopping counter: 1 out of 20
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 0.786414623260498
Epoch: 32, Steps: 15 | Train Loss: 0.3405521 Vali Loss: 0.7231929 Test Loss: 0.3873808
Validation loss decreased (0.725120 --> 0.723193).  Saving model ...
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 0.7849791049957275
Epoch: 33, Steps: 15 | Train Loss: 0.3402579 Vali Loss: 0.7253643 Test Loss: 0.3873294
EarlyStopping counter: 1 out of 20
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 0.6830151081085205
Epoch: 34, Steps: 15 | Train Loss: 0.3402488 Vali Loss: 0.7207170 Test Loss: 0.3872697
Validation loss decreased (0.723193 --> 0.720717).  Saving model ...
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 0.735492467880249
Epoch: 35, Steps: 15 | Train Loss: 0.3400508 Vali Loss: 0.7260479 Test Loss: 0.3871559
EarlyStopping counter: 1 out of 20
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 0.6797022819519043
Epoch: 36, Steps: 15 | Train Loss: 0.3397341 Vali Loss: 0.7223434 Test Loss: 0.3871366
EarlyStopping counter: 2 out of 20
Updating learning rate to 8.304169199380359e-05
Epoch: 37 cost time: 0.7795758247375488
Epoch: 37, Steps: 15 | Train Loss: 0.3394522 Vali Loss: 0.7253160 Test Loss: 0.3870817
EarlyStopping counter: 3 out of 20
Updating learning rate to 7.88896073941134e-05
Epoch: 38 cost time: 0.7119390964508057
Epoch: 38, Steps: 15 | Train Loss: 0.3389968 Vali Loss: 0.7258161 Test Loss: 0.3870525
EarlyStopping counter: 4 out of 20
Updating learning rate to 7.494512702440772e-05
Epoch: 39 cost time: 0.809657096862793
Epoch: 39, Steps: 15 | Train Loss: 0.3386279 Vali Loss: 0.7239873 Test Loss: 0.3869438
EarlyStopping counter: 5 out of 20
Updating learning rate to 7.119787067318733e-05
Epoch: 40 cost time: 0.8337500095367432
Epoch: 40, Steps: 15 | Train Loss: 0.3391640 Vali Loss: 0.7260748 Test Loss: 0.3869245
EarlyStopping counter: 6 out of 20
Updating learning rate to 6.763797713952796e-05
Epoch: 41 cost time: 0.6870729923248291
Epoch: 41, Steps: 15 | Train Loss: 0.3393239 Vali Loss: 0.7316598 Test Loss: 0.3868603
EarlyStopping counter: 7 out of 20
Updating learning rate to 6.425607828255156e-05
Epoch: 42 cost time: 0.6744823455810547
Epoch: 42, Steps: 15 | Train Loss: 0.3386596 Vali Loss: 0.7221054 Test Loss: 0.3868103
EarlyStopping counter: 8 out of 20
Updating learning rate to 6.104327436842398e-05
Epoch: 43 cost time: 0.7395076751708984
Epoch: 43, Steps: 15 | Train Loss: 0.3384057 Vali Loss: 0.7252116 Test Loss: 0.3867724
EarlyStopping counter: 9 out of 20
Updating learning rate to 5.799111065000278e-05
Epoch: 44 cost time: 0.7545111179351807
Epoch: 44, Steps: 15 | Train Loss: 0.3387711 Vali Loss: 0.7224370 Test Loss: 0.3867605
EarlyStopping counter: 10 out of 20
Updating learning rate to 5.509155511750264e-05
Epoch: 45 cost time: 0.7070004940032959
Epoch: 45, Steps: 15 | Train Loss: 0.3394152 Vali Loss: 0.7244660 Test Loss: 0.3867415
EarlyStopping counter: 11 out of 20
Updating learning rate to 5.2336977361627504e-05
Epoch: 46 cost time: 0.7532281875610352
Epoch: 46, Steps: 15 | Train Loss: 0.3384374 Vali Loss: 0.7202822 Test Loss: 0.3866991
Validation loss decreased (0.720717 --> 0.720282).  Saving model ...
Updating learning rate to 4.9720128493546124e-05
Epoch: 47 cost time: 0.8191373348236084
Epoch: 47, Steps: 15 | Train Loss: 0.3387698 Vali Loss: 0.7221571 Test Loss: 0.3866715
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.7234122068868816e-05
Epoch: 48 cost time: 0.7766778469085693
Epoch: 48, Steps: 15 | Train Loss: 0.3382958 Vali Loss: 0.7179714 Test Loss: 0.3866704
Validation loss decreased (0.720282 --> 0.717971).  Saving model ...
Updating learning rate to 4.487241596542538e-05
Epoch: 49 cost time: 0.7210628986358643
Epoch: 49, Steps: 15 | Train Loss: 0.3382210 Vali Loss: 0.7222974 Test Loss: 0.3866176
EarlyStopping counter: 1 out of 20
Updating learning rate to 4.26287951671541e-05
Epoch: 50 cost time: 0.7940332889556885
Epoch: 50, Steps: 15 | Train Loss: 0.3379133 Vali Loss: 0.7225318 Test Loss: 0.3865882
EarlyStopping counter: 2 out of 20
Updating learning rate to 4.0497355408796396e-05
Epoch: 51 cost time: 0.7859866619110107
Epoch: 51, Steps: 15 | Train Loss: 0.3382354 Vali Loss: 0.7258068 Test Loss: 0.3865875
EarlyStopping counter: 3 out of 20
Updating learning rate to 3.8472487638356575e-05
Epoch: 52 cost time: 0.712820291519165
Epoch: 52, Steps: 15 | Train Loss: 0.3382855 Vali Loss: 0.7244688 Test Loss: 0.3865583
EarlyStopping counter: 4 out of 20
Updating learning rate to 3.654886325643875e-05
Epoch: 53 cost time: 0.7909185886383057
Epoch: 53, Steps: 15 | Train Loss: 0.3378534 Vali Loss: 0.7258162 Test Loss: 0.3865608
EarlyStopping counter: 5 out of 20
Updating learning rate to 3.47214200936168e-05
Epoch: 54 cost time: 0.7706501483917236
Epoch: 54, Steps: 15 | Train Loss: 0.3381957 Vali Loss: 0.7195226 Test Loss: 0.3865374
EarlyStopping counter: 6 out of 20
Updating learning rate to 3.298534908893597e-05
