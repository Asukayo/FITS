Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=134, d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=6, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTh2_720_336', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=336, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:6
>>>>>>>start training : ETTh2_720_336_FITS_ETTh2_ftM_sl720_ll48_pl336_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7585
val 2545
test 2545
Model(
  (freq_upsampler): Linear(in_features=134, out_features=196, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  23532544.0
params:  26460.0
Trainable parameters:  26460
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 7.950775623321533
Epoch: 1, Steps: 59 | Train Loss: 0.8363830 Vali Loss: 0.5104019 Test Loss: 0.3918421
Validation loss decreased (inf --> 0.510402).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 9.247562170028687
Epoch: 2, Steps: 59 | Train Loss: 0.7029930 Vali Loss: 0.4557406 Test Loss: 0.3709455
Validation loss decreased (0.510402 --> 0.455741).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 8.879439115524292
Epoch: 3, Steps: 59 | Train Loss: 0.6689901 Vali Loss: 0.4312020 Test Loss: 0.3654664
Validation loss decreased (0.455741 --> 0.431202).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 10.519210577011108
Epoch: 4, Steps: 59 | Train Loss: 0.6547708 Vali Loss: 0.4197089 Test Loss: 0.3629361
Validation loss decreased (0.431202 --> 0.419709).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 8.85060453414917
Epoch: 5, Steps: 59 | Train Loss: 0.6457542 Vali Loss: 0.4131670 Test Loss: 0.3615666
Validation loss decreased (0.419709 --> 0.413167).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 11.149340152740479
Epoch: 6, Steps: 59 | Train Loss: 0.6393170 Vali Loss: 0.4065233 Test Loss: 0.3609001
Validation loss decreased (0.413167 --> 0.406523).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 11.418184280395508
Epoch: 7, Steps: 59 | Train Loss: 0.6367584 Vali Loss: 0.4032224 Test Loss: 0.3603677
Validation loss decreased (0.406523 --> 0.403222).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 11.490314960479736
Epoch: 8, Steps: 59 | Train Loss: 0.6335933 Vali Loss: 0.4001245 Test Loss: 0.3600498
Validation loss decreased (0.403222 --> 0.400124).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 12.811954975128174
Epoch: 9, Steps: 59 | Train Loss: 0.6320876 Vali Loss: 0.3990048 Test Loss: 0.3597580
Validation loss decreased (0.400124 --> 0.399005).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 12.906315565109253
Epoch: 10, Steps: 59 | Train Loss: 0.6284726 Vali Loss: 0.3963576 Test Loss: 0.3595134
Validation loss decreased (0.399005 --> 0.396358).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 12.640594005584717
Epoch: 11, Steps: 59 | Train Loss: 0.6264711 Vali Loss: 0.3945263 Test Loss: 0.3595027
Validation loss decreased (0.396358 --> 0.394526).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 12.212037086486816
Epoch: 12, Steps: 59 | Train Loss: 0.6259463 Vali Loss: 0.3906314 Test Loss: 0.3595001
Validation loss decreased (0.394526 --> 0.390631).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 12.961438417434692
Epoch: 13, Steps: 59 | Train Loss: 0.6259678 Vali Loss: 0.3910799 Test Loss: 0.3593825
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 10.337489604949951
Epoch: 14, Steps: 59 | Train Loss: 0.6245454 Vali Loss: 0.3910786 Test Loss: 0.3593249
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002566710416397524
