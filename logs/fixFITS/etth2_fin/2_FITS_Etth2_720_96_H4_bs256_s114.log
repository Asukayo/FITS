Args in experiment:
Namespace(H_order=4, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=512, c_out=7, checkpoints='./checkpoints/', cut_freq=134, d_ff=2048, d_layers=1, d_model=512, data='ETTh2', data_path='ETTh2.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=7, factor=1, features='M', freq='h', gpu=6, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='ETTh2_720_96', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:6
>>>>>>>start training : ETTh2_720_96_FITS_ETTh2_ftM_sl720_ll48_pl96_H4_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 7825
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=134, out_features=151, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  72518656.0
params:  20385.0
Trainable parameters:  20385
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 2.049705982208252
Epoch: 1, Steps: 15 | Train Loss: 0.6245674 Vali Loss: 0.4705980 Test Loss: 0.4963484
Validation loss decreased (inf --> 0.470598).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 1.969449520111084
Epoch: 2, Steps: 15 | Train Loss: 0.5701908 Vali Loss: 0.4337291 Test Loss: 0.4680487
Validation loss decreased (0.470598 --> 0.433729).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 2.7873315811157227
Epoch: 3, Steps: 15 | Train Loss: 0.5265172 Vali Loss: 0.4087125 Test Loss: 0.4459525
Validation loss decreased (0.433729 --> 0.408713).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 2.647170305252075
Epoch: 4, Steps: 15 | Train Loss: 0.4934862 Vali Loss: 0.3896324 Test Loss: 0.4288917
Validation loss decreased (0.408713 --> 0.389632).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 2.979395866394043
Epoch: 5, Steps: 15 | Train Loss: 0.4671267 Vali Loss: 0.3730991 Test Loss: 0.4157516
Validation loss decreased (0.389632 --> 0.373099).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 2.669032573699951
Epoch: 6, Steps: 15 | Train Loss: 0.4466385 Vali Loss: 0.3621030 Test Loss: 0.4056942
Validation loss decreased (0.373099 --> 0.362103).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 2.681852340698242
Epoch: 7, Steps: 15 | Train Loss: 0.4278127 Vali Loss: 0.3555229 Test Loss: 0.3977454
Validation loss decreased (0.362103 --> 0.355523).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 2.8298685550689697
Epoch: 8, Steps: 15 | Train Loss: 0.4120918 Vali Loss: 0.3472331 Test Loss: 0.3914034
Validation loss decreased (0.355523 --> 0.347233).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 2.605015754699707
Epoch: 9, Steps: 15 | Train Loss: 0.3993800 Vali Loss: 0.3430943 Test Loss: 0.3864753
Validation loss decreased (0.347233 --> 0.343094).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 2.515767812728882
Epoch: 10, Steps: 15 | Train Loss: 0.3868460 Vali Loss: 0.3376854 Test Loss: 0.3823062
Validation loss decreased (0.343094 --> 0.337685).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 2.718616008758545
Epoch: 11, Steps: 15 | Train Loss: 0.3774616 Vali Loss: 0.3349469 Test Loss: 0.3790842
Validation loss decreased (0.337685 --> 0.334947).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 2.783111333847046
Epoch: 12, Steps: 15 | Train Loss: 0.3696867 Vali Loss: 0.3327201 Test Loss: 0.3764624
Validation loss decreased (0.334947 --> 0.332720).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 2.6104397773742676
Epoch: 13, Steps: 15 | Train Loss: 0.3615588 Vali Loss: 0.3318364 Test Loss: 0.3741769
Validation loss decreased (0.332720 --> 0.331836).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 2.653439521789551
Epoch: 14, Steps: 15 | Train Loss: 0.3547211 Vali Loss: 0.3292933 Test Loss: 0.3723526
Validation loss decreased (0.331836 --> 0.329293).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 2.871872901916504
Epoch: 15, Steps: 15 | Train Loss: 0.3497557 Vali Loss: 0.3262163 Test Loss: 0.3706979
Validation loss decreased (0.329293 --> 0.326216).  Saving model ...
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 2.5345706939697266
Epoch: 16, Steps: 15 | Train Loss: 0.3434177 Vali Loss: 0.3261342 Test Loss: 0.3695088
Validation loss decreased (0.326216 --> 0.326134).  Saving model ...
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 2.503412961959839
Epoch: 17, Steps: 15 | Train Loss: 0.3397235 Vali Loss: 0.3247041 Test Loss: 0.3684325
Validation loss decreased (0.326134 --> 0.324704).  Saving model ...
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 2.8000385761260986
Epoch: 18, Steps: 15 | Train Loss: 0.3341853 Vali Loss: 0.3218378 Test Loss: 0.3674770
Validation loss decreased (0.324704 --> 0.321838).  Saving model ...
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 2.575519561767578
Epoch: 19, Steps: 15 | Train Loss: 0.3305787 Vali Loss: 0.3222265 Test Loss: 0.3665937
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 2.43723464012146
Epoch: 20, Steps: 15 | Train Loss: 0.3264601 Vali Loss: 0.3220725 Test Loss: 0.3657770
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 2.610381841659546
Epoch: 21, Steps: 15 | Train Loss: 0.3235168 Vali Loss: 0.3224404 Test Loss: 0.3652052
EarlyStopping counter: 3 out of 3
Early stopping
train 7825
val 2785
test 2785
Model(
  (freq_upsampler): Linear(in_features=134, out_features=151, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  72518656.0
params:  20385.0
Trainable parameters:  20385
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 2.8525803089141846
Epoch: 1, Steps: 15 | Train Loss: 0.5161763 Vali Loss: 0.2922295 Test Loss: 0.3389274
Validation loss decreased (inf --> 0.292229).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 2.7948687076568604
Epoch: 2, Steps: 15 | Train Loss: 0.4883744 Vali Loss: 0.2750325 Test Loss: 0.3231360
Validation loss decreased (0.292229 --> 0.275033).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 2.854130268096924
Epoch: 3, Steps: 15 | Train Loss: 0.4651372 Vali Loss: 0.2633626 Test Loss: 0.3137353
Validation loss decreased (0.275033 --> 0.263363).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 2.6515846252441406
Epoch: 4, Steps: 15 | Train Loss: 0.4531528 Vali Loss: 0.2559010 Test Loss: 0.3075960
Validation loss decreased (0.263363 --> 0.255901).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 2.5930166244506836
Epoch: 5, Steps: 15 | Train Loss: 0.4445927 Vali Loss: 0.2492518 Test Loss: 0.3034649
Validation loss decreased (0.255901 --> 0.249252).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 2.4998679161071777
Epoch: 6, Steps: 15 | Train Loss: 0.4377277 Vali Loss: 0.2456359 Test Loss: 0.3003999
Validation loss decreased (0.249252 --> 0.245636).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 1.8986625671386719
Epoch: 7, Steps: 15 | Train Loss: 0.4365145 Vali Loss: 0.2435960 Test Loss: 0.2984446
Validation loss decreased (0.245636 --> 0.243596).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 2.4754385948181152
Epoch: 8, Steps: 15 | Train Loss: 0.4305480 Vali Loss: 0.2392706 Test Loss: 0.2968937
Validation loss decreased (0.243596 --> 0.239271).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 2.3899102210998535
Epoch: 9, Steps: 15 | Train Loss: 0.4284047 Vali Loss: 0.2368544 Test Loss: 0.2959332
Validation loss decreased (0.239271 --> 0.236854).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 2.5853235721588135
Epoch: 10, Steps: 15 | Train Loss: 0.4266775 Vali Loss: 0.2351577 Test Loss: 0.2949751
Validation loss decreased (0.236854 --> 0.235158).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 3.0652666091918945
Epoch: 11, Steps: 15 | Train Loss: 0.4230965 Vali Loss: 0.2333662 Test Loss: 0.2943145
Validation loss decreased (0.235158 --> 0.233366).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 3.060177803039551
Epoch: 12, Steps: 15 | Train Loss: 0.4222924 Vali Loss: 0.2319970 Test Loss: 0.2939184
Validation loss decreased (0.233366 --> 0.231997).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 2.669071912765503
Epoch: 13, Steps: 15 | Train Loss: 0.4209263 Vali Loss: 0.2309225 Test Loss: 0.2934391
Validation loss decreased (0.231997 --> 0.230923).  Saving model ...
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 2.6105072498321533
Epoch: 14, Steps: 15 | Train Loss: 0.4150276 Vali Loss: 0.2285815 Test Loss: 0.2931394
Validation loss decreased (0.230923 --> 0.228581).  Saving model ...
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 2.5494544506073
Epoch: 15, Steps: 15 | Train Loss: 0.4179995 Vali Loss: 0.2288074 Test Loss: 0.2928466
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 2.5394065380096436
Epoch: 16, Steps: 15 | Train Loss: 0.4173949 Vali Loss: 0.2279166 Test Loss: 0.2925631
Validation loss decreased (0.228581 --> 0.227917).  Saving model ...
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 2.618222713470459
Epoch: 17, Steps: 15 | Train Loss: 0.4180729 Vali Loss: 0.2281443 Test Loss: 0.2922704
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 2.9642655849456787
Epoch: 18, Steps: 15 | Train Loss: 0.4152027 Vali Loss: 0.2282242 Test Loss: 0.2922834
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 2.9595210552215576
Epoch: 19, Steps: 15 | Train Loss: 0.4131095 Vali Loss: 0.2273913 Test Loss: 0.2922084
Validation loss decreased (0.227917 --> 0.227391).  Saving model ...
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 2.7389109134674072
Epoch: 20, Steps: 15 | Train Loss: 0.4135581 Vali Loss: 0.2265536 Test Loss: 0.2919990
Validation loss decreased (0.227391 --> 0.226554).  Saving model ...
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 2.895343780517578
Epoch: 21, Steps: 15 | Train Loss: 0.4152986 Vali Loss: 0.2269073 Test Loss: 0.2918270
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 2.8052186965942383
Epoch: 22, Steps: 15 | Train Loss: 0.4153193 Vali Loss: 0.2252305 Test Loss: 0.2917315
Validation loss decreased (0.226554 --> 0.225230).  Saving model ...
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 2.664438486099243
Epoch: 23, Steps: 15 | Train Loss: 0.4129970 Vali Loss: 0.2244443 Test Loss: 0.2916077
Validation loss decreased (0.225230 --> 0.224444).  Saving model ...
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 2.8314080238342285
Epoch: 24, Steps: 15 | Train Loss: 0.4129231 Vali Loss: 0.2247370 Test Loss: 0.2915896
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 2.7337684631347656
Epoch: 25, Steps: 15 | Train Loss: 0.4124069 Vali Loss: 0.2243507 Test Loss: 0.2915317
Validation loss decreased (0.224444 --> 0.224351).  Saving model ...
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 2.8640120029449463
Epoch: 26, Steps: 15 | Train Loss: 0.4116551 Vali Loss: 0.2239707 Test Loss: 0.2913898
Validation loss decreased (0.224351 --> 0.223971).  Saving model ...
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 2.8883917331695557
Epoch: 27, Steps: 15 | Train Loss: 0.4102922 Vali Loss: 0.2231086 Test Loss: 0.2913289
Validation loss decreased (0.223971 --> 0.223109).  Saving model ...
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 2.779015064239502
Epoch: 28, Steps: 15 | Train Loss: 0.4116289 Vali Loss: 0.2241664 Test Loss: 0.2913265
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 2.792433023452759
Epoch: 29, Steps: 15 | Train Loss: 0.4135718 Vali Loss: 0.2229291 Test Loss: 0.2912610
Validation loss decreased (0.223109 --> 0.222929).  Saving model ...
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 2.767817497253418
Epoch: 30, Steps: 15 | Train Loss: 0.4071006 Vali Loss: 0.2234900 Test Loss: 0.2912200
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 2.772106885910034
Epoch: 31, Steps: 15 | Train Loss: 0.4100206 Vali Loss: 0.2219457 Test Loss: 0.2911179
Validation loss decreased (0.222929 --> 0.221946).  Saving model ...
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 2.7869272232055664
Epoch: 32, Steps: 15 | Train Loss: 0.4132463 Vali Loss: 0.2231991 Test Loss: 0.2911323
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00010195341287289519
Epoch: 33 cost time: 2.8227288722991943
Epoch: 33, Steps: 15 | Train Loss: 0.4117581 Vali Loss: 0.2197842 Test Loss: 0.2910900
Validation loss decreased (0.221946 --> 0.219784).  Saving model ...
Updating learning rate to 9.685574222925044e-05
Epoch: 34 cost time: 2.7589588165283203
Epoch: 34, Steps: 15 | Train Loss: 0.4087425 Vali Loss: 0.2215254 Test Loss: 0.2910855
EarlyStopping counter: 1 out of 3
Updating learning rate to 9.201295511778792e-05
Epoch: 35 cost time: 2.8122949600219727
Epoch: 35, Steps: 15 | Train Loss: 0.4104182 Vali Loss: 0.2239940 Test Loss: 0.2910373
EarlyStopping counter: 2 out of 3
Updating learning rate to 8.74123073618985e-05
Epoch: 36 cost time: 2.8326351642608643
Epoch: 36, Steps: 15 | Train Loss: 0.4097070 Vali Loss: 0.2212446 Test Loss: 0.2910104
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : ETTh2_720_96_FITS_ETTh2_ftM_sl720_ll48_pl96_H4_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 2785
mse:0.2716861069202423, mae:0.338801771402359, rse:0.4200635552406311, corr:[0.27266544 0.27682266 0.27649266 0.2748736  0.27444637 0.27440956
 0.2740158  0.27298415 0.2718768  0.27073675 0.26935214 0.26782227
 0.2665545  0.26568237 0.26489425 0.26413506 0.2635014  0.26293528
 0.26212397 0.26106426 0.25983608 0.25861275 0.2573165  0.25563416
 0.25373763 0.25191462 0.25046462 0.24934055 0.24826154 0.24697353
 0.24538314 0.24374425 0.24241252 0.24147762 0.2406216  0.23941739
 0.23789468 0.23659314 0.23594168 0.23551147 0.23499247 0.23420352
 0.23320964 0.2322025  0.23147447 0.23075609 0.22972558 0.22804616
 0.22594911 0.22401544 0.2227215  0.22156054 0.22057924 0.21943028
 0.21754654 0.2154213  0.21339127 0.2116278  0.21041884 0.20969075
 0.20913166 0.20836711 0.20788155 0.20809121 0.20807214 0.20783064
 0.20711957 0.20634572 0.20600809 0.2059514  0.205327   0.20411007
 0.20270258 0.20166467 0.20115575 0.2000028  0.19860439 0.19733255
 0.19691549 0.19664536 0.19677581 0.19651262 0.19540209 0.19449359
 0.1945373  0.19536631 0.19535708 0.19439676 0.19271497 0.19224562
 0.192231   0.19070435 0.18874666 0.18789059 0.18854366 0.18521462]
