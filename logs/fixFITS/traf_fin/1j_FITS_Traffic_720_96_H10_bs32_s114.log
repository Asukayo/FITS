Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=320, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=6, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Traffic_720_j96_H10', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:6
>>>>>>>start training : Traffic_720_j96_H10_FITS_custom_ftM_sl720_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1661
test 3413
Model(
  (freq_upsampler): Linear(in_features=320, out_features=362, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  6390661120.0
params:  116202.0
Trainable parameters:  116202
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2931870
	speed: 0.4018s/iter; left time: 3556.1115s
Epoch: 1 cost time: 75.35498452186584
Epoch: 1, Steps: 179 | Train Loss: 0.4254985 Vali Loss: 0.3363933 Test Loss: 0.3989628
Validation loss decreased (inf --> 0.336393).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2275030
	speed: 1.2787s/iter; left time: 11089.2990s
Epoch: 2 cost time: 79.93745470046997
Epoch: 2, Steps: 179 | Train Loss: 0.2342816 Vali Loss: 0.3268482 Test Loss: 0.3906328
Validation loss decreased (0.336393 --> 0.326848).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2237993
	speed: 1.2054s/iter; left time: 10237.0403s
Epoch: 3 cost time: 73.12993097305298
Epoch: 3, Steps: 179 | Train Loss: 0.2324458 Vali Loss: 0.3272007 Test Loss: 0.3893857
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2352695
	speed: 1.2643s/iter; left time: 10511.3099s
Epoch: 4 cost time: 83.38794493675232
Epoch: 4, Steps: 179 | Train Loss: 0.2320100 Vali Loss: 0.3253441 Test Loss: 0.3893099
Validation loss decreased (0.326848 --> 0.325344).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2247572
	speed: 1.3455s/iter; left time: 10945.4428s
Epoch: 5 cost time: 83.68101119995117
Epoch: 5, Steps: 179 | Train Loss: 0.2319019 Vali Loss: 0.3251599 Test Loss: 0.3879921
Validation loss decreased (0.325344 --> 0.325160).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2208857
	speed: 1.2766s/iter; left time: 10156.7424s
Epoch: 6 cost time: 81.12778496742249
Epoch: 6, Steps: 179 | Train Loss: 0.2316851 Vali Loss: 0.3255998 Test Loss: 0.3876623
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2184572
	speed: 1.2633s/iter; left time: 9825.0725s
Epoch: 7 cost time: 79.19426369667053
Epoch: 7, Steps: 179 | Train Loss: 0.2315598 Vali Loss: 0.3248995 Test Loss: 0.3883736
Validation loss decreased (0.325160 --> 0.324900).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2354086
	speed: 1.2875s/iter; left time: 9782.6944s
Epoch: 8 cost time: 79.97373390197754
Epoch: 8, Steps: 179 | Train Loss: 0.2314889 Vali Loss: 0.3256920 Test Loss: 0.3873896
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2213162
	speed: 1.1210s/iter; left time: 8316.4289s
Epoch: 9 cost time: 67.21366691589355
Epoch: 9, Steps: 179 | Train Loss: 0.2313780 Vali Loss: 0.3255047 Test Loss: 0.3877345
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2327897
	speed: 1.3660s/iter; left time: 9889.9512s
Epoch: 10 cost time: 87.37507653236389
Epoch: 10, Steps: 179 | Train Loss: 0.2313180 Vali Loss: 0.3248022 Test Loss: 0.3878346
Validation loss decreased (0.324900 --> 0.324802).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2346268
	speed: 1.2058s/iter; left time: 8514.2620s
Epoch: 11 cost time: 74.06499457359314
Epoch: 11, Steps: 179 | Train Loss: 0.2311766 Vali Loss: 0.3254341 Test Loss: 0.3874766
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.2255491
	speed: 1.2182s/iter; left time: 8383.6228s
Epoch: 12 cost time: 75.70239901542664
Epoch: 12, Steps: 179 | Train Loss: 0.2311996 Vali Loss: 0.3251015 Test Loss: 0.3875387
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.2378952
	speed: 1.2157s/iter; left time: 8148.6773s
Epoch: 13 cost time: 77.08160996437073
Epoch: 13, Steps: 179 | Train Loss: 0.2311090 Vali Loss: 0.3236021 Test Loss: 0.3876744
Validation loss decreased (0.324802 --> 0.323602).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.2456151
	speed: 1.1050s/iter; left time: 7209.1859s
Epoch: 14 cost time: 65.77977252006531
Epoch: 14, Steps: 179 | Train Loss: 0.2310441 Vali Loss: 0.3253226 Test Loss: 0.3871789
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.2275964
	speed: 1.1159s/iter; left time: 7080.6838s
Epoch: 15 cost time: 77.72502636909485
Epoch: 15, Steps: 179 | Train Loss: 0.2310259 Vali Loss: 0.3249615 Test Loss: 0.3868431
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.2315311
	speed: 1.3121s/iter; left time: 8090.5297s
Epoch: 16 cost time: 85.1342704296112
Epoch: 16, Steps: 179 | Train Loss: 0.2309643 Vali Loss: 0.3248404 Test Loss: 0.3869533
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Traffic_720_j96_H10_FITS_custom_ftM_sl720_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.3873262405395508, mae:0.27043217420578003, rse:0.5153377652168274, corr:[0.27650073 0.29181254 0.29033226 0.29075533 0.2907019  0.29248515
 0.29372516 0.29348126 0.29273656 0.29160795 0.29185924 0.2915868
 0.29190922 0.29161444 0.2910721  0.29105845 0.29020572 0.29021794
 0.29083046 0.29166377 0.29212543 0.291963   0.29180548 0.2914416
 0.2930141  0.29281056 0.29190272 0.29226273 0.29254422 0.29324764
 0.29362497 0.29329702 0.29298687 0.29159445 0.29090092 0.2913515
 0.29165763 0.29154718 0.29162678 0.29225817 0.2923148  0.29228458
 0.29248324 0.29279366 0.29261982 0.29235655 0.29294127 0.29240495
 0.2919344  0.2923881  0.29251623 0.2924479  0.29231176 0.2922688
 0.292893   0.29307523 0.2924745  0.29156426 0.29090822 0.29119503
 0.2917589  0.29165238 0.2916557  0.29215866 0.29239622 0.29275244
 0.29288065 0.29247153 0.29218656 0.29178542 0.2918174  0.2922319
 0.292064   0.29157403 0.2909623  0.2910009  0.29125145 0.29156566
 0.29169947 0.29136926 0.29190323 0.29064524 0.28969073 0.2913329
 0.29216003 0.29208094 0.2919132  0.29183358 0.29050234 0.29044867
 0.2904748  0.28976357 0.29021502 0.28958032 0.29138753 0.291937  ]
