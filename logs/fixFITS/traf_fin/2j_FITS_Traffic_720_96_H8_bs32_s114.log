Args in experiment:
Namespace(H_order=8, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=258, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=6, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Traffic_720_j96_H8', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:6
>>>>>>>start training : Traffic_720_j96_H8_FITS_custom_ftM_sl720_ll48_pl96_H8_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1661
test 3413
Model(
  (freq_upsampler): Linear(in_features=258, out_features=292, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4156136448.0
params:  75628.0
Trainable parameters:  75628
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.8346808
	speed: 0.4116s/iter; left time: 3643.1727s
Epoch: 1 cost time: 71.14263081550598
Epoch: 1, Steps: 179 | Train Loss: 0.9065839 Vali Loss: 1.0072697 Test Loss: 1.1538582
Validation loss decreased (inf --> 1.007270).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.6380849
	speed: 1.0602s/iter; left time: 9193.6700s
Epoch: 2 cost time: 61.1722514629364
Epoch: 2, Steps: 179 | Train Loss: 0.6451826 Vali Loss: 0.8822341 Test Loss: 1.0141003
Validation loss decreased (1.007270 --> 0.882234).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.5111823
	speed: 1.0619s/iter; left time: 9018.8651s
Epoch: 3 cost time: 68.10925507545471
Epoch: 3, Steps: 179 | Train Loss: 0.5144692 Vali Loss: 0.7825709 Test Loss: 0.8992376
Validation loss decreased (0.882234 --> 0.782571).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.4160932
	speed: 1.0158s/iter; left time: 8444.9924s
Epoch: 4 cost time: 58.55080437660217
Epoch: 4, Steps: 179 | Train Loss: 0.4175071 Vali Loss: 0.7040590 Test Loss: 0.8087284
Validation loss decreased (0.782571 --> 0.704059).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3393344
	speed: 0.9086s/iter; left time: 7391.5712s
Epoch: 5 cost time: 56.62518358230591
Epoch: 5, Steps: 179 | Train Loss: 0.3426449 Vali Loss: 0.6382858 Test Loss: 0.7340901
Validation loss decreased (0.704059 --> 0.638286).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2767971
	speed: 1.2308s/iter; left time: 9792.0636s
Epoch: 6 cost time: 84.14757466316223
Epoch: 6, Steps: 179 | Train Loss: 0.2838594 Vali Loss: 0.5816170 Test Loss: 0.6690010
Validation loss decreased (0.638286 --> 0.581617).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2347104
	speed: 1.2508s/iter; left time: 9727.4061s
Epoch: 7 cost time: 98.9422402381897
Epoch: 7, Steps: 179 | Train Loss: 0.2371327 Vali Loss: 0.5369365 Test Loss: 0.6184797
Validation loss decreased (0.581617 --> 0.536937).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1979167
	speed: 2.0148s/iter; left time: 15308.6056s
Epoch: 8 cost time: 98.89410138130188
Epoch: 8, Steps: 179 | Train Loss: 0.1997458 Vali Loss: 0.4968615 Test Loss: 0.5727170
Validation loss decreased (0.536937 --> 0.496861).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1667129
	speed: 1.4583s/iter; left time: 10819.0346s
Epoch: 9 cost time: 93.1570303440094
Epoch: 9, Steps: 179 | Train Loss: 0.1696202 Vali Loss: 0.4664760 Test Loss: 0.5385244
Validation loss decreased (0.496861 --> 0.466476).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1439017
	speed: 1.4964s/iter; left time: 10833.6319s
Epoch: 10 cost time: 99.05263161659241
Epoch: 10, Steps: 179 | Train Loss: 0.1452566 Vali Loss: 0.4429670 Test Loss: 0.5111890
Validation loss decreased (0.466476 --> 0.442967).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1225608
	speed: 1.4274s/iter; left time: 10078.8047s
Epoch: 11 cost time: 86.07017683982849
Epoch: 11, Steps: 179 | Train Loss: 0.1254886 Vali Loss: 0.4223472 Test Loss: 0.4888667
Validation loss decreased (0.442967 --> 0.422347).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1100752
	speed: 1.4192s/iter; left time: 9766.8053s
Epoch: 12 cost time: 92.25123906135559
Epoch: 12, Steps: 179 | Train Loss: 0.1094536 Vali Loss: 0.4047708 Test Loss: 0.4683851
Validation loss decreased (0.422347 --> 0.404771).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0959823
	speed: 1.4625s/iter; left time: 9803.0518s
Epoch: 13 cost time: 88.72672486305237
Epoch: 13, Steps: 179 | Train Loss: 0.0964005 Vali Loss: 0.3901207 Test Loss: 0.4528382
Validation loss decreased (0.404771 --> 0.390121).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0825974
	speed: 1.2491s/iter; left time: 8149.1208s
Epoch: 14 cost time: 76.94598865509033
Epoch: 14, Steps: 179 | Train Loss: 0.0857919 Vali Loss: 0.3791874 Test Loss: 0.4401222
Validation loss decreased (0.390121 --> 0.379187).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0742103
	speed: 1.2975s/iter; left time: 8232.3846s
Epoch: 15 cost time: 86.57852244377136
Epoch: 15, Steps: 179 | Train Loss: 0.0771579 Vali Loss: 0.3703521 Test Loss: 0.4306664
Validation loss decreased (0.379187 --> 0.370352).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0684397
	speed: 1.3087s/iter; left time: 8069.4404s
Epoch: 16 cost time: 84.35212731361389
Epoch: 16, Steps: 179 | Train Loss: 0.0701375 Vali Loss: 0.3625450 Test Loss: 0.4221607
Validation loss decreased (0.370352 --> 0.362545).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0642989
	speed: 1.4181s/iter; left time: 8489.9714s
Epoch: 17 cost time: 93.60433387756348
Epoch: 17, Steps: 179 | Train Loss: 0.0644399 Vali Loss: 0.3569305 Test Loss: 0.4156555
Validation loss decreased (0.362545 --> 0.356930).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0621943
	speed: 1.3949s/iter; left time: 8101.6370s
Epoch: 18 cost time: 84.4678111076355
Epoch: 18, Steps: 179 | Train Loss: 0.0598376 Vali Loss: 0.3514218 Test Loss: 0.4104811
Validation loss decreased (0.356930 --> 0.351422).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0543112
	speed: 1.3688s/iter; left time: 7705.2046s
Epoch: 19 cost time: 83.38224291801453
Epoch: 19, Steps: 179 | Train Loss: 0.0561183 Vali Loss: 0.3479249 Test Loss: 0.4060673
Validation loss decreased (0.351422 --> 0.347925).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0534814
	speed: 1.2617s/iter; left time: 6876.3976s
Epoch: 20 cost time: 78.42282676696777
Epoch: 20, Steps: 179 | Train Loss: 0.0531216 Vali Loss: 0.3451802 Test Loss: 0.4030783
Validation loss decreased (0.347925 --> 0.345180).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0498594
	speed: 1.2755s/iter; left time: 6723.3983s
Epoch: 21 cost time: 92.06218647956848
Epoch: 21, Steps: 179 | Train Loss: 0.0507232 Vali Loss: 0.3412701 Test Loss: 0.4000538
Validation loss decreased (0.345180 --> 0.341270).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0471479
	speed: 1.6055s/iter; left time: 8175.1137s
Epoch: 22 cost time: 104.32150673866272
Epoch: 22, Steps: 179 | Train Loss: 0.0488052 Vali Loss: 0.3399761 Test Loss: 0.3986007
Validation loss decreased (0.341270 --> 0.339976).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0478641
	speed: 1.5432s/iter; left time: 7581.5109s
Epoch: 23 cost time: 89.48823571205139
Epoch: 23, Steps: 179 | Train Loss: 0.0472754 Vali Loss: 0.3371879 Test Loss: 0.3968162
Validation loss decreased (0.339976 --> 0.337188).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0480542
	speed: 1.4838s/iter; left time: 7024.5217s
Epoch: 24 cost time: 95.36147356033325
Epoch: 24, Steps: 179 | Train Loss: 0.0460776 Vali Loss: 0.3368275 Test Loss: 0.3959714
Validation loss decreased (0.337188 --> 0.336828).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0452388
	speed: 1.4349s/iter; left time: 6536.1576s
Epoch: 25 cost time: 90.57851696014404
Epoch: 25, Steps: 179 | Train Loss: 0.0451202 Vali Loss: 0.3362881 Test Loss: 0.3945478
Validation loss decreased (0.336828 --> 0.336288).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0458323
	speed: 1.4755s/iter; left time: 6456.7167s
Epoch: 26 cost time: 97.9233717918396
Epoch: 26, Steps: 179 | Train Loss: 0.0443840 Vali Loss: 0.3355025 Test Loss: 0.3943022
Validation loss decreased (0.336288 --> 0.335502).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0432432
	speed: 1.5503s/iter; left time: 6506.7986s
Epoch: 27 cost time: 87.93280339241028
Epoch: 27, Steps: 179 | Train Loss: 0.0438124 Vali Loss: 0.3348776 Test Loss: 0.3938126
Validation loss decreased (0.335502 --> 0.334878).  Saving model ...
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0418816
	speed: 1.3123s/iter; left time: 5272.8904s
Epoch: 28 cost time: 88.0061104297638
Epoch: 28, Steps: 179 | Train Loss: 0.0433624 Vali Loss: 0.3335027 Test Loss: 0.3935053
Validation loss decreased (0.334878 --> 0.333503).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0426261
	speed: 1.3610s/iter; left time: 5224.9566s
Epoch: 29 cost time: 89.90304589271545
Epoch: 29, Steps: 179 | Train Loss: 0.0430161 Vali Loss: 0.3337521 Test Loss: 0.3930857
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.0446378
	speed: 1.4313s/iter; left time: 5238.4400s
Epoch: 30 cost time: 93.17710709571838
Epoch: 30, Steps: 179 | Train Loss: 0.0427565 Vali Loss: 0.3333273 Test Loss: 0.3928454
Validation loss decreased (0.333503 --> 0.333327).  Saving model ...
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0435105
	speed: 1.5211s/iter; left time: 5294.8407s
Epoch: 31 cost time: 93.38835382461548
Epoch: 31, Steps: 179 | Train Loss: 0.0425629 Vali Loss: 0.3329555 Test Loss: 0.3930738
Validation loss decreased (0.333327 --> 0.332956).  Saving model ...
Updating learning rate to 0.00010731938197146864
	iters: 100, epoch: 32 | loss: 0.0408069
	speed: 1.4065s/iter; left time: 4644.3360s
Epoch: 32 cost time: 86.40776896476746
Epoch: 32, Steps: 179 | Train Loss: 0.0424133 Vali Loss: 0.3325371 Test Loss: 0.3926107
Validation loss decreased (0.332956 --> 0.332537).  Saving model ...
Updating learning rate to 0.00010195341287289519
	iters: 100, epoch: 33 | loss: 0.0413346
	speed: 1.4801s/iter; left time: 4622.3383s
Epoch: 33 cost time: 89.62174963951111
Epoch: 33, Steps: 179 | Train Loss: 0.0423026 Vali Loss: 0.3324194 Test Loss: 0.3927895
Validation loss decreased (0.332537 --> 0.332419).  Saving model ...
Updating learning rate to 9.685574222925044e-05
	iters: 100, epoch: 34 | loss: 0.0419745
	speed: 1.3743s/iter; left time: 4045.9240s
Epoch: 34 cost time: 84.87496733665466
Epoch: 34, Steps: 179 | Train Loss: 0.0422221 Vali Loss: 0.3322911 Test Loss: 0.3927987
Validation loss decreased (0.332419 --> 0.332291).  Saving model ...
Updating learning rate to 9.201295511778792e-05
	iters: 100, epoch: 35 | loss: 0.0441809
	speed: 1.4129s/iter; left time: 3906.7643s
Epoch: 35 cost time: 95.34151983261108
Epoch: 35, Steps: 179 | Train Loss: 0.0421535 Vali Loss: 0.3325010 Test Loss: 0.3928621
EarlyStopping counter: 1 out of 3
Updating learning rate to 8.74123073618985e-05
	iters: 100, epoch: 36 | loss: 0.0413168
	speed: 1.4685s/iter; left time: 3797.6448s
Epoch: 36 cost time: 91.79095578193665
Epoch: 36, Steps: 179 | Train Loss: 0.0421173 Vali Loss: 0.3320242 Test Loss: 0.3927356
Validation loss decreased (0.332291 --> 0.332024).  Saving model ...
Updating learning rate to 8.304169199380359e-05
	iters: 100, epoch: 37 | loss: 0.0423578
	speed: 1.3798s/iter; left time: 3321.2295s
Epoch: 37 cost time: 84.24025845527649
Epoch: 37, Steps: 179 | Train Loss: 0.0420838 Vali Loss: 0.3307922 Test Loss: 0.3929297
Validation loss decreased (0.332024 --> 0.330792).  Saving model ...
Updating learning rate to 7.88896073941134e-05
	iters: 100, epoch: 38 | loss: 0.0413215
	speed: 1.3578s/iter; left time: 3025.2401s
Epoch: 38 cost time: 79.31326603889465
Epoch: 38, Steps: 179 | Train Loss: 0.0420612 Vali Loss: 0.3320505 Test Loss: 0.3927801
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.494512702440772e-05
	iters: 100, epoch: 39 | loss: 0.0423202
	speed: 1.2121s/iter; left time: 2483.6748s
Epoch: 39 cost time: 74.59558510780334
Epoch: 39, Steps: 179 | Train Loss: 0.0420439 Vali Loss: 0.3320643 Test Loss: 0.3928074
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.119787067318733e-05
	iters: 100, epoch: 40 | loss: 0.0406579
	speed: 1.2946s/iter; left time: 2420.9304s
Epoch: 40 cost time: 82.65121269226074
Epoch: 40, Steps: 179 | Train Loss: 0.0420300 Vali Loss: 0.3308308 Test Loss: 0.3929550
EarlyStopping counter: 3 out of 3
Early stopping
train 11465
val 1661
test 3413
Model(
  (freq_upsampler): Linear(in_features=258, out_features=292, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4156136448.0
params:  75628.0
Trainable parameters:  75628
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2281464
	speed: 0.4568s/iter; left time: 4042.9643s
Epoch: 1 cost time: 81.66035628318787
Epoch: 1, Steps: 179 | Train Loss: 0.2342599 Vali Loss: 0.3270676 Test Loss: 0.3897311
Validation loss decreased (inf --> 0.327068).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2331147
	speed: 1.3574s/iter; left time: 11771.7182s
Epoch: 2 cost time: 83.45782732963562
Epoch: 2, Steps: 179 | Train Loss: 0.2332208 Vali Loss: 0.3263236 Test Loss: 0.3894715
Validation loss decreased (0.327068 --> 0.326324).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2331920
	speed: 1.2339s/iter; left time: 10479.4425s
Epoch: 3 cost time: 75.45492959022522
Epoch: 3, Steps: 179 | Train Loss: 0.2329399 Vali Loss: 0.3277782 Test Loss: 0.3900539
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2362805
	speed: 1.1630s/iter; left time: 9669.5494s
Epoch: 4 cost time: 69.71593308448792
Epoch: 4, Steps: 179 | Train Loss: 0.2327541 Vali Loss: 0.3264360 Test Loss: 0.3901623
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2448686
	speed: 1.1268s/iter; left time: 9166.5776s
Epoch: 5 cost time: 71.1479115486145
Epoch: 5, Steps: 179 | Train Loss: 0.2326895 Vali Loss: 0.3263758 Test Loss: 0.3892840
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Traffic_720_j96_H8_FITS_custom_ftM_sl720_ll48_pl96_H8_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.3891255855560303, mae:0.2743346393108368, rse:0.5165333151817322, corr:[0.2813165  0.2930954  0.2941689  0.2942542  0.29276487 0.2919761
 0.29232743 0.29254496 0.29203558 0.29156336 0.29202473 0.29293343
 0.29327488 0.29297015 0.2929751  0.29319236 0.2921555  0.29082507
 0.2912545  0.2923427  0.29243562 0.292167   0.291986   0.29200062
 0.29326397 0.29389238 0.29422066 0.2943698  0.2938944  0.2928115
 0.29217726 0.29239216 0.29226038 0.2918208  0.29228482 0.29302168
 0.29291382 0.29252452 0.29220912 0.29192433 0.2922053  0.29264906
 0.2926827  0.2926503  0.29280788 0.2930539  0.29304695 0.2931205
 0.2938474  0.2945057  0.29449895 0.29368767 0.29280144 0.29247114
 0.2925637  0.29255593 0.2922821  0.29202724 0.29237542 0.2931338
 0.29281825 0.29147556 0.2912328  0.29202577 0.29245138 0.2928984
 0.29367647 0.2938993  0.2933775  0.29258305 0.29221267 0.29279995
 0.29335806 0.293482   0.2939726  0.2943868  0.29363483 0.29204765
 0.2913299  0.29198337 0.29257214 0.29256722 0.29240736 0.29164073
 0.29069972 0.2908959  0.29156402 0.29173636 0.291658   0.29158133
 0.29184183 0.29216322 0.29240128 0.29280525 0.2917865  0.29056036]
