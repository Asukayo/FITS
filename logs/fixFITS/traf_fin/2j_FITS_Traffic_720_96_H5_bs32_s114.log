Args in experiment:
Namespace(H_order=5, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=165, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='traffic.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=862, factor=1, features='M', freq='h', gpu=6, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Traffic_720_j96_H5', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:6
>>>>>>>start training : Traffic_720_j96_H5_FITS_custom_ftM_sl720_ll48_pl96_H5_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 11465
val 1661
test 3413
Model(
  (freq_upsampler): Linear(in_features=165, out_features=187, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1702208640.0
params:  31042.0
Trainable parameters:  31042
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.8142380
	speed: 0.6067s/iter; left time: 5369.8530s
Epoch: 1 cost time: 109.613107919693
Epoch: 1, Steps: 179 | Train Loss: 0.8707296 Vali Loss: 0.9552819 Test Loss: 1.0973245
Validation loss decreased (inf --> 0.955282).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.5913470
	speed: 1.5268s/iter; left time: 13240.2652s
Epoch: 2 cost time: 81.77366995811462
Epoch: 2, Steps: 179 | Train Loss: 0.6137882 Vali Loss: 0.8298768 Test Loss: 0.9557167
Validation loss decreased (0.955282 --> 0.829877).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.4854672
	speed: 1.4237s/iter; left time: 12091.8870s
Epoch: 3 cost time: 88.94008731842041
Epoch: 3, Steps: 179 | Train Loss: 0.4898100 Vali Loss: 0.7410969 Test Loss: 0.8544259
Validation loss decreased (0.829877 --> 0.741097).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.3985367
	speed: 1.3956s/iter; left time: 11602.6623s
Epoch: 4 cost time: 88.98923802375793
Epoch: 4, Steps: 179 | Train Loss: 0.3996271 Vali Loss: 0.6650459 Test Loss: 0.7677730
Validation loss decreased (0.741097 --> 0.665046).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.3234722
	speed: 1.4478s/iter; left time: 11777.7053s
Epoch: 5 cost time: 91.07271981239319
Epoch: 5, Steps: 179 | Train Loss: 0.3307350 Vali Loss: 0.6025960 Test Loss: 0.6967291
Validation loss decreased (0.665046 --> 0.602596).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2739361
	speed: 1.4688s/iter; left time: 11686.0267s
Epoch: 6 cost time: 85.33843088150024
Epoch: 6, Steps: 179 | Train Loss: 0.2770762 Vali Loss: 0.5535062 Test Loss: 0.6383768
Validation loss decreased (0.602596 --> 0.553506).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2258403
	speed: 1.2290s/iter; left time: 9558.1058s
Epoch: 7 cost time: 79.07606720924377
Epoch: 7, Steps: 179 | Train Loss: 0.2348310 Vali Loss: 0.5113960 Test Loss: 0.5921980
Validation loss decreased (0.553506 --> 0.511396).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1965012
	speed: 1.3166s/iter; left time: 10003.1675s
Epoch: 8 cost time: 81.95140743255615
Epoch: 8, Steps: 179 | Train Loss: 0.2013006 Vali Loss: 0.4792433 Test Loss: 0.5545285
Validation loss decreased (0.511396 --> 0.479243).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1720816
	speed: 1.3653s/iter; left time: 10129.3401s
Epoch: 9 cost time: 83.91977190971375
Epoch: 9, Steps: 179 | Train Loss: 0.1745584 Vali Loss: 0.4538295 Test Loss: 0.5254473
Validation loss decreased (0.479243 --> 0.453829).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1474439
	speed: 1.4327s/iter; left time: 10372.9257s
Epoch: 10 cost time: 92.1920280456543
Epoch: 10, Steps: 179 | Train Loss: 0.1531432 Vali Loss: 0.4313423 Test Loss: 0.5006016
Validation loss decreased (0.453829 --> 0.431342).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1367759
	speed: 1.4100s/iter; left time: 9955.9225s
Epoch: 11 cost time: 85.16282320022583
Epoch: 11, Steps: 179 | Train Loss: 0.1359842 Vali Loss: 0.4135245 Test Loss: 0.4801137
Validation loss decreased (0.431342 --> 0.413525).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1198739
	speed: 1.3943s/iter; left time: 9595.2745s
Epoch: 12 cost time: 92.88454294204712
Epoch: 12, Steps: 179 | Train Loss: 0.1221781 Vali Loss: 0.3983074 Test Loss: 0.4633973
Validation loss decreased (0.413525 --> 0.398307).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1087382
	speed: 1.4164s/iter; left time: 9493.9022s
Epoch: 13 cost time: 84.22932362556458
Epoch: 13, Steps: 179 | Train Loss: 0.1110976 Vali Loss: 0.3878927 Test Loss: 0.4503888
Validation loss decreased (0.398307 --> 0.387893).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1023858
	speed: 1.3579s/iter; left time: 8859.1322s
Epoch: 14 cost time: 85.43295335769653
Epoch: 14, Steps: 179 | Train Loss: 0.1021986 Vali Loss: 0.3768926 Test Loss: 0.4390497
Validation loss decreased (0.387893 --> 0.376893).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0965609
	speed: 1.4225s/iter; left time: 9025.6809s
Epoch: 15 cost time: 87.18198275566101
Epoch: 15, Steps: 179 | Train Loss: 0.0950521 Vali Loss: 0.3695065 Test Loss: 0.4308727
Validation loss decreased (0.376893 --> 0.369506).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0874863
	speed: 1.4331s/iter; left time: 8836.4661s
Epoch: 16 cost time: 82.87850069999695
Epoch: 16, Steps: 179 | Train Loss: 0.0893282 Vali Loss: 0.3620656 Test Loss: 0.4238691
Validation loss decreased (0.369506 --> 0.362066).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0856027
	speed: 1.2989s/iter; left time: 7776.4151s
Epoch: 17 cost time: 81.3674213886261
Epoch: 17, Steps: 179 | Train Loss: 0.0847640 Vali Loss: 0.3575398 Test Loss: 0.4190559
Validation loss decreased (0.362066 --> 0.357540).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0798863
	speed: 1.2474s/iter; left time: 7244.7362s
Epoch: 18 cost time: 75.55269503593445
Epoch: 18, Steps: 179 | Train Loss: 0.0811239 Vali Loss: 0.3545828 Test Loss: 0.4149028
Validation loss decreased (0.357540 --> 0.354583).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0780356
	speed: 1.1217s/iter; left time: 6314.2496s
Epoch: 19 cost time: 73.8940007686615
Epoch: 19, Steps: 179 | Train Loss: 0.0782341 Vali Loss: 0.3514836 Test Loss: 0.4118908
Validation loss decreased (0.354583 --> 0.351484).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0742402
	speed: 1.2719s/iter; left time: 6931.9721s
Epoch: 20 cost time: 81.43405795097351
Epoch: 20, Steps: 179 | Train Loss: 0.0759590 Vali Loss: 0.3488625 Test Loss: 0.4096150
Validation loss decreased (0.351484 --> 0.348862).  Saving model ...
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0732544
	speed: 1.3463s/iter; left time: 7096.4567s
Epoch: 21 cost time: 81.26309871673584
Epoch: 21, Steps: 179 | Train Loss: 0.0741563 Vali Loss: 0.3461018 Test Loss: 0.4072978
Validation loss decreased (0.348862 --> 0.346102).  Saving model ...
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0710128
	speed: 1.2623s/iter; left time: 6427.4888s
Epoch: 22 cost time: 77.75434494018555
Epoch: 22, Steps: 179 | Train Loss: 0.0727527 Vali Loss: 0.3450105 Test Loss: 0.4059302
Validation loss decreased (0.346102 --> 0.345010).  Saving model ...
Updating learning rate to 0.0001702808131440574
	iters: 100, epoch: 23 | loss: 0.0715142
	speed: 1.1852s/iter; left time: 5822.6440s
Epoch: 23 cost time: 71.69822597503662
Epoch: 23, Steps: 179 | Train Loss: 0.0716424 Vali Loss: 0.3436411 Test Loss: 0.4050759
Validation loss decreased (0.345010 --> 0.343641).  Saving model ...
Updating learning rate to 0.0001617667724868545
	iters: 100, epoch: 24 | loss: 0.0707520
	speed: 1.1618s/iter; left time: 5500.1557s
Epoch: 24 cost time: 68.77750825881958
Epoch: 24, Steps: 179 | Train Loss: 0.0708045 Vali Loss: 0.3431500 Test Loss: 0.4043081
Validation loss decreased (0.343641 --> 0.343150).  Saving model ...
Updating learning rate to 0.00015367843386251178
	iters: 100, epoch: 25 | loss: 0.0697698
	speed: 1.1159s/iter; left time: 5082.9201s
Epoch: 25 cost time: 70.07062792778015
Epoch: 25, Steps: 179 | Train Loss: 0.0701454 Vali Loss: 0.3424382 Test Loss: 0.4034924
Validation loss decreased (0.343150 --> 0.342438).  Saving model ...
Updating learning rate to 0.0001459945121693862
	iters: 100, epoch: 26 | loss: 0.0685043
	speed: 1.1310s/iter; left time: 4949.1816s
Epoch: 26 cost time: 66.81779360771179
Epoch: 26, Steps: 179 | Train Loss: 0.0696562 Vali Loss: 0.3409168 Test Loss: 0.4030733
Validation loss decreased (0.342438 --> 0.340917).  Saving model ...
Updating learning rate to 0.00013869478656091687
	iters: 100, epoch: 27 | loss: 0.0693863
	speed: 1.0996s/iter; left time: 4615.1790s
Epoch: 27 cost time: 76.2063889503479
Epoch: 27, Steps: 179 | Train Loss: 0.0692709 Vali Loss: 0.3411058 Test Loss: 0.4033480
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00013176004723287101
	iters: 100, epoch: 28 | loss: 0.0671581
	speed: 1.2466s/iter; left time: 5009.0366s
Epoch: 28 cost time: 79.04855680465698
Epoch: 28, Steps: 179 | Train Loss: 0.0689920 Vali Loss: 0.3400518 Test Loss: 0.4025221
Validation loss decreased (0.340917 --> 0.340052).  Saving model ...
Updating learning rate to 0.00012517204487122748
	iters: 100, epoch: 29 | loss: 0.0683028
	speed: 1.2244s/iter; left time: 4700.3078s
Epoch: 29 cost time: 69.14459347724915
Epoch: 29, Steps: 179 | Train Loss: 0.0687753 Vali Loss: 0.3404203 Test Loss: 0.4026496
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00011891344262766608
	iters: 100, epoch: 30 | loss: 0.0699640
	speed: 1.2048s/iter; left time: 4409.4756s
Epoch: 30 cost time: 73.45219898223877
Epoch: 30, Steps: 179 | Train Loss: 0.0686165 Vali Loss: 0.3401126 Test Loss: 0.4022875
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00011296777049628277
	iters: 100, epoch: 31 | loss: 0.0667567
	speed: 1.1705s/iter; left time: 4074.3507s
Epoch: 31 cost time: 81.0199089050293
Epoch: 31, Steps: 179 | Train Loss: 0.0684977 Vali Loss: 0.3401638 Test Loss: 0.4023079
EarlyStopping counter: 3 out of 3
Early stopping
train 11465
val 1661
test 3413
Model(
  (freq_upsampler): Linear(in_features=165, out_features=187, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  1702208640.0
params:  31042.0
Trainable parameters:  31042
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.2327921
	speed: 0.4299s/iter; left time: 3805.4391s
Epoch: 1 cost time: 76.36499500274658
Epoch: 1, Steps: 179 | Train Loss: 0.2401596 Vali Loss: 0.3349894 Test Loss: 0.3998688
Validation loss decreased (inf --> 0.334989).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.2328907
	speed: 1.2677s/iter; left time: 10993.4259s
Epoch: 2 cost time: 75.57082438468933
Epoch: 2, Steps: 179 | Train Loss: 0.2391676 Vali Loss: 0.3347473 Test Loss: 0.3992423
Validation loss decreased (0.334989 --> 0.334747).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.2271849
	speed: 1.1837s/iter; left time: 10052.7854s
Epoch: 3 cost time: 70.07846307754517
Epoch: 3, Steps: 179 | Train Loss: 0.2387963 Vali Loss: 0.3348326 Test Loss: 0.3990209
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2734520
	speed: 1.1672s/iter; left time: 9704.3801s
Epoch: 4 cost time: 76.65929007530212
Epoch: 4, Steps: 179 | Train Loss: 0.2387744 Vali Loss: 0.3336023 Test Loss: 0.3987459
Validation loss decreased (0.334747 --> 0.333602).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.2383904
	speed: 1.2672s/iter; left time: 10308.8924s
Epoch: 5 cost time: 77.32914972305298
Epoch: 5, Steps: 179 | Train Loss: 0.2386584 Vali Loss: 0.3338873 Test Loss: 0.3982287
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.2473208
	speed: 1.2534s/iter; left time: 9972.1682s
Epoch: 6 cost time: 76.4735860824585
Epoch: 6, Steps: 179 | Train Loss: 0.2385532 Vali Loss: 0.3340768 Test Loss: 0.3984198
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.2366649
	speed: 1.2169s/iter; left time: 9463.9565s
Epoch: 7 cost time: 75.16603350639343
Epoch: 7, Steps: 179 | Train Loss: 0.2384819 Vali Loss: 0.3332720 Test Loss: 0.3983443
Validation loss decreased (0.333602 --> 0.333272).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.2387823
	speed: 1.2386s/iter; left time: 9410.5643s
Epoch: 8 cost time: 75.40978360176086
Epoch: 8, Steps: 179 | Train Loss: 0.2384393 Vali Loss: 0.3329394 Test Loss: 0.3981515
Validation loss decreased (0.333272 --> 0.332939).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.2409097
	speed: 1.2303s/iter; left time: 9127.5594s
Epoch: 9 cost time: 72.77954578399658
Epoch: 9, Steps: 179 | Train Loss: 0.2383459 Vali Loss: 0.3342584 Test Loss: 0.3978957
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.2390620
	speed: 1.1394s/iter; left time: 8249.3575s
Epoch: 10 cost time: 70.05996441841125
Epoch: 10, Steps: 179 | Train Loss: 0.2383141 Vali Loss: 0.3340403 Test Loss: 0.3981698
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.2355943
	speed: 1.1635s/iter; left time: 8215.3697s
Epoch: 11 cost time: 72.81683778762817
Epoch: 11, Steps: 179 | Train Loss: 0.2382851 Vali Loss: 0.3331343 Test Loss: 0.3986486
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Traffic_720_j96_H5_FITS_custom_ftM_sl720_ll48_pl96_H5_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 3413
mse:0.3978860080242157, mae:0.2851178050041199, rse:0.5223153233528137, corr:[0.28836045 0.2965357  0.2969885  0.29703614 0.29680306 0.29618365
 0.29576126 0.295998   0.29671872 0.29730448 0.29731628 0.29686558
 0.2964216  0.29629126 0.2964171  0.2964448  0.296221   0.29603446
 0.29619953 0.29667372 0.29701403 0.29681846 0.2962546  0.29623467
 0.29698038 0.2971486  0.29726243 0.2975893  0.29779872 0.29767087
 0.29727033 0.29675135 0.2962197  0.29571953 0.29533175 0.29522726
 0.29550537 0.2959069  0.29616502 0.2962461  0.29631886 0.29644254
 0.2964887  0.29637533 0.2961801  0.29604098 0.29598802 0.2960831
 0.29613158 0.29574788 0.29534158 0.29520813 0.29528922 0.29541433
 0.29555234 0.2957541  0.2959883  0.29606763 0.29581    0.29534855
 0.29510608 0.29517832 0.2953083  0.29516178 0.29478514 0.29458794
 0.29479665 0.29517835 0.29534295 0.29522574 0.2950823  0.2952616
 0.29558983 0.2957429  0.29556507 0.29515973 0.29484457 0.29471242
 0.29453972 0.29416513 0.2937555  0.29363373 0.29394564 0.29451475
 0.29500157 0.29512525 0.29496586 0.29477766 0.2946288  0.29434025
 0.29379123 0.29318917 0.29286954 0.2929757  0.2935547  0.29473257]
