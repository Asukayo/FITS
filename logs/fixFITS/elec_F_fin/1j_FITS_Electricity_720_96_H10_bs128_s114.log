Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=256, c_out=7, checkpoints='./checkpoints/', cut_freq=320, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=4, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_720_j96_H10', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:4
>>>>>>>start training : Electricity_720_j96_H10_FITS_custom_ftM_sl720_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=320, out_features=362, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  9519267840.0
params:  116202.0
Trainable parameters:  116202
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 38.552700996398926
Epoch: 1, Steps: 68 | Train Loss: 0.5456807 Vali Loss: 0.2394612 Test Loss: 0.2842294
Validation loss decreased (inf --> 0.239461).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 32.93962216377258
Epoch: 2, Steps: 68 | Train Loss: 0.2074005 Vali Loss: 0.1330206 Test Loss: 0.1605082
Validation loss decreased (0.239461 --> 0.133021).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 32.61631631851196
Epoch: 3, Steps: 68 | Train Loss: 0.1488476 Vali Loss: 0.1181201 Test Loss: 0.1420498
Validation loss decreased (0.133021 --> 0.118120).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 35.55862069129944
Epoch: 4, Steps: 68 | Train Loss: 0.1406514 Vali Loss: 0.1162317 Test Loss: 0.1392913
Validation loss decreased (0.118120 --> 0.116232).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 32.636895418167114
Epoch: 5, Steps: 68 | Train Loss: 0.1388872 Vali Loss: 0.1159799 Test Loss: 0.1384370
Validation loss decreased (0.116232 --> 0.115980).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 34.624271869659424
Epoch: 6, Steps: 68 | Train Loss: 0.1380838 Vali Loss: 0.1149225 Test Loss: 0.1380360
Validation loss decreased (0.115980 --> 0.114923).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 32.496424198150635
Epoch: 7, Steps: 68 | Train Loss: 0.1375868 Vali Loss: 0.1147031 Test Loss: 0.1376800
Validation loss decreased (0.114923 --> 0.114703).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 29.984140157699585
Epoch: 8, Steps: 68 | Train Loss: 0.1371658 Vali Loss: 0.1140638 Test Loss: 0.1374716
Validation loss decreased (0.114703 --> 0.114064).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 33.93478274345398
Epoch: 9, Steps: 68 | Train Loss: 0.1368750 Vali Loss: 0.1143593 Test Loss: 0.1372544
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 30.397318601608276
Epoch: 10, Steps: 68 | Train Loss: 0.1365477 Vali Loss: 0.1144046 Test Loss: 0.1371309
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 29.961066722869873
Epoch: 11, Steps: 68 | Train Loss: 0.1364061 Vali Loss: 0.1136264 Test Loss: 0.1369943
Validation loss decreased (0.114064 --> 0.113626).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 29.69364285469055
Epoch: 12, Steps: 68 | Train Loss: 0.1362090 Vali Loss: 0.1140778 Test Loss: 0.1368598
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 29.514361143112183
Epoch: 13, Steps: 68 | Train Loss: 0.1360857 Vali Loss: 0.1141118 Test Loss: 0.1368266
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 34.832967042922974
Epoch: 14, Steps: 68 | Train Loss: 0.1359323 Vali Loss: 0.1141916 Test Loss: 0.1367060
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Electricity_720_j96_H10_FITS_custom_ftM_sl720_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.13574716448783875, mae:0.23331782221794128, rse:0.3661923408508301, corr:[0.46480578 0.4660291  0.46998057 0.46999654 0.47195178 0.47129214
 0.47266898 0.4718027  0.47220182 0.47178003 0.47124705 0.47141498
 0.47091994 0.4709251  0.47078082 0.47067636 0.4708958  0.4707184
 0.470881   0.47072017 0.4707401  0.4708359  0.47077355 0.47131523
 0.47127676 0.4717134  0.4718085  0.4716257  0.47177553 0.4712652
 0.4713082  0.47098392 0.47077882 0.47084662 0.47042882 0.47063205
 0.47046518 0.47041327 0.47059092 0.47044    0.47064188 0.47058406
 0.47056875 0.47053343 0.47036907 0.47051314 0.47035182 0.47069103
 0.47082007 0.4707073  0.47101328 0.47072494 0.47073153 0.47051483
 0.47023955 0.47030413 0.46988815 0.47011015 0.47005683 0.46994436
 0.47010314 0.46995816 0.47015852 0.47004408 0.47003913 0.47016233
 0.47000355 0.46997827 0.46964926 0.4696533  0.46969208 0.46960357
 0.46978423 0.4694502  0.46952704 0.46937633 0.46905008 0.4691893
 0.4687776  0.4689913  0.4688423  0.468862   0.46921098 0.46892494
 0.469363   0.46913493 0.4690654  0.46918654 0.46848372 0.46876207
 0.467903   0.46768832 0.46696874 0.4670483  0.46631786 0.46962717]
