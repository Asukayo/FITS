Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=512, c_out=7, checkpoints='./checkpoints/', cut_freq=320, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=4, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_720_j96_H10', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:4
>>>>>>>start training : Electricity_720_j96_H10_FITS_custom_ftM_sl720_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=320, out_features=362, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  19038535680.0
params:  116202.0
Trainable parameters:  116202
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
Epoch: 1 cost time: 42.68151831626892
Epoch: 1, Steps: 34 | Train Loss: 0.7127495 Vali Loss: 0.4083255 Test Loss: 0.4756683
Validation loss decreased (inf --> 0.408326).  Saving model ...
Updating learning rate to 0.0005
Epoch: 2 cost time: 45.899314165115356
Epoch: 2, Steps: 34 | Train Loss: 0.3746907 Vali Loss: 0.2387042 Test Loss: 0.2845311
Validation loss decreased (0.408326 --> 0.238704).  Saving model ...
Updating learning rate to 0.000475
Epoch: 3 cost time: 48.783833026885986
Epoch: 3, Steps: 34 | Train Loss: 0.2386809 Vali Loss: 0.1654527 Test Loss: 0.2005786
Validation loss decreased (0.238704 --> 0.165453).  Saving model ...
Updating learning rate to 0.00045125
Epoch: 4 cost time: 47.584404945373535
Epoch: 4, Steps: 34 | Train Loss: 0.1798245 Vali Loss: 0.1353315 Test Loss: 0.1648498
Validation loss decreased (0.165453 --> 0.135332).  Saving model ...
Updating learning rate to 0.0004286875
Epoch: 5 cost time: 43.825562477111816
Epoch: 5, Steps: 34 | Train Loss: 0.1556638 Vali Loss: 0.1229846 Test Loss: 0.1501852
Validation loss decreased (0.135332 --> 0.122985).  Saving model ...
Updating learning rate to 0.00040725312499999993
Epoch: 6 cost time: 46.4171679019928
Epoch: 6, Steps: 34 | Train Loss: 0.1459531 Vali Loss: 0.1189908 Test Loss: 0.1442519
Validation loss decreased (0.122985 --> 0.118991).  Saving model ...
Updating learning rate to 0.0003868904687499999
Epoch: 7 cost time: 46.43778204917908
Epoch: 7, Steps: 34 | Train Loss: 0.1419446 Vali Loss: 0.1173836 Test Loss: 0.1418055
Validation loss decreased (0.118991 --> 0.117384).  Saving model ...
Updating learning rate to 0.00036754594531249993
Epoch: 8 cost time: 45.33647537231445
Epoch: 8, Steps: 34 | Train Loss: 0.1403332 Vali Loss: 0.1165409 Test Loss: 0.1406740
Validation loss decreased (0.117384 --> 0.116541).  Saving model ...
Updating learning rate to 0.00034916864804687486
Epoch: 9 cost time: 44.784607887268066
Epoch: 9, Steps: 34 | Train Loss: 0.1394793 Vali Loss: 0.1162229 Test Loss: 0.1400709
Validation loss decreased (0.116541 --> 0.116223).  Saving model ...
Updating learning rate to 0.00033171021564453113
Epoch: 10 cost time: 45.10107660293579
Epoch: 10, Steps: 34 | Train Loss: 0.1388832 Vali Loss: 0.1153095 Test Loss: 0.1397264
Validation loss decreased (0.116223 --> 0.115310).  Saving model ...
Updating learning rate to 0.00031512470486230455
Epoch: 11 cost time: 45.16970419883728
Epoch: 11, Steps: 34 | Train Loss: 0.1383778 Vali Loss: 0.1151480 Test Loss: 0.1394689
Validation loss decreased (0.115310 --> 0.115148).  Saving model ...
Updating learning rate to 0.00029936846961918935
Epoch: 12 cost time: 49.85841107368469
Epoch: 12, Steps: 34 | Train Loss: 0.1381484 Vali Loss: 0.1149536 Test Loss: 0.1393106
Validation loss decreased (0.115148 --> 0.114954).  Saving model ...
Updating learning rate to 0.0002844000461382298
Epoch: 13 cost time: 44.00531029701233
Epoch: 13, Steps: 34 | Train Loss: 0.1377853 Vali Loss: 0.1158624 Test Loss: 0.1391572
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002701800438313183
Epoch: 14 cost time: 39.324174642562866
Epoch: 14, Steps: 34 | Train Loss: 0.1375473 Vali Loss: 0.1155646 Test Loss: 0.1390453
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002566710416397524
Epoch: 15 cost time: 41.01162505149841
Epoch: 15, Steps: 34 | Train Loss: 0.1374512 Vali Loss: 0.1145780 Test Loss: 0.1389647
Validation loss decreased (0.114954 --> 0.114578).  Saving model ...
Updating learning rate to 0.00024383748955776477
Epoch: 16 cost time: 41.38376212120056
Epoch: 16, Steps: 34 | Train Loss: 0.1373489 Vali Loss: 0.1145075 Test Loss: 0.1388638
Validation loss decreased (0.114578 --> 0.114508).  Saving model ...
Updating learning rate to 0.0002316456150798765
Epoch: 17 cost time: 45.3627450466156
Epoch: 17, Steps: 34 | Train Loss: 0.1371265 Vali Loss: 0.1146599 Test Loss: 0.1388024
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00022006333432588268
Epoch: 18 cost time: 45.04664587974548
Epoch: 18, Steps: 34 | Train Loss: 0.1370030 Vali Loss: 0.1148725 Test Loss: 0.1387089
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00020906016760958854
Epoch: 19 cost time: 42.672133445739746
Epoch: 19, Steps: 34 | Train Loss: 0.1368920 Vali Loss: 0.1143119 Test Loss: 0.1386498
Validation loss decreased (0.114508 --> 0.114312).  Saving model ...
Updating learning rate to 0.0001986071592291091
Epoch: 20 cost time: 45.331525802612305
Epoch: 20, Steps: 34 | Train Loss: 0.1367288 Vali Loss: 0.1144291 Test Loss: 0.1385900
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00018867680126765363
Epoch: 21 cost time: 46.11999464035034
Epoch: 21, Steps: 34 | Train Loss: 0.1367291 Vali Loss: 0.1145532 Test Loss: 0.1385584
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00017924296120427094
Epoch: 22 cost time: 42.16768217086792
Epoch: 22, Steps: 34 | Train Loss: 0.1367008 Vali Loss: 0.1141790 Test Loss: 0.1385107
Validation loss decreased (0.114312 --> 0.114179).  Saving model ...
Updating learning rate to 0.0001702808131440574
Epoch: 23 cost time: 43.04717421531677
Epoch: 23, Steps: 34 | Train Loss: 0.1364604 Vali Loss: 0.1143252 Test Loss: 0.1384546
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0001617667724868545
Epoch: 24 cost time: 43.752360343933105
Epoch: 24, Steps: 34 | Train Loss: 0.1365005 Vali Loss: 0.1145435 Test Loss: 0.1384291
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00015367843386251178
Epoch: 25 cost time: 46.544694662094116
Epoch: 25, Steps: 34 | Train Loss: 0.1364120 Vali Loss: 0.1141534 Test Loss: 0.1383927
Validation loss decreased (0.114179 --> 0.114153).  Saving model ...
Updating learning rate to 0.0001459945121693862
Epoch: 26 cost time: 42.00490760803223
Epoch: 26, Steps: 34 | Train Loss: 0.1363180 Vali Loss: 0.1139494 Test Loss: 0.1383583
Validation loss decreased (0.114153 --> 0.113949).  Saving model ...
Updating learning rate to 0.00013869478656091687
Epoch: 27 cost time: 42.79074168205261
Epoch: 27, Steps: 34 | Train Loss: 0.1363011 Vali Loss: 0.1142606 Test Loss: 0.1383425
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00013176004723287101
Epoch: 28 cost time: 42.35483121871948
Epoch: 28, Steps: 34 | Train Loss: 0.1362405 Vali Loss: 0.1144511 Test Loss: 0.1383012
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00012517204487122748
Epoch: 29 cost time: 46.37334322929382
Epoch: 29, Steps: 34 | Train Loss: 0.1361043 Vali Loss: 0.1138829 Test Loss: 0.1382887
Validation loss decreased (0.113949 --> 0.113883).  Saving model ...
Updating learning rate to 0.00011891344262766608
Epoch: 30 cost time: 43.60048532485962
Epoch: 30, Steps: 34 | Train Loss: 0.1361214 Vali Loss: 0.1144949 Test Loss: 0.1382539
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00011296777049628277
Epoch: 31 cost time: 48.1153290271759
Epoch: 31, Steps: 34 | Train Loss: 0.1360575 Vali Loss: 0.1139207 Test Loss: 0.1382439
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00010731938197146864
Epoch: 32 cost time: 43.088473320007324
Epoch: 32, Steps: 34 | Train Loss: 0.1360318 Vali Loss: 0.1144028 Test Loss: 0.1382165
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Electricity_720_j96_H10_FITS_custom_ftM_sl720_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.13569962978363037, mae:0.23325462639331818, rse:0.36612820625305176, corr:[0.46454874 0.46584976 0.46986514 0.46997604 0.4719766  0.471247
 0.47271407 0.47182745 0.47219962 0.47180238 0.47134644 0.47141406
 0.4708775  0.4709356  0.47084522 0.47070652 0.4708703  0.470731
 0.4709302  0.470818   0.47087905 0.47102556 0.47090536 0.47137445
 0.4713282  0.47170565 0.47180593 0.47167417 0.471794   0.4712694
 0.47137156 0.47102565 0.47076878 0.47088534 0.47040394 0.4705665
 0.47048545 0.4704225  0.47060192 0.47048748 0.47067213 0.4706183
 0.47064647 0.47061846 0.47039714 0.47059694 0.47044763 0.47071773
 0.47087336 0.47084168 0.47109854 0.470716   0.4707269  0.4704931
 0.47020912 0.47032118 0.4699202  0.47011217 0.46998867 0.46990645
 0.47014746 0.46992418 0.47020096 0.47019517 0.47016838 0.4702957
 0.47006452 0.47008842 0.4697615  0.46966583 0.4697217  0.46960354
 0.46985695 0.46959227 0.46963888 0.4694964  0.46919295 0.46931076
 0.46889475 0.4690567  0.4688795  0.4688495  0.46917796 0.46887687
 0.4693131  0.46915615 0.46911207 0.46932188 0.4685963  0.46881685
 0.4678847  0.46774954 0.4670002  0.4670118  0.4662358  0.46956357]
