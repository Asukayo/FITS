Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=64, c_out=7, checkpoints='./checkpoints/', cut_freq=320, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=4, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_720_j96_H10', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=2, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:4
>>>>>>>start training : Electricity_720_j96_H10_FITS_custom_ftM_sl720_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=320, out_features=362, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2379816960.0
params:  116202.0
Trainable parameters:  116202
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.7008296
	speed: 0.2733s/iter; left time: 3716.5920s
	iters: 200, epoch: 1 | loss: 0.6047086
	speed: 0.2699s/iter; left time: 3643.4653s
Epoch: 1 cost time: 74.9888825416565
Epoch: 1, Steps: 274 | Train Loss: 0.7031561 Vali Loss: 0.5434951 Test Loss: 0.6204478
Validation loss decreased (inf --> 0.543495).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.4977539
	speed: 0.8802s/iter; left time: 11730.0728s
	iters: 200, epoch: 2 | loss: 0.4256871
	speed: 0.2391s/iter; left time: 3162.3461s
Epoch: 2 cost time: 68.54833745956421
Epoch: 2, Steps: 274 | Train Loss: 0.4711284 Vali Loss: 0.4292165 Test Loss: 0.4940685
Validation loss decreased (0.543495 --> 0.429216).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.3575988
	speed: 0.8543s/iter; left time: 11151.4229s
	iters: 200, epoch: 3 | loss: 0.3049873
	speed: 0.2463s/iter; left time: 3190.8614s
Epoch: 3 cost time: 68.3848512172699
Epoch: 3, Steps: 274 | Train Loss: 0.3374995 Vali Loss: 0.3401647 Test Loss: 0.3953306
Validation loss decreased (0.429216 --> 0.340165).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.2573166
	speed: 0.8963s/iter; left time: 11453.7683s
	iters: 200, epoch: 4 | loss: 0.2166705
	speed: 0.2483s/iter; left time: 3148.5746s
Epoch: 4 cost time: 70.14181613922119
Epoch: 4, Steps: 274 | Train Loss: 0.2425497 Vali Loss: 0.2720989 Test Loss: 0.3194815
Validation loss decreased (0.340165 --> 0.272099).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1857744
	speed: 0.8513s/iter; left time: 10645.2462s
	iters: 200, epoch: 5 | loss: 0.1602681
	speed: 0.2362s/iter; left time: 2930.3541s
Epoch: 5 cost time: 66.03690767288208
Epoch: 5, Steps: 274 | Train Loss: 0.1744890 Vali Loss: 0.2232929 Test Loss: 0.2640935
Validation loss decreased (0.272099 --> 0.223293).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1281563
	speed: 0.8172s/iter; left time: 9994.9413s
	iters: 200, epoch: 6 | loss: 0.1136623
	speed: 0.2405s/iter; left time: 2917.3818s
Epoch: 6 cost time: 67.20270609855652
Epoch: 6, Steps: 274 | Train Loss: 0.1257381 Vali Loss: 0.1892899 Test Loss: 0.2255361
Validation loss decreased (0.223293 --> 0.189290).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.0935274
	speed: 0.8403s/iter; left time: 10047.3509s
	iters: 200, epoch: 7 | loss: 0.0842635
	speed: 0.2308s/iter; left time: 2736.2428s
Epoch: 7 cost time: 64.74973011016846
Epoch: 7, Steps: 274 | Train Loss: 0.0911516 Vali Loss: 0.1667475 Test Loss: 0.1999057
Validation loss decreased (0.189290 --> 0.166748).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.0658123
	speed: 0.8097s/iter; left time: 9460.1514s
	iters: 200, epoch: 8 | loss: 0.0623898
	speed: 0.2323s/iter; left time: 2691.0008s
Epoch: 8 cost time: 64.65958142280579
Epoch: 8, Steps: 274 | Train Loss: 0.0668745 Vali Loss: 0.1475569 Test Loss: 0.1775317
Validation loss decreased (0.166748 --> 0.147557).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.0525486
	speed: 0.8767s/iter; left time: 10002.6275s
	iters: 200, epoch: 9 | loss: 0.0460607
	speed: 0.2613s/iter; left time: 2955.2234s
Epoch: 9 cost time: 71.07547402381897
Epoch: 9, Steps: 274 | Train Loss: 0.0501335 Vali Loss: 0.1369269 Test Loss: 0.1651316
Validation loss decreased (0.147557 --> 0.136927).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.0392805
	speed: 0.8330s/iter; left time: 9275.8547s
	iters: 200, epoch: 10 | loss: 0.0380419
	speed: 0.2351s/iter; left time: 2594.4794s
Epoch: 10 cost time: 66.51479530334473
Epoch: 10, Steps: 274 | Train Loss: 0.0388197 Vali Loss: 0.1287368 Test Loss: 0.1552278
Validation loss decreased (0.136927 --> 0.128737).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.0346830
	speed: 0.8671s/iter; left time: 9417.3468s
	iters: 200, epoch: 11 | loss: 0.0289056
	speed: 0.2450s/iter; left time: 2636.9648s
Epoch: 11 cost time: 68.17560172080994
Epoch: 11, Steps: 274 | Train Loss: 0.0313757 Vali Loss: 0.1238464 Test Loss: 0.1493517
Validation loss decreased (0.128737 --> 0.123846).  Saving model ...
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.0252911
	speed: 0.9022s/iter; left time: 9551.7042s
	iters: 200, epoch: 12 | loss: 0.0249876
	speed: 0.2646s/iter; left time: 2774.4598s
Epoch: 12 cost time: 71.51853442192078
Epoch: 12, Steps: 274 | Train Loss: 0.0266096 Vali Loss: 0.1208672 Test Loss: 0.1454380
Validation loss decreased (0.123846 --> 0.120867).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.0244264
	speed: 0.8380s/iter; left time: 8642.2626s
	iters: 200, epoch: 13 | loss: 0.0230758
	speed: 0.2240s/iter; left time: 2287.6290s
Epoch: 13 cost time: 63.08183312416077
Epoch: 13, Steps: 274 | Train Loss: 0.0236770 Vali Loss: 0.1192278 Test Loss: 0.1433169
Validation loss decreased (0.120867 --> 0.119228).  Saving model ...
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.0254541
	speed: 0.7413s/iter; left time: 7441.9942s
	iters: 200, epoch: 14 | loss: 0.0216479
	speed: 0.2326s/iter; left time: 2311.5886s
Epoch: 14 cost time: 62.411367893218994
Epoch: 14, Steps: 274 | Train Loss: 0.0219346 Vali Loss: 0.1182436 Test Loss: 0.1418347
Validation loss decreased (0.119228 --> 0.118244).  Saving model ...
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.0221337
	speed: 0.8424s/iter; left time: 8225.7045s
	iters: 200, epoch: 15 | loss: 0.0210138
	speed: 0.2362s/iter; left time: 2282.8214s
Epoch: 15 cost time: 64.12143993377686
Epoch: 15, Steps: 274 | Train Loss: 0.0209481 Vali Loss: 0.1175444 Test Loss: 0.1408681
Validation loss decreased (0.118244 --> 0.117544).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.0192780
	speed: 0.7926s/iter; left time: 7522.6367s
	iters: 200, epoch: 16 | loss: 0.0202172
	speed: 0.2238s/iter; left time: 2101.4171s
Epoch: 16 cost time: 63.25523090362549
Epoch: 16, Steps: 274 | Train Loss: 0.0204209 Vali Loss: 0.1174521 Test Loss: 0.1405542
Validation loss decreased (0.117544 --> 0.117452).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.0199528
	speed: 0.7625s/iter; left time: 7028.2216s
	iters: 200, epoch: 17 | loss: 0.0210081
	speed: 0.2233s/iter; left time: 2036.1529s
Epoch: 17 cost time: 63.75689911842346
Epoch: 17, Steps: 274 | Train Loss: 0.0201524 Vali Loss: 0.1173563 Test Loss: 0.1401410
Validation loss decreased (0.117452 --> 0.117356).  Saving model ...
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.0204312
	speed: 0.8842s/iter; left time: 7907.3672s
	iters: 200, epoch: 18 | loss: 0.0212751
	speed: 0.2235s/iter; left time: 1975.9937s
Epoch: 18 cost time: 63.801769971847534
Epoch: 18, Steps: 274 | Train Loss: 0.0200262 Vali Loss: 0.1171965 Test Loss: 0.1400305
Validation loss decreased (0.117356 --> 0.117197).  Saving model ...
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.0200887
	speed: 0.7765s/iter; left time: 6731.0971s
	iters: 200, epoch: 19 | loss: 0.0184280
	speed: 0.2223s/iter; left time: 1904.6191s
Epoch: 19 cost time: 62.00008845329285
Epoch: 19, Steps: 274 | Train Loss: 0.0199666 Vali Loss: 0.1171335 Test Loss: 0.1399823
Validation loss decreased (0.117197 --> 0.117133).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.0196826
	speed: 0.7847s/iter; left time: 6587.8675s
	iters: 200, epoch: 20 | loss: 0.0194496
	speed: 0.2364s/iter; left time: 1960.9806s
Epoch: 20 cost time: 63.56713891029358
Epoch: 20, Steps: 274 | Train Loss: 0.0199477 Vali Loss: 0.1172772 Test Loss: 0.1400441
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.0210271
	speed: 0.8247s/iter; left time: 6697.5164s
	iters: 200, epoch: 21 | loss: 0.0228817
	speed: 0.2309s/iter; left time: 1851.8705s
Epoch: 21 cost time: 63.28087759017944
Epoch: 21, Steps: 274 | Train Loss: 0.0199400 Vali Loss: 0.1172024 Test Loss: 0.1399360
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.0185302
	speed: 0.8144s/iter; left time: 6390.9725s
	iters: 200, epoch: 22 | loss: 0.0189536
	speed: 0.2593s/iter; left time: 2008.7692s
Epoch: 22 cost time: 71.13555979728699
Epoch: 22, Steps: 274 | Train Loss: 0.0199325 Vali Loss: 0.1171656 Test Loss: 0.1399007
EarlyStopping counter: 3 out of 3
Early stopping
train 17597
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=320, out_features=362, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  2379816960.0
params:  116202.0
Trainable parameters:  116202
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1228776
	speed: 0.2556s/iter; left time: 3476.8707s
	iters: 200, epoch: 1 | loss: 0.1246044
	speed: 0.2294s/iter; left time: 3097.1463s
Epoch: 1 cost time: 65.00687670707703
Epoch: 1, Steps: 274 | Train Loss: 0.1366078 Vali Loss: 0.1139446 Test Loss: 0.1358070
Validation loss decreased (inf --> 0.113945).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1299493
	speed: 0.7789s/iter; left time: 10379.8705s
	iters: 200, epoch: 2 | loss: 0.1523196
	speed: 0.2255s/iter; left time: 2982.1095s
Epoch: 2 cost time: 61.567622661590576
Epoch: 2, Steps: 274 | Train Loss: 0.1357187 Vali Loss: 0.1138851 Test Loss: 0.1353409
Validation loss decreased (0.113945 --> 0.113885).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1377826
	speed: 0.7965s/iter; left time: 10397.3539s
	iters: 200, epoch: 3 | loss: 0.1434348
	speed: 0.2159s/iter; left time: 2797.0939s
Epoch: 3 cost time: 60.52152228355408
Epoch: 3, Steps: 274 | Train Loss: 0.1354773 Vali Loss: 0.1138248 Test Loss: 0.1354537
Validation loss decreased (0.113885 --> 0.113825).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1305478
	speed: 0.7926s/iter; left time: 10128.5300s
	iters: 200, epoch: 4 | loss: 0.1351031
	speed: 0.2176s/iter; left time: 2758.9513s
Epoch: 4 cost time: 61.33798623085022
Epoch: 4, Steps: 274 | Train Loss: 0.1354012 Vali Loss: 0.1136499 Test Loss: 0.1350688
Validation loss decreased (0.113825 --> 0.113650).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1472969
	speed: 0.8069s/iter; left time: 10089.9549s
	iters: 200, epoch: 5 | loss: 0.1339440
	speed: 0.2152s/iter; left time: 2669.7474s
Epoch: 5 cost time: 60.37060046195984
Epoch: 5, Steps: 274 | Train Loss: 0.1352956 Vali Loss: 0.1135599 Test Loss: 0.1350643
Validation loss decreased (0.113650 --> 0.113560).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1334475
	speed: 0.7663s/iter; left time: 9372.1555s
	iters: 200, epoch: 6 | loss: 0.1335480
	speed: 0.2091s/iter; left time: 2536.9392s
Epoch: 6 cost time: 60.3028519153595
Epoch: 6, Steps: 274 | Train Loss: 0.1352607 Vali Loss: 0.1135932 Test Loss: 0.1352910
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1452620
	speed: 0.8240s/iter; left time: 9852.1486s
	iters: 200, epoch: 7 | loss: 0.1498485
	speed: 0.2320s/iter; left time: 2751.2856s
Epoch: 7 cost time: 65.39217400550842
Epoch: 7, Steps: 274 | Train Loss: 0.1352474 Vali Loss: 0.1133826 Test Loss: 0.1350287
Validation loss decreased (0.113560 --> 0.113383).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1278432
	speed: 0.7741s/iter; left time: 9043.3915s
	iters: 200, epoch: 8 | loss: 0.1310878
	speed: 0.2072s/iter; left time: 2400.2109s
Epoch: 8 cost time: 58.84718298912048
Epoch: 8, Steps: 274 | Train Loss: 0.1351939 Vali Loss: 0.1133018 Test Loss: 0.1347967
Validation loss decreased (0.113383 --> 0.113302).  Saving model ...
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1346640
	speed: 0.8032s/iter; left time: 9164.1690s
	iters: 200, epoch: 9 | loss: 0.1343554
	speed: 0.2328s/iter; left time: 2632.3961s
Epoch: 9 cost time: 63.81418180465698
Epoch: 9, Steps: 274 | Train Loss: 0.1351099 Vali Loss: 0.1133132 Test Loss: 0.1349415
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1428090
	speed: 0.7681s/iter; left time: 8552.3351s
	iters: 200, epoch: 10 | loss: 0.1265221
	speed: 0.2162s/iter; left time: 2385.8050s
Epoch: 10 cost time: 61.655494928359985
Epoch: 10, Steps: 274 | Train Loss: 0.1349951 Vali Loss: 0.1133983 Test Loss: 0.1347410
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1394940
	speed: 0.7826s/iter; left time: 8500.2530s
	iters: 200, epoch: 11 | loss: 0.1323127
	speed: 0.2085s/iter; left time: 2243.8125s
Epoch: 11 cost time: 59.88940191268921
Epoch: 11, Steps: 274 | Train Loss: 0.1350740 Vali Loss: 0.1133338 Test Loss: 0.1348194
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Electricity_720_j96_H10_FITS_custom_ftM_sl720_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.13465569913387299, mae:0.23169605433940887, rse:0.36471718549728394, corr:[0.46530044 0.4689596  0.47073904 0.4709589  0.47145012 0.4711739
 0.47136837 0.47127113 0.47120512 0.4710721  0.47120598 0.47121677
 0.47088042 0.47071832 0.4707262  0.47051248 0.47068676 0.47066352
 0.47068885 0.47070822 0.47050175 0.47041908 0.47034702 0.47074607
 0.47088107 0.47078952 0.4709375  0.4709515  0.47075945 0.47068247
 0.47076464 0.47077236 0.47034127 0.4701546  0.47017103 0.47005087
 0.47013545 0.47019    0.47019058 0.47009727 0.47014624 0.47037828
 0.47031164 0.47015697 0.47009078 0.4700852  0.47035915 0.47039822
 0.47001612 0.4702252  0.4705741  0.47056547 0.47073466 0.47072813
 0.47045317 0.47027242 0.47019076 0.4701282  0.47002998 0.4698774
 0.46990117 0.46994394 0.46993503 0.46991572 0.46960223 0.46949825
 0.46962935 0.4694197  0.46941715 0.46950015 0.46952206 0.4695991
 0.46957073 0.46969658 0.469801   0.46981224 0.4699248  0.4697235
 0.46950617 0.46970546 0.4695541  0.46924576 0.46929985 0.4692965
 0.4692818  0.46907184 0.4687316  0.46891254 0.46909583 0.46876082
 0.4687731  0.46895817 0.46919018 0.4690498  0.4689845  0.46944538]
