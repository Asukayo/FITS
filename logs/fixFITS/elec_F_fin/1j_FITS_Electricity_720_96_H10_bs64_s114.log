Args in experiment:
Namespace(H_order=10, ab=2, activation='gelu', aug_data_size=1, aug_method='NA', aug_rate=0.5, base_T=24, batch_size=128, c_out=7, checkpoints='./checkpoints/', cut_freq=320, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='electricity.csv', data_size=1, dec_in=7, des='Exp', devices='0,1,2,3', distil=True, do_predict=False, dropout=0.05, e_layers=2, embed='timeF', embed_type=0, enc_in=321, factor=1, features='M', freq='h', gpu=4, groups=1, hidden_size=1, in_batch_augmentation=False, in_dataset_augmentation=False, individual=False, is_training=1, itr=1, kernel=5, label_len=48, learning_rate=0.0005, levels=3, loss='mse', lradj='type3', model='FITS', model_id='Electricity_720_j96_H10', moving_avg=25, n_heads=8, num_workers=10, output_attention=False, patience=3, pred_len=96, root_path='./dataset/', seed=114, seq_len=720, stacks=1, target='OT', test_flop=False, test_time_train=False, testset_div=2, train_epochs=50, train_mode=1, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:4
>>>>>>>start training : Electricity_720_j96_H10_FITS_custom_ftM_sl720_ll48_pl96_H10_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 2537
test 5165
Model(
  (freq_upsampler): Linear(in_features=320, out_features=362, bias=True)
)
[INFO] Register count_linear() for <class 'torch.nn.modules.linear.Linear'>.
FLOPs:  4759633920.0
params:  116202.0
Trainable parameters:  116202
!!!!!!!!!!!!!!learning rate!!!!!!!!!!!!!!!
0.0005
	iters: 100, epoch: 1 | loss: 0.1985007
	speed: 0.3459s/iter; left time: 2335.1059s
Epoch: 1 cost time: 47.5944139957428
Epoch: 1, Steps: 137 | Train Loss: 0.3770186 Vali Loss: 0.1327663 Test Loss: 0.1600283
Validation loss decreased (inf --> 0.132766).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 2 | loss: 0.1456995
	speed: 0.7172s/iter; left time: 4743.7934s
Epoch: 2 cost time: 42.8094744682312
Epoch: 2, Steps: 137 | Train Loss: 0.1445843 Vali Loss: 0.1161987 Test Loss: 0.1386164
Validation loss decreased (0.132766 --> 0.116199).  Saving model ...
Updating learning rate to 0.000475
	iters: 100, epoch: 3 | loss: 0.1351635
	speed: 0.6941s/iter; left time: 4496.0067s
Epoch: 3 cost time: 43.32272124290466
Epoch: 3, Steps: 137 | Train Loss: 0.1383515 Vali Loss: 0.1151015 Test Loss: 0.1374330
Validation loss decreased (0.116199 --> 0.115101).  Saving model ...
Updating learning rate to 0.00045125
	iters: 100, epoch: 4 | loss: 0.1487771
	speed: 0.7235s/iter; left time: 4586.7775s
Epoch: 4 cost time: 45.67701315879822
Epoch: 4, Steps: 137 | Train Loss: 0.1373052 Vali Loss: 0.1145087 Test Loss: 0.1367022
Validation loss decreased (0.115101 --> 0.114509).  Saving model ...
Updating learning rate to 0.0004286875
	iters: 100, epoch: 5 | loss: 0.1374144
	speed: 0.7266s/iter; left time: 4507.1703s
Epoch: 5 cost time: 45.6423876285553
Epoch: 5, Steps: 137 | Train Loss: 0.1366262 Vali Loss: 0.1143358 Test Loss: 0.1363820
Validation loss decreased (0.114509 --> 0.114336).  Saving model ...
Updating learning rate to 0.00040725312499999993
	iters: 100, epoch: 6 | loss: 0.1362018
	speed: 0.7276s/iter; left time: 4413.3540s
Epoch: 6 cost time: 43.4796302318573
Epoch: 6, Steps: 137 | Train Loss: 0.1362308 Vali Loss: 0.1138643 Test Loss: 0.1360988
Validation loss decreased (0.114336 --> 0.113864).  Saving model ...
Updating learning rate to 0.0003868904687499999
	iters: 100, epoch: 7 | loss: 0.1351200
	speed: 0.7202s/iter; left time: 4270.2309s
Epoch: 7 cost time: 45.88408637046814
Epoch: 7, Steps: 137 | Train Loss: 0.1359862 Vali Loss: 0.1136294 Test Loss: 0.1359229
Validation loss decreased (0.113864 --> 0.113629).  Saving model ...
Updating learning rate to 0.00036754594531249993
	iters: 100, epoch: 8 | loss: 0.1309020
	speed: 0.8000s/iter; left time: 4633.4738s
Epoch: 8 cost time: 50.01841902732849
Epoch: 8, Steps: 137 | Train Loss: 0.1357399 Vali Loss: 0.1137724 Test Loss: 0.1357613
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00034916864804687486
	iters: 100, epoch: 9 | loss: 0.1306471
	speed: 0.7443s/iter; left time: 4209.2569s
Epoch: 9 cost time: 46.352017641067505
Epoch: 9, Steps: 137 | Train Loss: 0.1355786 Vali Loss: 0.1135170 Test Loss: 0.1356185
Validation loss decreased (0.113629 --> 0.113517).  Saving model ...
Updating learning rate to 0.00033171021564453113
	iters: 100, epoch: 10 | loss: 0.1507436
	speed: 0.7317s/iter; left time: 4037.4321s
Epoch: 10 cost time: 46.07698726654053
Epoch: 10, Steps: 137 | Train Loss: 0.1355075 Vali Loss: 0.1134329 Test Loss: 0.1355398
Validation loss decreased (0.113517 --> 0.113433).  Saving model ...
Updating learning rate to 0.00031512470486230455
	iters: 100, epoch: 11 | loss: 0.1397313
	speed: 0.7390s/iter; left time: 3976.8045s
Epoch: 11 cost time: 45.428609132766724
Epoch: 11, Steps: 137 | Train Loss: 0.1353539 Vali Loss: 0.1134968 Test Loss: 0.1355561
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00029936846961918935
	iters: 100, epoch: 12 | loss: 0.1280901
	speed: 0.7055s/iter; left time: 3699.6464s
Epoch: 12 cost time: 39.07493591308594
Epoch: 12, Steps: 137 | Train Loss: 0.1352295 Vali Loss: 0.1133244 Test Loss: 0.1354856
Validation loss decreased (0.113433 --> 0.113324).  Saving model ...
Updating learning rate to 0.0002844000461382298
	iters: 100, epoch: 13 | loss: 0.1516973
	speed: 0.6416s/iter; left time: 3276.5328s
Epoch: 13 cost time: 40.4219434261322
Epoch: 13, Steps: 137 | Train Loss: 0.1352315 Vali Loss: 0.1134502 Test Loss: 0.1354703
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0002701800438313183
	iters: 100, epoch: 14 | loss: 0.1402299
	speed: 0.6189s/iter; left time: 3076.1655s
Epoch: 14 cost time: 37.063008546829224
Epoch: 14, Steps: 137 | Train Loss: 0.1351392 Vali Loss: 0.1133948 Test Loss: 0.1354177
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.0002566710416397524
	iters: 100, epoch: 15 | loss: 0.1381893
	speed: 0.5526s/iter; left time: 2670.5367s
Epoch: 15 cost time: 36.53973722457886
Epoch: 15, Steps: 137 | Train Loss: 0.1351614 Vali Loss: 0.1132995 Test Loss: 0.1354347
Validation loss decreased (0.113324 --> 0.113299).  Saving model ...
Updating learning rate to 0.00024383748955776477
	iters: 100, epoch: 16 | loss: 0.1310732
	speed: 0.7098s/iter; left time: 3333.2506s
Epoch: 16 cost time: 41.61239242553711
Epoch: 16, Steps: 137 | Train Loss: 0.1350935 Vali Loss: 0.1132859 Test Loss: 0.1354033
Validation loss decreased (0.113299 --> 0.113286).  Saving model ...
Updating learning rate to 0.0002316456150798765
	iters: 100, epoch: 17 | loss: 0.1294549
	speed: 0.6368s/iter; left time: 2903.1701s
Epoch: 17 cost time: 37.76235294342041
Epoch: 17, Steps: 137 | Train Loss: 0.1350743 Vali Loss: 0.1133021 Test Loss: 0.1353392
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00022006333432588268
	iters: 100, epoch: 18 | loss: 0.1322082
	speed: 0.6117s/iter; left time: 2704.9010s
Epoch: 18 cost time: 38.89583110809326
Epoch: 18, Steps: 137 | Train Loss: 0.1350273 Vali Loss: 0.1133546 Test Loss: 0.1352893
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00020906016760958854
	iters: 100, epoch: 19 | loss: 0.1274202
	speed: 0.5477s/iter; left time: 2346.8997s
Epoch: 19 cost time: 31.8615505695343
Epoch: 19, Steps: 137 | Train Loss: 0.1350239 Vali Loss: 0.1129906 Test Loss: 0.1352544
Validation loss decreased (0.113286 --> 0.112991).  Saving model ...
Updating learning rate to 0.0001986071592291091
	iters: 100, epoch: 20 | loss: 0.1298851
	speed: 0.5685s/iter; left time: 2357.9357s
Epoch: 20 cost time: 42.29033398628235
Epoch: 20, Steps: 137 | Train Loss: 0.1349475 Vali Loss: 0.1133264 Test Loss: 0.1352899
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00018867680126765363
	iters: 100, epoch: 21 | loss: 0.1284230
	speed: 0.6498s/iter; left time: 2606.4941s
Epoch: 21 cost time: 38.76823544502258
Epoch: 21, Steps: 137 | Train Loss: 0.1349352 Vali Loss: 0.1131542 Test Loss: 0.1352304
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00017924296120427094
	iters: 100, epoch: 22 | loss: 0.1473276
	speed: 0.6817s/iter; left time: 2641.0379s
Epoch: 22 cost time: 43.04666614532471
Epoch: 22, Steps: 137 | Train Loss: 0.1348841 Vali Loss: 0.1132479 Test Loss: 0.1353127
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : Electricity_720_j96_H10_FITS_custom_ftM_sl720_ll48_pl96_H10_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.1346725970506668, mae:0.23156128823757172, rse:0.3647400736808777, corr:[0.4661694  0.46835655 0.46965384 0.47050902 0.47103414 0.47120562
 0.47145182 0.47127318 0.47141016 0.4710501  0.47126552 0.47097647
 0.47095272 0.47092253 0.47095028 0.47079217 0.4708895  0.4708619
 0.4706852  0.4707365  0.4706859  0.47079706 0.47082403 0.47105685
 0.47132006 0.4714022  0.47134823 0.47148445 0.47122002 0.4709658
 0.47084126 0.4707804  0.47068778 0.47050983 0.47051492 0.47036752
 0.4705255  0.47041488 0.47032642 0.47046813 0.4704171  0.47056183
 0.47049686 0.47029662 0.47017628 0.4701138  0.47010884 0.4702814
 0.47054785 0.47066906 0.47058818 0.47062507 0.47053927 0.4703013
 0.47021624 0.4701341  0.47026244 0.4700544  0.47012192 0.47011393
 0.46996397 0.47013023 0.4699857  0.47004375 0.4699301  0.4699942
 0.4700534  0.46964702 0.4694792  0.46930248 0.4692813  0.46939313
 0.46945453 0.46956047 0.46932173 0.4692071  0.46935403 0.4691868
 0.4692769  0.46912915 0.46921057 0.46910423 0.46900126 0.46924782
 0.4690014  0.46941814 0.46904606 0.46912223 0.46896416 0.46874654
 0.46900073 0.46849898 0.46860737 0.4682797  0.46915016 0.46954474]
